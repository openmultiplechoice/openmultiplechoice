import{S as x,i as ee,s as te,n as T,d as w,q as C,a as S,c as f,f as m,b as v,t as L,g as c,E as le,D as se,F as ne,k as ie,m as B,l as U,p as j,H as N}from"./index-C5hKwDc9.js";import{e as E}from"./each-JoEH9o9l.js";import{c as A}from"./NewSessionHelper-Ba9jtPTo.js";import{C as ae}from"./auto-C0VlNTRY.js";import{f as I,p as oe}from"./parseISO-nqt9u7wd.js";function O(s,e,a){const r=s.slice();return r[15]=e[a],r}function V(s,e,a){const r=s.slice();return r[15]=e[a],r}function P(s,e,a){const r=s.slice();return r[15]=e[a],r}function re(s){let e;return{c(){e=m("div"),e.innerHTML='No stats available yet <i class="bi bi-heartbreak-fill"></i>',c(e,"class","alert alert-light text-center"),c(e,"role","alert")},m(a,r){S(a,e,r)},p:T,d(a){a&&w(e)}}}function ce(s){let e;return{c(){e=m("div"),e.innerHTML='<div class="spinner-border text-secondary" role="status"><span class="visually-hidden">Loading stats ...</span></div>',c(e,"class","d-flex justify-content-center mt-3 mb-3")},m(a,r){S(a,e,r)},p:T,d(a){a&&w(e)}}}function fe(s){let e,a,r,i=s[2].length>0&&F(s),l=s[3].length>0&&s[4]&&Z(s),t=s[5].length>0&&Q(s);return{c(){e=m("div"),i&&i.c(),a=v(),l&&l.c(),r=v(),t&&t.c(),c(e,"class","row")},m(o,n){S(o,e,n),i&&i.m(e,null),f(e,a),l&&l.m(e,null),f(e,r),t&&t.m(e,null)},p(o,n){o[2].length>0?i?i.p(o,n):(i=F(o),i.c(),i.m(e,a)):i&&(i.d(1),i=null),o[3].length>0&&o[4]?l?l.p(o,n):(l=Z(o),l.c(),l.m(e,r)):l&&(l.d(1),l=null),o[5].length>0?t?t.p(o,n):(t=Q(o),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},d(o){o&&w(e),i&&i.d(),l&&l.d(),t&&t.d()}}}function F(s){let e,a,r,i=E(s[2]),l=[];for(let t=0;t<i.length;t+=1)l[t]=z(P(s,i,t));return{c(){e=m("div"),a=m("h6"),a.textContent="New decks",r=v();for(let t=0;t<l.length;t+=1)l[t].c();c(e,"class","col-lg mt-3 text-truncate")},m(t,o){S(t,e,o),f(e,a),f(e,r);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(t,o){if(o&4){i=E(t[2]);let n;for(n=0;n<i.length;n+=1){const d=P(t,i,n);l[n]?l[n].p(d,o):(l[n]=z(d),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=i.length}},d(t){t&&w(e),B(l,t)}}}function R(s){let e,a,r,i,l=s[15].questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"";return{c(){e=m("span"),a=m("i"),r=v(),i=new N(!1),c(a,"class","bi bi-collection"),i.a=null,c(e,"class","badge text-bg-light font-monospace"),c(e,"title","Number of questions")},m(t,o){S(t,e,o),f(e,a),f(e,r),i.m(l,e)},p(t,o){o&4&&l!==(l=t[15].questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"")&&i.p(l)},d(t){t&&w(e)}}}function z(s){let e,a,r,i,l,t=s[15].name+"",o,n,d,g,_,u=s[15].questions.length>0&&R(s);function k(){return s[9](s[15])}return{c(){e=m("div"),u&&u.c(),a=v(),r=m("button"),r.innerHTML='<i class="bi bi-rocket-takeoff"></i>',i=v(),l=m("a"),o=L(t),d=v(),c(r,"type","button"),c(r,"class","btn btn-sm btn-primary"),c(l,"href",n="/decks/"+s[15].id),c(l,"class","alert-link text-truncate"),c(e,"class","alert alert-light m-1 p-2 text-truncate"),c(e,"role","alert")},m(b,y){S(b,e,y),u&&u.m(e,null),f(e,a),f(e,r),f(e,i),f(e,l),f(l,o),f(e,d),g||(_=U(r,"click",j(k)),g=!0)},p(b,y){s=b,s[15].questions.length>0?u?u.p(s,y):(u=R(s),u.c(),u.m(e,a)):u&&(u.d(1),u=null),y&4&&t!==(t=s[15].name+"")&&C(o,t),y&4&&n!==(n="/decks/"+s[15].id)&&c(l,"href",n)},d(b){b&&w(e),u&&u.d(),g=!1,_()}}}function Z(s){let e,a,r,i,l,t,o=E(s[3]),n=[];for(let d=0;d<o.length;d+=1)n[d]=K(V(s,o,d));return{c(){e=m("div"),a=m("h6"),r=L("Popular decks (last "),i=L(s[4]),l=L(" days)"),t=v();for(let d=0;d<n.length;d+=1)n[d].c();c(e,"class","col-lg mt-3 text-truncate")},m(d,g){S(d,e,g),f(e,a),f(a,r),f(a,i),f(a,l),f(e,t);for(let _=0;_<n.length;_+=1)n[_]&&n[_].m(e,null)},p(d,g){if(g&16&&C(i,d[4]),g&8){o=E(d[3]);let _;for(_=0;_<o.length;_+=1){const u=V(d,o,_);n[_]?n[_].p(u,g):(n[_]=K(u),n[_].c(),n[_].m(e,null))}for(;_<n.length;_+=1)n[_].d(1);n.length=o.length}},d(d){d&&w(e),B(n,d)}}}function G(s){let e,a,r,i,l=s[15].questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"";return{c(){e=m("span"),a=m("i"),r=v(),i=new N(!1),c(a,"class","bi bi-collection"),i.a=null,c(e,"class","badge text-bg-light font-monospace"),c(e,"title","Number of questions")},m(t,o){S(t,e,o),f(e,a),f(e,r),i.m(l,e)},p(t,o){o&8&&l!==(l=t[15].questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"")&&i.p(l)},d(t){t&&w(e)}}}function J(s){let e,a,r,i,l=s[15].sessions_count.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"";return{c(){e=m("span"),a=m("i"),r=v(),i=new N(!1),c(a,"class","bi bi-rocket"),i.a=null,c(e,"class","badge text-bg-light font-monospace"),c(e,"title","Number of sessions")},m(t,o){S(t,e,o),f(e,a),f(e,r),i.m(l,e)},p(t,o){o&8&&l!==(l=t[15].sessions_count.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"")&&i.p(l)},d(t){t&&w(e)}}}function K(s){let e,a,r,i,l,t,o=s[15].name+"",n,d,g,_,u,k=s[15].questions.length>0&&G(s),b=s[15].sessions_count&&J(s);function y(){return s[10](s[15])}return{c(){e=m("div"),k&&k.c(),a=v(),b&&b.c(),r=v(),i=m("button"),i.innerHTML='<i class="bi bi-rocket-takeoff"></i>',l=v(),t=m("a"),n=L(o),g=v(),c(i,"type","button"),c(i,"class","btn btn-sm btn-primary"),c(t,"href",d="/decks/"+s[15].id),c(t,"class","alert-link"),c(e,"class","alert alert-light m-1 p-2 text-truncate"),c(e,"role","alert")},m(q,p){S(q,e,p),k&&k.m(e,null),f(e,a),b&&b.m(e,null),f(e,r),f(e,i),f(e,l),f(e,t),f(t,n),f(e,g),_||(u=U(i,"click",j(y)),_=!0)},p(q,p){s=q,s[15].questions.length>0?k?k.p(s,p):(k=G(s),k.c(),k.m(e,a)):k&&(k.d(1),k=null),s[15].sessions_count?b?b.p(s,p):(b=J(s),b.c(),b.m(e,r)):b&&(b.d(1),b=null),p&8&&o!==(o=s[15].name+"")&&C(n,o),p&8&&d!==(d="/decks/"+s[15].id)&&c(t,"href",d)},d(q){q&&w(e),k&&k.d(),b&&b.d(),_=!1,u()}}}function Q(s){let e,a,r,i=E(s[5]),l=[];for(let t=0;t<i.length;t+=1)l[t]=X(O(s,i,t));return{c(){e=m("div"),a=m("h6"),a.textContent="Last used decks",r=v();for(let t=0;t<l.length;t+=1)l[t].c();c(e,"class","col-lg mt-3 text-truncate")},m(t,o){S(t,e,o),f(e,a),f(e,r);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(t,o){if(o&32){i=E(t[5]);let n;for(n=0;n<i.length;n+=1){const d=O(t,i,n);l[n]?l[n].p(d,o):(l[n]=X(d),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=i.length}},d(t){t&&w(e),B(l,t)}}}function W(s){let e,a,r,i,l=s[15].questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"";return{c(){e=m("span"),a=m("i"),r=v(),i=new N(!1),c(a,"class","bi bi-collection"),i.a=null,c(e,"class","badge text-bg-light font-monospace"),c(e,"title","Number of questions")},m(t,o){S(t,e,o),f(e,a),f(e,r),i.m(l,e)},p(t,o){o&32&&l!==(l=t[15].questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"")&&i.p(l)},d(t){t&&w(e)}}}function X(s){let e,a,r,i,l,t=s[15].name+"",o,n,d,g,_,u=s[15].questions.length>0&&W(s);function k(){return s[11](s[15])}return{c(){e=m("div"),u&&u.c(),a=v(),r=m("button"),r.innerHTML='<i class="bi bi-rocket-takeoff"></i>',i=v(),l=m("a"),o=L(t),d=v(),c(r,"type","button"),c(r,"class","btn btn-sm btn-primary"),c(l,"href",n="/decks/"+s[15].id),c(l,"class","alert-link"),c(e,"class","alert alert-light m-1 p-2 text-truncate"),c(e,"role","alert")},m(b,y){S(b,e,y),u&&u.m(e,null),f(e,a),f(e,r),f(e,i),f(e,l),f(l,o),f(e,d),g||(_=U(r,"click",j(k)),g=!0)},p(b,y){s=b,s[15].questions.length>0?u?u.p(s,y):(u=W(s),u.c(),u.m(e,a)):u&&(u.d(1),u=null),y&32&&t!==(t=s[15].name+"")&&C(o,t),y&32&&n!==(n="/decks/"+s[15].id)&&c(l,"href",n)},d(b){b&&w(e),u&&u.d(),g=!1,_()}}}function ue(s){let e,a,r,i,l,t,o,n,d,g,_,u=(s[1]?I(s[1],"HH:mm"):"unknown")+"",k;function b(p,h){return p[2]&&p[3]&&p[5]&&(p[2].length>0||p[3].length>0||p[5].length>0)?fe:!p[2]&&!p[3]&&!p[5]?ce:re}let y=b(s),q=y(s);return{c(){e=m("div"),e.innerHTML='<div class="col-md"><h4>Stats</h4></div>',a=v(),q.c(),r=v(),i=m("div"),l=m("div"),t=m("canvas"),o=v(),n=m("div"),d=m("div"),g=m("span"),_=L("Last updated: "),k=L(u),c(e,"class","row"),le(t,"max-height","300px"),c(l,"class","col-md"),c(i,"id","stats"),c(i,"class","row mt-3 p-3"),c(g,"class","badge text-bg-light text-muted"),c(d,"class","col-md"),c(n,"class","row")},m(p,h){S(p,e,h),S(p,a,h),q.m(p,h),S(p,r,h),S(p,i,h),f(i,l),f(l,t),s[12](t),S(p,o,h),S(p,n,h),f(n,d),f(d,g),f(g,_),f(g,k)},p(p,[h]){y===(y=b(p))&&q?q.p(p,h):(q.d(1),q=y(p),q&&(q.c(),q.m(r.parentNode,r))),h&2&&u!==(u=(p[1]?I(p[1],"HH:mm"):"unknown")+"")&&C(k,u)},i:T,o:T,d(p){p&&(w(e),w(a),w(r),w(i),w(o),w(n)),q.d(p),s[12](null)}}}function de(s,e,a){let r,i,l,t,o={},n={},d,g,_=0,u;se(()=>{k(),l=setInterval(k,2*60*1e3)}),ne(()=>{clearInterval(l)});function k(){axios.get("/api/stats/activity").then(function(h){const H=h.data;a(7,o=H.answers_byhour),a(8,n=H.users_byhour),a(2,d=H.decks_new),a(3,g=H.decks_popular),a(4,_=H.decks_popular_timespan),a(5,u=H.decks_last_used),a(1,t=new Date)}).catch(function(h){console.log(h)})}const b=h=>A(h.id),y=h=>A(h.id),q=h=>A(h.id);function p(h){ie[h?"unshift":"push"](()=>{r=h,a(0,r)})}return s.$$.update=()=>{s.$$.dirty&449&&r&&o&&n&&(()=>{const h=Object.keys(o),H=Object.values(o);if(H.reduce((M,D)=>M+D,0)===0){document.getElementById("stats").style.display="none";return}document.getElementById("stats").style.display="block";const Y={type:"line",data:{labels:h,datasets:[{label:"Answers",data:H,backgroundColor:"rgba(255, 205, 86, 0.4)",borderColor:"rgba(255, 205, 86, 0.4)",fill:!0,showLine:!1,pointRadius:0,tension:.2},{label:"Users",data:Object.values(n),backgroundColor:"rgba(54, 162, 235, 0.7)",borderColor:"rgba(54, 162, 235, 0.7)",fill:!0,showLine:!1,pointRadius:0,tension:.2}]},options:{plugins:{legend:{display:!1},tooltip:{callbacks:{title(M){return I(oe(M[0].label),"dd.MM.yyyy HH:mm")}}}},responsive:!0,interaction:{intersect:!1},scales:{x:{display:!0,title:{display:!1,text:"Hour of the day"},ticks:{autoSkip:!0,maxTicksLimit:3,callback(M){const D=this.getLabelForValue(M);return I(D,"dd.MM.yyyy")}},grid:{display:!1},border:{display:!1}},y:{display:!0,title:{display:!1,text:"Number of answers"},ticks:{beginAtZero:!0,stepSize:1,maxTicksLimit:4,autoSkip:!0},border:{display:!1}}}}};i&&i.destroy();var $=r.getContext("2d");a(6,i=new ae($,Y))})()},[r,t,d,g,_,u,i,o,n,b,y,q,p]}class pe extends x{constructor(e){super(),ee(this,e,de,ue,te,{})}}const _e=document.getElementById("IndexStatsView");new pe({target:_e});
