import{S as je,i as Ae,s as Pe,e as Ue,b as B,n as ne,d as V,k as ve,c as u,a as I,t as g,f as r,h as s,q as R,l as x,p as ie,o as ce,B as Re,C as mt,H as gt,r as qe,u as Te,j as Le,G as bt,I as Fe,v as Be,w as ye,D as pt,z as kt,x as be,y as he,A as Ve,m as Ke,J as ht,K as vt,L as Oe}from"./index-CW_84yAU.js";import{e as pe,u as wt,o as Dt}from"./each-23V_io8F.js";import{C as St}from"./auto-TbvzFur0.js";import{s as Mt}from"./StatsHelper-B91isISU.js";import{c as Ct}from"./NewSessionHelper-Ba9jtPTo.js";import{f as Ge,p as He}from"./parseISO-JEmvXouO.js";import{U as Qe}from"./UserSettingsStore-D7Gisc9d.js";function It(e){let t,n,l,i,o,a,c,p,_,d,f,h,M,C,m,k,U,w,Q,b,D,q=Math.round(100*e[5]/e[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",A,S,L,E,Y,T,G,O,N,J=Math.round(100*e[1]/e[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",H,z,K,W,y,P,v,j,Z,re=Math.round(100*e[4]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",we,ke,De,de,Se,se,oe,fe,Me,ge=Math.round(100*e[3]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",_e,Ce,Ne,me,ue,Ie,ae,ee,X,$=Math.round(100*e[2]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",Ee,We,Ye,te=e[2]>0&&Je(e);return{c(){t=u("div"),n=u("div"),l=u("canvas"),i=I(),o=u("div"),a=u("table"),c=u("thead"),p=I(),_=u("tbody"),d=u("tr"),f=u("td"),f.textContent="Questions",h=I(),M=u("td"),C=g(e[6]),m=I(),k=u("tr"),U=u("td"),U.textContent="Answered",w=I(),Q=u("td"),b=g(e[5]),D=g(`
                            (`),A=g(q),S=g("%)"),L=I(),E=u("tr"),Y=u("td"),Y.textContent="Unanswered",T=I(),G=u("td"),O=g(e[1]),N=g(`
                            (`),H=g(J),z=g("%)"),K=I(),W=u("tr"),y=u("td"),y.textContent="Correct",P=I(),v=u("td"),j=g(e[4]),Z=g(`
                            (`),we=g(re),ke=g("%)"),De=I(),de=u("tr"),Se=u("td"),Se.textContent="Correct with help",se=I(),oe=u("td"),fe=g(e[3]),Me=g(`
                            (`),_e=g(ge),Ce=g("%)"),Ne=I(),me=u("tr"),ue=u("td"),ue.textContent="Incorrect",Ie=I(),ae=u("td"),ee=g(e[2]),X=g(`
                            (`),Ee=g($),We=g("%)"),Ye=I(),te&&te.c(),r(n,"class","col-md-5"),r(M,"class","font-monospace text-end"),r(Q,"class","font-monospace text-end"),r(G,"class","font-monospace text-end"),r(v,"class","font-monospace text-end"),r(oe,"class","font-monospace text-end"),r(ae,"class","font-monospace text-end"),r(a,"class","table"),r(o,"class","col-md-7 mt-3"),r(t,"class","row mb-5")},m(F,le){B(F,t,le),s(t,n),s(n,l),e[14](l),s(t,i),s(t,o),s(o,a),s(a,c),s(a,p),s(a,_),s(_,d),s(d,f),s(d,h),s(d,M),s(M,C),s(_,m),s(_,k),s(k,U),s(k,w),s(k,Q),s(Q,b),s(Q,D),s(Q,A),s(Q,S),s(_,L),s(_,E),s(E,Y),s(E,T),s(E,G),s(G,O),s(G,N),s(G,H),s(G,z),s(_,K),s(_,W),s(W,y),s(W,P),s(W,v),s(v,j),s(v,Z),s(v,we),s(v,ke),s(_,De),s(_,de),s(de,Se),s(de,se),s(de,oe),s(oe,fe),s(oe,Me),s(oe,_e),s(oe,Ce),s(_,Ne),s(_,me),s(me,ue),s(me,Ie),s(me,ae),s(ae,ee),s(ae,X),s(ae,Ee),s(ae,We),s(o,Ye),te&&te.m(o,null)},p(F,le){le&64&&R(C,F[6]),le&32&&R(b,F[5]),le&96&&q!==(q=Math.round(100*F[5]/F[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&R(A,q),le&2&&R(O,F[1]),le&66&&J!==(J=Math.round(100*F[1]/F[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&R(H,J),le&16&&R(j,F[4]),le&48&&re!==(re=Math.round(100*F[4]/F[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&R(we,re),le&8&&R(fe,F[3]),le&40&&ge!==(ge=Math.round(100*F[3]/F[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&R(_e,ge),le&4&&R(ee,F[2]),le&36&&$!==($=Math.round(100*F[2]/F[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&R(Ee,$),F[2]>0?te?te.p(F,le):(te=Je(F),te.c(),te.m(o,null)):te&&(te.d(1),te=null)},d(F){F&&V(t),e[14](null),te&&te.d()}}}function Lt(e){let t,n,l,i,o,a,c,p;return{c(){t=u("div"),n=u("div"),l=u("p"),i=g("Number of questions (duplicates included): "),o=u("span"),a=u("i"),c=I(),p=g(e[6]),r(a,"class","bi bi-collection"),r(o,"class","badge text-bg-light font-monospace"),r(n,"class","col-md"),r(t,"class","row")},m(_,d){B(_,t,d),s(t,n),s(n,l),s(l,i),s(l,o),s(o,a),s(o,c),s(o,p)},p(_,d){d&64&&R(p,_[6])},d(_){_&&V(t)}}}function Je(e){let t,n,l,i,o,a,c,p,_,d,f=e[2]>=40&&Xe(e),h=e[2]>=70&&Ze(e);return{c(){t=u("div"),f&&f.c(),n=I(),h&&h.c(),l=I(),i=u("button"),o=u("i"),a=g(" Repeat "),c=g(e[2]),p=g(" incorrect"),r(o,"class","bi bi-repeat"),r(i,"class","btn btn-sm btn-outline-secondary"),r(i,"type","button"),r(t,"class","d-grid gap-2")},m(M,C){B(M,t,C),f&&f.m(t,null),s(t,n),h&&h.m(t,null),s(t,l),s(t,i),s(i,o),s(i,a),s(i,c),s(i,p),_||(d=x(i,"click",ie(e[17])),_=!0)},p(M,C){M[2]>=40?f?f.p(M,C):(f=Xe(M),f.c(),f.m(t,n)):f&&(f.d(1),f=null),M[2]>=70?h?h.p(M,C):(h=Ze(M),h.c(),h.m(t,l)):h&&(h.d(1),h=null),C&4&&R(c,M[2])},d(M){M&&V(t),f&&f.d(),h&&h.d(),_=!1,d()}}}function Xe(e){let t,n,l;return{c(){t=u("button"),t.innerHTML='<i class="bi bi-repeat"></i> Repeat 30 incorrect',r(t,"class","btn btn-sm btn-outline-secondary"),r(t,"type","button")},m(i,o){B(i,t,o),n||(l=x(t,"click",ie(e[15])),n=!0)},p:ne,d(i){i&&V(t),n=!1,l()}}}function Ze(e){let t,n,l;return{c(){t=u("button"),t.innerHTML='<i class="bi bi-repeat"></i> Repeat 60 incorrect',r(t,"class","btn btn-sm btn-outline-secondary"),r(t,"type","button")},m(i,o){B(i,t,o),n||(l=x(t,"click",ie(e[16])),n=!0)},p:ne,d(i){i&&V(t),n=!1,l()}}}function qt(e){let t;function n(o,a){return o[6]===o[1]?Lt:It}let l=n(e),i=l(e);return{c(){i.c(),t=Ue()},m(o,a){i.m(o,a),B(o,t,a)},p(o,[a]){l===(l=n(o))&&i?i.p(o,a):(i.d(1),i=l(o),i&&(i.c(),i.m(t.parentNode,t)))},i:ne,o:ne,d(o){o&&V(t),i.d(o)}}}function yt(e,t,n){let l,i,o,a,c,p,_,{decks:d}=t,{moduleId:f}=t,h=[],M=[],C,m;function k(D){const q={module_id:f,question_ids:D};axios.post("/api/sessions/newfromquestionids",q).then(function(A){window.location.href="/sessions/"+A.data.id}).catch(function(A){alert(A)})}function U(D){ve[D?"unshift":"push"](()=>{m=D,n(0,m)})}const w=()=>k(_.slice(0,30)),Q=()=>k(_.slice(0,60)),b=()=>k(_);return e.$$set=D=>{"decks"in D&&n(9,d=D.decks),"moduleId"in D&&n(10,f=D.moduleId)},e.$$.update=()=>{e.$$.dirty&2560&&(()=>{const D=d.map(A=>A.questions).flat();n(11,h=D.filter(A=>!A.is_invalid));const q=[];for(const A of d){const S=A.sessions.sort((E,Y)=>Y.id-E.id);if(S.length===0)continue;const L=S[0];q.push(...L.answer_choices)}n(12,M=q.filter(A=>h.some(({id:S})=>S===A.question_id)))})(),e.$$.dirty&2048&&n(6,l=h.length),e.$$.dirty&4096&&n(5,i=M.length),e.$$.dirty&96&&n(1,o=l-i),e.$$.dirty&4096&&n(4,a=M.filter(D=>D.is_correct&&!D.help_used).length),e.$$.dirty&4096&&n(3,c=M.filter(D=>D.is_correct&&D.help_used).length),e.$$.dirty&4096&&n(2,p=M.filter(D=>!D.is_correct).length),e.$$.dirty&4096&&n(7,_=M.filter(D=>!D.is_correct).map(D=>D.question_id)),e.$$.dirty&8223&&m&&(()=>{const D={type:"doughnut",data:{labels:["Correct","Correct with help","Incorrect","Unanswered"],datasets:[{label:"n",data:[a,c,p,o],backgroundColor:["#d4edda","#fff3cd","#f8d7da","#bbbbbb"],hoverOffet:4}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:null},plugins:{legend:{display:!1}}}};C&&C.destroy();var q=m.getContext("2d");n(13,C=new St(q,D))})()},[m,o,p,c,a,i,l,_,k,d,f,h,M,C,U,w,Q,b]}class Ut extends je{constructor(t){super(),Ae(this,t,yt,qt,Pe,{decks:9,moduleId:10})}}function Nt(e){let t,n=Ge(He(e[0].created_at),"dd.MM.yyyy")+"",l;return{c(){t=u("span"),l=g(n),r(t,"class","badge text-bg-light")},m(i,o){B(i,t,o),s(t,l)},p(i,o){o&1&&n!==(n=Ge(He(i[0].created_at),"dd.MM.yyyy")+"")&&R(l,n)},d(i){i&&V(t)}}}function jt(e){let t,n=Ge(He(e[0].exam_at),"dd.MM.yyyy")+"",l;return{c(){t=u("span"),l=g(n),r(t,"class","badge text-bg-light")},m(i,o){B(i,t,o),s(t,l)},p(i,o){o&1&&n!==(n=Ge(He(i[0].exam_at),"dd.MM.yyyy")+"")&&R(l,n)},d(i){i&&V(t)}}}function $e(e){let t,n,l,i=e[0].sessions.length+"",o;return{c(){t=u("span"),n=u("i"),l=I(),o=g(i),r(n,"class","bi bi-rocket"),r(t,"class","badge text-bg-light font-monospace"),r(t,"title","Number of sessions")},m(a,c){B(a,t,c),s(t,n),s(t,l),s(t,o)},p(a,c){c&1&&i!==(i=a[0].sessions.length+"")&&R(o,i)},d(a){a&&V(t)}}}function xe(e){let t,n;return{c(){t=new gt(!1),n=Ue(),t.a=n},m(l,i){t.m(e[3],l,i),B(l,n,i)},p(l,i){i&8&&t.p(l[3])},d(l){l&&(V(n),t.d())}}}function At(e){let t,n,l,i,o,a,c,p=e[0].questions.length+"",_,d,f,h,M,C,m,k,U,w,Q,b,D,q=e[0].name+"",A,S,L,E,Y,T,G,O,N;function J(y,P){return y[0].exam_at?jt:Nt}let H=J(e),z=H(e),K=e[0].sessions&&$e(e),W=e[3]&&xe(e);return{c(){t=u("div"),n=u("div"),l=u("div"),z.c(),i=I(),o=u("span"),a=u("i"),c=I(),_=g(p),d=I(),K&&K.c(),f=I(),W&&W.c(),h=I(),M=u("button"),C=u("i"),C.innerHTML="",m=I(),k=u("input"),Q=I(),b=u("div"),D=u("h6"),A=g(q),S=I(),L=u("button"),L.innerHTML='<i class="bi bi-rocket-takeoff"></i> Start session',E=I(),Y=u("a"),T=g("Browse deck"),r(a,"class","bi bi-collection"),r(o,"class","badge text-bg-light font-monospace"),r(o,"title","Number of questions"),ce(C,"bi-bookmark-check-fill",e[4]),ce(C,"bi-bookmark",!e[4]),r(M,"class","btn btn-sm btn-link"),r(k,"type","checkbox"),r(k,"class","form-check-input float-end"),k.value="",r(k,"id",U="selected"+e[0].id),k.checked=w=e[2].has(e[0].id),r(l,"class","card-header"),r(D,"class","card-title"),r(L,"type","button"),r(L,"class","btn btn-sm btn-primary"),r(Y,"href",G="/decks/"+e[0].id),r(Y,"class","card-link"),r(b,"class","card-body"),r(n,"class","card"),r(t,"class","col-lg-6 mb-1")},m(y,P){B(y,t,P),s(t,n),s(n,l),z.m(l,null),s(l,i),s(l,o),s(o,a),s(o,c),s(o,_),s(l,d),K&&K.m(l,null),s(l,f),W&&W.m(l,null),s(l,h),s(l,M),s(M,C),s(l,m),s(l,k),s(n,Q),s(n,b),s(b,D),s(D,A),s(b,S),s(b,L),s(b,E),s(b,Y),s(Y,T),O||(N=[x(M,"click",e[5]),x(k,"click",e[6]),x(L,"click",ie(e[7]))],O=!0)},p(y,[P]){H===(H=J(y))&&z?z.p(y,P):(z.d(1),z=H(y),z&&(z.c(),z.m(l,i))),P&1&&p!==(p=y[0].questions.length+"")&&R(_,p),y[0].sessions?K?K.p(y,P):(K=$e(y),K.c(),K.m(l,f)):K&&(K.d(1),K=null),y[3]?W?W.p(y,P):(W=xe(y),W.c(),W.m(l,h)):W&&(W.d(1),W=null),P&16&&ce(C,"bi-bookmark-check-fill",y[4]),P&16&&ce(C,"bi-bookmark",!y[4]),P&1&&U!==(U="selected"+y[0].id)&&r(k,"id",U),P&5&&w!==(w=y[2].has(y[0].id))&&(k.checked=w),P&1&&q!==(q=y[0].name+"")&&R(A,q),P&1&&G!==(G="/decks/"+y[0].id)&&r(Y,"href",G)},i:ne,o:ne,d(y){y&&V(t),z.d(),K&&K.d(),W&&W.d(),O=!1,Re(N)}}}function Pt(e,t,n){let{deck:l}=t,{selectDeck:i}=t,{selectedDecks:o}=t,a,c=l.bookmarks.length>0;mt(()=>{const f=l.questions.filter(k=>!k.is_invalid),h=l.sessions.sort((k,U)=>U.id-k.id);if(h.length===0)return;const C=h[0].answer_choices.filter(k=>f.some(({id:U})=>U===k.question_id)),m=Mt(f.length,C);m.correct>=60?n(3,a='<span style="color: #155724; background-color: #d4edda;" class="badge" title="Correct answers in percent">'+m.correct+" %</span>"):n(3,a='<span style="color: #721c24; background-color: #f8d7da;" class="badge" title="Correct answers in percent">'+m.correct+" %</span>")});function p(){c?axios.delete("/api/decks/"+l.id+"/bookmark/"+l.bookmarks[0].id).then(function(f){f.status===204&&n(4,c=!1)}).catch(function(f){alert(f)}):axios.post("/api/decks/"+l.id+"/bookmark").then(function(f){f.status===200&&(n(4,c=!0),n(0,l.bookmarks=[f.data],l))}).catch(function(f){alert(f)})}const _=()=>i(l.id),d=()=>Ct(l.id);return e.$$set=f=>{"deck"in f&&n(0,l=f.deck),"selectDeck"in f&&n(1,i=f.selectDeck),"selectedDecks"in f&&n(2,o=f.selectedDecks)},[l,i,o,a,c,p,_,d]}class Qt extends je{constructor(t){super(),Ae(this,t,Pt,At,Pe,{deck:0,selectDeck:1,selectedDecks:2})}}function et(e,t,n){const l=e.slice();return l[17]=t[n],l}function tt(e,t,n){const l=e.slice();return l[20]=t[n],l[21]=t,l[22]=n,l}function lt(e){let t;return{c(){t=u("div"),t.innerHTML='<div class="alert alert-light">No decks found! Create a new deck <a href="/decks" class="alert-link">here</a>.</div> ',r(t,"class","col")},m(n,l){B(n,t,l)},p:ne,d(n){n&&V(t)}}}function st(e,t){let n,l,i,o,a;function c(d){t[11](d,t[20],t[21],t[22])}function p(d){t[12](d)}let _={selectDeck:t[2]};return t[20]!==void 0&&(_.deck=t[20]),t[1]!==void 0&&(_.selectedDecks=t[1]),l=new Qt({props:_}),ve.push(()=>qe(l,"deck",c)),ve.push(()=>qe(l,"selectedDecks",p)),{key:e,first:null,c(){n=Ue(),Te(l.$$.fragment),this.first=n},m(d,f){B(d,n,f),Be(l,d,f),a=!0},p(d,f){t=d;const h={};f&4&&(h.selectDeck=t[2]),!i&&f&8&&(i=!0,h.deck=t[20],ye(()=>i=!1)),!o&&f&2&&(o=!0,h.selectedDecks=t[1],ye(()=>o=!1)),l.$set(h)},i(d){a||(be(l.$$.fragment,d),a=!0)},o(d){he(l.$$.fragment,d),a=!1},d(d){d&&V(n),Ve(l,d)}}}function nt(e){let t,n,l,i,o,a=e[5].from+"",c,p,_,d=e[5].to+"",f,h,M,C=e[5].total+"",m,k,U,w,Q,b,D,q,A,S,L,E,Y,T,G=pe(e[5].links.slice(1,e[5].links.length-1)),O=[];for(let N=0;N<G.length;N+=1)O[N]=it(et(e,G,N));return{c(){t=u("div"),n=u("div"),l=u("p"),i=g("Showing "),o=u("span"),c=g(a),p=g(`
                to `),_=u("span"),f=g(d),h=g(`
                of `),M=u("span"),m=g(C),k=g(" decks"),U=I(),w=u("div"),Q=u("nav"),b=u("ul"),D=u("li"),q=u("button"),q.textContent="‹",A=I();for(let N=0;N<O.length;N+=1)O[N].c();S=I(),L=u("li"),E=u("button"),E.textContent="›",r(o,"class","fw-semibold"),r(_,"class","fw-semibold"),r(M,"class","fw-semibold"),r(l,"class","small text-muted"),r(n,"class","col"),r(q,"class","page-link"),r(D,"class","page-item"),ce(D,"disabled",e[5].prev_page_url===null),r(E,"class","page-link"),r(L,"class","page-item"),ce(L,"disabled",e[5].next_page_url===null),r(b,"class","pagination"),r(w,"class","col"),r(t,"class","row sticky-bottom bg-white mt-3 pt-3")},m(N,J){B(N,t,J),s(t,n),s(n,l),s(l,i),s(l,o),s(o,c),s(l,p),s(l,_),s(_,f),s(l,h),s(l,M),s(M,m),s(l,k),s(t,U),s(t,w),s(w,Q),s(Q,b),s(b,D),s(D,q),s(b,A);for(let H=0;H<O.length;H+=1)O[H]&&O[H].m(b,null);s(b,S),s(b,L),s(L,E),Y||(T=[x(q,"click",ie(e[13])),x(E,"click",ie(e[15]))],Y=!0)},p(N,J){if(J&32&&a!==(a=N[5].from+"")&&R(c,a),J&32&&d!==(d=N[5].to+"")&&R(f,d),J&32&&C!==(C=N[5].total+"")&&R(m,C),J&32&&ce(D,"disabled",N[5].prev_page_url===null),J&160){G=pe(N[5].links.slice(1,N[5].links.length-1));let H;for(H=0;H<G.length;H+=1){const z=et(N,G,H);O[H]?O[H].p(z,J):(O[H]=it(z),O[H].c(),O[H].m(b,S))}for(;H<O.length;H+=1)O[H].d(1);O.length=G.length}J&32&&ce(L,"disabled",N[5].next_page_url===null)},d(N){N&&V(t),Ke(O,N),Y=!1,Re(T)}}}function it(e){let t,n,l=e[17].label+"",i,o,a;function c(){return e[14](e[17])}return{c(){t=u("li"),n=u("button"),i=g(l),r(n,"class","page-link"),r(t,"class","page-item d-none d-sm-block"),ce(t,"disabled",e[17].active||!e[17].url)},m(p,_){B(p,t,_),s(t,n),s(n,i),o||(a=x(n,"click",ie(c)),o=!0)},p(p,_){e=p,_&32&&l!==(l=e[17].label+"")&&R(i,l),_&32&&ce(t,"disabled",e[17].active||!e[17].url)},d(p){p&&V(t),o=!1,a()}}}function Gt(e){let t,n,l,i,o,a,c,p,_,d,f,h,M,C,m,k,U,w,Q,b,D,q,A,S,L=[],E=new Map,Y,T,G,O,N;function J(v){e[9](v)}function H(v){e[10](v)}let z={};e[3]!==void 0&&(z.decks=e[3]),e[0]!==void 0&&(z.moduleId=e[0]),b=new Ut({props:z}),ve.push(()=>qe(b,"decks",J)),ve.push(()=>qe(b,"moduleId",H));let K=pe(e[3]);const W=v=>v[20].id;for(let v=0;v<K.length;v+=1){let j=tt(e,K,v),Z=W(j);E.set(Z,L[v]=st(Z,j))}let y=null;K.length||(y=lt());let P=e[5]&&e[5].total>1&&nt(e);return{c(){t=u("div"),n=u("div"),l=u("div"),i=u("span"),i.innerHTML='<i class="bi bi-archive"></i>',o=I(),a=u("select"),c=u("option"),p=g("Main decks"),d=u("option"),f=g("Your decks"),M=u("option"),C=g("User decks"),k=u("option"),U=g("Bookmarked decks"),Q=I(),Te(b.$$.fragment),A=I(),S=u("div");for(let v=0;v<L.length;v+=1)L[v].c();y&&y.c(),Y=I(),P&&P.c(),T=Ue(),r(i,"class","input-group-text"),c.__value="public-rw-listed",Le(c,c.__value),c.selected=_=e[4]==="public-rw-listed",d.__value="user",Le(d,d.__value),d.selected=h=e[4]==="user",M.__value="public",Le(M,M.__value),M.selected=m=e[4]==="public",k.__value="bookmarked",Le(k,k.__value),k.selected=w=e[4]==="bookmarked",r(a,"id","kind"),r(a,"class","form-select"),e[4]===void 0&&bt(()=>e[8].call(a)),r(l,"class","input-group"),r(n,"class","col"),r(t,"class","row mb-3"),r(S,"class","row")},m(v,j){B(v,t,j),s(t,n),s(n,l),s(l,i),s(l,o),s(l,a),s(a,c),s(c,p),s(a,d),s(d,f),s(a,M),s(M,C),s(a,k),s(k,U),Fe(a,e[4],!0),B(v,Q,j),Be(b,v,j),B(v,A,j),B(v,S,j);for(let Z=0;Z<L.length;Z+=1)L[Z]&&L[Z].m(S,null);y&&y.m(S,null),B(v,Y,j),P&&P.m(v,j),B(v,T,j),G=!0,O||(N=[x(a,"change",e[8]),x(a,"change",e[6])],O=!0)},p(v,[j]){(!G||j&16&&_!==(_=v[4]==="public-rw-listed"))&&(c.selected=_),(!G||j&16&&h!==(h=v[4]==="user"))&&(d.selected=h),(!G||j&16&&m!==(m=v[4]==="public"))&&(M.selected=m),(!G||j&16&&w!==(w=v[4]==="bookmarked"))&&(k.selected=w),j&16&&Fe(a,v[4]);const Z={};!D&&j&8&&(D=!0,Z.decks=v[3],ye(()=>D=!1)),!q&&j&1&&(q=!0,Z.moduleId=v[0],ye(()=>q=!1)),b.$set(Z),j&14&&(K=pe(v[3]),pt(),L=wt(L,j,W,1,v,K,E,S,Dt,st,null,tt),kt(),!K.length&&y?y.p(v,j):K.length?y&&(y.d(1),y=null):(y=lt(),y.c(),y.m(S,null))),v[5]&&v[5].total>1?P?P.p(v,j):(P=nt(v),P.c(),P.m(T.parentNode,T)):P&&(P.d(1),P=null)},i(v){if(!G){be(b.$$.fragment,v);for(let j=0;j<K.length;j+=1)be(L[j]);G=!0}},o(v){he(b.$$.fragment,v);for(let j=0;j<L.length;j+=1)he(L[j]);G=!1},d(v){v&&(V(t),V(Q),V(A),V(S),V(Y),V(T)),Ve(b,v);for(let j=0;j<L.length;j+=1)L[j].d();y&&y.d(),P&&P.d(v),O=!1,Re(N)}}}function ze(e){return new URLSearchParams(window.location.search).get(e)}function Ht(e,t,n){let{moduleId:l}=t,{selectDeck:i}=t,{selectedDecks:o}=t,a=[],c=ze("kind")??"public-rw-listed",p=ze("page")??1,_;function d(){if(!l){n(3,a=[]);return}const b=new URL(window.location);b.searchParams.set("module",l),b.searchParams.set("kind",c),b.searchParams.set("page",p),window.history.replaceState({},"",b),axios.get("/api/decks?module="+l+"&kind="+c+"&page="+p).then(function(D){n(5,_=D.data),n(3,a=_.data),a.sort(function(q,A){return q.exam_at===null||A.exam_at===null?q.id<A.id?1:q.id>A.id?-1:0:q.exam_at<A.exam_at?1:q.exam_at>A.exam_at?-1:0})}).catch(function(D){alert(D)})}function f(b){p=b,d()}function h(){c=ht(this),n(4,c)}function M(b){a=b,n(3,a)}function C(b){l=b,n(0,l)}function m(b,D,q,A){q[A]=b,n(3,a)}function k(b){o=b,n(1,o)}const U=()=>{_.prev_page_url&&f(_.current_page-1)},w=b=>{b.url&&f(b.label)},Q=()=>{_.next_page_url&&f(_.current_page+1)};return e.$$set=b=>{"moduleId"in b&&n(0,l=b.moduleId),"selectDeck"in b&&n(2,i=b.selectDeck),"selectedDecks"in b&&n(1,o=b.selectedDecks)},e.$$.update=()=>{e.$$.dirty&1&&(p=ze("page")??1,d())},[l,o,i,a,c,_,d,f,h,M,C,m,k,U,w,Q]}class Rt extends je{constructor(t){super(),Ae(this,t,Ht,Gt,Pe,{moduleId:0,selectDeck:2,selectedDecks:1})}}function ot(e){let t,n,l,i,o,a,c,p,_,d=e[1].length+"",f,h,M=e[1].length>1?"s":"",C,m,k,U=e[3].length+"",w,Q,b=e[3].length>1?"s":"",D,q,A,S=e[2]?"excluded":"included",L,E,Y,T,G,O,N,J,H,z,K,W,y,P,v,j,Z=e[3].length+"",re,we,ke=e[3].length>1?"s":"",De,de,Se,se,oe,fe=e[5].length+"",Me,ge,_e=e[5].length>1?"s":"",Ce,Ne,me,ue,Ie,ae,ee=e[5].length>0&&at(e);return{c(){t=u("div"),n=u("div"),l=u("div"),i=u("p"),i.textContent="Create your own super deck:",o=I(),a=u("p"),c=g("You have "),p=u("strong"),_=g("selected "),f=g(d),h=g(" deck"),C=g(M),m=g(`
                    with `),k=u("strong"),w=g(U),Q=g(" question"),D=g(b),q=I(),ee&&ee.c(),A=g(`
                    (duplicates `),L=g(S),E=g(")"),Y=I(),T=u("div"),G=u("label"),G.textContent="Deck Name",O=I(),N=u("input"),J=I(),H=u("div"),z=u("input"),K=I(),W=u("label"),W.textContent="Filter out duplicates",y=I(),P=u("div"),v=u("button"),j=g("Create deck ("),re=g(Z),we=g(" question"),De=g(ke),de=g(")"),Se=I(),se=u("button"),oe=g("Create deck ("),Me=g(fe),ge=g(" image question"),Ce=g(_e),Ne=g(")"),me=I(),ue=u("button"),ue.textContent="Cancel",r(G,"for","name"),r(G,"class","form-label"),r(N,"type","text"),r(N,"class","form-control"),r(N,"id","name"),r(T,"class","mb-3"),r(z,"type","checkbox"),r(z,"class","form-check-input"),r(z,"id","checkboxRemoveDuplicates"),r(W,"class","form-check-label"),r(W,"for","checkboxRemoveDuplicates"),r(H,"class","mb-3 form-check"),r(v,"class","btn btn-sm btn-primary"),r(se,"class","btn btn-sm btn-primary"),r(ue,"class","btn btn-sm btn-link"),r(P,"class","d-grid gap-2 d-md-block"),r(l,"class","alert alert-light"),r(l,"role","alert"),r(n,"class","col-md"),r(t,"class","row")},m(X,$){B(X,t,$),s(t,n),s(n,l),s(l,i),s(l,o),s(l,a),s(a,c),s(a,p),s(p,_),s(p,f),s(p,h),s(p,C),s(a,m),s(a,k),s(k,w),s(k,Q),s(k,D),s(a,q),ee&&ee.m(a,null),s(a,A),s(a,L),s(a,E),s(l,Y),s(l,T),s(T,G),s(T,O),s(T,N),Le(N,e[4]),s(l,J),s(l,H),s(H,z),z.checked=e[2],s(H,K),s(H,W),s(l,y),s(l,P),s(P,v),s(v,j),s(v,re),s(v,we),s(v,De),s(v,de),s(P,Se),s(P,se),s(se,oe),s(se,Me),s(se,ge),s(se,Ce),s(se,Ne),s(P,me),s(P,ue),Ie||(ae=[x(N,"input",e[6]),x(N,"focus",Bt),x(z,"change",e[7]),x(v,"click",ie(e[8])),x(se,"click",ie(e[9])),x(ue,"click",ie(e[10]))],Ie=!0)},p(X,$){$&2&&d!==(d=X[1].length+"")&&R(f,d),$&2&&M!==(M=X[1].length>1?"s":"")&&R(C,M),$&8&&U!==(U=X[3].length+"")&&R(w,U),$&8&&b!==(b=X[3].length>1?"s":"")&&R(D,b),X[5].length>0?ee?ee.p(X,$):(ee=at(X),ee.c(),ee.m(a,A)):ee&&(ee.d(1),ee=null),$&4&&S!==(S=X[2]?"excluded":"included")&&R(L,S),$&16&&N.value!==X[4]&&Le(N,X[4]),$&4&&(z.checked=X[2]),$&8&&Z!==(Z=X[3].length+"")&&R(re,Z),$&8&&ke!==(ke=X[3].length>1?"s":"")&&R(De,ke),$&32&&fe!==(fe=X[5].length+"")&&R(Me,fe),$&32&&_e!==(_e=X[5].length>1?"s":"")&&R(Ce,_e)},d(X){X&&V(t),ee&&ee.d(),Ie=!1,Re(ae)}}}function at(e){let t,n,l=e[5].length+"",i,o,a=e[5].length>1?"s":"",c,p;return{c(){t=g("/ "),n=u("strong"),i=g(l),o=g(" question"),c=g(a),p=g(" with images")},m(_,d){B(_,t,d),B(_,n,d),s(n,i),s(n,o),s(n,c),s(n,p)},p(_,d){d&32&&l!==(l=_[5].length+"")&&R(i,l),d&32&&a!==(a=_[5].length>1?"s":"")&&R(c,a)},d(_){_&&(V(t),V(n))}}}function Tt(e){let t,n=e[1].length>0&&ot(e);return{c(){n&&n.c(),t=Ue()},m(l,i){n&&n.m(l,i),B(l,t,i)},p(l,[i]){l[1].length>0?n?n.p(l,i):(n=ot(l),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:ne,o:ne,d(l){l&&V(t),n&&n.d(l)}}}function ct(e,t){var n={name:e,question_ids:t};axios.post("/api/decks",n).then(function(l){window.location.href="/decks/"+l.data.id}).catch(function(l){alert(l)})}const Bt=e=>e.target.select();function Vt(e,t,n){let l,i,{selectedDecks:o}=t,a=[],c="My new super deck",p=!0;function _(){if(o.size===0){n(1,a=[]);return}const m=[...o].map(k=>"decks[]="+k);axios.get("/api/decks?"+m.join("&")).then(function(k){n(1,a=k.data)}).catch(function(k){alert(k)})}function d(){c=this.value,n(4,c)}function f(){p=this.checked,n(2,p)}const h=()=>ct(c,l.map(m=>m.id)),M=()=>ct(c,i.map(m=>m.id)),C=()=>n(0,o=new Set);return e.$$set=m=>{"selectedDecks"in m&&n(0,o=m.selectedDecks)},e.$$.update=()=>{e.$$.dirty&1&&_(),e.$$.dirty&6&&n(3,l=(()=>{var m=[];return a.forEach(k=>m.push(...k.questions)),p?[...new Map(m.map(k=>[k.id,k])).values()]:m})()),e.$$.dirty&6&&n(5,i=(()=>{var m=[];return a.forEach(k=>{k.questions.forEach(U=>{U.images.length>0&&m.push(U)})}),p?[...new Map(m.map(k=>[k.id,k])).values()]:m})())},[o,a,p,l,c,i,d,f,h,M,C]}class Et extends je{constructor(t){super(),Ae(this,t,Vt,Tt,Pe,{selectedDecks:0})}}function ut(e,t,n){const l=e.slice();return l[12]=t[n],l}function rt(e,t,n){const l=e.slice();return l[15]=t[n],l}function dt(e){let t,n,l=pe(e[2]),i=[];for(let o=0;o<l.length;o+=1)i[o]=ft(rt(e,l,o));return{c(){t=u("ul");for(let o=0;o<i.length;o+=1)i[o].c();n=I(),r(t,"class","list-group m-2 me-0")},m(o,a){B(o,t,a);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(t,null);s(t,n)},p(o,a){if(a&37){l=pe(o[2]);let c;for(c=0;c<l.length;c+=1){const p=rt(o,l,c);i[c]?i[c].p(p,a):(i[c]=ft(p),i[c].c(),i[c].m(t,n))}for(;c<i.length;c+=1)i[c].d(1);i.length=l.length}},d(o){o&&V(t),Ke(i,o)}}}function ft(e){let t,n=e[15].name+"",l,i,o,a;function c(){return e[9](e[15])}return{c(){t=u("button"),l=g(n),r(t,"data-bs-target","#offcanvasModuleSelection"),r(t,"data-bs-dismiss","offcanvas"),r(t,"class",i="list-group-item list-group-item-action "+(e[0].last_module_id===e[15].id?"list-group-item-secondary":"list-group-item-light"))},m(p,_){B(p,t,_),s(t,l),o||(a=x(t,"click",ie(c)),o=!0)},p(p,_){e=p,_&4&&n!==(n=e[15].name+"")&&R(l,n),_&5&&i!==(i="list-group-item list-group-item-action "+(e[0].last_module_id===e[15].id?"list-group-item-secondary":"list-group-item-light"))&&r(t,"class",i)},d(p){p&&V(t),o=!1,a()}}}function _t(e){let t,n=e[12].name+"",l,i,o,a,c,p;function _(){return e[8](e[12])}let d=e[0].last_subject_id===e[12].id&&dt(e);return{c(){t=u("button"),l=g(n),o=I(),d&&d.c(),a=Ue(),r(t,"class",i="list-group-item list-group-item-action "+(e[0].last_subject_id===e[12].id?"list-group-item-dark":"list-group-item-light"))},m(f,h){B(f,t,h),s(t,l),B(f,o,h),d&&d.m(f,h),B(f,a,h),c||(p=x(t,"click",ie(_)),c=!0)},p(f,h){e=f,h&2&&n!==(n=e[12].name+"")&&R(l,n),h&3&&i!==(i="list-group-item list-group-item-action "+(e[0].last_subject_id===e[12].id?"list-group-item-dark":"list-group-item-light"))&&r(t,"class",i),e[0].last_subject_id===e[12].id?d?d.p(e,h):(d=dt(e),d.c(),d.m(a.parentNode,a)):d&&(d.d(1),d=null)},d(f){f&&(V(t),V(o),V(a)),d&&d.d(f),c=!1,p()}}}function Ot(e){let t;return{c(){t=u("p"),t.textContent="No module selected."},m(n,l){B(n,t,l)},p:ne,i:ne,o:ne,d(n){n&&V(t)}}}function zt(e){let t,n,l;function i(a){e[11](a)}let o={moduleId:e[0].last_module_id,selectDeck:e[6]};return e[3]!==void 0&&(o.selectedDecks=e[3]),t=new Rt({props:o}),ve.push(()=>qe(t,"selectedDecks",i)),{c(){Te(t.$$.fragment)},m(a,c){Be(t,a,c),l=!0},p(a,c){const p={};c&1&&(p.moduleId=a[0].last_module_id),!n&&c&8&&(n=!0,p.selectedDecks=a[3],ye(()=>n=!1)),t.$set(p)},i(a){l||(be(t.$$.fragment,a),l=!0)},o(a){he(t.$$.fragment,a),l=!1},d(a){Ve(t,a)}}}function Kt(e){let t,n,l,i,o,a,c,p,_,d,f,h,M,C,m,k,U=pe(e[1]),w=[];for(let S=0;S<U.length;S+=1)w[S]=_t(ut(e,U,S));function Q(S){e[10](S)}let b={};e[3]!==void 0&&(b.selectedDecks=e[3]),f=new Et({props:b}),ve.push(()=>qe(f,"selectedDecks",Q));const D=[zt,Ot],q=[];function A(S,L){return S[0].last_module_id?0:1}return C=A(e),m=q[C]=D[C](e),{c(){t=u("div"),t.innerHTML='<div class="col-12 d-grid mb-2"><button type="button" class="btn btn-sm btn-primary d-lg-none my-2" data-bs-toggle="offcanvas" data-bs-target="#offcanvasModuleSelection" aria-controls="offcanvasModuleSelection">Switch module</button></div>',n=I(),l=u("div"),i=u("div"),o=u("div"),o.innerHTML='<h5 id="offcanvasAddToDeckLabel">Choose subject and module</h5> <button type="button" class="btn-close text-reset" data-bs-target="#offcanvasModuleSelection" data-bs-dismiss="offcanvas" aria-label="Close"></button>',a=I(),c=u("div"),p=u("ul");for(let S=0;S<w.length;S+=1)w[S].c();_=I(),d=u("div"),Te(f.$$.fragment),M=I(),m.c(),r(t,"class","row"),r(o,"class","offcanvas-header"),r(p,"class","list-group w-100"),r(c,"class","offcanvas-body"),r(i,"class","col-lg-4 offcanvas-lg offcanvas-start"),r(i,"tabindex","-1"),r(i,"id","offcanvasModuleSelection"),r(d,"class","col-12 col-lg-8"),r(l,"class","row")},m(S,L){B(S,t,L),B(S,n,L),B(S,l,L),s(l,i),s(i,o),s(i,a),s(i,c),s(c,p);for(let E=0;E<w.length;E+=1)w[E]&&w[E].m(p,null);s(l,_),s(l,d),Be(f,d,null),s(d,M),q[C].m(d,null),k=!0},p(S,[L]){if(L&55){U=pe(S[1]);let T;for(T=0;T<U.length;T+=1){const G=ut(S,U,T);w[T]?w[T].p(G,L):(w[T]=_t(G),w[T].c(),w[T].m(p,null))}for(;T<w.length;T+=1)w[T].d(1);w.length=U.length}const E={};!h&&L&8&&(h=!0,E.selectedDecks=S[3],ye(()=>h=!1)),f.$set(E);let Y=C;C=A(S),C===Y?q[C].p(S,L):(pt(),he(q[Y],1,1,()=>{q[Y]=null}),kt(),m=q[C],m?m.p(S,L):(m=q[C]=D[C](S),m.c()),be(m,1),m.m(d,null))},i(S){k||(be(f.$$.fragment,S),be(m),k=!0)},o(S){he(f.$$.fragment,S),he(m),k=!1},d(S){S&&(V(t),V(n),V(l)),Ke(w,S),Ve(f),q[C].d()}}}function Wt(e,t,n){let l;vt(e,Qe,m=>n(0,l=m));let i=[],o=[],a=[],c=new Set;mt(()=>{axios.get("/api/modules").then(function(m){var k=m.data;n(7,i=k.filter((w,Q,b)=>Q===b.findIndex(D=>D.id===w.id)).sort(function(w,Q){return w.name>Q.name?1:w.name<Q.name?-1:0}));var U=i.map(w=>w.subject).filter(w=>!!w);n(1,o=U.filter((w,Q,b)=>Q===b.findIndex(D=>D.id===w.id)).sort(function(w,Q){return w.name>Q.name?1:w.name<Q.name?-1:0}))}).catch(function(m){alert(m)})});function p(m){var k={last_subject_id:m,last_module_id:0};axios.put("/api/users/me/settings",k).then(function(U){const w=new URL(window.location);w.searchParams.delete("module"),w.searchParams.delete("page"),window.history.replaceState({},"",w),Oe(Qe,l.last_subject_id=m,l),Oe(Qe,l.last_module_id=0,l)}).catch(function(U){alert(U)})}function _(m){var k={last_module_id:m};axios.put("/api/users/me/settings",k).then(function(U){const w=new URL(window.location);w.searchParams.set("module",m),w.searchParams.set("page",1),window.history.replaceState({},"",w),Oe(Qe,l.last_module_id=m,l)}).catch(function(U){alert(U)})}function d(m){c.has(m)?c.delete(m):c.add(m),n(3,c=new Set([...c]))}const f=m=>p(m.id),h=m=>_(m.id);function M(m){c=m,n(3,c)}function C(m){c=m,n(3,c)}return e.$$.update=()=>{e.$$.dirty&129&&(l.last_subject_id,n(2,a=i.filter(m=>l.last_subject_id?m.subject?m.subject.id===l.last_subject_id:!1:!0)))},[l,o,a,c,p,_,d,i,f,h,M,C]}class Yt extends je{constructor(t){super(),Ae(this,t,Wt,Kt,Pe,{})}}const Ft=document.getElementById("NewSessionView");new Yt({target:Ft});
