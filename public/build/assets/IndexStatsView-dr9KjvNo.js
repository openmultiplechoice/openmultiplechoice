import{S as F,i as Z,s as G,g as h,b as _,q as J,c as u,a as g,h as f,n as L,d as k,A as K,k as Q,f as R,t as C,l as U,p as z,j as S}from"./index-CovtvcR3.js";import{e as N}from"./each-CtuGQY9F.js";import{C as W}from"./auto-DTdYmgno.js";import{f as M,p as X}from"./parseISO-Ds5nI7_t.js";function A(s,e,o){const a=s.slice();return a[9]=e[o],a}function j(s,e,o){const a=s.slice();return a[9]=e[o],a}function Y(s){let e;return{c(){e=_("p"),e.textContent="No stats available yet"},m(o,a){g(o,e,a)},p:L,d(o){o&&k(e)}}}function $(s){let e,o,a=s[1].length>0&&I(s),i=s[2].length>0&&V(s);return{c(){e=_("div"),a&&a.c(),o=h(),i&&i.c(),u(e,"class","row mt-3")},m(l,t){g(l,e,t),a&&a.m(e,null),f(e,o),i&&i.m(e,null)},p(l,t){l[1].length>0?a?a.p(l,t):(a=I(l),a.c(),a.m(e,o)):a&&(a.d(1),a=null),l[2].length>0?i?i.p(l,t):(i=V(l),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(l){l&&k(e),a&&a.d(),i&&i.d()}}}function I(s){let e,o,a,i=N(s[1]),l=[];for(let t=0;t<i.length;t+=1)l[t]=T(j(s,i,t));return{c(){e=_("div"),o=_("h6"),o.textContent="New decks",a=h();for(let t=0;t<l.length;t+=1)l[t].c();u(e,"class","col-md-6")},m(t,r){g(t,e,r),f(e,o),f(e,a);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(t,r){if(r&2){i=N(t[1]);let n;for(n=0;n<i.length;n+=1){const p=j(t,i,n);l[n]?l[n].p(p,r):(l[n]=T(p),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=i.length}},d(t){t&&k(e),R(l,t)}}}function O(s){let e,o,a,i=s[9].questions.length+"",l;return{c(){e=_("span"),o=_("i"),a=h(),l=C(i),u(o,"class","bi bi-collection"),u(e,"class","badge text-bg-light"),u(e,"title","Number of questions")},m(t,r){g(t,e,r),f(e,o),f(e,a),f(e,l)},p(t,r){r&2&&i!==(i=t[9].questions.length+"")&&S(l,i)},d(t){t&&k(e)}}}function T(s){let e,o,a,i,l,t=s[9].name+"",r,n,p,y,w,c=s[9].questions.length>0&&O(s);function d(){return s[6](s[9])}return{c(){e=_("div"),c&&c.c(),o=h(),a=_("button"),a.innerHTML='<i class="bi bi-rocket-takeoff"></i>',i=h(),l=_("a"),r=C(t),p=h(),u(a,"type","button"),u(a,"class","btn btn-sm btn-primary"),u(l,"href",n="/decks/"+s[9].id),u(l,"class","alert-link text-overflow svelte-1gfmo48"),u(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),u(e,"role","alert")},m(b,v){g(b,e,v),c&&c.m(e,null),f(e,o),f(e,a),f(e,i),f(e,l),f(l,r),f(e,p),y||(w=U(a,"click",z(d)),y=!0)},p(b,v){s=b,s[9].questions.length>0?c?c.p(s,v):(c=O(s),c.c(),c.m(e,o)):c&&(c.d(1),c=null),v&2&&t!==(t=s[9].name+"")&&S(r,t),v&2&&n!==(n="/decks/"+s[9].id)&&u(l,"href",n)},d(b){b&&k(e),c&&c.d(),y=!1,w()}}}function V(s){let e,o,a,i=N(s[2]),l=[];for(let t=0;t<i.length;t+=1)l[t]=E(A(s,i,t));return{c(){e=_("div"),o=_("h6"),o.textContent="Popular decks",a=h();for(let t=0;t<l.length;t+=1)l[t].c();u(e,"class","col-md-6")},m(t,r){g(t,e,r),f(e,o),f(e,a);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(t,r){if(r&4){i=N(t[2]);let n;for(n=0;n<i.length;n+=1){const p=A(t,i,n);l[n]?l[n].p(p,r):(l[n]=E(p),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=i.length}},d(t){t&&k(e),R(l,t)}}}function B(s){let e,o,a,i=s[9].questions.length+"",l;return{c(){e=_("span"),o=_("i"),a=h(),l=C(i),u(o,"class","bi bi-collection"),u(e,"class","badge text-bg-light"),u(e,"title","Number of questions")},m(t,r){g(t,e,r),f(e,o),f(e,a),f(e,l)},p(t,r){r&4&&i!==(i=t[9].questions.length+"")&&S(l,i)},d(t){t&&k(e)}}}function D(s){let e,o,a,i=s[9].sessions.length+"",l;return{c(){e=_("span"),o=_("i"),a=h(),l=C(i),u(o,"class","bi bi-rocket"),u(e,"class","badge text-bg-light"),u(e,"title","Number of sessions")},m(t,r){g(t,e,r),f(e,o),f(e,a),f(e,l)},p(t,r){r&4&&i!==(i=t[9].sessions.length+"")&&S(l,i)},d(t){t&&k(e)}}}function E(s){let e,o,a,i,l,t,r=s[9].name+"",n,p,y,w,c,d=s[9].questions.length>0&&B(s),b=s[9].sessions.length>0&&D(s);function v(){return s[7](s[9])}return{c(){e=_("div"),d&&d.c(),o=h(),b&&b.c(),a=h(),i=_("button"),i.innerHTML='<i class="bi bi-rocket-takeoff"></i>',l=h(),t=_("a"),n=C(r),y=h(),u(i,"type","button"),u(i,"class","btn btn-sm btn-primary"),u(t,"href",p="/decks/"+s[9].id),u(t,"class","alert-link"),u(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),u(e,"role","alert")},m(q,m){g(q,e,m),d&&d.m(e,null),f(e,o),b&&b.m(e,null),f(e,a),f(e,i),f(e,l),f(e,t),f(t,n),f(e,y),w||(c=U(i,"click",z(v)),w=!0)},p(q,m){s=q,s[9].questions.length>0?d?d.p(s,m):(d=B(s),d.c(),d.m(e,o)):d&&(d.d(1),d=null),s[9].sessions.length>0?b?b.p(s,m):(b=D(s),b.c(),b.m(e,a)):b&&(b.d(1),b=null),m&4&&r!==(r=s[9].name+"")&&S(n,r),m&4&&p!==(p="/decks/"+s[9].id)&&u(t,"href",p)},d(q){q&&k(e),d&&d.d(),b&&b.d(),w=!1,c()}}}function x(s){let e,o,a,i;function l(n,p){return n[1]&&n[2]?$:Y}let t=l(s),r=t(s);return{c(){r.c(),e=h(),o=_("div"),a=_("div"),i=_("canvas"),J(i,"max-height","300px"),u(a,"class","col-md"),u(o,"class","row mt-3 p-3")},m(n,p){r.m(n,p),g(n,e,p),g(n,o,p),f(o,a),f(a,i),s[8](i)},p(n,[p]){t===(t=l(n))&&r?r.p(n,p):(r.d(1),r=t(n),r&&(r.c(),r.m(e.parentNode,e)))},i:L,o:L,d(n){n&&(k(e),k(o)),r.d(n),s[8](null)}}}function P(s){var e={deck_id:s};axios.post("/api/sessions",e).then(function(o){window.location.href="/sessions/"+o.data.id}).catch(function(o){alert(o)})}function ee(s,e,o){let a,i,l={},t={},r=[],n=[];K(()=>{axios.get("/api/stats/activity").then(function(c){const d=c.data;o(4,l=d.answers_byhour),o(5,t=d.users_byhour),o(1,r=d.decks_new),o(2,n=d.decks_popular)}).catch(function(c){console.log(c)})});const p=c=>P(c.id),y=c=>P(c.id);function w(c){Q[c?"unshift":"push"](()=>{a=c,o(0,a)})}return s.$$.update=()=>{s.$$.dirty&57&&a&&l&&t&&(()=>{const c=Object.keys(l),d=Object.values(l);if(d.reduce((m,H)=>m+H,0)===0)return;const v={type:"line",data:{labels:c,datasets:[{label:"Answers",data:d,backgroundColor:"rgba(255, 205, 86, 0.4)",borderColor:"rgba(255, 205, 86, 0.4)",fill:!0,showLine:!1,pointRadius:0,tension:.2},{label:"Users",data:Object.values(t),backgroundColor:"rgba(54, 162, 235, 0.7)",borderColor:"rgba(54, 162, 235, 0.7)",fill:!0,showLine:!1,pointRadius:0,tension:.2}]},options:{plugins:{legend:{display:!1},tooltip:{callbacks:{title(m){return M(X(m[0].label),"dd.MM.yyyy HH:mm")}}}},responsive:!0,interaction:{intersect:!1},scales:{x:{display:!0,title:{display:!1,text:"Hour of the day"},ticks:{autoSkip:!0,maxTicksLimit:3,callback(m){const H=this.getLabelForValue(m);return M(H,"dd.MM.yyyy")}},grid:{display:!1},border:{display:!1}},y:{display:!0,title:{display:!1,text:"Number of answers"},ticks:{beginAtZero:!0,stepSize:1,maxTicksLimit:4,autoSkip:!0},border:{display:!1}}}}};i&&i.destroy();var q=a.getContext("2d");o(3,i=new W(q,v))})()},[a,r,n,i,l,t,p,y,w]}class te extends F{constructor(e){super(),Z(this,e,ee,x,G,{})}}const le=document.getElementById("IndexStatsView");new te({target:le});
