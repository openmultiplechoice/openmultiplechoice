import{S as Z,i as x,s as $,e as re,a as k,n as S,d as q,b as f,c as a,f as ae,t as A,g as D,h as c,l as V,p as O,j as G,r as ee,k as te,m as ne,o as ie,q as ce,u as se,v as oe,w as j,x as H,y as de,z as le,A as fe,B as me}from"./index-CovtvcR3.js";import{Q as _e}from"./QuestionForm-BNJWjR89.js";import{e as P}from"./each-CtuGQY9F.js";import{p as U}from"./purify.es-wjz4va4G.js";import"./_commonjsHelpers-Cpj98o6Y.js";function W(o,t,n){const s=o.slice();return s[4]=t[n],s[6]=n,s}function pe(o){let t;return{c(){t=f("p"),t.textContent="Loading ..."},m(n,s){k(n,t,s)},p:S,d(n){n&&q(t)}}}function be(o){let t,n=P(o[0].questions),s=[];for(let i=0;i<n.length;i+=1)s[i]=X(W(o,n,i));return{c(){t=f("div");for(let i=0;i<s.length;i+=1)s[i].c();a(t,"class","list-group")},m(i,l){k(i,t,l);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null)},p(i,l){if(l&3){n=P(i[0].questions);let e;for(e=0;e<n.length;e+=1){const u=W(i,n,e);s[e]?s[e].p(u,l):(s[e]=X(u),s[e].c(),s[e].m(t,null))}for(;e<s.length;e+=1)s[e].d(1);s.length=n.length}},d(i){i&&q(t),ae(s,i)}}}function he(o){let t,n=o[6]+1+"",s;return{c(){t=A("Question Nr. "),s=A(n)},m(i,l){k(i,t,l),k(i,s,l)},p:S,d(i){i&&(q(t),q(s))}}}function ke(o){let t=U.sanitize(o[4].text).replace(/<\/?[^>]+(>|$)/g,"")+"",n;return{c(){n=A(t)},m(s,i){k(s,n,i)},p(s,i){i&1&&t!==(t=U.sanitize(s[4].text).replace(/<\/?[^>]+(>|$)/g,"")+"")&&G(n,t)},d(s){s&&q(n)}}}function X(o){let t,n,s,i,l=o[4].id+"",e,u,_,g,v=o[4].type+"",N,Q,r,p,h,F,R,w,T;function B(){return o[2](o[4])}function M(C,I){return C[4].text?ke:he}let L=M(o),b=L(o);function z(){return o[3](o[4])}return{c(){t=f("button"),n=f("div"),s=f("p"),i=A("ID: "),e=A(l),u=D(),_=f("p"),g=A("Type: "),N=A(v),Q=D(),r=f("button"),r.innerHTML='<i class="bi bi-trash"></i>',p=D(),h=f("p"),b.c(),F=D(),a(s,"class","mb-1 font-monospace"),a(_,"class","mb-1 font-monospace text-uppercase"),a(r,"type","button"),a(r,"class","btn btn-sm btn-light"),a(n,"class","d-flex w-100 justify-content-between mb-1"),a(h,"class","mb-1 index-list-item svelte-sfi4r3"),a(t,"type","button"),a(t,"class",R="list-group-item "+(o[4].id===o[0].current_question_id?"list-group-item-secondary":"list-group-item-light")),a(t,"aria-current","true")},m(C,I){k(C,t,I),c(t,n),c(n,s),c(s,i),c(s,e),c(n,u),c(n,_),c(_,g),c(_,N),c(n,Q),c(n,r),c(t,p),c(t,h),b.m(h,null),c(t,F),w||(T=[V(r,"click",O(B)),V(t,"click",O(z))],w=!0)},p(C,I){o=C,I&1&&l!==(l=o[4].id+"")&&G(e,l),I&1&&v!==(v=o[4].type+"")&&G(N,v),L===(L=M(o))&&b?b.p(o,I):(b.d(1),b=L(o),b&&(b.c(),b.m(h,null))),I&1&&R!==(R="list-group-item "+(o[4].id===o[0].current_question_id?"list-group-item-secondary":"list-group-item-light"))&&a(t,"class",R)},d(C){C&&q(t),b.d(),w=!1,ee(T)}}}function qe(o){let t;function n(l,e){return l[0]?be:pe}let s=n(o),i=s(o);return{c(){i.c(),t=re()},m(l,e){i.m(l,e),k(l,t,e)},p(l,[e]){s===(s=n(l))&&i?i.p(l,e):(i.d(1),i=s(l),i&&(i.c(),i.m(t.parentNode,t)))},i:S,o:S,d(l){l&&q(t),i.d(l)}}}function ge(o,t,n){let{data:s}=t,{handleQuestionRemove:i}=t;const l=u=>{i(u.id)},e=u=>{n(0,s.current_question_id=u.id,s)};return o.$$set=u=>{"data"in u&&n(0,s=u.data),"handleQuestionRemove"in u&&n(1,i=u.handleQuestionRemove)},[s,i,l,e]}class ve extends Z{constructor(t){super(),x(this,t,ge,qe,$,{data:0,handleQuestionRemove:1})}}function Y(o){let t,n,s,i;function l(u){o[9](u)}let e={};return o[3]!==void 0&&(e.question=o[3]),n=new _e({props:e}),te.push(()=>ne(n,"question",l)),{c(){t=f("div"),ie(n.$$.fragment),a(t,"class","mt-2 p-3")},m(u,_){k(u,t,_),se(n,t,null),i=!0},p(u,_){const g={};!s&&_&8&&(s=!0,g.question=u[3],oe(()=>s=!1)),n.$set(g)},i(u){i||(j(n.$$.fragment,u),i=!0)},o(u){H(n.$$.fragment,u),i=!1},d(u){u&&q(t),le(n)}}}function ye(o){let t,n,s,i,l,e,u,_,g,v,N,Q,r,p,h,F,R,w,T,B,M,L,b,z,C,I;function ue(d){o[8](d)}let J={handleQuestionRemove:o[5]};o[2]!==void 0&&(J.data=o[2]),w=new ve({props:J}),te.push(()=>ne(w,"data",ue));let m=o[3]&&Y(o);return{c(){t=f("div"),n=f("div"),s=f("h4"),i=f("a"),l=A(o[1]),u=D(),_=f("div"),g=f("div"),v=f("button"),v.textContent="Add MC question",N=D(),Q=f("button"),Q.textContent="Add card question",r=D(),p=f("div"),p.innerHTML='<div class="col"><div class="mt-3 mb-3 border-dark" style="border-bottom: dotted; border-width: 1px;"></div></div>',h=D(),F=f("div"),R=f("div"),ie(w.$$.fragment),B=D(),M=f("div"),L=D(),b=f("div"),m&&m.c(),a(i,"href",e="/decks/"+o[0]),a(i,"class","text-reset text-decoration-none"),a(n,"class","col"),a(t,"class","row"),a(v,"type","button"),a(v,"class","btn btn-sm btn-primary"),a(Q,"type","button"),a(Q,"class","btn btn-sm btn-primary"),a(g,"class","col"),a(_,"class","row"),a(p,"class","row"),a(M,"class","btn-group-vertical btn-group-sm"),ce(M,"width","100%"),a(M,"role","group"),a(M,"aria-label","Vertical button group"),a(R,"class","col-md-4"),a(b,"class","col-md-8"),a(F,"class","row")},m(d,y){k(d,t,y),c(t,n),c(n,s),c(s,i),c(i,l),k(d,u,y),k(d,_,y),c(_,g),c(g,v),c(g,N),c(g,Q),k(d,r,y),k(d,p,y),k(d,h,y),k(d,F,y),c(F,R),se(w,R,null),c(R,B),c(R,M),c(F,L),c(F,b),m&&m.m(b,null),z=!0,C||(I=[V(v,"click",o[6]),V(Q,"click",o[7])],C=!0)},p(d,[y]){(!z||y&2)&&G(l,d[1]),(!z||y&1&&e!==(e="/decks/"+d[0]))&&a(i,"href",e);const K={};!T&&y&4&&(T=!0,K.data=d[2],oe(()=>T=!1)),w.$set(K),d[3]?m?(m.p(d,y),y&8&&j(m,1)):(m=Y(d),m.c(),j(m,1),m.m(b,null)):m&&(me(),H(m,1,1,()=>{m=null}),de())},i(d){z||(j(w.$$.fragment,d),j(m),z=!0)},o(d){H(w.$$.fragment,d),H(m),z=!1},d(d){d&&(q(t),q(u),q(_),q(r),q(p),q(h),q(F)),le(w),m&&m.d(),C=!1,ee(I)}}}function we(o,t,n){let s,{id:i}=t,{name:l}=t,e={questions:[]};fe(()=>{axios.get("/api/decks/"+i+"/questions").then(function(r){n(2,e.questions=r.data,e),e.questions.length>0&&n(2,e.current_question_id=e.questions[e.questions.length-1].id,e)}).catch(function(r){alert(r)})});function u(r){var p={id:null,text:"",type:r||"mc",correct_answer_id:null,images:[],answers:[]};axios.post("/api/decks/"+i+"/questions",p).then(function(h){p.id=h.data.id,n(2,e.questions=[...e.questions,p],e),n(2,e.current_question_id=p.id,e)}).catch(function(h){alert(h)})}function _(r){axios.delete("/api/decks/"+i+"/questions/"+r).then(function(p){n(2,e.questions=e.questions.filter(h=>h.id!==r),e),e.questions.length>0&&n(2,e.current_question_id=e.questions[e.questions.length-1].id,e)}).catch(function(p){alert(p)})}const g=()=>{u("mc")},v=()=>{u("card")};function N(r){e=r,n(2,e)}function Q(r){s=r,n(3,s),n(2,e)}return o.$$set=r=>{"id"in r&&n(0,i=r.id),"name"in r&&n(1,l=r.name)},o.$$.update=()=>{o.$$.dirty&4&&n(3,s=e?e.questions.find(r=>r.id===e.current_question_id):null)},[i,l,e,s,u,_,g,v,N,Q]}class Qe extends Z{constructor(t){super(),x(this,t,we,ye,$,{id:0,name:1})}}const E=document.getElementById("DeckForm");new Qe({target:E,props:{id:E.dataset.deckId,name:E.dataset.deckName,moduleId:E.dataset.moduleId}});
