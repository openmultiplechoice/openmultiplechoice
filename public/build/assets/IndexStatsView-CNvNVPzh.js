import{p as _t,h as b,l as gt,g as t,m,a as ht,i as yt,f as v,s as r,b as et,c as f,t as U,u as i,k as xt,d as l,e as wt,j as s,n as kt}from"./lifecycle-BvmTvt_c.js";import{o as St,a as Lt}from"./index-client-DUeXGvoC.js";import{c as O,b as $,a as G,e as J,p as K,i as Q}from"./event-modifiers-C9-V6teM.js";import{h as z}from"./html-DWUw1S_J.js";import{b as qt}from"./this-DymA9FIw.js";import{c as W}from"./NewSessionHelper-Ba9jtPTo.js";import{C as rt}from"./auto-g150VQ4A.js";import{f as F,p as It}from"./parseISO-BjONWRSE.js";var Et=v('<span class="badge text-bg-light font-monospace" title="Number of questions"><i class="bi bi-collection"></i> <!></span>'),Nt=v('<div class="alert alert-light mx-1 my-2 p-1 text-truncate small" role="alert"><!> <button type="button" class="btn btn-sm btn-primary"><i class="bi bi-rocket-takeoff"></i></button> <a class="alert-link text-decoration-none"> </a></div>'),Ct=v('<div class="col-lg mt-3 text-truncate"><h6>New decks</h6> <!></div>'),Dt=v('<span class="badge text-bg-light font-monospace" title="Number of questions"><i class="bi bi-collection"></i> <!></span>'),Ht=v('<span class="badge text-bg-light font-monospace" title="Number of sessions"><i class="bi bi-rocket"></i> <!></span>'),jt=v('<div class="alert alert-light mx-1 my-2 p-1 text-truncate small" role="alert"><!> <!> <button type="button" class="btn btn-sm btn-primary"><i class="bi bi-rocket-takeoff"></i></button> <a class="alert-link text-decoration-none"> </a></div>'),At=v('<div class="col-lg mt-3 text-truncate"><h6> </h6> <!></div>'),Bt=v('<span class="badge text-bg-light font-monospace" title="Number of questions"><i class="bi bi-collection"></i> <!></span>'),Mt=v('<div class="alert alert-light mx-1 my-2 p-1 text-truncate small" role="alert"><!> <button type="button" class="btn btn-sm btn-primary"><i class="bi bi-rocket-takeoff"></i></button> <a class="alert-link text-decoration-none"> </a></div>'),Ut=v('<div class="col-lg mt-3 text-truncate"><h6>Last used decks</h6> <!></div>'),Ot=v('<div class="row"><!> <!> <!></div>'),Vt=v('<div class="d-flex justify-content-center mt-3 mb-3"><div class="spinner-border text-secondary" role="status"><span class="visually-hidden">Loading stats ...</span></div></div>'),Pt=v('<div class="alert alert-light text-center" role="alert">No stats available yet <i class="bi bi-heartbreak-fill"></i></div>'),Tt=v('<div class="row"><div class="col-md"><h4>Stats</h4></div></div> <!> <div id="stats" class="row mt-3 p-3"><div class="col-md"><canvas style="max-height: 300px;"></canvas></div></div> <div class="row"><div class="col-md"><span class="badge text-bg-light text-muted"> </span></div></div>',1);function Rt(it,ot){_t(ot,!1);let D=m(),V=m(),X,P=m(),H=m({}),T=m({}),_=m(void 0),g=m(void 0),R=m(0),h=m(void 0);St(()=>{Y(),X=setInterval(Y,120*1e3)}),Lt(()=>{clearInterval(X)});function Y(){axios.get("/api/stats/activity").then(function(o){const n=o.data;b(H,n.answers_byhour),b(T,n.users_byhour),b(_,n.decks_new),b(g,n.decks_popular),b(R,n.decks_popular_timespan),b(h,n.decks_last_used),b(P,new Date)}).catch(function(o){console.log(o)})}gt(()=>(t(D),t(H),t(T),t(V),rt),()=>{t(D)&&t(H)&&t(T)&&(()=>{const o=Object.keys(t(H)),n=Object.values(t(H));if(n.reduce((d,p)=>d+p,0)===0){document.getElementById("stats").style.display="none";return}document.getElementById("stats").style.display="block";const A={type:"line",data:{labels:o,datasets:[{label:"Answers",data:n,backgroundColor:"rgba(255, 205, 86, 0.4)",borderColor:"rgba(255, 205, 86, 0.4)",fill:!0,showLine:!1,pointRadius:0,tension:.2},{label:"Users",data:Object.values(t(T)),backgroundColor:"rgba(54, 162, 235, 0.7)",borderColor:"rgba(54, 162, 235, 0.7)",fill:!0,showLine:!1,pointRadius:0,tension:.2}]},options:{plugins:{legend:{display:!1},tooltip:{callbacks:{title(d){return F(It(d[0].label),"dd.MM.yyyy HH:mm")}}}},responsive:!0,interaction:{intersect:!1},scales:{x:{display:!0,title:{display:!1,text:"Hour of the day"},ticks:{autoSkip:!0,maxTicksLimit:3,callback(d){const p=this.getLabelForValue(d);return F(p,"dd.MM.yyyy")}},grid:{display:!1},border:{display:!1}},y:{display:!0,title:{display:!1,text:"Number of answers"},ticks:{beginAtZero:!0,stepSize:1,maxTicksLimit:3,autoSkip:!0},border:{display:!1}}}}};t(V)&&t(V).destroy();var q=t(D).getContext("2d");b(V,new rt(q,A))})()}),ht(),yt();var tt=Tt(),at=r(et(tt),2);{var nt=o=>{var n=Ot(),j=s(n);{var A=c=>{var y=Ct(),I=r(s(y),2);$(I,1,()=>t(_),Q,(B,a)=>{var k=Nt(),e=s(k);{var E=u=>{var w=Et(),C=r(s(w),2);z(C,()=>(t(a),i(()=>t(a).questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")))),l(u,w)};f(e,u=>{t(a),i(()=>t(a).questions.length>0)&&u(E)})}var x=r(e,2),S=r(x,2),N=s(S);U(()=>{G(S,"href",`/decks/${t(a),i(()=>t(a).id)??""}`),O(N,(t(a),i(()=>t(a).name)))}),J("click",x,K(()=>W(t(a).id))),l(B,k)}),l(c,y)};f(j,c=>{t(_),i(()=>t(_).length>0)&&c(A)})}var q=r(j,2);{var d=c=>{var y=At(),I=s(y),B=s(I),a=r(I,2);$(a,1,()=>t(g),Q,(k,e)=>{var E=jt(),x=s(E);{var S=L=>{var M=Dt(),Z=r(s(M),2);z(Z,()=>(t(e),i(()=>t(e).questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")))),l(L,M)};f(x,L=>{t(e),i(()=>t(e).questions.length>0)&&L(S)})}var N=r(x,2);{var u=L=>{var M=Ht(),Z=r(s(M),2);z(Z,()=>(t(e),i(()=>t(e).sessions_count.toString().padEnd(3," ").replace(/ /g,"&nbsp;")))),l(L,M)};f(N,L=>{t(e),i(()=>t(e).sessions_count)&&L(u)})}var w=r(N,2),C=r(w,2),ft=s(C);U(()=>{G(C,"href",`/decks/${t(e),i(()=>t(e).id)??""}`),O(ft,(t(e),i(()=>t(e).name)))}),J("click",w,K(()=>W(t(e).id))),l(k,E)}),U(()=>O(B,`Popular decks (last ${t(R)??""} days)`)),l(c,y)};f(q,c=>{t(g),t(R),i(()=>t(g).length>0&&t(R))&&c(d)})}var p=r(q,2);{var mt=c=>{var y=Ut(),I=r(s(y),2);$(I,1,()=>t(h),Q,(B,a)=>{var k=Mt(),e=s(k);{var E=u=>{var w=Bt(),C=r(s(w),2);z(C,()=>(t(a),i(()=>t(a).questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")))),l(u,w)};f(e,u=>{t(a),i(()=>t(a).questions.length>0)&&u(E)})}var x=r(e,2),S=r(x,2),N=s(S);U(()=>{G(S,"href",`/decks/${t(a),i(()=>t(a).id)??""}`),O(N,(t(a),i(()=>t(a).name)))}),J("click",x,K(()=>W(t(a).id))),l(B,k)}),l(c,y)};f(p,c=>{t(h),i(()=>t(h).length>0)&&c(mt)})}l(o,n)},lt=o=>{var n=kt(),j=et(n);{var A=d=>{var p=Vt();l(d,p)},q=d=>{var p=Pt();l(d,p)};f(j,d=>{!t(_)&&!t(g)&&!t(h)?d(A):d(q,!1)},!0)}l(o,n)};f(at,o=>{t(_),t(g),t(h),i(()=>t(_)&&t(g)&&t(h)&&(t(_).length>0||t(g).length>0||t(h).length>0))?o(nt):o(lt,!1)})}var st=r(at,2),dt=s(st),vt=s(dt);qt(vt,o=>b(D,o),()=>t(D));var ct=r(st,2),pt=s(ct),ut=s(pt),bt=s(ut);U(o=>O(bt,`Last updated: ${o??""}`),[()=>(t(P),xt(F),i(()=>t(P)?F(t(P),"HH:mm"):"unknown"))]),l(it,tt),wt()}const zt=document.getElementById("IndexStatsView");new Rt({target:zt});
