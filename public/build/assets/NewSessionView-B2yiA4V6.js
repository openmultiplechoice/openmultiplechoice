import{S as je,i as Ae,s as Pe,n as x,d as A,a as P,e as we,k as ve,q as T,c as n,f as _,t as v,b as L,g as d,l as J,p as ie,v as Te,o as ue,E as bt,H as gt,r as qe,u as Ge,w as de,x as fe,I as Xe,y as Ue,z as Ke,A as We,B as Be,C as Ee,h as ye,J as ht,K as vt,m as Ye,L as wt,M as Oe}from"./index-CTA786D7.js";import{e as be,u as Dt,o as St}from"./each-KlFnVOXz.js";import{C as Mt}from"./auto-C0VlNTRY.js";import{s as Ct}from"./StatsHelper-B91isISU.js";import{c as It}from"./NewSessionHelper-Ba9jtPTo.js";import{f as Qe,p as Re}from"./parseISO-DDcmzaBF.js";import{U as He}from"./UserSettingsStore-vIMzuXmW.js";function Lt(l){let e,s,t,i,o,a,c,r,u,f,m,w,b,g,p,k,y,h,q,S,C,U=Math.round(100*l[6]/l[7]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",N,M,H,j,W,Q,G,Z,z,le=Math.round(100*l[2]/l[7]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",$,K,Y,R,E,I,D,B,oe,se=Math.round(100*l[5]/l[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",De,ge,Se,_e,Me,ne,ae,me,Ce,he=Math.round(100*l[4]/l[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",pe,Ie,Ne,ke,re,Le,ce,X,O,F=Math.round(100*l[3]/l[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",Ve,Fe,Je,ee=l[3]>0&&Ze(l);return{c(){e=_("div"),s=_("div"),t=_("canvas"),i=L(),o=_("div"),a=_("table"),c=_("thead"),r=L(),u=_("tbody"),f=_("tr"),m=_("td"),m.textContent="Questions",w=L(),b=_("td"),g=v(l[7]),p=L(),k=_("tr"),y=_("td"),y.textContent="Answered",h=L(),q=_("td"),S=v(l[6]),C=v(`
                            (`),N=v(U),M=v("%)"),H=L(),j=_("tr"),W=_("td"),W.textContent="Unanswered",Q=L(),G=_("td"),Z=v(l[2]),z=v(`
                            (`),$=v(le),K=v("%)"),Y=L(),R=_("tr"),E=_("td"),E.textContent="Correct",I=L(),D=_("td"),B=v(l[5]),oe=v(`
                            (`),De=v(se),ge=v("%)"),Se=L(),_e=_("tr"),Me=_("td"),Me.textContent="Correct with help",ne=L(),ae=_("td"),me=v(l[4]),Ce=v(`
                            (`),pe=v(he),Ie=v("%)"),Ne=L(),ke=_("tr"),re=_("td"),re.textContent="Incorrect",Le=L(),ce=_("td"),X=v(l[3]),O=v(`
                            (`),Ve=v(F),Fe=v("%)"),Je=L(),ee&&ee.c(),d(s,"class","col-md-5"),d(b,"class","font-monospace text-end"),d(q,"class","font-monospace text-end"),d(G,"class","font-monospace text-end"),d(D,"class","font-monospace text-end"),d(ae,"class","font-monospace text-end"),d(ce,"class","font-monospace text-end"),d(a,"class","table"),d(o,"class","col-md-7 mt-3"),d(e,"class","row mb-5")},m(V,te){P(V,e,te),n(e,s),n(s,t),l[14](t),n(e,i),n(e,o),n(o,a),n(a,c),n(a,r),n(a,u),n(u,f),n(f,m),n(f,w),n(f,b),n(b,g),n(u,p),n(u,k),n(k,y),n(k,h),n(k,q),n(q,S),n(q,C),n(q,N),n(q,M),n(u,H),n(u,j),n(j,W),n(j,Q),n(j,G),n(G,Z),n(G,z),n(G,$),n(G,K),n(u,Y),n(u,R),n(R,E),n(R,I),n(R,D),n(D,B),n(D,oe),n(D,De),n(D,ge),n(u,Se),n(u,_e),n(_e,Me),n(_e,ne),n(_e,ae),n(ae,me),n(ae,Ce),n(ae,pe),n(ae,Ie),n(u,Ne),n(u,ke),n(ke,re),n(ke,Le),n(ke,ce),n(ce,X),n(ce,O),n(ce,Ve),n(ce,Fe),n(o,Je),ee&&ee.m(o,null)},p(V,te){te&128&&T(g,V[7]),te&64&&T(S,V[6]),te&192&&U!==(U=Math.round(100*V[6]/V[7]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&T(N,U),te&4&&T(Z,V[2]),te&132&&le!==(le=Math.round(100*V[2]/V[7]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&T($,le),te&32&&T(B,V[5]),te&96&&se!==(se=Math.round(100*V[5]/V[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&T(De,se),te&16&&T(me,V[4]),te&80&&he!==(he=Math.round(100*V[4]/V[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&T(pe,he),te&8&&T(X,V[3]),te&72&&F!==(F=Math.round(100*V[3]/V[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&T(Ve,F),V[3]>0?ee?ee.p(V,te):(ee=Ze(V),ee.c(),ee.m(o,null)):ee&&(ee.d(1),ee=null)},d(V){V&&A(e),l[14](null),ee&&ee.d()}}}function yt(l){let e,s,t,i,o,a,c,r;return{c(){e=_("div"),s=_("div"),t=_("p"),i=v("Number of questions (duplicates included): "),o=_("span"),a=_("i"),c=L(),r=v(l[7]),d(a,"class","bi bi-collection"),d(o,"class","badge text-bg-light font-monospace"),d(s,"class","col-md"),d(e,"class","row")},m(u,f){P(u,e,f),n(e,s),n(s,t),n(t,i),n(t,o),n(o,a),n(o,c),n(o,r)},p(u,f){f&128&&T(r,u[7])},d(u){u&&A(e)}}}function Ze(l){let e,s,t,i,o,a,c,r,u,f,m=l[3]>=40&&$e(l),w=l[3]>=70&&xe(l);return{c(){e=_("div"),m&&m.c(),s=L(),w&&w.c(),t=L(),i=_("button"),o=_("i"),a=v(" Repeat "),c=v(l[3]),r=v(" incorrect"),d(o,"class","bi bi-repeat"),d(i,"class","btn btn-sm btn-outline-secondary"),d(i,"type","button"),d(e,"class","d-grid gap-2")},m(b,g){P(b,e,g),m&&m.m(e,null),n(e,s),w&&w.m(e,null),n(e,t),n(e,i),n(i,o),n(i,a),n(i,c),n(i,r),u||(f=J(i,"click",ie(l[17])),u=!0)},p(b,g){b[3]>=40?m?m.p(b,g):(m=$e(b),m.c(),m.m(e,s)):m&&(m.d(1),m=null),b[3]>=70?w?w.p(b,g):(w=xe(b),w.c(),w.m(e,t)):w&&(w.d(1),w=null),g&8&&T(c,b[3])},d(b){b&&A(e),m&&m.d(),w&&w.d(),u=!1,f()}}}function $e(l){let e,s,t;return{c(){e=_("button"),e.innerHTML='<i class="bi bi-repeat"></i> Repeat 30 incorrect',d(e,"class","btn btn-sm btn-outline-secondary"),d(e,"type","button")},m(i,o){P(i,e,o),s||(t=J(e,"click",ie(l[15])),s=!0)},p:x,d(i){i&&A(e),s=!1,t()}}}function xe(l){let e,s,t;return{c(){e=_("button"),e.innerHTML='<i class="bi bi-repeat"></i> Repeat 60 incorrect',d(e,"class","btn btn-sm btn-outline-secondary"),d(e,"type","button")},m(i,o){P(i,e,o),s||(t=J(e,"click",ie(l[16])),s=!0)},p:x,d(i){i&&A(e),s=!1,t()}}}function qt(l){let e;function s(o,a){if(o[0]&&o[7]===o[2])return yt;if(o[0])return Lt}let t=s(l),i=t&&t(l);return{c(){i&&i.c(),e=we()},m(o,a){i&&i.m(o,a),P(o,e,a)},p(o,[a]){t===(t=s(o))&&i?i.p(o,a):(i&&i.d(1),i=t&&t(o),i&&(i.c(),i.m(e.parentNode,e)))},i:x,o:x,d(o){o&&A(e),i&&i.d(o)}}}function Ut(l,e,s){let t,i,o,a,c,r,u,{decks:f}=e,{moduleId:m}=e,w=[],b=[],g,p;function k(C){const U={module_id:m,question_ids:C};axios.post("/api/sessions/newfromquestionids",U).then(function(N){window.location.href="/sessions/"+N.data.id}).catch(function(N){alert(N)})}function y(C){ve[C?"unshift":"push"](()=>{p=C,s(1,p)})}const h=()=>k(u.slice(0,30)),q=()=>k(u.slice(0,60)),S=()=>k(u);return l.$$set=C=>{"decks"in C&&s(0,f=C.decks),"moduleId"in C&&s(10,m=C.moduleId)},l.$$.update=()=>{l.$$.dirty&2049&&(()=>{if(!f)return;const C=f.map(N=>N.questions).flat();s(11,w=C.filter(N=>!N.is_invalid));const U=[];for(const N of f){const M=N.sessions.sort((j,W)=>W.id-j.id);if(M.length===0)continue;const H=M[0];U.push(...H.answer_choices)}s(12,b=U.filter(N=>w.some(({id:M})=>M===N.question_id)))})(),l.$$.dirty&2048&&s(7,t=w.length),l.$$.dirty&4096&&s(6,i=b.length),l.$$.dirty&192&&s(2,o=t-i),l.$$.dirty&4096&&s(5,a=b.filter(C=>C.is_correct&&!C.help_used).length),l.$$.dirty&4096&&s(4,c=b.filter(C=>C.is_correct&&C.help_used).length),l.$$.dirty&4096&&s(3,r=b.filter(C=>!C.is_correct).length),l.$$.dirty&4096&&s(8,u=b.filter(C=>!C.is_correct).map(C=>C.question_id)),l.$$.dirty&8254&&p&&(()=>{const C={type:"doughnut",data:{labels:["Correct","Correct with help","Incorrect","Unanswered"],datasets:[{label:"n",data:[a,c,r,o],backgroundColor:["#198754","#ffc107","#dc3545","#bbbbbb"],hoverOffet:4}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:null},plugins:{legend:{display:!1}}}};g&&g.destroy();var U=p.getContext("2d");s(13,g=new Mt(U,C))})()},[f,p,o,r,c,a,i,t,u,k,m,w,b,g,y,h,q,S]}class Nt extends je{constructor(e){super(),Ae(this,e,Ut,qt,Pe,{decks:0,moduleId:10})}}function jt(l){let e,s=Qe(Re(l[0].created_at),"dd.MM.yyyy")+"",t;return{c(){e=_("span"),t=v(s),d(e,"class","badge text-bg-light")},m(i,o){P(i,e,o),n(e,t)},p(i,o){o&1&&s!==(s=Qe(Re(i[0].created_at),"dd.MM.yyyy")+"")&&T(t,s)},d(i){i&&A(e)}}}function At(l){let e,s=Qe(Re(l[0].exam_at),"dd.MM.yyyy")+"",t;return{c(){e=_("span"),t=v(s),d(e,"class","badge text-bg-light")},m(i,o){P(i,e,o),n(e,t)},p(i,o){o&1&&s!==(s=Qe(Re(i[0].exam_at),"dd.MM.yyyy")+"")&&T(t,s)},d(i){i&&A(e)}}}function et(l){let e,s,t,i=l[0].sessions.length+"",o;return{c(){e=_("span"),s=_("i"),t=L(),o=v(i),d(s,"class","bi bi-rocket"),d(e,"class","badge text-bg-light font-monospace"),d(e,"title","Number of sessions")},m(a,c){P(a,e,c),n(e,s),n(e,t),n(e,o)},p(a,c){c&1&&i!==(i=a[0].sessions.length+"")&&T(o,i)},d(a){a&&A(e)}}}function tt(l){let e,s;return{c(){e=new gt(!1),s=we(),e.a=s},m(t,i){e.m(l[3],t,i),P(t,s,i)},p(t,i){i&8&&e.p(t[3])},d(t){t&&(A(s),e.d())}}}function Pt(l){let e,s,t,i,o,a,c,r=l[0].questions.length+"",u,f,m,w,b,g,p,k,y,h,q,S,C,U=l[0].name+"",N,M,H,j,W,Q,G,Z,z,le;function $(I,D){return I[0].exam_at?At:jt}let K=$(l),Y=K(l),R=l[0].sessions&&et(l),E=l[3]&&tt(l);return{c(){e=_("div"),s=_("div"),t=_("div"),Y.c(),i=L(),o=_("span"),a=_("i"),c=L(),u=v(r),f=L(),R&&R.c(),m=L(),E&&E.c(),w=L(),b=_("button"),g=_("i"),g.innerHTML="",p=L(),k=_("input"),q=L(),S=_("div"),C=_("h6"),N=v(U),H=L(),j=_("button"),j.innerHTML='<i class="bi bi-rocket-takeoff"></i> Start session',W=L(),Q=_("a"),G=v("Browse deck"),d(a,"class","bi bi-collection"),d(o,"class","badge text-bg-light font-monospace"),d(o,"title","Number of questions"),ue(g,"bi-bookmark-check-fill",l[4]),ue(g,"bi-bookmark",!l[4]),d(b,"class","btn btn-sm btn-link"),d(k,"type","checkbox"),d(k,"class","form-check-input float-end"),k.value="",d(k,"id",y="selected"+l[0].id),k.checked=h=l[2].has(l[0].id),d(t,"class","card-header"),d(C,"class","card-title text-truncate"),d(C,"title",M=l[0].name),d(j,"type","button"),d(j,"class","btn btn-sm btn-primary"),d(Q,"href",Z="/decks/"+l[0].id),d(Q,"class","card-link"),d(S,"class","card-body"),d(s,"class","card"),d(e,"class","col-md-6 mb-3")},m(I,D){P(I,e,D),n(e,s),n(s,t),Y.m(t,null),n(t,i),n(t,o),n(o,a),n(o,c),n(o,u),n(t,f),R&&R.m(t,null),n(t,m),E&&E.m(t,null),n(t,w),n(t,b),n(b,g),n(t,p),n(t,k),n(s,q),n(s,S),n(S,C),n(C,N),n(S,H),n(S,j),n(S,W),n(S,Q),n(Q,G),z||(le=[J(b,"click",l[5]),J(k,"click",l[6]),J(j,"click",ie(l[7]))],z=!0)},p(I,[D]){K===(K=$(I))&&Y?Y.p(I,D):(Y.d(1),Y=K(I),Y&&(Y.c(),Y.m(t,i))),D&1&&r!==(r=I[0].questions.length+"")&&T(u,r),I[0].sessions?R?R.p(I,D):(R=et(I),R.c(),R.m(t,m)):R&&(R.d(1),R=null),I[3]?E?E.p(I,D):(E=tt(I),E.c(),E.m(t,w)):E&&(E.d(1),E=null),D&16&&ue(g,"bi-bookmark-check-fill",I[4]),D&16&&ue(g,"bi-bookmark",!I[4]),D&1&&y!==(y="selected"+I[0].id)&&d(k,"id",y),D&5&&h!==(h=I[2].has(I[0].id))&&(k.checked=h),D&1&&U!==(U=I[0].name+"")&&T(N,U),D&1&&M!==(M=I[0].name)&&d(C,"title",M),D&1&&Z!==(Z="/decks/"+I[0].id)&&d(Q,"href",Z)},i:x,o:x,d(I){I&&A(e),Y.d(),R&&R.d(),E&&E.d(),z=!1,Te(le)}}}function Ht(l,e,s){let{deck:t}=e,{selectDeck:i}=e,{selectedDecks:o}=e,a,c=t.bookmarks.length>0;bt(()=>{const m=t.questions.filter(k=>!k.is_invalid),w=t.sessions.sort((k,y)=>y.id-k.id);if(w.length===0)return;const g=w[0].answer_choices.filter(k=>m.some(({id:y})=>y===k.question_id)),p=Ct(m.length,g);p.correct>=60?s(3,a='<span class="badge text-bg-success" title="Correct answers in percent">'+p.correct+" %</span>"):s(3,a='<span class="badge text-bg-danger" title="Correct answers in percent">'+p.correct+" %</span>")});function r(){c?axios.delete("/api/decks/"+t.id+"/bookmark/"+t.bookmarks[0].id).then(function(m){m.status===204&&s(4,c=!1)}).catch(function(m){alert(m)}):axios.post("/api/decks/"+t.id+"/bookmark").then(function(m){m.status===200&&(s(4,c=!0),s(0,t.bookmarks=[m.data],t))}).catch(function(m){alert(m)})}const u=()=>i(t.id),f=()=>It(t.id);return l.$$set=m=>{"deck"in m&&s(0,t=m.deck),"selectDeck"in m&&s(1,i=m.selectDeck),"selectedDecks"in m&&s(2,o=m.selectedDecks)},[t,i,o,a,c,r,u,f]}class Qt extends je{constructor(e){super(),Ae(this,e,Ht,Pt,Pe,{deck:0,selectDeck:1,selectedDecks:2})}}function lt(l,e,s){const t=l.slice();return t[17]=e[s],t}function st(l,e,s){const t=l.slice();return t[20]=e[s],t[21]=e,t[22]=s,t}function Rt(l){let e;return{c(){e=_("div"),e.innerHTML='<div class="spinner-border text-secondary" role="status"><span class="visually-hidden">Loading decks ...</span></div>',d(e,"class","d-flex justify-content-center")},m(s,t){P(s,e,t)},p:x,i:x,o:x,d(s){s&&A(e)}}}function Tt(l){let e=[],s=new Map,t,i,o=be(l[3]);const a=r=>r[20].id;for(let r=0;r<o.length;r+=1){let u=st(l,o,r),f=a(u);s.set(f,e[r]=it(f,u))}let c=null;return o.length||(c=nt()),{c(){for(let r=0;r<e.length;r+=1)e[r].c();t=we(),c&&c.c()},m(r,u){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(r,u);P(r,t,u),c&&c.m(r,u),i=!0},p(r,u){u&14&&(o=be(r[3]),Ke(),e=Dt(e,u,a,1,r,o,s,t.parentNode,St,it,t,st),We(),!o.length&&c?c.p(r,u):o.length?c&&(c.d(1),c=null):(c=nt(),c.c(),c.m(t.parentNode,t)))},i(r){if(!i){for(let u=0;u<o.length;u+=1)fe(e[u]);i=!0}},o(r){for(let u=0;u<e.length;u+=1)de(e[u]);i=!1},d(r){r&&A(t);for(let u=0;u<e.length;u+=1)e[u].d(r);c&&c.d(r)}}}function nt(l){let e;return{c(){e=_("div"),e.innerHTML='<div class="alert alert-light">No decks found! Create a new deck <a href="/decks" class="alert-link">here</a>.</div> ',d(e,"class","col")},m(s,t){P(s,e,t)},p:x,d(s){s&&A(e)}}}function it(l,e){let s,t,i,o,a;function c(f){e[11](f,e[20],e[21],e[22])}function r(f){e[12](f)}let u={selectDeck:e[2]};return e[20]!==void 0&&(u.deck=e[20]),e[1]!==void 0&&(u.selectedDecks=e[1]),t=new Qt({props:u}),ve.push(()=>qe(t,"deck",c)),ve.push(()=>qe(t,"selectedDecks",r)),{key:l,first:null,c(){s=we(),Ee(t.$$.fragment),this.first=s},m(f,m){P(f,s,m),Be(t,f,m),a=!0},p(f,m){e=f;const w={};m&4&&(w.selectDeck=e[2]),!i&&m&8&&(i=!0,w.deck=e[20],Ue(()=>i=!1)),!o&&m&2&&(o=!0,w.selectedDecks=e[1],Ue(()=>o=!1)),t.$set(w)},i(f){a||(fe(t.$$.fragment,f),a=!0)},o(f){de(t.$$.fragment,f),a=!1},d(f){f&&A(s),Ge(t,f)}}}function ot(l){let e,s,t,i,o,a=l[5].from+"",c,r,u,f=l[5].to+"",m,w,b,g=l[5].total+"",p,k,y,h=l[5].last_page>1&&at(l);return{c(){e=_("div"),s=_("div"),t=_("p"),i=v("Showing "),o=_("span"),c=v(a),r=v(`
                to `),u=_("span"),m=v(f),w=v(`
                of `),b=_("span"),p=v(g),k=v(" decks"),y=L(),h&&h.c(),d(o,"class","fw-semibold"),d(u,"class","fw-semibold"),d(b,"class","fw-semibold"),d(t,"class","small text-muted"),d(s,"class","col"),d(e,"class","row sticky-bottom bg-white mt-3 pt-3")},m(q,S){P(q,e,S),n(e,s),n(s,t),n(t,i),n(t,o),n(o,c),n(t,r),n(t,u),n(u,m),n(t,w),n(t,b),n(b,p),n(t,k),n(e,y),h&&h.m(e,null)},p(q,S){S&32&&a!==(a=q[5].from+"")&&T(c,a),S&32&&f!==(f=q[5].to+"")&&T(m,f),S&32&&g!==(g=q[5].total+"")&&T(p,g),q[5].last_page>1?h?h.p(q,S):(h=at(q),h.c(),h.m(e,null)):h&&(h.d(1),h=null)},d(q){q&&A(e),h&&h.d()}}}function at(l){let e,s,t,i,o,a,c,r,u,f,m,w=be(l[5].links.slice(1,l[5].links.length-1)),b=[];for(let g=0;g<w.length;g+=1)b[g]=ct(lt(l,w,g));return{c(){e=_("div"),s=_("nav"),t=_("ul"),i=_("li"),o=_("button"),o.textContent="‹",a=L();for(let g=0;g<b.length;g+=1)b[g].c();c=L(),r=_("li"),u=_("button"),u.textContent="›",d(o,"class","page-link"),d(i,"class","page-item"),ue(i,"disabled",l[5].prev_page_url===null),d(u,"class","page-link"),d(r,"class","page-item"),ue(r,"disabled",l[5].next_page_url===null),d(t,"class","pagination"),d(e,"class","col")},m(g,p){P(g,e,p),n(e,s),n(s,t),n(t,i),n(i,o),n(t,a);for(let k=0;k<b.length;k+=1)b[k]&&b[k].m(t,null);n(t,c),n(t,r),n(r,u),f||(m=[J(o,"click",ie(l[13])),J(u,"click",ie(l[15]))],f=!0)},p(g,p){if(p&32&&ue(i,"disabled",g[5].prev_page_url===null),p&160){w=be(g[5].links.slice(1,g[5].links.length-1));let k;for(k=0;k<w.length;k+=1){const y=lt(g,w,k);b[k]?b[k].p(y,p):(b[k]=ct(y),b[k].c(),b[k].m(t,c))}for(;k<b.length;k+=1)b[k].d(1);b.length=w.length}p&32&&ue(r,"disabled",g[5].next_page_url===null)},d(g){g&&A(e),Ye(b,g),f=!1,Te(m)}}}function ct(l){let e,s,t=l[17].label+"",i,o,a;function c(){return l[14](l[17])}return{c(){e=_("li"),s=_("button"),i=v(t),d(s,"class","page-link"),d(e,"class","page-item d-none d-sm-block"),ue(e,"disabled",l[17].active||!l[17].url)},m(r,u){P(r,e,u),n(e,s),n(s,i),o||(a=J(s,"click",ie(c)),o=!0)},p(r,u){l=r,u&32&&t!==(t=l[17].label+"")&&T(i,t),u&32&&ue(e,"disabled",l[17].active||!l[17].url)},d(r){r&&A(e),o=!1,a()}}}function Gt(l){let e,s,t,i,o,a,c,r,u,f,m,w,b,g,p,k,y,h,q,S,C,U,N,M,H,j,W,Q,G,Z,z;function le(D){l[9](D)}function $(D){l[10](D)}let K={};l[3]!==void 0&&(K.decks=l[3]),l[0]!==void 0&&(K.moduleId=l[0]),S=new Nt({props:K}),ve.push(()=>qe(S,"decks",le)),ve.push(()=>qe(S,"moduleId",$));const Y=[Tt,Rt],R=[];function E(D,B){return D[3]?0:1}H=E(l),j=R[H]=Y[H](l);let I=l[5]&&l[5].total>0&&ot(l);return{c(){e=_("div"),s=_("div"),t=_("div"),i=_("span"),i.innerHTML='<i class="bi bi-archive"></i>',o=L(),a=_("select"),c=_("option"),r=v("Main decks"),f=_("option"),m=v("Your decks"),b=_("option"),g=v("User decks"),k=_("option"),y=v("Bookmarked decks"),q=L(),Ee(S.$$.fragment),N=L(),M=_("div"),j.c(),W=L(),I&&I.c(),Q=we(),d(i,"class","input-group-text"),c.__value="public-rw-listed",ye(c,c.__value),c.selected=u=l[4]==="public-rw-listed",f.__value="user",ye(f,f.__value),f.selected=w=l[4]==="user",b.__value="public",ye(b,b.__value),b.selected=p=l[4]==="public",k.__value="bookmarked",ye(k,k.__value),k.selected=h=l[4]==="bookmarked",d(a,"id","kind"),d(a,"class","form-select"),l[4]===void 0&&ht(()=>l[8].call(a)),d(t,"class","input-group"),d(s,"class","col"),d(e,"class","row mb-3"),d(M,"class","row")},m(D,B){P(D,e,B),n(e,s),n(s,t),n(t,i),n(t,o),n(t,a),n(a,c),n(c,r),n(a,f),n(f,m),n(a,b),n(b,g),n(a,k),n(k,y),Xe(a,l[4],!0),P(D,q,B),Be(S,D,B),P(D,N,B),P(D,M,B),R[H].m(M,null),P(D,W,B),I&&I.m(D,B),P(D,Q,B),G=!0,Z||(z=[J(a,"change",l[8]),J(a,"change",l[6])],Z=!0)},p(D,[B]){(!G||B&16&&u!==(u=D[4]==="public-rw-listed"))&&(c.selected=u),(!G||B&16&&w!==(w=D[4]==="user"))&&(f.selected=w),(!G||B&16&&p!==(p=D[4]==="public"))&&(b.selected=p),(!G||B&16&&h!==(h=D[4]==="bookmarked"))&&(k.selected=h),B&16&&Xe(a,D[4]);const oe={};!C&&B&8&&(C=!0,oe.decks=D[3],Ue(()=>C=!1)),!U&&B&1&&(U=!0,oe.moduleId=D[0],Ue(()=>U=!1)),S.$set(oe);let se=H;H=E(D),H===se?R[H].p(D,B):(Ke(),de(R[se],1,1,()=>{R[se]=null}),We(),j=R[H],j?j.p(D,B):(j=R[H]=Y[H](D),j.c()),fe(j,1),j.m(M,null)),D[5]&&D[5].total>0?I?I.p(D,B):(I=ot(D),I.c(),I.m(Q.parentNode,Q)):I&&(I.d(1),I=null)},i(D){G||(fe(S.$$.fragment,D),fe(j),G=!0)},o(D){de(S.$$.fragment,D),de(j),G=!1},d(D){D&&(A(e),A(q),A(N),A(M),A(W),A(Q)),Ge(S,D),R[H].d(),I&&I.d(D),Z=!1,Te(z)}}}function ze(l){return new URLSearchParams(window.location.search).get(l)}function Bt(l,e,s){let{moduleId:t}=e,{selectDeck:i}=e,{selectedDecks:o}=e,a,c=ze("kind")??"public-rw-listed",r=ze("page")??1,u;function f(){if(!t){s(3,a=[]);return}s(3,a=void 0);const S=new URL(window.location);S.searchParams.set("module",t),S.searchParams.set("kind",c),S.searchParams.set("page",r),window.history.replaceState({},"",S),axios.get("/api/decks?module="+t+"&kind="+c+"&page="+r).then(function(C){s(5,u=C.data),s(3,a=u.data),a.sort(function(U,N){return U.exam_at===null||N.exam_at===null?U.id<N.id?1:U.id>N.id?-1:0:U.exam_at<N.exam_at?1:U.exam_at>N.exam_at?-1:0})}).catch(function(C){alert(C)})}function m(S){r=S,f()}function w(){c=vt(this),s(4,c)}function b(S){a=S,s(3,a)}function g(S){t=S,s(0,t)}function p(S,C,U,N){U[N]=S,s(3,a)}function k(S){o=S,s(1,o)}const y=()=>{u.prev_page_url&&m(u.current_page-1)},h=S=>{S.url&&m(S.label)},q=()=>{u.next_page_url&&m(u.current_page+1)};return l.$$set=S=>{"moduleId"in S&&s(0,t=S.moduleId),"selectDeck"in S&&s(2,i=S.selectDeck),"selectedDecks"in S&&s(1,o=S.selectedDecks)},l.$$.update=()=>{l.$$.dirty&1&&(r=ze("page")??1,f())},[t,o,i,a,c,u,f,m,w,b,g,p,k,y,h,q]}class Et extends je{constructor(e){super(),Ae(this,e,Bt,Gt,Pe,{moduleId:0,selectDeck:2,selectedDecks:1})}}function ut(l){let e,s,t,i,o,a,c,r,u,f=l[1].length+"",m,w,b=l[1].length>1?"s":"",g,p,k,y=l[3].length+"",h,q,S=l[3].length>1?"s":"",C,U,N,M=l[2]?"excluded":"included",H,j,W,Q,G,Z,z,le,$,K,Y,R,E,I,D,B,oe=l[3].length+"",se,De,ge=l[3].length>1?"s":"",Se,_e,Me,ne,ae,me=l[5].length+"",Ce,he,pe=l[5].length>1?"s":"",Ie,Ne,ke,re,Le,ce,X=l[5].length>0&&rt(l);return{c(){e=_("div"),s=_("div"),t=_("div"),i=_("p"),i.textContent="Create your own super deck:",o=L(),a=_("p"),c=v("You have "),r=_("strong"),u=v("selected "),m=v(f),w=v(" deck"),g=v(b),p=v(`
                    with `),k=_("strong"),h=v(y),q=v(" question"),C=v(S),U=L(),X&&X.c(),N=v(`
                    (duplicates `),H=v(M),j=v(")"),W=L(),Q=_("div"),G=_("label"),G.textContent="Deck Name",Z=L(),z=_("input"),le=L(),$=_("div"),K=_("input"),Y=L(),R=_("label"),R.textContent="Filter out duplicates",E=L(),I=_("div"),D=_("button"),B=v("Create deck ("),se=v(oe),De=v(" question"),Se=v(ge),_e=v(")"),Me=L(),ne=_("button"),ae=v("Create deck ("),Ce=v(me),he=v(" image question"),Ie=v(pe),Ne=v(")"),ke=L(),re=_("button"),re.textContent="Cancel",d(G,"for","name"),d(G,"class","form-label"),d(z,"type","text"),d(z,"class","form-control"),d(z,"id","name"),d(Q,"class","mb-3"),d(K,"type","checkbox"),d(K,"class","form-check-input"),d(K,"id","checkboxRemoveDuplicates"),d(R,"class","form-check-label"),d(R,"for","checkboxRemoveDuplicates"),d($,"class","mb-3 form-check"),d(D,"class","btn btn-sm btn-primary"),d(ne,"class","btn btn-sm btn-primary"),d(re,"class","btn btn-sm btn-link"),d(I,"class","d-grid gap-2 d-md-block"),d(t,"class","alert alert-light"),d(t,"role","alert"),d(s,"class","col-md"),d(e,"class","row")},m(O,F){P(O,e,F),n(e,s),n(s,t),n(t,i),n(t,o),n(t,a),n(a,c),n(a,r),n(r,u),n(r,m),n(r,w),n(r,g),n(a,p),n(a,k),n(k,h),n(k,q),n(k,C),n(a,U),X&&X.m(a,null),n(a,N),n(a,H),n(a,j),n(t,W),n(t,Q),n(Q,G),n(Q,Z),n(Q,z),ye(z,l[4]),n(t,le),n(t,$),n($,K),K.checked=l[2],n($,Y),n($,R),n(t,E),n(t,I),n(I,D),n(D,B),n(D,se),n(D,De),n(D,Se),n(D,_e),n(I,Me),n(I,ne),n(ne,ae),n(ne,Ce),n(ne,he),n(ne,Ie),n(ne,Ne),n(I,ke),n(I,re),Le||(ce=[J(z,"input",l[6]),J(z,"focus",Ot),J(K,"change",l[7]),J(D,"click",ie(l[8])),J(ne,"click",ie(l[9])),J(re,"click",ie(l[10]))],Le=!0)},p(O,F){F&2&&f!==(f=O[1].length+"")&&T(m,f),F&2&&b!==(b=O[1].length>1?"s":"")&&T(g,b),F&8&&y!==(y=O[3].length+"")&&T(h,y),F&8&&S!==(S=O[3].length>1?"s":"")&&T(C,S),O[5].length>0?X?X.p(O,F):(X=rt(O),X.c(),X.m(a,N)):X&&(X.d(1),X=null),F&4&&M!==(M=O[2]?"excluded":"included")&&T(H,M),F&16&&z.value!==O[4]&&ye(z,O[4]),F&4&&(K.checked=O[2]),F&8&&oe!==(oe=O[3].length+"")&&T(se,oe),F&8&&ge!==(ge=O[3].length>1?"s":"")&&T(Se,ge),F&32&&me!==(me=O[5].length+"")&&T(Ce,me),F&32&&pe!==(pe=O[5].length>1?"s":"")&&T(Ie,pe)},d(O){O&&A(e),X&&X.d(),Le=!1,Te(ce)}}}function rt(l){let e,s,t=l[5].length+"",i,o,a=l[5].length>1?"s":"",c,r;return{c(){e=v("/ "),s=_("strong"),i=v(t),o=v(" question"),c=v(a),r=v(" with images")},m(u,f){P(u,e,f),P(u,s,f),n(s,i),n(s,o),n(s,c),n(s,r)},p(u,f){f&32&&t!==(t=u[5].length+"")&&T(i,t),f&32&&a!==(a=u[5].length>1?"s":"")&&T(c,a)},d(u){u&&(A(e),A(s))}}}function Vt(l){let e,s=l[1].length>0&&ut(l);return{c(){s&&s.c(),e=we()},m(t,i){s&&s.m(t,i),P(t,e,i)},p(t,[i]){t[1].length>0?s?s.p(t,i):(s=ut(t),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null)},i:x,o:x,d(t){t&&A(e),s&&s.d(t)}}}function dt(l,e){var s={name:l,question_ids:e};axios.post("/api/decks",s).then(function(t){window.location.href="/decks/"+t.data.id}).catch(function(t){alert(t)})}const Ot=l=>l.target.select();function zt(l,e,s){let t,i,{selectedDecks:o}=e,a=[],c="My new super deck",r=!0;function u(){if(o.size===0){s(1,a=[]);return}const p=[...o].map(k=>"decks[]="+k);axios.get("/api/decks?"+p.join("&")).then(function(k){s(1,a=k.data)}).catch(function(k){alert(k)})}function f(){c=this.value,s(4,c)}function m(){r=this.checked,s(2,r)}const w=()=>dt(c,t.map(p=>p.id)),b=()=>dt(c,i.map(p=>p.id)),g=()=>s(0,o=new Set);return l.$$set=p=>{"selectedDecks"in p&&s(0,o=p.selectedDecks)},l.$$.update=()=>{l.$$.dirty&1&&u(),l.$$.dirty&6&&s(3,t=(()=>{var p=[];return a.forEach(k=>p.push(...k.questions)),r?[...new Map(p.map(k=>[k.id,k])).values()]:p})()),l.$$.dirty&6&&s(5,i=(()=>{var p=[];return a.forEach(k=>{k.questions.forEach(y=>{y.images.length>0&&p.push(y)})}),r?[...new Map(p.map(k=>[k.id,k])).values()]:p})())},[o,a,r,t,c,i,f,m,w,b,g]}class Kt extends je{constructor(e){super(),Ae(this,e,zt,Vt,Pe,{selectedDecks:0})}}function ft(l,e,s){const t=l.slice();return t[12]=e[s],t}function _t(l,e,s){const t=l.slice();return t[15]=e[s],t}function mt(l){let e,s,t=be(l[2]),i=[];for(let o=0;o<t.length;o+=1)i[o]=pt(_t(l,t,o));return{c(){e=_("ul");for(let o=0;o<i.length;o+=1)i[o].c();s=L(),d(e,"class","list-group m-2 me-0")},m(o,a){P(o,e,a);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(e,null);n(e,s)},p(o,a){if(a&37){t=be(o[2]);let c;for(c=0;c<t.length;c+=1){const r=_t(o,t,c);i[c]?i[c].p(r,a):(i[c]=pt(r),i[c].c(),i[c].m(e,s))}for(;c<i.length;c+=1)i[c].d(1);i.length=t.length}},d(o){o&&A(e),Ye(i,o)}}}function pt(l){let e,s=l[15].name+"",t,i,o,a;function c(){return l[9](l[15])}return{c(){e=_("button"),t=v(s),d(e,"data-bs-target","#offcanvasModuleSelection"),d(e,"data-bs-dismiss","offcanvas"),d(e,"class",i="list-group-item list-group-item-action "+(l[0].last_module_id===l[15].id?"list-group-item-secondary":"list-group-item-light"))},m(r,u){P(r,e,u),n(e,t),o||(a=J(e,"click",ie(c)),o=!0)},p(r,u){l=r,u&4&&s!==(s=l[15].name+"")&&T(t,s),u&5&&i!==(i="list-group-item list-group-item-action "+(l[0].last_module_id===l[15].id?"list-group-item-secondary":"list-group-item-light"))&&d(e,"class",i)},d(r){r&&A(e),o=!1,a()}}}function kt(l){let e,s=l[12].name+"",t,i,o,a,c,r;function u(){return l[8](l[12])}let f=l[0].last_subject_id===l[12].id&&mt(l);return{c(){e=_("button"),t=v(s),o=L(),f&&f.c(),a=we(),d(e,"class",i="list-group-item list-group-item-action "+(l[0].last_subject_id===l[12].id?"list-group-item-dark":"list-group-item-light"))},m(m,w){P(m,e,w),n(e,t),P(m,o,w),f&&f.m(m,w),P(m,a,w),c||(r=J(e,"click",ie(u)),c=!0)},p(m,w){l=m,w&2&&s!==(s=l[12].name+"")&&T(t,s),w&3&&i!==(i="list-group-item list-group-item-action "+(l[0].last_subject_id===l[12].id?"list-group-item-dark":"list-group-item-light"))&&d(e,"class",i),l[0].last_subject_id===l[12].id?f?f.p(l,w):(f=mt(l),f.c(),f.m(a.parentNode,a)):f&&(f.d(1),f=null)},d(m){m&&(A(e),A(o),A(a)),f&&f.d(m),c=!1,r()}}}function Wt(l){let e;return{c(){e=_("div"),e.textContent="No module selected",d(e,"class","alert alert-light text-center"),d(e,"role","alert")},m(s,t){P(s,e,t)},p:x,i:x,o:x,d(s){s&&A(e)}}}function Yt(l){let e,s,t;function i(a){l[11](a)}let o={moduleId:l[0].last_module_id,selectDeck:l[6]};return l[3]!==void 0&&(o.selectedDecks=l[3]),e=new Et({props:o}),ve.push(()=>qe(e,"selectedDecks",i)),{c(){Ee(e.$$.fragment)},m(a,c){Be(e,a,c),t=!0},p(a,c){const r={};c&1&&(r.moduleId=a[0].last_module_id),!s&&c&8&&(s=!0,r.selectedDecks=a[3],Ue(()=>s=!1)),e.$set(r)},i(a){t||(fe(e.$$.fragment,a),t=!0)},o(a){de(e.$$.fragment,a),t=!1},d(a){Ge(e,a)}}}function Ft(l){let e,s,t,i,o,a,c,r,u,f,m,w,b,g,p,k,y=be(l[1]),h=[];for(let M=0;M<y.length;M+=1)h[M]=kt(ft(l,y,M));function q(M){l[10](M)}let S={};l[3]!==void 0&&(S.selectedDecks=l[3]),m=new Kt({props:S}),ve.push(()=>qe(m,"selectedDecks",q));const C=[Yt,Wt],U=[];function N(M,H){return M[0].last_module_id?0:1}return g=N(l),p=U[g]=C[g](l),{c(){e=_("div"),e.innerHTML='<div class="col-12 d-grid mb-2"><button type="button" class="btn btn-sm btn-primary d-lg-none my-2" data-bs-toggle="offcanvas" data-bs-target="#offcanvasModuleSelection" aria-controls="offcanvasModuleSelection">Switch module</button></div>',s=L(),t=_("div"),i=_("div"),o=_("div"),o.innerHTML='<h5 id="offcanvasAddToDeckLabel">Choose subject and module</h5> <button type="button" class="btn-close text-reset" data-bs-target="#offcanvasModuleSelection" data-bs-dismiss="offcanvas" aria-label="Close"></button>',a=L(),c=_("div"),r=_("ul");for(let M=0;M<h.length;M+=1)h[M].c();u=L(),f=_("div"),Ee(m.$$.fragment),b=L(),p.c(),d(e,"class","row"),d(o,"class","offcanvas-header"),d(r,"class","list-group w-100"),d(c,"class","offcanvas-body"),d(i,"class","col-lg-4 offcanvas-lg offcanvas-start"),d(i,"tabindex","-1"),d(i,"id","offcanvasModuleSelection"),d(f,"class","col-12 col-lg-8"),d(t,"class","row")},m(M,H){P(M,e,H),P(M,s,H),P(M,t,H),n(t,i),n(i,o),n(i,a),n(i,c),n(c,r);for(let j=0;j<h.length;j+=1)h[j]&&h[j].m(r,null);n(t,u),n(t,f),Be(m,f,null),n(f,b),U[g].m(f,null),k=!0},p(M,[H]){if(H&55){y=be(M[1]);let Q;for(Q=0;Q<y.length;Q+=1){const G=ft(M,y,Q);h[Q]?h[Q].p(G,H):(h[Q]=kt(G),h[Q].c(),h[Q].m(r,null))}for(;Q<h.length;Q+=1)h[Q].d(1);h.length=y.length}const j={};!w&&H&8&&(w=!0,j.selectedDecks=M[3],Ue(()=>w=!1)),m.$set(j);let W=g;g=N(M),g===W?U[g].p(M,H):(Ke(),de(U[W],1,1,()=>{U[W]=null}),We(),p=U[g],p?p.p(M,H):(p=U[g]=C[g](M),p.c()),fe(p,1),p.m(f,null))},i(M){k||(fe(m.$$.fragment,M),fe(p),k=!0)},o(M){de(m.$$.fragment,M),de(p),k=!1},d(M){M&&(A(e),A(s),A(t)),Ye(h,M),Ge(m),U[g].d()}}}function Jt(l,e,s){let t;wt(l,He,p=>s(0,t=p));let i=[],o=[],a=[],c=new Set;bt(()=>{axios.get("/api/modules").then(function(p){var k=p.data;s(7,i=k.filter((h,q,S)=>q===S.findIndex(C=>C.id===h.id)).sort(function(h,q){return h.name>q.name?1:h.name<q.name?-1:0}));var y=i.map(h=>h.subject).filter(h=>!!h);s(1,o=y.filter((h,q,S)=>q===S.findIndex(C=>C.id===h.id)).sort(function(h,q){return h.name>q.name?1:h.name<q.name?-1:0}))}).catch(function(p){alert(p)})});function r(p){var k={last_subject_id:p,last_module_id:0};axios.put("/api/users/me/settings",k).then(function(y){const h=new URL(window.location);h.searchParams.delete("module"),h.searchParams.delete("page"),window.history.replaceState({},"",h),Oe(He,t.last_subject_id=p,t),Oe(He,t.last_module_id=0,t)}).catch(function(y){alert(y)})}function u(p){var k={last_module_id:p};axios.put("/api/users/me/settings",k).then(function(y){const h=new URL(window.location);h.searchParams.set("module",p),h.searchParams.set("page",1),window.history.replaceState({},"",h),Oe(He,t.last_module_id=p,t)}).catch(function(y){alert(y)})}function f(p){c.has(p)?c.delete(p):c.add(p),s(3,c=new Set([...c]))}const m=p=>r(p.id),w=p=>u(p.id);function b(p){c=p,s(3,c)}function g(p){c=p,s(3,c)}return l.$$.update=()=>{l.$$.dirty&129&&(t.last_subject_id,s(2,a=i.filter(p=>t.last_subject_id?p.subject?p.subject.id===t.last_subject_id:!1:!0)))},[t,o,a,c,r,u,f,i,m,w,b,g]}class Xt extends je{constructor(e){super(),Ae(this,e,Jt,Ft,Pe,{})}}const Zt=document.getElementById("NewSessionView");new Xt({target:Zt});
