import{x as Nt,y as Ut,z as Ft,A as zt,B as Gt,C as Wt,U as Vt,D as Yt,p as vt,g as r,s as M,a as E,f as Q,c as u,j as d,t as K,e as A,h as pt,d as Jt,o as Xt,b as me,i as N,u as U,m as rt,v as Zt,k as $t}from"./if-GZgNzgdl.js";import{o as mt}from"./index-client-CpfOMyFP.js";import{s as F,a as T,e as Re,p as Y,d as ei,c as Ne,i as ti}from"./event-modifiers-CaIg6h4B.js";import{h as oe}from"./html-G7Rd4QX6.js";import{s as j}from"./class-BfJg_ovI.js";import{s as ii}from"./style-BtOSwUPa.js";import{b as be,a as ct}from"./input-B1qKra93.js";import{b as dt}from"./select-BE7SEtm-.js";import{b as ge}from"./this-VlG-phZ8.js";import{p as qe}from"./props-D-4SDZEQ.js";import{r as ne}from"./legacy-client-DjQiZhkg.js";import{_ as ni}from"./lodash-DjGC5Q8M.js";import{d as ht,p as lt}from"./purify.es-Dnvgf1Dd.js";function ai(t,i,e){var a=t,n=Vt,c,f,s=null,v=Ut;function w(){c&&Yt(c),s!==null&&(s.lastChild.remove(),a.before(s),s=null),c=f}Nt(()=>{if(v(n,n=i())){var g=a,b=Wt();b&&(s=document.createDocumentFragment(),s.append(g=Ft())),f=zt(()=>e(g)),b?Gt.add_callback(w):w()}})}const Ue=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Fe(t,i,e,a){t.addEventListener?t.addEventListener(i,e,a):t.attachEvent&&t.attachEvent("on".concat(i),e)}function he(t,i,e,a){t.removeEventListener?t.removeEventListener(i,e,a):t.detachEvent&&t.detachEvent("on".concat(i),e)}function _t(t,i){const e=i.slice(0,i.length-1);for(let a=0;a<e.length;a++)e[a]=t[e[a].toLowerCase()];return e}function bt(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");const i=t.split(",");let e=i.lastIndexOf("");for(;e>=0;)i[e-1]+=",",i.splice(e,1),e=i.lastIndexOf("");return i}function si(t,i){const e=t.length>=i.length?t:i,a=t.length>=i.length?i:t;let n=!0;for(let c=0;c<e.length;c++)a.indexOf(e[c])===-1&&(n=!1);return n}const we={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,arrowup:38,arrowdown:40,arrowleft:37,arrowright:39,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":Ue?173:189,"=":Ue?61:187,";":Ue?59:186,"'":222,"{":219,"}":221,"[":219,"]":221,"\\":220},R={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,meta:91,command:91},_e={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},O={16:!1,18:!1,17:!1,91:!1},_={};for(let t=1;t<20;t++)we["f".concat(t)]=111+t;let h=[],ye=null,gt="all";const J=new Map,re=t=>we[t.toLowerCase()]||R[t.toLowerCase()]||t.toUpperCase().charCodeAt(0),oi=t=>Object.keys(we).find(i=>we[i]===t),ri=t=>Object.keys(R).find(i=>R[i]===t);function yt(t){gt=t||"all"}function xe(){return gt||"all"}function ci(){return h.slice(0)}function di(){return h.map(t=>oi(t)||ri(t)||String.fromCharCode(t))}function li(){const t=[];return Object.keys(_).forEach(i=>{_[i].forEach(e=>{let{key:a,scope:n,mods:c,shortcut:f}=e;t.push({scope:n,shortcut:f,mods:c,keys:a.split("+").map(s=>re(s))})})}),t}function ui(t){const i=t.target||t.srcElement,{tagName:e}=i;let a=!0;const n=e==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(i.type);return(i.isContentEditable||(n||e==="TEXTAREA"||e==="SELECT")&&!i.readOnly)&&(a=!1),a}function fi(t){return typeof t=="string"&&(t=re(t)),h.indexOf(t)!==-1}function vi(t,i){let e,a;t||(t=xe());for(const n in _)if(Object.prototype.hasOwnProperty.call(_,n))for(e=_[n],a=0;a<e.length;)e[a].scope===t?e.splice(a,1).forEach(f=>{let{element:s}=f;return Ge(s)}):a++;xe()===t&&yt(i||"all")}function pi(t){let i=t.keyCode||t.which||t.charCode;t.key&&t.key.toLowerCase()==="capslock"&&(i=re(t.key));const e=h.indexOf(i);if(e>=0&&h.splice(e,1),t.key&&t.key.toLowerCase()==="meta"&&h.splice(0,h.length),(i===93||i===224)&&(i=91),i in O){O[i]=!1;for(const a in R)R[a]===i&&(z[a]=!1)}}function wt(t){if(typeof t>"u")Object.keys(_).forEach(n=>{Array.isArray(_[n])&&_[n].forEach(c=>Oe(c)),delete _[n]}),Ge(null);else if(Array.isArray(t))t.forEach(n=>{n.key&&Oe(n)});else if(typeof t=="object")t.key&&Oe(t);else if(typeof t=="string"){for(var i=arguments.length,e=new Array(i>1?i-1:0),a=1;a<i;a++)e[a-1]=arguments[a];let[n,c]=e;typeof n=="function"&&(c=n,n=""),Oe({key:t,scope:n,method:c,splitKey:"+"})}}const Oe=t=>{let{key:i,scope:e,method:a,splitKey:n="+"}=t;bt(i).forEach(f=>{const s=f.split(n),v=s.length,w=s[v-1],g=w==="*"?"*":re(w);if(!_[g])return;e||(e=xe());const b=v>1?_t(R,s):[],S=[];_[g]=_[g].filter(x=>{const I=(a?x.method===a:!0)&&x.scope===e&&si(x.mods,b);return I&&S.push(x.element),!I}),S.forEach(x=>Ge(x))})};function ut(t,i,e,a){if(i.element!==a)return;let n;if(i.scope===e||i.scope==="all"){n=i.mods.length>0;for(const c in O)Object.prototype.hasOwnProperty.call(O,c)&&(!O[c]&&i.mods.indexOf(+c)>-1||O[c]&&i.mods.indexOf(+c)===-1)&&(n=!1);(i.mods.length===0&&!O[16]&&!O[18]&&!O[17]&&!O[91]||n||i.shortcut==="*")&&(i.keys=[],i.keys=i.keys.concat(h),i.method(t,i)===!1&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)))}}function ft(t,i){const e=_["*"];let a=t.keyCode||t.which||t.charCode;if(t.key&&t.key.toLowerCase()==="capslock"||!z.filter.call(this,t))return;if((a===93||a===224)&&(a=91),h.indexOf(a)===-1&&a!==229&&h.push(a),["metaKey","ctrlKey","altKey","shiftKey"].forEach(s=>{const v=_e[s];t[s]&&h.indexOf(v)===-1?h.push(v):!t[s]&&h.indexOf(v)>-1?h.splice(h.indexOf(v),1):s==="metaKey"&&t[s]&&(h=h.filter(w=>w in _e||w===a))}),a in O){O[a]=!0;for(const s in R)if(Object.prototype.hasOwnProperty.call(R,s)){const v=_e[R[s]];z[s]=t[v]}if(!e)return}for(const s in O)Object.prototype.hasOwnProperty.call(O,s)&&(O[s]=t[_e[s]]);t.getModifierState&&!(t.altKey&&!t.ctrlKey)&&t.getModifierState("AltGraph")&&(h.indexOf(17)===-1&&h.push(17),h.indexOf(18)===-1&&h.push(18),O[17]=!0,O[18]=!0);const n=xe();if(e)for(let s=0;s<e.length;s++)e[s].scope===n&&(t.type==="keydown"&&e[s].keydown||t.type==="keyup"&&e[s].keyup)&&ut(t,e[s],n,i);if(!(a in _))return;const c=_[a],f=c.length;for(let s=0;s<f;s++)if((t.type==="keydown"&&c[s].keydown||t.type==="keyup"&&c[s].keyup)&&c[s].key){const v=c[s],{splitKey:w}=v,g=v.key.split(w),b=[];for(let S=0;S<g.length;S++)b.push(re(g[S]));b.sort().join("")===h.sort().join("")&&ut(t,v,n,i)}}function z(t,i,e){h=[];const a=bt(t);let n=[],c="all",f=document,s=0,v=!1,w=!0,g="+",b=!1,S=!1;for(e===void 0&&typeof i=="function"&&(e=i),Object.prototype.toString.call(i)==="[object Object]"&&(i.scope&&(c=i.scope),i.element&&(f=i.element),i.keyup&&(v=i.keyup),i.keydown!==void 0&&(w=i.keydown),i.capture!==void 0&&(b=i.capture),typeof i.splitKey=="string"&&(g=i.splitKey),i.single===!0&&(S=!0)),typeof i=="string"&&(c=i),S&&wt(t,c);s<a.length;s++)t=a[s].split(g),n=[],t.length>1&&(n=_t(R,t)),t=t[t.length-1],t=t==="*"?"*":re(t),t in _||(_[t]=[]),_[t].push({keyup:v,keydown:w,scope:c,mods:n,shortcut:a[s],method:e,key:a[s],splitKey:g,element:f});if(typeof f<"u"&&window){if(!J.has(f)){const x=function(){let I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return ft(I,f)},q=function(){let I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;ft(I,f),pi(I)};J.set(f,{keydownListener:x,keyupListenr:q,capture:b}),Fe(f,"keydown",x,b),Fe(f,"keyup",q,b)}if(!ye){const x=()=>{h=[]};ye={listener:x,capture:b},Fe(window,"focus",x,b)}}}function mi(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(_).forEach(e=>{_[e].filter(n=>n.scope===i&&n.shortcut===t).forEach(n=>{n&&n.method&&n.method()})})}function Ge(t){const i=Object.values(_).flat();if(i.findIndex(a=>{let{element:n}=a;return n===t})<0){const{keydownListener:a,keyupListenr:n,capture:c}=J.get(t)||{};a&&n&&(he(t,"keyup",n,c),he(t,"keydown",a,c),J.delete(t))}if((i.length<=0||J.size<=0)&&(Object.keys(J).forEach(n=>{const{keydownListener:c,keyupListenr:f,capture:s}=J.get(n)||{};c&&f&&(he(n,"keyup",f,s),he(n,"keydown",c,s),J.delete(n))}),J.clear(),Object.keys(_).forEach(n=>delete _[n]),ye)){const{listener:n,capture:c}=ye;he(window,"focus",n,c),ye=null}}const ze={getPressedKeyString:di,setScope:yt,getScope:xe,deleteScope:vi,getPressedKeyCodes:ci,getAllKeyCodes:li,isPressed:fi,filter:ui,trigger:mi,unbind:wt,keyMap:we,modifier:R,modifierMap:_e};for(const t in ze)Object.prototype.hasOwnProperty.call(ze,t)&&(z[t]=ze[t]);if(typeof window<"u"){const t=window.hotkeys;z.noConflict=i=>(i&&window.hotkeys===z&&(window.hotkeys=t),z),window.hotkeys=z}var hi=Q('<form action="#"><div class="mb-3"><label class="form-label">Answer text</label> <input type="hidden"/> <trix-editor></trix-editor> <!></div> <div class="accordion my-2 "><div class="accordion-item"><h2 class="accordion-header"><button type="button" data-bs-toggle="collapse" aria-expanded="false">Answer hint (optional)</button></h2> <div><div class="accordion-body"><div class="mb-3"><input type="hidden"/> <trix-editor></trix-editor> <!> <div class="form-text">A hint that will be shown once the user has answered the question.</div></div></div></div></div></div></form>',2);function _i(t,i){vt(i,!0);let e=qe(i,"answer",15),a=M(void 0),n=M(void 0),c=M(void 0),f=M("");ne(()=>{r(a)&&s(r(a))}),ne(()=>{r(n)&&s(r(n))}),mt(()=>{const k=document.getElementById("collapseAnswerHint"+e().id);k&&k.addEventListener("shown.bs.collapse",()=>{r(n)&&r(n).focus()}),E(c,!!e().hint)});function s(k){k.addEventListener("trix-change",function(){e(e().text=document.getElementById("answerText"+e().id).value,!0),e(e().hint=document.getElementById("answerHint"+e().id).value,!0),E(f,'<p class="text-end">Saving ...</p>'),w()})}var v;function w(){v&&v.cancel(),v=ht(()=>{axios.put("/api/answers/"+e().id,e()).then(function(k){E(f,'<p class="text-end">Saved <span class="text-success-dark">&check;</span></p>')}).catch(function(k){E(f,'<p class="text-end">Saving ... <span class="text-danger-dark">failed!</span></p>'),alert(k)})},500,{maxWait:2e3}),v()}var g=hi(),b=d(g),S=d(b),x=u(S,2),q=u(x,2);K(()=>F(q,"id",`editor-answer${e().id??""}`)),j(q,1,"bg-light trix-content"),K(()=>F(q,"input",`answerText${e().id??""}`)),ge(q,k=>E(a,k),()=>r(a));var I=u(q,2);oe(I,()=>r(f));var ae=u(b,2),Le=d(ae),$=d(Le),se=d($),ce=u($,2),He=d(ce),ke=d(He),de=d(ke),ee=u(de,2);K(()=>F(ee,"id",`editor-answerHint${e().id??""}`)),j(ee,1,"bg-light trix-content"),K(()=>F(ee,"input",`answerHint${e().id??""}`)),ge(ee,k=>E(n,k),()=>r(n));var Ee=u(ee,2);oe(Ee,()=>r(f));var Qe=u(Ee,2);K(()=>{T(S,"for",`answerText${e().id??""}`),T(x,"id",`answerText${e().id??""}`),T(ae,"id",`accordionAnswerHint${e().id??""}`),j(se,1,`accordion-button text-black bg-white py-2 px-3 ${r(c)?"":"collapsed"}`),T(se,"data-bs-target",`#collapseAnswerHint${e().id??""}`),T(se,"aria-controls",`#collapseAnswerHint${e().id??""}`),T(ce,"id",`collapseAnswerHint${e().id??""}`),j(ce,1,`accordion-collapse collapse ${r(c)?"show":""}`),T(de,"id",`answerHint${e().id??""}`),T(Qe,"id",`answerHint${e().id??""}`)}),be(x,()=>e().text,k=>e(e().text=k,!0)),be(de,()=>e().hint,k=>e(e().hint=k,!0)),A(t,g),pt()}function bi(t,i){axios.put("/api/questions/"+i().id,{type:i().type==="mc"?"mc":"card"}).then(function(e){i(i().type=e.data.type,!0)}).catch(function(e){alert(e)})}function gi(t,i,e,a){axios.put("/api/questions/"+i().id,{case_id:r(e)}).then(function(n){i(i().case_id=n.data.case_id,!0);const c=a.cases.find(f=>f.id===n.data.case_id);i(i().case=c,!0),c.questions||(c.questions=[]),c.questions.push({id:i().id,case_id:c.id})}).catch(function(n){alert(n)})}var yi=Q('<button type="button" class="btn btn-outline-secondary btn-sm">Close editor</button>'),wi=Q('<div class="alert alert-secondary m-1" role="alert"><p class="small fw-bold"><i class="bi bi-clipboard2-pulse"></i> CASE</p> <p class="trix-content"><!></p></div> <div class="text-end m-1"><button type="button" class="btn btn-sm btn-light" title="Remove case"><i class="bi bi-trash"></i> Remove case</button></div>',1),xi=Q("<option> </option>"),ki=Q('<div class="alert alert-light" role="alert"><div class="row g-3 align-items-center"><div class="col-auto"><label for="case" class="col-form-label small fw-bold"><i class="bi bi-clipboard2-pulse"></i> CASE</label></div> <div class="col-auto"><select id="case" class="form-select"><option>Select case</option><!></select></div></div></div>'),Ei=Q(`<!> <div class="mt-3 mb-2"><label for="questionText" class="form-label">Question text</label> <input type="hidden"/> <trix-editor></trix-editor> <!></div> <div class="accordion my-2 " id="accordionQuestionHint"><div class="accordion-item"><h2 class="accordion-header"><button type="button" data-bs-toggle="collapse" data-bs-target="#collapseQuestionHint" aria-expanded="false" aria-controls="collapseQuestionHint">Question hint (optional)</button></h2> <div id="collapseQuestionHint"><div class="accordion-body"><div class="mt-3 mb-3"><input type="hidden"/> <trix-editor></trix-editor> <!> <div id="questionHint" class="form-text">A hint that can be shown to the user if they are stuck.</div></div></div></div></div></div> <div class="accordion my-2" id="accordionQuestionComment"><div class="accordion-item"><h2 class="accordion-header"><button type="button" data-bs-toggle="collapse" data-bs-target="#collapseQuestionComment" aria-expanded="false" aria-controls="collapseQuestionComment">Question comment (optional)</button></h2> <div id="collapseQuestionComment"><div class="accordion-body"><div class="mt-3 mb-3"><input type="hidden"/> <trix-editor></trix-editor> <!> <div id="questionHint" class="form-text">A comment that will be shown once the user has answered the question.
                                It can be used to explain the correct answer or provide additional
                                information, for example sources.</div></div></div></div></div></div> <div class="mb-3 p-3 bg-light rounded"><div class="form-check mb-3"><input type="checkbox" class="form-check-input" id="checkInvalidQuestion"/> <label class="form-check-label" for="checkInvalidQuestion"><i class="bi bi-cone-striped"></i> <strong>Invalid question</strong> - Is the answer unknown or disputed? Invalid questions remain in deck but are not counted into results.</label></div> <div class="form-check"><input type="checkbox" class="form-check-input" id="checkNeedsReview"/> <label class="form-check-label" for="checkNeedsReview"><i class="bi bi-eraser-fill"></i> <strong>Needs review</strong> - Does this question need to be reviewed and improved? Questions marked for review remain in deck and are counted into results.</label></div></div>`,3),Ci=Q(`<div class="col"><div class="alert alert-warning" role="alert">Don't forget to set the correct answer!</div></div>`),Ai=Q('<div class="card-body"><p class="card-text"> </p></div>'),Ki=Q('<div class="col"><div class="card" style="width: 18rem"><div class="card-header bg-transparent"><button type="button" class="btn btn-sm btn-light"><i class="bi bi-trash"></i></button></div> <img class="card-img-top" alt=""/> <!></div></div>'),Oi=Q('<button type="button" title="Set as correct answer"><i class="bi bi-check-lg"></i></button>'),qi=Q('<div class="mt-3 mb-1 px-3 pt-2 pb-1 bg-light-subtle rounded"><!> <div class="text-end mb-2"><!> <button type="button" class="btn btn-sm btn-light" title="Delete answer"><i class="bi bi-trash"></i></button></div></div>'),Li=Q('<div class="sticky-bottom bg-white mt-3" style="z-index: 10;"><div class="row py-3"><div class="col"><button class="btn btn-sm btn-primary" title="Add a new answer (Shortcut: Alt+A)">Add answer</button></div></div></div>'),Hi=Q("<option>card</option>"),Qi=Q('<div class="alert alert-light" role="alert"><p><strong>Delete question?</strong> Deleting a question will also delete all associated answers and images.</p> <button type="button" class="btn btn-sm btn-danger"><i class="bi bi-trash"></i> Delete question</button></div>'),Si=Q(`<div class="row"><div class="col"><div class="mb-3 border-dark" style="border-bottom: dotted; border-width: 1px;"></div></div></div> <div class="alert alert-light" role="alert"><div class="input-group mb-3"><span class="input-group-text">ID</span> <input type="text" class="form-control" disabled readonly=""/></div> <div class="row g-3 align-items-center"><div class="col-auto"><label for="questionType" class="col-form-label fw-bold">Question type:</label></div> <div class="col-auto"><select id="questionType" class="form-select font-monospace text-uppercase"><!><option>mc</option></select></div> <div class="col-auto"><span id="questionTypeHelp" class="form-text">Can be either multiple choice (MC) or card (CARD). <strong>Card Questions
                    can have only one or no answer.</strong></span></div></div></div> <!>`,1),Ii=Q('<form action="#" class="mt-3"><!> <!> <div class="mb-3"><label for="image" class="form-label">Add image</label> <input class="form-control" type="file" accept="image/jpeg, image/png, image/webp" name="image"/> <div id="imageHelp" class="form-text">Supported formats are JPEG, PNG, and WebP.</div></div></form> <!> <div class="row row-cols-1 row-cols-lg-3 g4"></div> <!> <!> <!>',1);function Vi(t,i){vt(i,!0);let e=qe(i,"question",15),a=qe(i,"showConfigEditor",3,!1),n=qe(i,"showCaseSelector",3,!1),c=M(void 0),f=M(void 0),s=M(void 0),v=M(void 0),w=0,g=M(void 0),b=M(void 0),S=M(void 0);const x=1e3;let q=M(""),I=U(()=>e().correct_answer_id);ne(()=>{r(c)&&ae(r(c))}),ne(()=>{r(f)&&ae(r(f))}),ne(()=>{r(s)&&ae(r(s))}),ne(()=>{e().case?E(v,e().case.id,!0):E(v,"")}),ne(()=>{e().id!==r(S)&&(E(S,e().id,!0),E(g,!!e().hint),E(b,!!e().comment))}),mt(()=>{z.filter=function(){return!0},z("alt+A",function(p){p.preventDefault();const y=Date.now();y-w>x&&(ke(),w=y)});const o=document.getElementById("collapseQuestionHint");o&&o.addEventListener("shown.bs.collapse",()=>{r(s)&&r(s).focus()});const l=document.getElementById("collapseQuestionComment");l&&l.addEventListener("shown.bs.collapse",()=>{r(f)&&r(f).focus()})});function ae(o){o.addEventListener("trix-change",function(){e(e().text=document.getElementById("questionText"+e().id).value,!0),e(e().comment=document.getElementById("questionComment"+e().id).value,!0),e(e().hint=document.getElementById("questionHint"+e().id).value,!0),E(q,'<p class="text-end">Saving ...</p>'),se()})}function Le(o){o!==e().correct_answer_id&&(e(e().correct_answer_id=o,!0),axios.put("/api/questions/"+e().id,e()).then(function(l){}).catch(function(l){alert(l)}))}var $;function se(){$&&$.cancel(),$=ht(()=>{axios.put("/api/questions/"+e().id,e()).then(function(o){E(q,'<p class="text-end">Saved <span class="text-success-dark">&check;</span></p>')}).catch(function(o){E(q,'<p class="text-end">Saving ... <span class="text-danger-dark">failed!</span></p>'),alert(o)})},500,{maxWait:2e3}),$()}function ce(){var o=new FormData,l=document.getElementById("imageInput"+e().id);o.set("image",l.files[0]),axios.post("/api/questions/"+e().id+"/images",o,{headers:{"Content-Type":"multipart/form-data"}}).then(function(p){l.value="";var y=p.data;e(e().images=[...e().images,y],!0)}).catch(function(p){l.value="",alert(p)})}function He(o){axios.delete("/api/images/"+o).then(function(l){e(e().images=e().images.filter(p=>p.id!==o),!0)}).catch(function(l){alert(l)})}function ke(){axios.post("/api/questions/"+e().id+"/answers",{}).then(function(o){e(e().answers=[...e().answers,o.data],!0),Xt().then(()=>{const l=document.getElementById("editor-answer"+o.data.id);l&&l.focus()})}).catch(function(o){alert(o)})}function de(o){axios.delete("/api/answers/"+o).then(function(l){e(e().answers=e().answers.filter(p=>p.id!==o),!0)}).catch(function(l){alert(l)})}function ee(){axios.put("/api/questions/"+e().id,{case_id:null}).then(function(o){e(e().case_id=null,!0),e(e().case=null,!0),i.cases.map(l=>{l.questions=l.questions.filter(p=>p.id!==e().id)})}).catch(function(o){alert(o)})}function Ee(){axios.put("/api/questions/"+e().id,{is_invalid:!e().is_invalid}).then(function(o){e(e().is_invalid=!e().is_invalid,!0)}).catch(function(o){alert(o)})}function Qe(){axios.put("/api/questions/"+e().id,{needs_review:!e().needs_review}).then(function(o){e(e().needs_review=!e().needs_review,!0)}).catch(function(o){alert(o)})}var k=Ii(),Se=me(k),xt=U(()=>Y(se)),We=d(Se);{var kt=o=>{var l=yi(),p=U(()=>Y(i.toggleEditor));l.__click=function(...y){r(p)?.apply(this,y)},A(o,l)};N(We,o=>{i.toggleEditor&&o(kt)})}var Ve=u(We,2);ai(Ve,()=>e().id,o=>{var l=Ei(),p=me(l);{var y=m=>{var fe=wi(),Ce=me(fe),Te=u(d(Ce),2),ve=d(Te);oe(ve,()=>lt.sanitize(i.cases.find(ie=>ie.id===e().case_id).text));var Ae=u(Ce,2),Me=d(Ae),je=U(()=>Y(ee));Me.__click=function(...ie){r(je)?.apply(this,ie)},A(m,fe)},B=m=>{var fe=$t(),Ce=me(fe);{var Te=ve=>{var Ae=ki(),Me=d(Ae),je=u(d(Me),2),ie=d(je);ie.__change=[gi,e,v,i];var Be=d(ie);Be.value=Be.__value="";var Bt=u(Be);Re(Bt,17,()=>i.cases,ti,(Pe,Ke)=>{var pe=xi(),Pt=d(pe),ot={};K(Rt=>{Ne(pe,e().case_id==r(Ke).id),rt(Pt,Rt),ot!==(ot=r(Ke).id)&&(pe.value=(pe.__value=r(Ke).id)??"")},[()=>ni.truncate(lt.sanitize(r(Ke).text,{ALLOWED_TAGS:[]}),{length:30})]),A(Pe,pe)}),dt(ie,()=>r(v),Pe=>E(v,Pe)),A(ve,Ae)};N(Ce,ve=>{n()&&i.cases&&i.cases.length>0&&ve(Te)},!0)}A(m,fe)};N(p,m=>{n()&&e().case_id?m(y):m(B,!1)})}var G=u(p,2),W=u(d(G),2),L=u(W,2);F(L,"id","editor-questionText"),j(L,1,"bg-light trix-content"),K(()=>F(L,"input",`questionText${e().id??""}`)),ge(L,m=>E(c,m),()=>r(c));var X=u(L,2);oe(X,()=>r(q));var Z=u(G,2),D=d(Z),C=d(D),V=d(C),H=u(C,2),P=d(H),Ie=d(P),le=d(Ie),te=u(le,2);F(te,"id","editor-questionHint"),j(te,1,"bg-light trix-content"),K(()=>F(te,"input",`questionHint${e().id??""}`)),ge(te,m=>E(s,m),()=>r(s));var qt=u(te,2);oe(qt,()=>r(q));var et=u(Z,2),Lt=d(et),tt=d(Lt),Ht=d(tt),it=u(tt,2),Qt=d(it),St=d(Qt),De=d(St),ue=u(De,2);F(ue,"id","editor-questionComment"),j(ue,1,"bg-light trix-content"),K(()=>F(ue,"input",`questionComment${e().id??""}`)),ge(ue,m=>E(f,m),()=>r(f));var It=u(ue,2);oe(It,()=>r(q));var Dt=u(et,2),nt=d(Dt),at=d(nt),Tt=U(()=>Y(Ee));at.__click=function(...m){r(Tt)?.apply(this,m)};var Mt=u(nt,2),st=d(Mt),jt=U(()=>Y(Qe));st.__click=function(...m){r(jt)?.apply(this,m)},K(()=>{T(W,"id",`questionText${e().id??""}`),j(V,1,`accordion-button text-black bg-white py-2 px-3 ${r(g)?"":"collapsed"}`),j(H,1,`accordion-collapse collapse ${r(g)?"show":""}`),T(le,"id",`questionHint${e().id??""}`),j(Ht,1,`accordion-button text-black bg-white py-2 px-3 ${r(b)?"":"collapsed"}`),j(it,1,`accordion-collapse collapse ${r(b)?"show":""}`),T(De,"id",`questionComment${e().id??""}`)}),be(W,()=>e().text,m=>e(e().text=m,!0)),be(le,()=>e().hint,m=>e(e().hint=m,!0)),be(De,()=>e().comment,m=>e(e().comment=m,!0)),ct(at,()=>e().is_invalid,m=>e(e().is_invalid=m,!0)),ct(st,()=>e().needs_review,m=>e(e().needs_review=m,!0)),A(o,l)});var Et=u(Ve,2),Ye=u(d(Et),2);Ye.__input=ce;var Je=u(Se,2);{var Ct=o=>{var l=Ci();A(o,l)};N(Je,o=>{!r(I)&&e().type==="mc"&&o(Ct)})}var Xe=u(Je,2);Re(Xe,21,()=>e().images,o=>o.id,(o,l)=>{var p=Ki(),y=d(p),B=d(y),G=d(B),W=U(()=>Y(()=>{confirm("Are you sure you want to delete this image?")&&He(r(l).id)}));G.__click=function(...D){r(W)?.apply(this,D)};var L=u(B,2),X=u(L,2);{var Z=D=>{var C=Ai(),V=d(C),H=d(V);K(()=>rt(H,r(l).comment)),A(D,C)};N(X,D=>{r(l).comment&&D(Z)})}K(()=>T(L,"src",`/${r(l).path??""}`)),A(o,p)});var Ze=u(Xe,2);Re(Ze,19,()=>e().answers,o=>o.id,(o,l,p)=>{var y=qi();let B;var G=d(y);_i(G,{get answer(){return e().answers[r(p)]},set answer(C){e(e().answers[r(p)]=C,!0)}});var W=u(G,2),L=d(W);{var X=C=>{var V=Oi(),H=U(()=>Y(()=>{Le(r(l).id)}));V.__click=function(...P){r(H)?.apply(this,P)},K(()=>j(V,1,`btn btn-sm ${r(I)===r(l).id?"btn-success":"btn-light"}`)),A(C,V)};N(L,C=>{e().type==="mc"&&C(X)})}var Z=u(L,2),D=U(()=>Y(()=>{confirm("Are you sure you want to delete this answer?")&&de(r(l).id)}));Z.__click=function(...C){r(D)?.apply(this,C)},K(C=>B=ii(y,"",B,C),[()=>({border:"2px dotted "+(r(I)===r(l).id?"green":"lightgray")})]),A(o,y)});var $e=u(Ze,2);{var At=o=>{var l=Li(),p=d(l),y=d(p),B=d(y);B.__click=ke,A(o,l)};N($e,o=>{(e().type==="mc"||e().answers.length===0)&&o(At)})}var Kt=u($e,2);{var Ot=o=>{var l=Si(),p=u(me(l),2),y=d(p),B=u(d(y),2),G=u(y,2),W=u(d(G),2),L=d(W);L.__change=[bi,e];var X=d(L);{var Z=H=>{var P=Hi();P.value=P.__value="card",K(()=>Ne(P,e().type=="card")),A(H,P)};N(X,H=>{(e().answers.length<=1||e().type==="card")&&H(Z)})}var D=u(X);D.value=D.__value="mc";var C=u(p,2);{var V=H=>{var P=Qi(),Ie=u(d(P),2),le=U(()=>Y(()=>{confirm("Are you sure you want to delete this question?")&&i.handleQuestionRemove(e().id)}));Ie.__click=function(...te){r(le)?.apply(this,te)},A(H,P)};N(C,H=>{i.handleQuestionRemove&&H(V)})}K(()=>{ei(B,e().id),L.disabled=e().answers.length>1,Ne(D,e().type=="mc")}),dt(L,()=>e().type,H=>e(e().type=H,!0)),A(o,l)};N(Kt,o=>{a()&&o(Ot)})}K(()=>T(Ye,"id",`imageInput${e().id??""}`)),Zt("submit",Se,function(...o){r(xt)?.apply(this,o)}),A(t,k),pt()}Jt(["click","change","input"]);export{Vi as Q,z as h,ai as k};
