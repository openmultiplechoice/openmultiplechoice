import{S as je,i as Le,s as Ue,e as Ae,b as L,n as $,d as U,k as ge,c as _,a as I,t as b,f,h as n,q as y,l as X,p as ie,B as ot,C as ct,H as dt,r as Ie,u as He,v as Te,w as Ce,D as at,z as ut,x as me,y as pe,A as Re,j as Pe,m as rt,G as ft,I as Ee}from"./index-Cm33_cbi.js";import{e as ye,u as _t,o as mt}from"./each-C5IGOPsu.js";import{C as pt}from"./auto-De2ec26M.js";import{s as gt}from"./StatsHelper-B91isISU.js";import{c as kt}from"./NewSessionHelper-Ba9jtPTo.js";import{f as Qe,p as Ge}from"./parseISO-JEmvXouO.js";import{U as Ne}from"./UserSettingsStore-Csk5U10K.js";function ht(t){let e,l,s,i,o,c,u,g,m,r,h,d,v,k,a,p,D,S,j,B,M,q=Math.round(100*t[5]/t[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",A,w,R,H,Y,N,O,x,G,V=Math.round(100*t[1]/t[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",Q,C,W,ee,ke,te,F,he,de,oe=Math.round(100*t[4]/t[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",be,fe,ve,ce,we,Z,se,ae,De,_e=Math.round(100*t[3]/t[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",ue,Se,qe,re,ne,Me,le,z,E,P=Math.round(100*t[2]/t[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",Ve,Be,Oe,J=t[2]>0&&ze(t);return{c(){e=_("div"),l=_("div"),s=_("canvas"),i=I(),o=_("div"),c=_("table"),u=_("thead"),g=I(),m=_("tbody"),r=_("tr"),h=_("td"),h.textContent="Questions",d=I(),v=_("td"),k=b(t[6]),a=I(),p=_("tr"),D=_("td"),D.textContent="Answered",S=I(),j=_("td"),B=b(t[5]),M=b(`
                            (`),A=b(q),w=b("%)"),R=I(),H=_("tr"),Y=_("td"),Y.textContent="Unanswered",N=I(),O=_("td"),x=b(t[1]),G=b(`
                            (`),Q=b(V),C=b("%)"),W=I(),ee=_("tr"),ke=_("td"),ke.textContent="Correct",te=I(),F=_("td"),he=b(t[4]),de=b(`
                            (`),be=b(oe),fe=b("%)"),ve=I(),ce=_("tr"),we=_("td"),we.textContent="Correct with help",Z=I(),se=_("td"),ae=b(t[3]),De=b(`
                            (`),ue=b(_e),Se=b("%)"),qe=I(),re=_("tr"),ne=_("td"),ne.textContent="Incorrect",Me=I(),le=_("td"),z=b(t[2]),E=b(`
                            (`),Ve=b(P),Be=b("%)"),Oe=I(),J&&J.c(),f(l,"class","col-md-5"),f(v,"class","font-monospace text-end"),f(j,"class","font-monospace text-end"),f(O,"class","font-monospace text-end"),f(F,"class","font-monospace text-end"),f(se,"class","font-monospace text-end"),f(le,"class","font-monospace text-end"),f(c,"class","table"),f(o,"class","col-md-7 mt-3"),f(e,"class","row mb-5")},m(T,K){L(T,e,K),n(e,l),n(l,s),t[14](s),n(e,i),n(e,o),n(o,c),n(c,u),n(c,g),n(c,m),n(m,r),n(r,h),n(r,d),n(r,v),n(v,k),n(m,a),n(m,p),n(p,D),n(p,S),n(p,j),n(j,B),n(j,M),n(j,A),n(j,w),n(m,R),n(m,H),n(H,Y),n(H,N),n(H,O),n(O,x),n(O,G),n(O,Q),n(O,C),n(m,W),n(m,ee),n(ee,ke),n(ee,te),n(ee,F),n(F,he),n(F,de),n(F,be),n(F,fe),n(m,ve),n(m,ce),n(ce,we),n(ce,Z),n(ce,se),n(se,ae),n(se,De),n(se,ue),n(se,Se),n(m,qe),n(m,re),n(re,ne),n(re,Me),n(re,le),n(le,z),n(le,E),n(le,Ve),n(le,Be),n(o,Oe),J&&J.m(o,null)},p(T,K){K&64&&y(k,T[6]),K&32&&y(B,T[5]),K&96&&q!==(q=Math.round(100*T[5]/T[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&y(A,q),K&2&&y(x,T[1]),K&66&&V!==(V=Math.round(100*T[1]/T[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&y(Q,V),K&16&&y(he,T[4]),K&48&&oe!==(oe=Math.round(100*T[4]/T[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&y(be,oe),K&8&&y(ae,T[3]),K&40&&_e!==(_e=Math.round(100*T[3]/T[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&y(ue,_e),K&4&&y(z,T[2]),K&36&&P!==(P=Math.round(100*T[2]/T[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&y(Ve,P),T[2]>0?J?J.p(T,K):(J=ze(T),J.c(),J.m(o,null)):J&&(J.d(1),J=null)},d(T){T&&U(e),t[14](null),J&&J.d()}}}function bt(t){let e,l,s,i,o,c,u,g;return{c(){e=_("div"),l=_("div"),s=_("p"),i=b("Number of questions in this module (duplicates included): "),o=_("span"),c=_("i"),u=I(),g=b(t[6]),f(c,"class","bi bi-collection"),f(o,"class","badge text-bg-light font-monospace"),f(l,"class","col-md"),f(e,"class","row")},m(m,r){L(m,e,r),n(e,l),n(l,s),n(s,i),n(s,o),n(o,c),n(o,u),n(o,g)},p(m,r){r&64&&y(g,m[6])},d(m){m&&U(e)}}}function ze(t){let e,l,s,i,o,c,u,g,m,r,h=t[2]>=40&&We(t),d=t[2]>=70&&Fe(t);return{c(){e=_("div"),h&&h.c(),l=I(),d&&d.c(),s=I(),i=_("button"),o=_("i"),c=b(" Repeat "),u=b(t[2]),g=b(" incorrect"),f(o,"class","bi bi-repeat"),f(i,"class","btn btn-sm btn-outline-secondary"),f(i,"type","button"),f(e,"class","d-grid gap-2")},m(v,k){L(v,e,k),h&&h.m(e,null),n(e,l),d&&d.m(e,null),n(e,s),n(e,i),n(i,o),n(i,c),n(i,u),n(i,g),m||(r=X(i,"click",ie(t[17])),m=!0)},p(v,k){v[2]>=40?h?h.p(v,k):(h=We(v),h.c(),h.m(e,l)):h&&(h.d(1),h=null),v[2]>=70?d?d.p(v,k):(d=Fe(v),d.c(),d.m(e,s)):d&&(d.d(1),d=null),k&4&&y(u,v[2])},d(v){v&&U(e),h&&h.d(),d&&d.d(),m=!1,r()}}}function We(t){let e,l,s;return{c(){e=_("button"),e.innerHTML='<i class="bi bi-repeat"></i> Repeat 30 incorrect',f(e,"class","btn btn-sm btn-outline-secondary"),f(e,"type","button")},m(i,o){L(i,e,o),l||(s=X(e,"click",ie(t[15])),l=!0)},p:$,d(i){i&&U(e),l=!1,s()}}}function Fe(t){let e,l,s;return{c(){e=_("button"),e.innerHTML='<i class="bi bi-repeat"></i> Repeat 60 incorrect',f(e,"class","btn btn-sm btn-outline-secondary"),f(e,"type","button")},m(i,o){L(i,e,o),l||(s=X(e,"click",ie(t[16])),l=!0)},p:$,d(i){i&&U(e),l=!1,s()}}}function vt(t){let e;function l(o,c){return o[6]===o[1]?bt:ht}let s=l(t),i=s(t);return{c(){i.c(),e=Ae()},m(o,c){i.m(o,c),L(o,e,c)},p(o,[c]){s===(s=l(o))&&i?i.p(o,c):(i.d(1),i=s(o),i&&(i.c(),i.m(e.parentNode,e)))},i:$,o:$,d(o){o&&U(e),i.d(o)}}}function wt(t,e,l){let s,i,o,c,u,g,m,{decks:r}=e,{moduleId:h}=e,d=[],v=[],k,a;function p(M){const q={module_id:h,question_ids:M};axios.post("/api/sessions/newfromquestionids",q).then(function(A){window.location.href="/sessions/"+A.data.id}).catch(function(A){alert(A)})}function D(M){ge[M?"unshift":"push"](()=>{a=M,l(0,a)})}const S=()=>p(m.slice(0,30)),j=()=>p(m.slice(0,60)),B=()=>p(m);return t.$$set=M=>{"decks"in M&&l(9,r=M.decks),"moduleId"in M&&l(10,h=M.moduleId)},t.$$.update=()=>{t.$$.dirty&2560&&(()=>{const M=r.map(A=>A.questions).flat();l(11,d=M.filter(A=>!A.is_invalid));const q=[];for(const A of r){const w=A.sessions.sort((H,Y)=>Y.id-H.id);if(w.length===0)continue;const R=w[0];q.push(...R.answer_choices)}l(12,v=q.filter(A=>d.some(({id:w})=>w===A.question_id)))})(),t.$$.dirty&2048&&l(6,s=d.length),t.$$.dirty&4096&&l(5,i=v.length),t.$$.dirty&96&&l(1,o=s-i),t.$$.dirty&4096&&l(4,c=v.filter(M=>M.is_correct&&!M.help_used).length),t.$$.dirty&4096&&l(3,u=v.filter(M=>M.is_correct&&M.help_used).length),t.$$.dirty&4096&&l(2,g=v.filter(M=>!M.is_correct).length),t.$$.dirty&4096&&l(7,m=v.filter(M=>!M.is_correct).map(M=>M.question_id)),t.$$.dirty&8223&&a&&(()=>{const M={type:"doughnut",data:{labels:["Correct","Correct with help","Incorrect","Unanswered"],datasets:[{label:"n",data:[c,u,g,o],backgroundColor:["#d4edda","#fff3cd","#f8d7da","#bbbbbb"],hoverOffet:4}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:null},plugins:{legend:{display:!1}}}};k&&k.destroy();var q=a.getContext("2d");l(13,k=new pt(q,M))})()},[a,o,g,u,c,i,s,m,p,r,h,d,v,k,D,S,j,B]}class Dt extends je{constructor(e){super(),Le(this,e,wt,vt,Ue,{decks:9,moduleId:10})}}function St(t){let e,l=Qe(Ge(t[0].created_at),"dd.MM.yyyy")+"",s;return{c(){e=_("span"),s=b(l),f(e,"class","badge text-bg-light")},m(i,o){L(i,e,o),n(e,s)},p(i,o){o&1&&l!==(l=Qe(Ge(i[0].created_at),"dd.MM.yyyy")+"")&&y(s,l)},d(i){i&&U(e)}}}function Mt(t){let e,l=Qe(Ge(t[0].exam_at),"dd.MM.yyyy")+"",s;return{c(){e=_("span"),s=b(l),f(e,"class","badge text-bg-light")},m(i,o){L(i,e,o),n(e,s)},p(i,o){o&1&&l!==(l=Qe(Ge(i[0].exam_at),"dd.MM.yyyy")+"")&&y(s,l)},d(i){i&&U(e)}}}function Ye(t){let e,l,s,i=t[0].sessions.length+"",o;return{c(){e=_("span"),l=_("i"),s=I(),o=b(i),f(l,"class","bi bi-rocket"),f(e,"class","badge text-bg-light font-monospace"),f(e,"title","Number of sessions")},m(c,u){L(c,e,u),n(e,l),n(e,s),n(e,o)},p(c,u){u&1&&i!==(i=c[0].sessions.length+"")&&y(o,i)},d(c){c&&U(e)}}}function Je(t){let e,l;return{c(){e=new dt(!1),l=Ae(),e.a=l},m(s,i){e.m(t[3],s,i),L(s,l,i)},p(s,i){i&8&&e.p(s[3])},d(s){s&&(U(l),e.d())}}}function It(t){let e,l,s,i,o,c,u,g=t[0].questions.length+"",m,r,h,d,v,k,a,p,D,S,j=t[0].name+"",B,M,q,A,w,R,H,Y,N;function O(C,W){return C[0].exam_at?Mt:St}let x=O(t),G=x(t),V=t[0].sessions&&Ye(t),Q=t[3]&&Je(t);return{c(){e=_("div"),l=_("div"),s=_("div"),G.c(),i=I(),o=_("span"),c=_("i"),u=I(),m=b(g),r=I(),V&&V.c(),h=I(),Q&&Q.c(),d=I(),v=_("input"),p=I(),D=_("div"),S=_("h6"),B=b(j),M=I(),q=_("button"),q.innerHTML='<i class="bi bi-rocket-takeoff"></i> Start session',A=I(),w=_("a"),R=b("Browse deck"),f(c,"class","bi bi-collection"),f(o,"class","badge text-bg-light font-monospace"),f(o,"title","Number of questions"),f(v,"type","checkbox"),f(v,"class","form-check-input float-end"),v.value="",f(v,"id",k="selected"+t[0].id),v.checked=a=t[2].has(t[0].id),f(s,"class","card-header"),f(S,"class","card-title"),f(q,"type","button"),f(q,"class","btn btn-sm btn-primary"),f(w,"href",H="/decks/"+t[0].id),f(w,"class","card-link"),f(D,"class","card-body"),f(l,"class","card"),f(e,"class","col-lg-6 mb-1")},m(C,W){L(C,e,W),n(e,l),n(l,s),G.m(s,null),n(s,i),n(s,o),n(o,c),n(o,u),n(o,m),n(s,r),V&&V.m(s,null),n(s,h),Q&&Q.m(s,null),n(s,d),n(s,v),n(l,p),n(l,D),n(D,S),n(S,B),n(D,M),n(D,q),n(D,A),n(D,w),n(w,R),Y||(N=[X(v,"click",t[4]),X(q,"click",ie(t[5]))],Y=!0)},p(C,[W]){x===(x=O(C))&&G?G.p(C,W):(G.d(1),G=x(C),G&&(G.c(),G.m(s,i))),W&1&&g!==(g=C[0].questions.length+"")&&y(m,g),C[0].sessions?V?V.p(C,W):(V=Ye(C),V.c(),V.m(s,h)):V&&(V.d(1),V=null),C[3]?Q?Q.p(C,W):(Q=Je(C),Q.c(),Q.m(s,d)):Q&&(Q.d(1),Q=null),W&1&&k!==(k="selected"+C[0].id)&&f(v,"id",k),W&5&&a!==(a=C[2].has(C[0].id))&&(v.checked=a),W&1&&j!==(j=C[0].name+"")&&y(B,j),W&1&&H!==(H="/decks/"+C[0].id)&&f(w,"href",H)},i:$,o:$,d(C){C&&U(e),G.d(),V&&V.d(),Q&&Q.d(),Y=!1,ot(N)}}}function Ct(t,e,l){let{deck:s}=e,{selectDeck:i}=e,{selectedDecks:o}=e,c;ct(()=>{const m=s.questions.filter(k=>!k.is_invalid),r=s.sessions.sort((k,a)=>a.id-k.id);if(r.length===0)return;const d=r[0].answer_choices.filter(k=>m.some(({id:a})=>a===k.question_id)),v=gt(m.length,d);v.correct>=60?l(3,c='<span style="color: #155724; background-color: #d4edda;" class="badge" title="Correct answers in percent">'+v.correct+" %</span>"):l(3,c='<span style="color: #721c24; background-color: #f8d7da;" class="badge" title="Correct answers in percent">'+v.correct+" %</span>")});const u=()=>i(s.id),g=()=>kt(s.id);return t.$$set=m=>{"deck"in m&&l(0,s=m.deck),"selectDeck"in m&&l(1,i=m.selectDeck),"selectedDecks"in m&&l(2,o=m.selectedDecks)},[s,i,o,c,u,g]}class yt extends je{constructor(e){super(),Le(this,e,Ct,It,Ue,{deck:0,selectDeck:1,selectedDecks:2})}}function Ke(t,e,l){const s=t.slice();return s[9]=e[l],s[10]=e,s[11]=l,s}function Xe(t){let e;return{c(){e=_("p"),e.textContent="Loading ..."},m(l,s){L(l,e,s)},p:$,d(l){l&&U(e)}}}function Ze(t,e){let l,s,i,o,c;function u(r){e[6](r,e[9],e[10],e[11])}function g(r){e[7](r)}let m={selectDeck:e[2]};return e[9]!==void 0&&(m.deck=e[9]),e[1]!==void 0&&(m.selectedDecks=e[1]),s=new yt({props:m}),ge.push(()=>Ie(s,"deck",u)),ge.push(()=>Ie(s,"selectedDecks",g)),{key:t,first:null,c(){l=Ae(),He(s.$$.fragment),this.first=l},m(r,h){L(r,l,h),Te(s,r,h),c=!0},p(r,h){e=r;const d={};h&4&&(d.selectDeck=e[2]),!i&&h&8&&(i=!0,d.deck=e[9],Ce(()=>i=!1)),!o&&h&2&&(o=!0,d.selectedDecks=e[1],Ce(()=>o=!1)),s.$set(d)},i(r){c||(me(s.$$.fragment,r),c=!0)},o(r){pe(s.$$.fragment,r),c=!1},d(r){r&&U(l),Re(s,r)}}}function qt(t){let e,l,s,i,o,c=[],u=new Map,g;function m(a){t[4](a)}function r(a){t[5](a)}let h={};t[3]!==void 0&&(h.decks=t[3]),t[0]!==void 0&&(h.moduleId=t[0]),e=new Dt({props:h}),ge.push(()=>Ie(e,"decks",m)),ge.push(()=>Ie(e,"moduleId",r));let d=ye(t[3]);const v=a=>a[9].id;for(let a=0;a<d.length;a+=1){let p=Ke(t,d,a),D=v(p);u.set(D,c[a]=Ze(D,p))}let k=null;return d.length||(k=Xe()),{c(){He(e.$$.fragment),i=I(),o=_("div");for(let a=0;a<c.length;a+=1)c[a].c();k&&k.c(),f(o,"class","row")},m(a,p){Te(e,a,p),L(a,i,p),L(a,o,p);for(let D=0;D<c.length;D+=1)c[D]&&c[D].m(o,null);k&&k.m(o,null),g=!0},p(a,[p]){const D={};!l&&p&8&&(l=!0,D.decks=a[3],Ce(()=>l=!1)),!s&&p&1&&(s=!0,D.moduleId=a[0],Ce(()=>s=!1)),e.$set(D),p&14&&(d=ye(a[3]),at(),c=_t(c,p,v,1,a,d,u,o,mt,Ze,null,Ke),ut(),!d.length&&k?k.p(a,p):d.length?k&&(k.d(1),k=null):(k=Xe(),k.c(),k.m(o,null)))},i(a){if(!g){me(e.$$.fragment,a);for(let p=0;p<d.length;p+=1)me(c[p]);g=!0}},o(a){pe(e.$$.fragment,a);for(let p=0;p<c.length;p+=1)pe(c[p]);g=!1},d(a){a&&(U(i),U(o)),Re(e,a);for(let p=0;p<c.length;p+=1)c[p].d();k&&k.d()}}}function jt(t,e,l){let{moduleId:s}=e,{selectDeck:i}=e,{selectedDecks:o}=e,c=[];function u(){if(!s){l(3,c=[]);return}axios.get("/api/decks?module="+s).then(function(d){l(3,c=d.data),c.sort(function(v,k){return v.exam_at===null?1:k.exam_at===null?-1:v.exam_at<k.exam_at?1:v.exam_at>k.exam_at?-1:0})}).catch(function(d){alert(d)})}function g(d){c=d,l(3,c)}function m(d){s=d,l(0,s)}function r(d,v,k,a){k[a]=d,l(3,c)}function h(d){o=d,l(1,o)}return t.$$set=d=>{"moduleId"in d&&l(0,s=d.moduleId),"selectDeck"in d&&l(2,i=d.selectDeck),"selectedDecks"in d&&l(1,o=d.selectedDecks)},t.$$.update=()=>{t.$$.dirty&1&&u()},[s,o,i,c,g,m,r,h]}class Lt extends je{constructor(e){super(),Le(this,e,jt,qt,Ue,{moduleId:0,selectDeck:2,selectedDecks:1})}}function $e(t){let e,l,s,i,o,c,u,g,m,r=t[1].length+"",h,d,v=t[1].length>1?"s":"",k,a,p,D=t[3].length+"",S,j,B=t[3].length>1?"s":"",M,q,A,w=t[2]?"excluded":"included",R,H,Y,N,O,x,G,V,Q,C,W,ee,ke,te,F,he,de=t[3].length+"",oe,be,fe=t[3].length>1?"s":"",ve,ce,we,Z,se,ae=t[5].length+"",De,_e,ue=t[5].length>1?"s":"",Se,qe,re,ne,Me,le,z=t[5].length>0&&xe(t);return{c(){e=_("div"),l=_("div"),s=_("div"),i=_("p"),i.textContent="Create your own super deck:",o=I(),c=_("p"),u=b("You have "),g=_("strong"),m=b("selected "),h=b(r),d=b(" deck"),k=b(v),a=b(`
                    with `),p=_("strong"),S=b(D),j=b(" question"),M=b(B),q=I(),z&&z.c(),A=b(`
                    (duplicates `),R=b(w),H=b(")"),Y=I(),N=_("div"),O=_("label"),O.textContent="Deck Name",x=I(),G=_("input"),V=I(),Q=_("div"),C=_("input"),W=I(),ee=_("label"),ee.textContent="Filter out duplicates",ke=I(),te=_("div"),F=_("button"),he=b("Create deck ("),oe=b(de),be=b(" question"),ve=b(fe),ce=b(")"),we=I(),Z=_("button"),se=b("Create deck ("),De=b(ae),_e=b(" image question"),Se=b(ue),qe=b(")"),re=I(),ne=_("button"),ne.textContent="Cancel",f(O,"for","name"),f(O,"class","form-label"),f(G,"type","text"),f(G,"class","form-control"),f(G,"id","name"),f(N,"class","mb-3"),f(C,"type","checkbox"),f(C,"class","form-check-input"),f(C,"id","checkboxRemoveDuplicates"),f(ee,"class","form-check-label"),f(ee,"for","checkboxRemoveDuplicates"),f(Q,"class","mb-3 form-check"),f(F,"class","btn btn-sm btn-primary"),f(Z,"class","btn btn-sm btn-primary"),f(ne,"class","btn btn-sm btn-link"),f(te,"class","d-grid gap-2 d-md-block"),f(s,"class","alert alert-light"),f(s,"role","alert"),f(l,"class","col-md"),f(e,"class","row")},m(E,P){L(E,e,P),n(e,l),n(l,s),n(s,i),n(s,o),n(s,c),n(c,u),n(c,g),n(g,m),n(g,h),n(g,d),n(g,k),n(c,a),n(c,p),n(p,S),n(p,j),n(p,M),n(c,q),z&&z.m(c,null),n(c,A),n(c,R),n(c,H),n(s,Y),n(s,N),n(N,O),n(N,x),n(N,G),Pe(G,t[4]),n(s,V),n(s,Q),n(Q,C),C.checked=t[2],n(Q,W),n(Q,ee),n(s,ke),n(s,te),n(te,F),n(F,he),n(F,oe),n(F,be),n(F,ve),n(F,ce),n(te,we),n(te,Z),n(Z,se),n(Z,De),n(Z,_e),n(Z,Se),n(Z,qe),n(te,re),n(te,ne),Me||(le=[X(G,"input",t[6]),X(G,"focus",At),X(C,"change",t[7]),X(F,"click",ie(t[8])),X(Z,"click",ie(t[9])),X(ne,"click",ie(t[10]))],Me=!0)},p(E,P){P&2&&r!==(r=E[1].length+"")&&y(h,r),P&2&&v!==(v=E[1].length>1?"s":"")&&y(k,v),P&8&&D!==(D=E[3].length+"")&&y(S,D),P&8&&B!==(B=E[3].length>1?"s":"")&&y(M,B),E[5].length>0?z?z.p(E,P):(z=xe(E),z.c(),z.m(c,A)):z&&(z.d(1),z=null),P&4&&w!==(w=E[2]?"excluded":"included")&&y(R,w),P&16&&G.value!==E[4]&&Pe(G,E[4]),P&4&&(C.checked=E[2]),P&8&&de!==(de=E[3].length+"")&&y(oe,de),P&8&&fe!==(fe=E[3].length>1?"s":"")&&y(ve,fe),P&32&&ae!==(ae=E[5].length+"")&&y(De,ae),P&32&&ue!==(ue=E[5].length>1?"s":"")&&y(Se,ue)},d(E){E&&U(e),z&&z.d(),Me=!1,ot(le)}}}function xe(t){let e,l,s=t[5].length+"",i,o,c=t[5].length>1?"s":"",u,g;return{c(){e=b("/ "),l=_("strong"),i=b(s),o=b(" question"),u=b(c),g=b(" with images")},m(m,r){L(m,e,r),L(m,l,r),n(l,i),n(l,o),n(l,u),n(l,g)},p(m,r){r&32&&s!==(s=m[5].length+"")&&y(i,s),r&32&&c!==(c=m[5].length>1?"s":"")&&y(u,c)},d(m){m&&(U(e),U(l))}}}function Ut(t){let e,l=t[1].length>0&&$e(t);return{c(){l&&l.c(),e=Ae()},m(s,i){l&&l.m(s,i),L(s,e,i)},p(s,[i]){s[1].length>0?l?l.p(s,i):(l=$e(s),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:$,o:$,d(s){s&&U(e),l&&l.d(s)}}}function et(t,e){var l={name:t,question_ids:e};axios.post("/api/decks",l).then(function(s){window.location.href="/decks/"+s.data.id}).catch(function(s){alert(s)})}const At=t=>t.target.select();function Nt(t,e,l){let s,i,{selectedDecks:o}=e,c=[],u="My new super deck",g=!0;function m(){if(o.size===0){l(1,c=[]);return}const a=[...o].map(p=>"decks[]="+p);axios.get("/api/decks?"+a.join("&")).then(function(p){l(1,c=p.data)}).catch(function(p){alert(p)})}function r(){u=this.value,l(4,u)}function h(){g=this.checked,l(2,g)}const d=()=>et(u,s.map(a=>a.id)),v=()=>et(u,i.map(a=>a.id)),k=()=>l(0,o=new Set);return t.$$set=a=>{"selectedDecks"in a&&l(0,o=a.selectedDecks)},t.$$.update=()=>{t.$$.dirty&1&&m(),t.$$.dirty&6&&l(3,s=(()=>{var a=[];return c.forEach(p=>a.push(...p.questions)),g?[...new Map(a.map(p=>[p.id,p])).values()]:a})()),t.$$.dirty&6&&l(5,i=(()=>{var a=[];return c.forEach(p=>{p.questions.forEach(D=>{D.images.length>0&&a.push(D)})}),g?[...new Map(a.map(p=>[p.id,p])).values()]:a})())},[o,c,g,s,u,i,r,h,d,v,k]}class Qt extends je{constructor(e){super(),Le(this,e,Nt,Ut,Ue,{selectedDecks:0})}}function tt(t,e,l){const s=t.slice();return s[12]=e[l],s}function st(t,e,l){const s=t.slice();return s[15]=e[l],s}function lt(t){let e,l,s=ye(t[2]),i=[];for(let o=0;o<s.length;o+=1)i[o]=nt(st(t,s,o));return{c(){e=_("ul");for(let o=0;o<i.length;o+=1)i[o].c();l=I(),f(e,"class","list-group m-2 me-0")},m(o,c){L(o,e,c);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);n(e,l)},p(o,c){if(c&37){s=ye(o[2]);let u;for(u=0;u<s.length;u+=1){const g=st(o,s,u);i[u]?i[u].p(g,c):(i[u]=nt(g),i[u].c(),i[u].m(e,l))}for(;u<i.length;u+=1)i[u].d(1);i.length=s.length}},d(o){o&&U(e),rt(i,o)}}}function nt(t){let e,l=t[15].name+"",s,i,o,c;function u(){return t[9](t[15])}return{c(){e=_("button"),s=b(l),f(e,"data-bs-target","#offcanvasModuleSelection"),f(e,"data-bs-dismiss","offcanvas"),f(e,"class",i="list-group-item list-group-item-action "+(t[0].last_module_id===t[15].id?"list-group-item-secondary":"list-group-item-light"))},m(g,m){L(g,e,m),n(e,s),o||(c=X(e,"click",ie(u)),o=!0)},p(g,m){t=g,m&4&&l!==(l=t[15].name+"")&&y(s,l),m&5&&i!==(i="list-group-item list-group-item-action "+(t[0].last_module_id===t[15].id?"list-group-item-secondary":"list-group-item-light"))&&f(e,"class",i)},d(g){g&&U(e),o=!1,c()}}}function it(t){let e,l=t[12].name+"",s,i,o,c,u,g;function m(){return t[8](t[12])}let r=t[0].last_subject_id===t[12].id&&lt(t);return{c(){e=_("button"),s=b(l),o=I(),r&&r.c(),c=Ae(),f(e,"class",i="list-group-item list-group-item-action "+(t[0].last_subject_id===t[12].id?"list-group-item-dark":"list-group-item-light"))},m(h,d){L(h,e,d),n(e,s),L(h,o,d),r&&r.m(h,d),L(h,c,d),u||(g=X(e,"click",ie(m)),u=!0)},p(h,d){t=h,d&2&&l!==(l=t[12].name+"")&&y(s,l),d&3&&i!==(i="list-group-item list-group-item-action "+(t[0].last_subject_id===t[12].id?"list-group-item-dark":"list-group-item-light"))&&f(e,"class",i),t[0].last_subject_id===t[12].id?r?r.p(t,d):(r=lt(t),r.c(),r.m(c.parentNode,c)):r&&(r.d(1),r=null)},d(h){h&&(U(e),U(o),U(c)),r&&r.d(h),u=!1,g()}}}function Gt(t){let e;return{c(){e=_("p"),e.textContent="No module selected."},m(l,s){L(l,e,s)},p:$,i:$,o:$,d(l){l&&U(e)}}}function Ht(t){let e,l,s;function i(c){t[11](c)}let o={moduleId:t[0].last_module_id,selectDeck:t[6]};return t[3]!==void 0&&(o.selectedDecks=t[3]),e=new Lt({props:o}),ge.push(()=>Ie(e,"selectedDecks",i)),{c(){He(e.$$.fragment)},m(c,u){Te(e,c,u),s=!0},p(c,u){const g={};u&1&&(g.moduleId=c[0].last_module_id),!l&&u&8&&(l=!0,g.selectedDecks=c[3],Ce(()=>l=!1)),e.$set(g)},i(c){s||(me(e.$$.fragment,c),s=!0)},o(c){pe(e.$$.fragment,c),s=!1},d(c){Re(e,c)}}}function Tt(t){let e,l,s,i,o,c,u,g,m,r,h,d,v,k,a,p,D=ye(t[1]),S=[];for(let w=0;w<D.length;w+=1)S[w]=it(tt(t,D,w));function j(w){t[10](w)}let B={};t[3]!==void 0&&(B.selectedDecks=t[3]),h=new Qt({props:B}),ge.push(()=>Ie(h,"selectedDecks",j));const M=[Ht,Gt],q=[];function A(w,R){return w[0].last_module_id?0:1}return k=A(t),a=q[k]=M[k](t),{c(){e=_("div"),e.innerHTML='<div class="col-12 d-grid mb-3"><button type="button" class="btn btn-sm btn-primary d-lg-none my-2" data-bs-toggle="offcanvas" data-bs-target="#offcanvasModuleSelection" aria-controls="offcanvasModuleSelection">Switch module</button></div>',l=I(),s=_("div"),i=_("div"),o=_("div"),o.innerHTML='<h5 id="offcanvasAddToDeckLabel">Choose subject and module</h5> <button type="button" class="btn-close text-reset" data-bs-target="#offcanvasModuleSelection" data-bs-dismiss="offcanvas" aria-label="Close"></button>',c=I(),u=_("div"),g=_("ul");for(let w=0;w<S.length;w+=1)S[w].c();m=I(),r=_("div"),He(h.$$.fragment),v=I(),a.c(),f(e,"class","row"),f(o,"class","offcanvas-header"),f(g,"class","list-group w-100"),f(u,"class","offcanvas-body"),f(i,"class","col-lg-4 offcanvas-lg offcanvas-start"),f(i,"tabindex","-1"),f(i,"id","offcanvasModuleSelection"),f(r,"class","col-12 col-lg-8"),f(s,"class","row")},m(w,R){L(w,e,R),L(w,l,R),L(w,s,R),n(s,i),n(i,o),n(i,c),n(i,u),n(u,g);for(let H=0;H<S.length;H+=1)S[H]&&S[H].m(g,null);n(s,m),n(s,r),Te(h,r,null),n(r,v),q[k].m(r,null),p=!0},p(w,[R]){if(R&55){D=ye(w[1]);let N;for(N=0;N<D.length;N+=1){const O=tt(w,D,N);S[N]?S[N].p(O,R):(S[N]=it(O),S[N].c(),S[N].m(g,null))}for(;N<S.length;N+=1)S[N].d(1);S.length=D.length}const H={};!d&&R&8&&(d=!0,H.selectedDecks=w[3],Ce(()=>d=!1)),h.$set(H);let Y=k;k=A(w),k===Y?q[k].p(w,R):(at(),pe(q[Y],1,1,()=>{q[Y]=null}),ut(),a=q[k],a?a.p(w,R):(a=q[k]=M[k](w),a.c()),me(a,1),a.m(r,null))},i(w){p||(me(h.$$.fragment,w),me(a),p=!0)},o(w){pe(h.$$.fragment,w),pe(a),p=!1},d(w){w&&(U(e),U(l),U(s)),rt(S,w),Re(h),q[k].d()}}}function Rt(t,e,l){let s;ft(t,Ne,a=>l(0,s=a));let i=[],o=[],c=[],u=new Set;ct(()=>{axios.get("/api/modules").then(function(a){var p=a.data;l(7,i=p.filter((S,j,B)=>j===B.findIndex(M=>M.id===S.id)).sort(function(S,j){return S.name>j.name?1:S.name<j.name?-1:0}));var D=i.map(S=>S.subject).filter(S=>!!S);l(1,o=D.filter((S,j,B)=>j===B.findIndex(M=>M.id===S.id)).sort(function(S,j){return S.name>j.name?1:S.name<j.name?-1:0}))}).catch(function(a){alert(a)})});function g(a){var p={last_subject_id:a,last_module_id:0};axios.put("/api/users/me/settings",p).then(function(D){Ee(Ne,s.last_subject_id=a,s),Ee(Ne,s.last_module_id=0,s)}).catch(function(D){alert(D)})}function m(a){var p={last_module_id:a};axios.put("/api/users/me/settings",p).then(function(D){Ee(Ne,s.last_module_id=a,s)}).catch(function(D){alert(D)})}function r(a){u.has(a)?u.delete(a):u.add(a),l(3,u=new Set([...u]))}const h=a=>g(a.id),d=a=>m(a.id);function v(a){u=a,l(3,u)}function k(a){u=a,l(3,u)}return t.$$.update=()=>{t.$$.dirty&129&&(s.last_subject_id,l(2,c=i.filter(a=>s.last_subject_id?a.subject?a.subject.id===s.last_subject_id:!1:!0)))},[s,o,c,u,g,m,r,i,h,d,v,k]}class Vt extends je{constructor(e){super(),Le(this,e,Rt,Tt,Ue,{})}}const Et=document.getElementById("NewSessionView");new Vt({target:Et});
