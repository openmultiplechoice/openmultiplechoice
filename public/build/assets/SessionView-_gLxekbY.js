import{S as de,i as _e,s as ge,n as E,d as Q,a as P,e as ve,D as Pe,m as Xe,o as v,f as C,g as k,E as I,M as ye,c as q,l as ie,q as we,b as V,t as $,p as ce,k as O,H as on,w as H,x as M,z as ne,A as se,K as rn,r as W,u as te,v as un,y as K,B as oe,C as re,N as ln,L as Me}from"./index-C5hKwDc9.js";import{p as Fe,d as fn}from"./purify.es-CzHI0FGf.js";import{e as Ce}from"./each-JoEH9o9l.js";import{M as an}from"./Messages-Dp-WrbKj.js";import{C as cn}from"./auto-C0VlNTRY.js";import{S as dn}from"./SessionProgressBar-D35tF687.js";import{h as Qe,S as _n}from"./SessionQuestionView-DioQisgK.js";import{s as gn}from"./StatsHelper-B91isISU.js";import{U as qe}from"./UserSettingsStore-DIGhToub.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./parseISO-nqt9u7wd.js";import"./lodash-DBMh2b1a.js";import"./QuestionForm-LRPWcbwj.js";function Ge(s,n,e){const i=s.slice();return i[19]=n[e],i}function Te(s){let n,e=Ce({length:s[6]}),i=[];for(let t=0;t<e.length;t+=1)i[t]=ze(Ge(s,e,t));return{c(){n=C("div");for(let t=0;t<i.length;t+=1)i[t].c();k(n,"class","confetti-holder svelte-15ksp55"),v(n,"rounded",s[9]),v(n,"cone",s[10]),v(n,"no-gravity",s[11]),v(n,"reduced-motion",s[13])},m(t,r){P(t,n,r);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(n,null)},p(t,r){if(r&37375){e=Ce({length:t[6]});let o;for(o=0;o<e.length;o+=1){const d=Ge(t,e,o);i[o]?i[o].p(d,r):(i[o]=ze(d),i[o].c(),i[o].m(n,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=e.length}r&512&&v(n,"rounded",t[9]),r&1024&&v(n,"cone",t[10]),r&2048&&v(n,"no-gravity",t[11]),r&8192&&v(n,"reduced-motion",t[13])},d(t){t&&Q(n),Xe(i,t)}}}function ze(s){let n;return{c(){n=C("div"),k(n,"class","confetti svelte-15ksp55"),I(n,"--fall-distance",s[8]),I(n,"--size",s[0]+"px"),I(n,"--color",s[15]()),I(n,"--skew",X(-45,45)+"deg,"+X(-45,45)+"deg"),I(n,"--rotation-xyz",X(-10,10)+", "+X(-10,10)+", "+X(-10,10)),I(n,"--rotation-deg",X(0,360)+"deg"),I(n,"--translate-y-multiplier",X(s[2][0],s[2][1])),I(n,"--translate-x-multiplier",X(s[1][0],s[1][1])),I(n,"--scale",.1*X(2,10)),I(n,"--transition-duration",s[4]?`calc(${s[3]}ms * var(--scale))`:`${s[3]}ms`),I(n,"--transition-delay",X(s[5][0],s[5][1])+"ms"),I(n,"--transition-iteration-count",s[4]?"infinite":s[7]),I(n,"--x-spread",1-s[12])},m(e,i){P(e,n,i)},p(e,i){i&256&&I(n,"--fall-distance",e[8]),i&1&&I(n,"--size",e[0]+"px"),i&4&&I(n,"--translate-y-multiplier",X(e[2][0],e[2][1])),i&2&&I(n,"--translate-x-multiplier",X(e[1][0],e[1][1])),i&24&&I(n,"--transition-duration",e[4]?`calc(${e[3]}ms * var(--scale))`:`${e[3]}ms`),i&32&&I(n,"--transition-delay",X(e[5][0],e[5][1])+"ms"),i&144&&I(n,"--transition-iteration-count",e[4]?"infinite":e[7]),i&4096&&I(n,"--x-spread",1-e[12])},d(e){e&&Q(n)}}}function mn(s){let n,e=!s[14]&&Te(s);return{c(){e&&e.c(),n=ve()},m(i,t){e&&e.m(i,t),P(i,n,t)},p(i,[t]){i[14]?e&&(e.d(1),e=null):e?e.p(i,t):(e=Te(i),e.c(),e.m(n.parentNode,n))},i:E,o:E,d(i){i&&Q(n),e&&e.d(i)}}}function X(s,n){return Math.random()*(n-s)+s}function hn(s,n,e){let{size:i=10}=n,{x:t=[-.5,.5]}=n,{y:r=[.25,1]}=n,{duration:o=2e3}=n,{infinite:d=!1}=n,{delay:u=[0,50]}=n,{colorRange:f=[0,360]}=n,{colorArray:a=[]}=n,{amount:b=50}=n,{iterationCount:p=1}=n,{fallDistance:m="100px"}=n,{rounded:G=!1}=n,{cone:A=!1}=n,{noGravity:T=!1}=n,{xSpread:z=.15}=n,{destroyOnComplete:y=!0}=n,{disableForReducedMotion:F=!1}=n,h=!1;Pe(()=>{!y||d||p=="infinite"||setTimeout(()=>e(14,h=!0),(o+u[1])*p)});function w(){return a.length?a[Math.round(Math.random()*(a.length-1))]:`hsl(${Math.round(X(f[0],f[1]))}, 75%, 50%)`}return s.$$set=c=>{"size"in c&&e(0,i=c.size),"x"in c&&e(1,t=c.x),"y"in c&&e(2,r=c.y),"duration"in c&&e(3,o=c.duration),"infinite"in c&&e(4,d=c.infinite),"delay"in c&&e(5,u=c.delay),"colorRange"in c&&e(16,f=c.colorRange),"colorArray"in c&&e(17,a=c.colorArray),"amount"in c&&e(6,b=c.amount),"iterationCount"in c&&e(7,p=c.iterationCount),"fallDistance"in c&&e(8,m=c.fallDistance),"rounded"in c&&e(9,G=c.rounded),"cone"in c&&e(10,A=c.cone),"noGravity"in c&&e(11,T=c.noGravity),"xSpread"in c&&e(12,z=c.xSpread),"destroyOnComplete"in c&&e(18,y=c.destroyOnComplete),"disableForReducedMotion"in c&&e(13,F=c.disableForReducedMotion)},[i,t,r,o,d,u,b,p,m,G,A,T,z,F,h,w,f,a,y]}class bn extends de{constructor(n){super(),_e(this,n,hn,mn,ge,{size:0,x:1,y:2,duration:3,infinite:4,delay:5,colorRange:16,colorArray:17,amount:6,iterationCount:7,fallDistance:8,rounded:9,cone:10,noGravity:11,xSpread:12,destroyOnComplete:18,disableForReducedMotion:13})}}function He(s){let n,e,i,t,r;return{c(){n=C("div"),e=C("img"),k(e,"class","img-fluid"),ye(e.src,i="/"+s[0])||k(e,"src",i),k(e,"alt","Magic GIF"),k(n,"class","img-fullscreen d-flex justify-content-center align-items-center svelte-k1osqd")},m(o,d){P(o,n,d),q(n,e),t||(r=ie(n,"click",s[2]),t=!0)},p(o,d){d&1&&!ye(e.src,i="/"+o[0])&&k(e,"src",i)},d(o){o&&Q(n),t=!1,r()}}}function pn(s){let n,e=s[0]&&s[1]&&He(s);return{c(){e&&e.c(),n=ve()},m(i,t){e&&e.m(i,t),P(i,n,t)},p(i,[t]){i[0]&&i[1]?e?e.p(i,t):(e=He(i),e.c(),e.m(n.parentNode,n)):e&&(e.d(1),e=null)},i:E,o:E,d(i){i&&Q(n),e&&e.d(i)}}}function wn(s,n,e){let{magicGIFPath:i=""}=n;var t=!0;function r(){e(1,t=!t)}return s.$$set=o=>{"magicGIFPath"in o&&e(0,i=o.magicGIFPath)},[i,t,r]}class kn extends de{constructor(n){super(),_e(this,n,wn,pn,ge,{magicGIFPath:0})}}function Le(s){let n,e,i;return{c(){n=C("button"),n.innerHTML='<i class="bi bi-repeat"></i> Repeat incorrect',k(n,"class","btn btn-sm btn-outline-secondary"),k(n,"type","button")},m(t,r){P(t,n,r),e||(i=ie(n,"click",ce(s[5])),e=!0)},p:E,d(t){t&&Q(n),e=!1,i()}}}function qn(s){let n,e,i,t,r,o,d,u=s[0].correct+"",f,a,b,p,m,G,A,T,z,y=s[0].incorrect>0&&Le(s);return{c(){n=C("div"),e=C("div"),i=C("canvas"),t=V(),r=C("div"),o=C("p"),d=C("span"),f=$(u),a=$("%"),b=$(" correct"),p=V(),m=C("div"),G=C("a"),G.innerHTML='<i class="bi bi-rocket-takeoff"></i> New session',A=V(),y&&y.c(),T=V(),z=C("a"),z.textContent="Home",k(e,"class","col-md"),k(d,"class","fs-4 font-monospace"),k(o,"class","mt-3 text-dark"),k(G,"href","/sessions/create"),k(G,"class","btn btn-sm btn-primary"),k(z,"href","/"),k(z,"class","btn btn-sm btn-outline-secondary"),k(m,"class","d-grid gap-2"),k(r,"class","col-md"),k(n,"class","row mb-5")},m(F,h){P(F,n,h),q(n,e),q(e,i),s[4](i),q(n,t),q(n,r),q(r,o),q(o,d),q(d,f),q(d,a),q(o,b),q(r,p),q(r,m),q(m,G),q(m,A),y&&y.m(m,null),q(m,T),q(m,z)},p(F,[h]){h&1&&u!==(u=F[0].correct+"")&&we(f,u),F[0].incorrect>0?y?y.p(F,h):(y=Le(F),y.c(),y.m(m,T)):y&&(y.d(1),y=null)},i:E,o:E,d(F){F&&Q(n),s[4](null),y&&y.d()}}}function Cn(s){axios.post("/api/sessions/"+s+"/newfromincorrect").then(function(n){window.location.href="/sessions/"+n.data.id}).catch(function(n){alert(n)})}function vn(s,n,e){let{progressPercentage:i}=n,{sessionId:t}=n,r,o;function d(f){O[f?"unshift":"push"](()=>{r=f,e(2,r)})}const u=()=>Cn(t);return s.$$set=f=>{"progressPercentage"in f&&e(0,i=f.progressPercentage),"sessionId"in f&&e(1,t=f.sessionId)},s.$$.update=()=>{s.$$.dirty&13&&r&&(()=>{if(o)return;const f={type:"doughnut",data:{labels:["Correct","Correct with help","Incorrect"],datasets:[{label:"%",data:[i.correct,i.correctWithHelp,i.incorrect],backgroundColor:["#d4edda","#fff3cd","#f8d7da"],hoverOffet:4}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:null},plugins:{legend:{display:!1}}}};o&&o.destroy();var a=r.getContext("2d");e(3,o=new cn(a,f))})()},[i,t,r,o,d,u]}class Sn extends de{constructor(n){super(),_e(this,n,vn,qn,ge,{progressPercentage:0,sessionId:1})}}function Ne(s,n,e){const i=s.slice();return i[5]=n[e],i[7]=e,i}function Re(s){let n;return{c(){n=C("li"),n.textContent="Loading ...",k(n,"class","svelte-za7w49")},m(e,i){P(e,n,i)},p:E,d(e){e&&Q(n)}}}function An(s){let n,e=s[7]+1+"",i;return{c(){n=$("Question Nr. "),i=$(e)},m(t,r){P(t,n,r),P(t,i,r)},p:E,d(t){t&&(Q(n),Q(i))}}}function In(s){let n=Fe.sanitize(s[5].text).replace(/<\/?[^>]+(>|$)/g,"")+"",e;return{c(){e=$(n)},m(i,t){P(i,e,t)},p(i,t){t&1&&n!==(n=Fe.sanitize(i[5].text).replace(/<\/?[^>]+(>|$)/g,"")+"")&&we(e,n)},d(i){i&&Q(e)}}}function Ue(s){let n,e,i,t=s[1](s[5])+"",r,o,d,u,f,a;function b(A,T){return A[5].text?In:An}let p=b(s),m=p(s);function G(){return s[4](s[5])}return{c(){n=C("li"),e=C("small"),i=new on(!1),r=V(),m.c(),o=V(),i.a=r,k(n,"class",d="list-group-item list-group-item-action text-overflow "+(s[5].id===s[0].session.current_question_id?"list-group-item-dark":"list-group-item-light")+" svelte-za7w49"),k(n,"id",u="question"+s[5].id)},m(A,T){P(A,n,T),q(n,e),i.m(t,e),q(e,r),m.m(e,null),q(n,o),f||(a=ie(n,"click",G),f=!0)},p(A,T){s=A,T&3&&t!==(t=s[1](s[5])+"")&&i.p(t),p===(p=b(s))&&m?m.p(s,T):(m.d(1),m=p(s),m&&(m.c(),m.m(e,null))),T&1&&d!==(d="list-group-item list-group-item-action text-overflow "+(s[5].id===s[0].session.current_question_id?"list-group-item-dark":"list-group-item-light")+" svelte-za7w49")&&k(n,"class",d),T&1&&u!==(u="question"+s[5].id)&&k(n,"id",u)},d(A){A&&Q(n),m.d(),f=!1,a()}}}function Mn(s){let n,e,i=Ce(s[0].deck.questions),t=[];for(let o=0;o<i.length;o+=1)t[o]=Ue(Ne(s,i,o));let r=null;return i.length||(r=Re()),{c(){n=C("div"),e=C("ul");for(let o=0;o<t.length;o+=1)t[o].c();r&&r.c(),k(e,"class","list-group"),k(n,"class","overflow-scroll"),I(n,"max-height","85vh")},m(o,d){P(o,n,d),q(n,e);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);r&&r.m(e,null)},p(o,[d]){if(d&3){i=Ce(o[0].deck.questions);let u;for(u=0;u<i.length;u+=1){const f=Ne(o,i,u);t[u]?t[u].p(f,d):(t[u]=Ue(f),t[u].c(),t[u].m(e,null))}for(;u<t.length;u+=1)t[u].d(1);t.length=i.length,!i.length&&r?r.p(o,d):i.length?r&&(r.d(1),r=null):(r=Re(),r.c(),r.m(e,null))}},i:E,o:E,d(o){o&&Q(n),Xe(t,o),r&&r.d()}}}function Qn(s,n,e){let i,t,{data:r}=n,{examMode:o}=n;const d=u=>e(0,r.session.current_question_id=u.id,r);return s.$$set=u=>{"data"in u&&e(0,r=u.data),"examMode"in u&&e(2,o=u.examMode)},s.$$.update=()=>{s.$$.dirty&1&&e(3,i=r.session.current_question_id),s.$$.dirty&8&&(()=>{var u=document.getElementById("question"+i);u&&u.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})})(),s.$$.dirty&5&&e(1,t=function(u){var f=r.session.answer_choices.find(a=>a.question_id===u.id);return f?o?'<span class="text-dark fw-bold">&check;</span>':f.is_correct?f.help_used?'<span class="text-warning-dark fw-bold">&check;</span>':'<span class="text-success-dark fw-bold">&check;</span>':'<span class="text-danger-dark fw-bold">&cross;</span>':'<span class="text-dark fw-bold">&rightarrow;</span>'})},[r,t,o,i,d]}class Pn extends de{constructor(n){super(),_e(this,n,Qn,Mn,ge,{data:0,examMode:2})}}function yn(s){let n;return{c(){n=C("div"),n.innerHTML="",k(n,"class","col-6")},m(e,i){P(e,n,i)},p:E,d(e){e&&Q(n)}}}function Fn(s){let n,e,i,t;return{c(){n=C("div"),e=C("button"),e.innerHTML='<span class="fw-bold">←</span> Previous',k(e,"class","btn btn-sm btn-light w-100"),k(n,"class","col-6")},m(r,o){P(r,n,o),q(n,e),i||(t=ie(e,"click",ce(s[2])),i=!0)},p:E,d(r){r&&Q(n),i=!1,t()}}}function Gn(s){let n;return{c(){n=C("div"),n.innerHTML="",k(n,"class","col-6")},m(e,i){P(e,n,i)},p:E,d(e){e&&Q(n)}}}function Tn(s){let n,e,i,t;return{c(){n=C("div"),e=C("button"),e.innerHTML='Next <span class="fw-bold">→</span>',k(e,"class","btn btn-sm w-100"),v(e,"btn-warning",s[1].isAnswered),v(e,"btn-light",!s[1].isAnswered),k(n,"class","col-6")},m(r,o){P(r,n,o),q(n,e),i||(t=ie(e,"click",ce(s[3])),i=!0)},p(r,o){o&2&&v(e,"btn-warning",r[1].isAnswered),o&2&&v(e,"btn-light",!r[1].isAnswered)},d(r){r&&Q(n),i=!1,t()}}}function zn(s){let n,e;function i(f,a){return f[0].session.current_question_id&&f[0].session.current_question_id!=f[0].deck.questions[0].id?Fn:yn}let t=i(s),r=t(s);function o(f,a){return f[0].session.current_question_id!=f[0].deck.questions[f[0].deck.questions.length-1].id?Tn:Gn}let d=o(s),u=d(s);return{c(){n=C("div"),r.c(),e=V(),u.c(),k(n,"class","row mb-3 pt-1 pb-1 sticky-top bg-white")},m(f,a){P(f,n,a),r.m(n,null),q(n,e),u.m(n,null)},p(f,[a]){t===(t=i(f))&&r?r.p(f,a):(r.d(1),r=t(f),r&&(r.c(),r.m(n,e))),d===(d=o(f))&&u?u.p(f,a):(u.d(1),u=d(f),u&&(u.c(),u.m(n,null)))},i:E,o:E,d(f){f&&Q(n),r.d(),u.d()}}}function Hn(s,n,e){let{data:i}=n,{currentQuestionId:t}=n,{currentQuestionContext:r}=n;Pe(()=>{Qe("left","questions",function(f,a){d()}),Qe("right","questions",function(f,a){u()}),Qe.setScope("questions")});function o(f){return i.deck.questions.findIndex(a=>a.id===f)}function d(){var f=o(t),a=i.deck.questions[f-1];a&&e(0,i.session.current_question_id=a.id,i)}function u(){var f=o(t),a=i.deck.questions[f+1];a&&e(0,i.session.current_question_id=a.id,i)}return s.$$set=f=>{"data"in f&&e(0,i=f.data),"currentQuestionId"in f&&e(4,t=f.currentQuestionId),"currentQuestionContext"in f&&e(1,r=f.currentQuestionContext)},[i,r,d,u,t]}class Ln extends de{constructor(n){super(),_e(this,n,Hn,zn,ge,{data:0,currentQuestionId:4,currentQuestionContext:1})}}function Nn(s){let n;return{c(){n=C("p"),n.textContent="Loading ..."},m(e,i){P(e,n,i)},p:E,i:E,o:E,d(e){e&&Q(n)}}}function Rn(s){let n,e,i,t,r,o,d,u,f,a,b,p,m,G,A,T,z=s[0].deck.name+"",y,F,h,w,c,_,ee,Y,le,J,Z,j,me,he,ue,L,be,ke,R=!s[13]&&s[16]&&(!s[4]||!s[9].isAnswered)&&De(s),U=s[4]&&s[9].isAnswered&&Be(s),D=s[7]&&Ve(s);function Se(g){s[33](g)}function Ae(g){s[34](g)}function Ie(g){s[35](g)}let fe={};s[0]!==void 0&&(fe.data=s[0]),s[0].session.current_question_id!==void 0&&(fe.currentQuestionId=s[0].session.current_question_id),s[9]!==void 0&&(fe.currentQuestionContext=s[9]),Z=new Ln({props:fe}),O.push(()=>W(Z,"data",Se)),O.push(()=>W(Z,"currentQuestionId",Ae)),O.push(()=>W(Z,"currentQuestionContext",Ie));let B=s[14]&&Ee(s);return{c(){n=C("div"),e=C("div"),i=C("p"),t=C("button"),t.innerHTML='<i class="bi bi-layout-sidebar"></i>',r=V(),o=C("button"),o.innerHTML='<i class="bi bi-shuffle"></i>',d=V(),u=C("button"),u.innerHTML='<i class="bi bi-exclamation-square"></i>',f=V(),a=C("span"),b=$(s[15]),p=$("/"),m=$(s[2]),G=V(),A=C("a"),T=C("strong"),y=$(z),h=V(),w=C("div"),c=C("div"),R&&R.c(),_=V(),U&&U.c(),ee=V(),Y=C("div"),D&&D.c(),le=V(),J=C("div"),re(Z.$$.fragment),ue=V(),B&&B.c(),k(t,"class","btn btn-sm d-none d-sm-none d-md-none d-lg-inline"),k(t,"title","Toggle sidebar"),v(t,"bg-light",!s[7]),v(t,"bg-dark-subtle",s[7]),k(o,"class","btn btn-sm"),k(o,"title","Toggle answer shuffling"),v(o,"bg-light",!s[5]),v(o,"bg-dark-subtle",s[5]),k(u,"class","btn btn-sm"),k(u,"title","Toggle exam mode"),v(u,"bg-light",!s[6]),v(u,"bg-dark-subtle",s[6]),k(a,"class","ms-1 float-end fw-bold font-monospace badge text-dark"),v(a,"text-bg-light",!s[1]||s[13]),v(a,"bg-success",!s[13]&&!s[14].is_invalid&&s[1]&&s[1].is_correct),v(a,"bg-danger",!s[13]&&!s[14].is_invalid&&s[1]&&!s[1].is_correct),k(A,"href",F="/decks/"+s[0].deck.id),k(A,"class","text-reset text-decoration-none"),k(i,"class","text-overflow svelte-1gfmo48"),k(e,"class","col mb-1"),k(n,"class","row"),k(c,"class","col mb-1"),k(w,"class","row"),k(J,"class","col-md-12"),v(J,"col-lg-9",s[7]),v(J,"col-lg-10",!s[7]),v(J,"offset-lg-1",!s[7]),k(Y,"class","row mt-3")},m(g,S){P(g,n,S),q(n,e),q(e,i),q(i,t),q(i,r),q(i,o),q(i,d),q(i,u),q(i,f),q(i,a),q(a,b),q(a,p),q(a,m),q(i,G),q(i,A),q(A,T),q(T,y),P(g,h,S),P(g,w,S),q(w,c),R&&R.m(c,null),q(c,_),U&&U.m(c,null),P(g,ee,S),P(g,Y,S),D&&D.m(Y,null),q(Y,le),q(Y,J),oe(Z,J,null),q(J,ue),B&&B.m(J,null),L=!0,be||(ke=[ie(t,"click",ce(s[26])),ie(o,"click",ce(s[27])),ie(u,"click",ce(s[28]))],be=!0)},p(g,S){(!L||S[0]&128)&&v(t,"bg-light",!g[7]),(!L||S[0]&128)&&v(t,"bg-dark-subtle",g[7]),(!L||S[0]&32)&&v(o,"bg-light",!g[5]),(!L||S[0]&32)&&v(o,"bg-dark-subtle",g[5]),(!L||S[0]&64)&&v(u,"bg-light",!g[6]),(!L||S[0]&64)&&v(u,"bg-dark-subtle",g[6]),(!L||S[0]&32768)&&we(b,g[15]),(!L||S[0]&4)&&we(m,g[2]),(!L||S[0]&8194)&&v(a,"text-bg-light",!g[1]||g[13]),(!L||S[0]&24578)&&v(a,"bg-success",!g[13]&&!g[14].is_invalid&&g[1]&&g[1].is_correct),(!L||S[0]&24578)&&v(a,"bg-danger",!g[13]&&!g[14].is_invalid&&g[1]&&!g[1].is_correct),(!L||S[0]&1)&&z!==(z=g[0].deck.name+"")&&we(y,z),(!L||S[0]&1&&F!==(F="/decks/"+g[0].deck.id))&&k(A,"href",F),!g[13]&&g[16]&&(!g[4]||!g[9].isAnswered)?R?(R.p(g,S),S[0]&74256&&M(R,1)):(R=De(g),R.c(),M(R,1),R.m(c,_)):R&&(ne(),H(R,1,1,()=>{R=null}),se()),g[4]&&g[9].isAnswered?U?(U.p(g,S),S[0]&528&&M(U,1)):(U=Be(g),U.c(),M(U,1),U.m(c,null)):U&&(ne(),H(U,1,1,()=>{U=null}),se()),g[7]?D?(D.p(g,S),S[0]&128&&M(D,1)):(D=Ve(g),D.c(),M(D,1),D.m(Y,le)):D&&(ne(),H(D,1,1,()=>{D=null}),se());const ae={};!j&&S[0]&1&&(j=!0,ae.data=g[0],K(()=>j=!1)),!me&&S[0]&1&&(me=!0,ae.currentQuestionId=g[0].session.current_question_id,K(()=>me=!1)),!he&&S[0]&512&&(he=!0,ae.currentQuestionContext=g[9],K(()=>he=!1)),Z.$set(ae),g[14]?B?(B.p(g,S),S[0]&16384&&M(B,1)):(B=Ee(g),B.c(),M(B,1),B.m(J,null)):B&&(ne(),H(B,1,1,()=>{B=null}),se()),(!L||S[0]&128)&&v(J,"col-lg-9",g[7]),(!L||S[0]&128)&&v(J,"col-lg-10",!g[7]),(!L||S[0]&128)&&v(J,"offset-lg-1",!g[7])},i(g){L||(M(R),M(U),M(D),M(Z.$$.fragment,g),M(B),L=!0)},o(g){H(R),H(U),H(D),H(Z.$$.fragment,g),H(B),L=!1},d(g){g&&(Q(n),Q(h),Q(w),Q(ee),Q(Y)),R&&R.d(),U&&U.d(),D&&D.d(),te(Z),B&&B.d(),be=!1,un(ke)}}}function De(s){let n,e,i;function t(o){s[29](o)}let r={};return s[3]!==void 0&&(r.progressPercentage=s[3]),n=new dn({props:r}),O.push(()=>W(n,"progressPercentage",t)),{c(){re(n.$$.fragment)},m(o,d){oe(n,o,d),i=!0},p(o,d){const u={};!e&&d[0]&8&&(e=!0,u.progressPercentage=o[3],K(()=>e=!1)),n.$set(u)},i(o){i||(M(n.$$.fragment,o),i=!0)},o(o){H(n.$$.fragment,o),i=!1},d(o){te(n,o)}}}function Be(s){let n,e,i;function t(o){s[30](o)}let r={sessionId:s[0].session.id};return s[3]!==void 0&&(r.progressPercentage=s[3]),n=new Sn({props:r}),O.push(()=>W(n,"progressPercentage",t)),{c(){re(n.$$.fragment)},m(o,d){oe(n,o,d),i=!0},p(o,d){const u={};d[0]&1&&(u.sessionId=o[0].session.id),!e&&d[0]&8&&(e=!0,u.progressPercentage=o[3],K(()=>e=!1)),n.$set(u)},i(o){i||(M(n.$$.fragment,o),i=!0)},o(o){H(n.$$.fragment,o),i=!1},d(o){te(n,o)}}}function Ve(s){let n,e,i,t,r;function o(f){s[31](f)}function d(f){s[32](f)}let u={};return s[0]!==void 0&&(u.data=s[0]),s[13]!==void 0&&(u.examMode=s[13]),e=new Pn({props:u}),O.push(()=>W(e,"data",o)),O.push(()=>W(e,"examMode",d)),{c(){n=C("div"),re(e.$$.fragment),k(n,"class","col-lg-3 d-none d-lg-block")},m(f,a){P(f,n,a),oe(e,n,null),r=!0},p(f,a){const b={};!i&&a[0]&1&&(i=!0,b.data=f[0],K(()=>i=!1)),!t&&a[0]&8192&&(t=!0,b.examMode=f[13],K(()=>t=!1)),e.$set(b)},i(f){r||(M(e.$$.fragment,f),r=!0)},o(f){H(e.$$.fragment,f),r=!1},d(f){f&&Q(n),te(e)}}}function Ee(s){let n,e,i,t,r,o,d,u,f,a,b;function p(w){s[36](w)}function m(w){s[37](w)}function G(w){s[38](w)}function A(w){s[39](w)}function T(w){s[40](w)}function z(w){s[41](w)}function y(w){s[42](w)}let F={deckId:s[0].deck.id,submitAnswer:s[19],deleteAnswer:s[20],updateCurrentQuestionData:s[18]};s[14]!==void 0&&(F.question=s[14]),s[9]!==void 0&&(F.questionContext=s[9]),s[10]!==void 0&&(F.helpUsed=s[10]),s[1]!==void 0&&(F.answerChoice=s[1]),s[13]!==void 0&&(F.examMode=s[13]),s[5]!==void 0&&(F.settingsShuffleAnswers=s[5]),s[17]!==void 0&&(F.settingsShowAnswerStats=s[17]),n=new _n({props:F}),O.push(()=>W(n,"question",p)),O.push(()=>W(n,"questionContext",m)),O.push(()=>W(n,"helpUsed",G)),O.push(()=>W(n,"answerChoice",A)),O.push(()=>W(n,"examMode",T)),O.push(()=>W(n,"settingsShuffleAnswers",z)),O.push(()=>W(n,"settingsShowAnswerStats",y));let h=!s[13]&&Oe(s);return{c(){re(n.$$.fragment),f=V(),h&&h.c(),a=ve()},m(w,c){oe(n,w,c),P(w,f,c),h&&h.m(w,c),P(w,a,c),b=!0},p(w,c){const _={};c[0]&1&&(_.deckId=w[0].deck.id),!e&&c[0]&16384&&(e=!0,_.question=w[14],K(()=>e=!1)),!i&&c[0]&512&&(i=!0,_.questionContext=w[9],K(()=>i=!1)),!t&&c[0]&1024&&(t=!0,_.helpUsed=w[10],K(()=>t=!1)),!r&&c[0]&2&&(r=!0,_.answerChoice=w[1],K(()=>r=!1)),!o&&c[0]&8192&&(o=!0,_.examMode=w[13],K(()=>o=!1)),!d&&c[0]&32&&(d=!0,_.settingsShuffleAnswers=w[5],K(()=>d=!1)),!u&&c[0]&131072&&(u=!0,_.settingsShowAnswerStats=w[17],K(()=>u=!1)),n.$set(_),w[13]?h&&(ne(),H(h,1,1,()=>{h=null}),se()):h?(h.p(w,c),c[0]&8192&&M(h,1)):(h=Oe(w),h.c(),M(h,1),h.m(a.parentNode,a))},i(w){b||(M(n.$$.fragment,w),M(h),b=!0)},o(w){H(n.$$.fragment,w),H(h),b=!1},d(w){w&&(Q(f),Q(a)),te(n,w),h&&h.d(w)}}}function Oe(s){let n,e,i,t;function r(u){s[43](u)}function o(u){s[44](u)}let d={};return s[14].id!==void 0&&(d.questionId=s[14].id),s[9]!==void 0&&(d.questionContext=s[9]),n=new an({props:d}),O.push(()=>W(n,"questionId",r)),O.push(()=>W(n,"questionContext",o)),{c(){re(n.$$.fragment)},m(u,f){oe(n,u,f),t=!0},p(u,f){const a={};!e&&f[0]&16384&&(e=!0,a.questionId=u[14].id,K(()=>e=!1)),!i&&f[0]&512&&(i=!0,a.questionContext=u[9],K(()=>i=!1)),n.$set(a)},i(u){t||(M(n.$$.fragment,u),t=!0)},o(u){H(n.$$.fragment,u),t=!1},d(u){te(n,u)}}}function We(s){let n,e,i;function t(o){s[45](o)}let r={};return s[11]!==void 0&&(r.magicGIFPath=s[11]),n=new kn({props:r}),O.push(()=>W(n,"magicGIFPath",t)),{c(){re(n.$$.fragment)},m(o,d){oe(n,o,d),i=!0},p(o,d){const u={};!e&&d[0]&2048&&(e=!0,u.magicGIFPath=o[11],K(()=>e=!1)),n.$set(u)},i(o){i||(M(n.$$.fragment,o),i=!0)},o(o){H(n.$$.fragment,o),i=!1},d(o){te(n,o)}}}function Ke(s){let n,e,i;return e=new bn({props:{x:[-5,5],y:[0,.1],delay:[100,3e3],infinite:!0,duration:"5000",amount:"200",fallDistance:"100vh"}}),{c(){n=C("div"),re(e.$$.fragment),I(n,"position","fixed"),I(n,"top","-50px"),I(n,"left","0"),I(n,"height","100vh"),I(n,"width","100vw"),I(n,"display","flex"),I(n,"justify-content","center"),I(n,"overflow","hidden"),I(n,"pointer-events","none")},m(t,r){P(t,n,r),oe(e,n,null),i=!0},i(t){i||(M(e.$$.fragment,t),i=!0)},o(t){H(e.$$.fragment,t),i=!1},d(t){t&&Q(n),te(e)}}}function Un(s){let n,e,i,t,r,o;const d=[Rn,Nn],u=[];function f(p,m){return p[0]?0:1}n=f(s),e=u[n]=d[n](s);let a=!s[13]&&We(s),b=s[12]&&Ke();return{c(){e.c(),i=V(),a&&a.c(),t=V(),b&&b.c(),r=ve()},m(p,m){u[n].m(p,m),P(p,i,m),a&&a.m(p,m),P(p,t,m),b&&b.m(p,m),P(p,r,m),o=!0},p(p,m){let G=n;n=f(p),n===G?u[n].p(p,m):(ne(),H(u[G],1,1,()=>{u[G]=null}),se(),e=u[n],e?e.p(p,m):(e=u[n]=d[n](p),e.c()),M(e,1),e.m(i.parentNode,i)),p[13]?a&&(ne(),H(a,1,1,()=>{a=null}),se()):a?(a.p(p,m),m[0]&8192&&M(a,1)):(a=We(p),a.c(),M(a,1),a.m(t.parentNode,t)),p[12]?b?m[0]&4096&&M(b,1):(b=Ke(),b.c(),M(b,1),b.m(r.parentNode,r)):b&&(ne(),H(b,1,1,()=>{b=null}),se())},i(p){o||(M(e),M(a),M(b),o=!0)},o(p){H(e),H(a),H(b),o=!1},d(p){p&&(Q(i),Q(t),Q(r)),u[n].d(p),a&&a.d(p),b&&b.d(p)}}}function Dn(s,n,e){let i,t,r,o,d,u,f,a,b,p,m,G,A,T,z,y,F,h;rn(s,qe,l=>e(8,h=l));let{id:w}=n;var c,_,ee=!1,Y="",le=0;const J=document.getElementById("appconfig").dataset;function Z(){return{isAnswered:!!T,answerContext:m.answers.reduce((N,x)=>(N[x.id]={isCorrectAnswer:x.id===m.correct_answer_id,isSubmittedAnswer:b?x.id===b.answer_id:!1,isSelectedAnswer:b?x.id===b.answer_id:!1},N),{})}}var j=-1;Pe(()=>{axios.get("/api/sessions/"+w).then(function(l){e(0,_=l.data)}).catch(function(l){alert(l)})});function me(){return axios.get("/api/questions/"+m.id).then(function(l){var N=_.deck.questions.findIndex(pe=>pe.id===m.id),x=l.data;e(0,_.deck.questions[N]=x,_),he(x)}).catch(function(l){alert(l)})}function he(l){if(l.type!=="card"){var N=_.session.answer_choices.findIndex(x=>x.question_id===l.id);N!==-1&&e(0,_.session.answer_choices[N].is_correct=_.session.answer_choices[N].answer_id===l.correct_answer_id,_)}}var ue;function L(){ue&&ue.cancel(),ue=fn(()=>{axios.put("/api/sessions/"+_.session.id,_.session).then(function(l){}).catch(function(l){alert(l)})},1e3,{maxWait:2e3}),ue()}function be(l){if(l&&l!==-1?e(9,c.answerContext[l].isSelectedAnswer=!0,c):e(9,c.isAnswered=!0,c),T&&l&&l===m.correct_answer_id){e(9,c.isAnswered=!0,c);return}else if(T)return;var N=!1;m.type==="card"?(N=!!l,l===-1&&(l=null)):N=m.correct_answer_id===l,(N||i||!d)&&e(9,c.isAnswered=!0,c),l&&l!==-1&&(e(9,c.answerContext[l].isSubmittedAnswer=!0,c),e(9,c.answerContext[l].isCorrectAnswer=N,c));var x={question_id:A,answer_id:l,is_correct:N,help_used:ee};axios.post("/api/sessions/"+w+"/answerchoices",x).then(function(pe){e(0,_.session.answer_choices=[..._.session.answer_choices,pe.data],_)}).catch(function(pe){alert(pe)})}function ke(){T&&(e(1,b=_.session.answer_choices.find(l=>l.question_id===A)),b&&axios.delete("/api/sessions/"+w+"/answerchoices/"+b.id).then(function(l){e(0,_.session.answer_choices=[..._.session.answer_choices.filter(N=>N.question_id!==A)],_),ln().then(()=>{e(9,c=Z())})}).catch(function(l){alert(l)}))}const R=()=>{Me(qe,h.session_show_sidebar=!h.session_show_sidebar,h)},U=()=>{Me(qe,h.session_shuffle_answers=!h.session_shuffle_answers,h)},D=()=>{Me(qe,h.session_exam_mode=!h.session_exam_mode,h)};function Se(l){z=l,e(3,z),e(0,_),e(25,a),e(24,p)}function Ae(l){z=l,e(3,z),e(0,_),e(25,a),e(24,p)}function Ie(l){_=l,e(0,_)}function fe(l){i=l,e(13,i),e(4,G),e(8,h),e(0,_),e(25,a),e(24,p)}function B(l){_=l,e(0,_)}function g(l){s.$$.not_equal(_.session.current_question_id,l)&&(_.session.current_question_id=l,e(0,_))}function S(l){c=l,e(9,c),e(23,A),e(0,_)}function ae(l){m=l,e(14,m),e(0,_)}function Ye(l){c=l,e(9,c),e(23,A),e(0,_)}function Ze(l){ee=l,e(10,ee)}function je(l){b=l,e(1,b),e(0,_),e(23,A)}function xe(l){i=l,e(13,i),e(4,G),e(8,h),e(0,_),e(25,a),e(24,p)}function $e(l){o=l,e(5,o),e(8,h)}function en(l){u=l,e(17,u),e(8,h)}function nn(l){s.$$.not_equal(m.id,l)&&(m.id=l,e(14,m),e(0,_))}function sn(l){c=l,e(9,c),e(23,A),e(0,_)}function tn(l){Y=l,e(11,Y),e(3,z),e(22,j),e(2,y),e(0,_),e(25,a),e(24,p)}return s.$$set=l=>{"id"in l&&e(21,w=l.id)},s.$$.update=()=>{s.$$.dirty[0]&1&&e(25,a=_?_.deck.questions.filter(l=>!l.is_invalid):null),s.$$.dirty[0]&33554433&&e(24,p=_?_.session.answer_choices.filter(l=>a.some(({id:N})=>N===l.question_id)):null),s.$$.dirty[0]&50331649&&e(4,G=_?a.length===p.length:!1),s.$$.dirty[0]&272&&e(13,i=G?!1:h.session_exam_mode),s.$$.dirty[0]&256&&e(7,t=h.session_show_sidebar),s.$$.dirty[0]&256&&e(6,r=h.session_exam_mode),s.$$.dirty[0]&256&&e(5,o=h.session_shuffle_answers),s.$$.dirty[0]&256&&(d=h.session_multiple_answer_tries),s.$$.dirty[0]&256&&e(17,u=h.session_show_answer_stats),s.$$.dirty[0]&256&&e(16,f=h.session_show_progress_bar),s.$$.dirty[0]&128&&axios.put("/api/users/me/settings",{session_show_sidebar:t}).then(function(l){}).catch(function(l){alert(l)}),s.$$.dirty[0]&64&&axios.put("/api/users/me/settings",{session_exam_mode:r}).then(function(l){}).catch(function(l){alert(l)}),s.$$.dirty[0]&32&&axios.put("/api/users/me/settings",{session_shuffle_answers:o}).then(function(l){}).catch(function(l){alert(l)}),s.$$.dirty[0]&1&&e(23,A=_?_.session.current_question_id:null),s.$$.dirty[0]&8388609&&e(1,b=_?_.session.answer_choices.find(l=>l.question_id===A):null),s.$$.dirty[0]&1&&e(14,m=_?_.deck.questions.find(l=>l.id===_.session.current_question_id):null),s.$$.dirty[0]&16&&G&&e(13,i=!1),s.$$.dirty[0]&8388608&&L(),s.$$.dirty[0]&3&&(T=_?!!b:!1),s.$$.dirty[0]&8388608&&A&&e(9,c=Z()),s.$$.dirty[0]&50331649&&e(3,z=_?gn(a.length,p):null),s.$$.dirty[0]&1&&e(2,y=_?_.deck.questions.length:0),s.$$.dirty[0]&1&&e(15,F=_?_.deck.questions.findIndex(l=>l.id==_.session.current_question_id)+1:null),s.$$.dirty[0]&4194317&&(()=>{if(z){var l=z.correct;if(l<60){e(22,j=l);return}if(j===-1){e(22,j=l);return}j<60&&(e(22,j=l),axios.get("/api/magic-gif").then(function(N){e(11,Y="magic-gifs/"+N.data.id)}).catch(function(N){})),J.magic==="1"&&l===100&&j<100&&y>=10&&_.session.parent_session_id===null&&e(12,le=1)}})()},[_,b,y,z,G,o,r,t,h,c,ee,Y,le,i,m,F,f,u,me,be,ke,w,j,A,p,a,R,U,D,Se,Ae,Ie,fe,B,g,S,ae,Ye,Ze,je,xe,$e,en,nn,sn,tn]}class Bn extends de{constructor(n){super(),_e(this,n,Dn,Un,ge,{id:21},null,[-1,-1])}}const Je=document.getElementById("SessionView");new Bn({target:Je,props:{id:Je.dataset.sessionId}});
