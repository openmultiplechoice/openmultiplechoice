import{S as ue,i as ae,s as ce,e as ke,a as g,n as P,d as v,b as _,c as f,f as ge,t as N,g as R,h as d,l as T,p as $,j as V,r as re,k as de,m as fe,o as _e,q as X,u as ve,v as qe,w as ee,x as me,y as pe,z as H,A as O,B as ye,C as he,D as we,E as Qe,F as Ie}from"./index-CfkxbGBF.js";import{e as U,u as Ce,d as Fe}from"./each-11-GcuRw.js";import{Q as Re}from"./QuestionForm-JHzPKPoh.js";import{p as te}from"./purify.es-WTxncMLc.js";import"./_commonjsHelpers-5-cIlDoe.js";function ne(i,t,e){const n=i.slice();return n[4]=t[e],n[6]=e,n}function De(i){let t;return{c(){t=_("p"),t.textContent="Loading ..."},m(e,n){g(e,t,n)},p:P,d(e){e&&v(t)}}}function Me(i){let t,e=U(i[0].questions),n=[];for(let l=0;l<e.length;l+=1)n[l]=ie(ne(i,e,l));return{c(){t=_("div");for(let l=0;l<n.length;l+=1)n[l].c();f(t,"class","list-group")},m(l,a){g(l,t,a);for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(t,null)},p(l,a){if(a&3){e=U(l[0].questions);let s;for(s=0;s<e.length;s+=1){const u=ne(l,e,s);n[s]?n[s].p(u,a):(n[s]=ie(u),n[s].c(),n[s].m(t,null))}for(;s<n.length;s+=1)n[s].d(1);n.length=e.length}},d(l){l&&v(t),ge(n,l)}}}function Se(i){let t,e=i[6]+1+"",n;return{c(){t=N("Question Nr. "),n=N(e)},m(l,a){g(l,t,a),g(l,n,a)},p:P,d(l){l&&(v(t),v(n))}}}function Ne(i){let t=te.sanitize(i[4].text).replace(/<\/?[^>]+(>|$)/g,"")+"",e;return{c(){e=N(t)},m(n,l){g(n,e,l)},p(n,l){l&1&&t!==(t=te.sanitize(n[4].text).replace(/<\/?[^>]+(>|$)/g,"")+"")&&V(e,t)},d(n){n&&v(e)}}}function ie(i){let t,e,n,l,a=i[4].id+"",s,u,o,C,Q=i[4].type+"",z,A,p,F,h,L,D,c,q;function b(){return i[2](i[4])}function E(w,M){return w[4].text?Ne:Se}let I=E(i),y=I(i);function G(){return i[3](i[4])}return{c(){t=_("button"),e=_("div"),n=_("p"),l=N("ID: "),s=N(a),u=R(),o=_("p"),C=N("Type: "),z=N(Q),A=R(),p=_("button"),p.innerHTML='<i class="bi bi-trash"></i>',F=R(),h=_("p"),y.c(),L=R(),f(n,"class","mb-1 font-monospace"),f(o,"class","mb-1 font-monospace text-uppercase"),f(p,"type","button"),f(p,"class","btn btn-sm btn-light"),f(e,"class","d-flex w-100 justify-content-between mb-1"),f(h,"class","mb-1 index-list-item svelte-sfi4r3"),f(t,"type","button"),f(t,"class",D="list-group-item "+(i[4].id===i[0].current_question_id?"list-group-item-secondary":"list-group-item-light")),f(t,"aria-current","true")},m(w,M){g(w,t,M),d(t,e),d(e,n),d(n,l),d(n,s),d(e,u),d(e,o),d(o,C),d(o,z),d(e,A),d(e,p),d(t,F),d(t,h),y.m(h,null),d(t,L),c||(q=[T(p,"click",$(b)),T(t,"click",$(G))],c=!0)},p(w,M){i=w,M&1&&a!==(a=i[4].id+"")&&V(s,a),M&1&&Q!==(Q=i[4].type+"")&&V(z,Q),I===(I=E(i))&&y?y.p(i,M):(y.d(1),y=I(i),y&&(y.c(),y.m(h,null))),M&1&&D!==(D="list-group-item "+(i[4].id===i[0].current_question_id?"list-group-item-secondary":"list-group-item-light"))&&f(t,"class",D)},d(w){w&&v(t),y.d(),c=!1,re(q)}}}function ze(i){let t;function e(a,s){return a[0]?Me:De}let n=e(i),l=n(i);return{c(){l.c(),t=ke()},m(a,s){l.m(a,s),g(a,t,s)},p(a,[s]){n===(n=e(a))&&l?l.p(a,s):(l.d(1),l=n(a),l&&(l.c(),l.m(t.parentNode,t)))},i:P,o:P,d(a){a&&v(t),l.d(a)}}}function Ae(i,t,e){let{data:n}=t,{handleQuestionRemove:l}=t;const a=u=>{l(u.id)},s=u=>{e(0,n.current_question_id=u.id,n)};return i.$$set=u=>{"data"in u&&e(0,n=u.data),"handleQuestionRemove"in u&&e(1,l=u.handleQuestionRemove)},[n,l,a,s]}class Ee extends ue{constructor(t){super(),ae(this,t,Ae,ze,ce,{data:0,handleQuestionRemove:1})}}function le(i,t,e){const n=i.slice();return n[15]=t[e],n}function se(i,t){let e,n=t[15].name+"",l,a,s;return{key:i,first:null,c(){e=_("option"),l=N(n),s=N(">"),e.__value=a=t[15].id.toString(),X(e,e.__value),this.first=e},m(u,o){g(u,e,o),d(e,l),g(u,s,o)},p(u,o){t=u,o&8&&n!==(n=t[15].name+"")&&V(l,n),o&8&&a!==(a=t[15].id.toString())&&(e.__value=a,X(e,e.__value))},d(u){u&&(v(e),v(s))}}}function oe(i){let t,e,n,l;function a(u){i[14](u)}let s={};return i[4]!==void 0&&(s.question=i[4]),e=new Re({props:s}),de.push(()=>fe(e,"question",a)),{c(){t=_("div"),_e(e.$$.fragment),f(t,"class","mt-2 p-3")},m(u,o){g(u,t,o),me(e,t,null),l=!0},p(u,o){const C={};!n&&o&16&&(n=!0,C.question=u[4],pe(()=>n=!1)),e.$set(C)},i(u){l||(H(e.$$.fragment,u),l=!0)},o(u){O(e.$$.fragment,u),l=!1},d(u){u&&v(t),he(e)}}}function Le(i){let t,e,n,l,a,s,u,o,C,Q,z,A,p,F,h=[],L=new Map,D,c,q,b,E,I,y,G,w,M,j,B,W,Y,J=U(i[3]);const Z=r=>r[15].id;for(let r=0;r<J.length;r+=1){let m=le(i,J,r),S=Z(m);L.set(S,h[r]=se(S,m))}function be(r){i[13](r)}let x={handleQuestionRemove:i[6]};i[2]!==void 0&&(x.data=i[2]),I=new Ee({props:x}),de.push(()=>fe(I,"data",be));let k=i[4]&&oe(i);return{c(){t=_("div"),e=_("div"),n=_("h4"),l=N(i[1]),a=R(),s=_("div"),u=_("div"),o=_("button"),o.textContent="Add MC question",C=R(),Q=_("button"),Q.textContent="Add card question",z=R(),A=_("div"),p=_("select"),F=_("option"),F.textContent="Select module ...";for(let r=0;r<h.length;r+=1)h[r].c();D=R(),c=_("div"),c.innerHTML='<div class="col"><div class="mt-3 mb-3 border-dark" style="border-bottom: dotted; border-width: 1px;"></div></div>',q=R(),b=_("div"),E=_("div"),_e(I.$$.fragment),G=R(),w=_("div"),M=R(),j=_("div"),k&&k.c(),f(e,"class","col"),f(t,"class","row"),f(o,"type","button"),f(o,"class","btn btn-sm btn-primary"),f(Q,"type","button"),f(Q,"class","btn btn-sm btn-primary"),f(u,"class","col"),F.__value="",X(F,F.__value),F.disabled=!0,f(p,"class","form-select"),i[0]===void 0&&ve(()=>i[11].call(p)),f(A,"class","col"),f(s,"class","row"),f(c,"class","row"),f(w,"class","btn-group-vertical btn-group-sm"),qe(w,"width","100%"),f(w,"role","group"),f(w,"aria-label","Vertical button group"),f(E,"class","col-md-4"),f(j,"class","col-md-8"),f(b,"class","row")},m(r,m){g(r,t,m),d(t,e),d(e,n),d(n,l),g(r,a,m),g(r,s,m),d(s,u),d(u,o),d(u,C),d(u,Q),d(s,z),d(s,A),d(A,p),d(p,F);for(let S=0;S<h.length;S+=1)h[S]&&h[S].m(p,null);ee(p,i[0],!0),g(r,D,m),g(r,c,m),g(r,q,m),g(r,b,m),d(b,E),me(I,E,null),d(E,G),d(E,w),d(b,M),d(b,j),k&&k.m(j,null),B=!0,W||(Y=[T(o,"click",i[9]),T(Q,"click",i[10]),T(p,"change",i[11]),T(p,"change",i[12])],W=!0)},p(r,[m]){(!B||m&2)&&V(l,r[1]),m&8&&(J=U(r[3]),h=Ce(h,m,Z,1,r,J,L,p,Fe,se,null,le)),m&9&&ee(p,r[0]);const S={};!y&&m&4&&(y=!0,S.data=r[2],pe(()=>y=!1)),I.$set(S),r[4]?k?(k.p(r,m),m&16&&H(k,1)):(k=oe(r),k.c(),H(k,1),k.m(j,null)):k&&(Qe(),O(k,1,1,()=>{k=null}),ye())},i(r){B||(H(I.$$.fragment,r),H(k),B=!0)},o(r){O(I.$$.fragment,r),O(k),B=!1},d(r){r&&(v(t),v(a),v(s),v(D),v(c),v(q),v(b));for(let m=0;m<h.length;m+=1)h[m].d();he(I),k&&k.d(),W=!1,re(Y)}}}function Te(i,t,e){let n,{id:l}=t,{name:a}=t,{moduleId:s}=t;var u=[];let o={questions:[]};we(()=>{axios.get("/api/decks/"+l+"/questions").then(function(c){e(2,o.questions=c.data,o),o.questions.length>0&&e(2,o.current_question_id=o.questions[o.questions.length-1].id,o)}).catch(function(c){alert(c)}),axios.get("/api/modules").then(function(c){e(3,u=c.data)}).catch(function(c){alert(c)})});function C(c){var q={id:null,text:"",type:c||"mc",correct_answer_id:null,images:[],answers:[]};axios.post("/api/decks/"+l+"/questions",q).then(function(b){q.id=b.data.id,e(2,o.questions=[...o.questions,q],o),e(2,o.current_question_id=q.id,o)}).catch(function(b){alert(b)})}function Q(c){axios.delete("/api/decks/"+l+"/questions/"+c).then(function(q){e(2,o.questions=o.questions.filter(b=>b.id!==c),o),o.questions.length>0&&e(2,o.current_question_id=o.questions[o.questions.length-1].id,o)}).catch(function(q){alert(q)})}function z(c){var q={module_id:c};axios.put("/api/decks/"+l,q).then(function(b){e(0,s=c)}).catch(function(b){alert(b)})}const A=()=>{C("mc")},p=()=>{C("card")};function F(){s=Ie(this),e(0,s),e(3,u)}const h=()=>z(s);function L(c){o=c,e(2,o)}function D(c){n=c,e(4,n),e(2,o)}return i.$$set=c=>{"id"in c&&e(8,l=c.id),"name"in c&&e(1,a=c.name),"moduleId"in c&&e(0,s=c.moduleId)},i.$$.update=()=>{i.$$.dirty&4&&e(4,n=o?o.questions.find(c=>c.id===o.current_question_id):null)},[s,a,o,u,n,C,Q,z,l,A,p,F,h,L,D]}class je extends ue{constructor(t){super(),ae(this,t,Te,Le,ce,{id:8,name:1,moduleId:0})}}const K=document.getElementById("DeckForm");new je({target:K,props:{id:K.dataset.deckId,name:K.dataset.deckName,moduleId:K.dataset.moduleId}});
