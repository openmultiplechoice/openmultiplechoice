import{S as $,i as x,s as ee,c as m,a as v,t as L,f as c,E as te,b as q,h as f,q as S,n as A,d as H,C as le,F as se,k as ie,m as B,l as E,p as U}from"./index-Cm33_cbi.js";import{e as I}from"./each-C5IGOPsu.js";import{c as D}from"./NewSessionHelper-Ba9jtPTo.js";import{C as ne}from"./auto-De2ec26M.js";import{f as N,p as ae}from"./parseISO-JEmvXouO.js";function O(s,e,o){const r=s.slice();return r[15]=e[o],r}function V(s,e,o){const r=s.slice();return r[15]=e[o],r}function j(s,e,o){const r=s.slice();return r[15]=e[o],r}function oe(s){let e;return{c(){e=m("p"),e.textContent="No stats available yet"},m(o,r){q(o,e,r)},p:A,d(o){o&&H(e)}}}function re(s){let e,o,r,n=s[2].length>0&&P(s),l=s[3].length>0&&s[4]&&z(s),t=s[5].length>0&&K(s);return{c(){e=m("div"),n&&n.c(),o=v(),l&&l.c(),r=v(),t&&t.c(),c(e,"class","row")},m(a,i){q(a,e,i),n&&n.m(e,null),f(e,o),l&&l.m(e,null),f(e,r),t&&t.m(e,null)},p(a,i){a[2].length>0?n?n.p(a,i):(n=P(a),n.c(),n.m(e,o)):n&&(n.d(1),n=null),a[3].length>0&&a[4]?l?l.p(a,i):(l=z(a),l.c(),l.m(e,r)):l&&(l.d(1),l=null),a[5].length>0?t?t.p(a,i):(t=K(a),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},d(a){a&&H(e),n&&n.d(),l&&l.d(),t&&t.d()}}}function P(s){let e,o,r,n=I(s[2]),l=[];for(let t=0;t<n.length;t+=1)l[t]=R(j(s,n,t));return{c(){e=m("div"),o=m("h6"),o.textContent="New decks",r=v();for(let t=0;t<l.length;t+=1)l[t].c();c(e,"class","col-lg mt-3 text-overflow svelte-1gfmo48")},m(t,a){q(t,e,a),f(e,o),f(e,r);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(t,a){if(a&4){n=I(t[2]);let i;for(i=0;i<n.length;i+=1){const d=j(t,n,i);l[i]?l[i].p(d,a):(l[i]=R(d),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(t){t&&H(e),B(l,t)}}}function F(s){let e,o,r,n=s[15].questions.length+"",l;return{c(){e=m("span"),o=m("i"),r=v(),l=L(n),c(o,"class","bi bi-collection"),c(e,"class","badge text-bg-light"),c(e,"title","Number of questions")},m(t,a){q(t,e,a),f(e,o),f(e,r),f(e,l)},p(t,a){a&4&&n!==(n=t[15].questions.length+"")&&S(l,n)},d(t){t&&H(e)}}}function R(s){let e,o,r,n,l,t=s[15].name+"",a,i,d,g,_,u=s[15].questions.length>0&&F(s);function k(){return s[9](s[15])}return{c(){e=m("div"),u&&u.c(),o=v(),r=m("button"),r.innerHTML='<i class="bi bi-rocket-takeoff"></i>',n=v(),l=m("a"),a=L(t),d=v(),c(r,"type","button"),c(r,"class","btn btn-sm btn-primary"),c(l,"href",i="/decks/"+s[15].id),c(l,"class","alert-link text-overflow svelte-1gfmo48"),c(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),c(e,"role","alert")},m(p,y){q(p,e,y),u&&u.m(e,null),f(e,o),f(e,r),f(e,n),f(e,l),f(l,a),f(e,d),g||(_=E(r,"click",U(k)),g=!0)},p(p,y){s=p,s[15].questions.length>0?u?u.p(s,y):(u=F(s),u.c(),u.m(e,o)):u&&(u.d(1),u=null),y&4&&t!==(t=s[15].name+"")&&S(a,t),y&4&&i!==(i="/decks/"+s[15].id)&&c(l,"href",i)},d(p){p&&H(e),u&&u.d(),g=!1,_()}}}function z(s){let e,o,r,n,l,t,a=I(s[3]),i=[];for(let d=0;d<a.length;d+=1)i[d]=J(V(s,a,d));return{c(){e=m("div"),o=m("h6"),r=L("Popular decks (last "),n=L(s[4]),l=L(" days)"),t=v();for(let d=0;d<i.length;d+=1)i[d].c();c(e,"class","col-lg mt-3 text-overflow svelte-1gfmo48")},m(d,g){q(d,e,g),f(e,o),f(o,r),f(o,n),f(o,l),f(e,t);for(let _=0;_<i.length;_+=1)i[_]&&i[_].m(e,null)},p(d,g){if(g&16&&S(n,d[4]),g&8){a=I(d[3]);let _;for(_=0;_<a.length;_+=1){const u=V(d,a,_);i[_]?i[_].p(u,g):(i[_]=J(u),i[_].c(),i[_].m(e,null))}for(;_<i.length;_+=1)i[_].d(1);i.length=a.length}},d(d){d&&H(e),B(i,d)}}}function Z(s){let e,o,r,n=s[15].questions.length+"",l;return{c(){e=m("span"),o=m("i"),r=v(),l=L(n),c(o,"class","bi bi-collection"),c(e,"class","badge text-bg-light"),c(e,"title","Number of questions")},m(t,a){q(t,e,a),f(e,o),f(e,r),f(e,l)},p(t,a){a&8&&n!==(n=t[15].questions.length+"")&&S(l,n)},d(t){t&&H(e)}}}function G(s){let e,o,r,n=s[15].sessions_count+"",l;return{c(){e=m("span"),o=m("i"),r=v(),l=L(n),c(o,"class","bi bi-rocket"),c(e,"class","badge text-bg-light"),c(e,"title","Number of sessions")},m(t,a){q(t,e,a),f(e,o),f(e,r),f(e,l)},p(t,a){a&8&&n!==(n=t[15].sessions_count+"")&&S(l,n)},d(t){t&&H(e)}}}function J(s){let e,o,r,n,l,t,a=s[15].name+"",i,d,g,_,u,k=s[15].questions.length>0&&Z(s),p=s[15].sessions_count&&G(s);function y(){return s[10](s[15])}return{c(){e=m("div"),k&&k.c(),o=v(),p&&p.c(),r=v(),n=m("button"),n.innerHTML='<i class="bi bi-rocket-takeoff"></i>',l=v(),t=m("a"),i=L(a),g=v(),c(n,"type","button"),c(n,"class","btn btn-sm btn-primary"),c(t,"href",d="/decks/"+s[15].id),c(t,"class","alert-link"),c(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),c(e,"role","alert")},m(w,b){q(w,e,b),k&&k.m(e,null),f(e,o),p&&p.m(e,null),f(e,r),f(e,n),f(e,l),f(e,t),f(t,i),f(e,g),_||(u=E(n,"click",U(y)),_=!0)},p(w,b){s=w,s[15].questions.length>0?k?k.p(s,b):(k=Z(s),k.c(),k.m(e,o)):k&&(k.d(1),k=null),s[15].sessions_count?p?p.p(s,b):(p=G(s),p.c(),p.m(e,r)):p&&(p.d(1),p=null),b&8&&a!==(a=s[15].name+"")&&S(i,a),b&8&&d!==(d="/decks/"+s[15].id)&&c(t,"href",d)},d(w){w&&H(e),k&&k.d(),p&&p.d(),_=!1,u()}}}function K(s){let e,o,r,n=I(s[5]),l=[];for(let t=0;t<n.length;t+=1)l[t]=W(O(s,n,t));return{c(){e=m("div"),o=m("h6"),o.textContent="Last used decks",r=v();for(let t=0;t<l.length;t+=1)l[t].c();c(e,"class","col-lg mt-3 text-overflow svelte-1gfmo48")},m(t,a){q(t,e,a),f(e,o),f(e,r);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(t,a){if(a&32){n=I(t[5]);let i;for(i=0;i<n.length;i+=1){const d=O(t,n,i);l[i]?l[i].p(d,a):(l[i]=W(d),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(t){t&&H(e),B(l,t)}}}function Q(s){let e,o,r,n=s[15].questions.length+"",l;return{c(){e=m("span"),o=m("i"),r=v(),l=L(n),c(o,"class","bi bi-collection"),c(e,"class","badge text-bg-light"),c(e,"title","Number of questions")},m(t,a){q(t,e,a),f(e,o),f(e,r),f(e,l)},p(t,a){a&32&&n!==(n=t[15].questions.length+"")&&S(l,n)},d(t){t&&H(e)}}}function W(s){let e,o,r,n,l,t=s[15].name+"",a,i,d,g,_,u=s[15].questions.length>0&&Q(s);function k(){return s[11](s[15])}return{c(){e=m("div"),u&&u.c(),o=v(),r=m("button"),r.innerHTML='<i class="bi bi-rocket-takeoff"></i>',n=v(),l=m("a"),a=L(t),d=v(),c(r,"type","button"),c(r,"class","btn btn-sm btn-primary"),c(l,"href",i="/decks/"+s[15].id),c(l,"class","alert-link"),c(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),c(e,"role","alert")},m(p,y){q(p,e,y),u&&u.m(e,null),f(e,o),f(e,r),f(e,n),f(e,l),f(l,a),f(e,d),g||(_=E(r,"click",U(k)),g=!0)},p(p,y){s=p,s[15].questions.length>0?u?u.p(s,y):(u=Q(s),u.c(),u.m(e,o)):u&&(u.d(1),u=null),y&32&&t!==(t=s[15].name+"")&&S(a,t),y&32&&i!==(i="/decks/"+s[15].id)&&c(l,"href",i)},d(p){p&&H(e),u&&u.d(),g=!1,_()}}}function fe(s){let e,o,r,n,l,t,a,i,d,g,_,u=(s[1]?N(s[1],"HH:mm"):"unknown")+"",k;function p(b,h){return b[2]&&b[3]&&b[5]?re:oe}let y=p(s),w=y(s);return{c(){e=m("div"),e.innerHTML='<div class="col-md"><h4>Stats</h4></div>',o=v(),w.c(),r=v(),n=m("div"),l=m("div"),t=m("canvas"),a=v(),i=m("div"),d=m("div"),g=m("span"),_=L("Last updated: "),k=L(u),c(e,"class","row"),te(t,"max-height","300px"),c(l,"class","col-md"),c(n,"id","stats"),c(n,"class","row mt-3 p-3"),c(g,"class","badge text-bg-light text-muted"),c(d,"class","col-md"),c(i,"class","row")},m(b,h){q(b,e,h),q(b,o,h),w.m(b,h),q(b,r,h),q(b,n,h),f(n,l),f(l,t),s[12](t),q(b,a,h),q(b,i,h),f(i,d),f(d,g),f(g,_),f(g,k)},p(b,[h]){y===(y=p(b))&&w?w.p(b,h):(w.d(1),w=y(b),w&&(w.c(),w.m(r.parentNode,r))),h&2&&u!==(u=(b[1]?N(b[1],"HH:mm"):"unknown")+"")&&S(k,u)},i:A,o:A,d(b){b&&(H(e),H(o),H(r),H(n),H(a),H(i)),w.d(b),s[12](null)}}}function ce(s,e,o){let r,n,l,t,a={},i={},d=[],g=[],_=0,u=[];le(()=>{k(),l=setInterval(k,2*60*1e3)}),se(()=>{clearInterval(l)});function k(){axios.get("/api/stats/activity").then(function(h){const C=h.data;o(7,a=C.answers_byhour),o(8,i=C.users_byhour),o(2,d=C.decks_new),o(3,g=C.decks_popular),o(4,_=C.decks_popular_timespan),o(5,u=C.decks_last_used),o(1,t=new Date)}).catch(function(h){console.log(h)})}const p=h=>D(h.id),y=h=>D(h.id),w=h=>D(h.id);function b(h){ie[h?"unshift":"push"](()=>{r=h,o(0,r)})}return s.$$.update=()=>{s.$$.dirty&449&&r&&a&&i&&(()=>{const h=Object.keys(a),C=Object.values(a);if(C.reduce((M,T)=>M+T,0)===0){document.getElementById("stats").style.display="none";return}document.getElementById("stats").style.display="block";const X={type:"line",data:{labels:h,datasets:[{label:"Answers",data:C,backgroundColor:"rgba(255, 205, 86, 0.4)",borderColor:"rgba(255, 205, 86, 0.4)",fill:!0,showLine:!1,pointRadius:0,tension:.2},{label:"Users",data:Object.values(i),backgroundColor:"rgba(54, 162, 235, 0.7)",borderColor:"rgba(54, 162, 235, 0.7)",fill:!0,showLine:!1,pointRadius:0,tension:.2}]},options:{plugins:{legend:{display:!1},tooltip:{callbacks:{title(M){return N(ae(M[0].label),"dd.MM.yyyy HH:mm")}}}},responsive:!0,interaction:{intersect:!1},scales:{x:{display:!0,title:{display:!1,text:"Hour of the day"},ticks:{autoSkip:!0,maxTicksLimit:3,callback(M){const T=this.getLabelForValue(M);return N(T,"dd.MM.yyyy")}},grid:{display:!1},border:{display:!1}},y:{display:!0,title:{display:!1,text:"Number of answers"},ticks:{beginAtZero:!0,stepSize:1,maxTicksLimit:4,autoSkip:!0},border:{display:!1}}}}};n&&n.destroy();var Y=r.getContext("2d");o(6,n=new ne(Y,X))})()},[r,t,d,g,_,u,n,a,i,p,y,w,b]}class ue extends ${constructor(e){super(),x(this,e,ce,fe,ee,{})}}const de=document.getElementById("IndexStatsView");new ue({target:de});
