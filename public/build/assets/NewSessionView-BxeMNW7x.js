import{S as Ue,i as Ae,s as Le,e as Me,a as A,n as ee,d as L,k as he,b as f,g as M,t as S,c as m,h as l,j,l as K,p as ne,m as Se,o as He,u as Re,v as De,w as Ie,x as Ce,z as Pe,f as Ve,r as ot,H as rt,D as ze,y as ut,E as ct,A as at,B as dt,F as Ee}from"./index-DgDIGCFR.js";import{e as ge}from"./each-CvUUWvvD.js";import{s as ft}from"./StatsHelper-B91isISU.js";import{C as _t}from"./auto-C08LIDt6.js";import{f as je}from"./format-Dvme3Z7b.js";import{p as Ne}from"./parseISO-Bm-E8o14.js";import{U as ye}from"./UserSettingsStore-CHRhuN6R.js";function mt(e){let t,n,s,i,o,r,a,b,h,d,_,g,w,k,u,p,C,c,I,v,q,D=Math.round(100*e[5]/e[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",N,y,E,Y,V,le,T,B,O,U=Math.round(100*e[1]/e[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",se,J,H,P,ie,fe,$,oe,_e,re=Math.round(100*e[4]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",me,X,be,x,ue,ke,Z,ce,we,ae=Math.round(100*e[3]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",te,pe,ve,R,G,z,de,Qe,Te,qe=Math.round(100*e[2]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",Ge,Be,Oe,F=e[2]>0&&Fe(e);return{c(){t=f("div"),n=f("div"),s=f("canvas"),i=M(),o=f("div"),r=f("table"),a=f("thead"),b=M(),h=f("tbody"),d=f("tr"),_=f("td"),_.textContent="Questions",g=M(),w=f("td"),k=S(e[6]),u=M(),p=f("tr"),C=f("td"),C.textContent="Answered",c=M(),I=f("td"),v=S(e[5]),q=S(`
                            (`),N=S(D),y=S("%)"),E=M(),Y=f("tr"),V=f("td"),V.textContent="Unanswered",le=M(),T=f("td"),B=S(e[1]),O=S(`
                            (`),se=S(U),J=S("%)"),H=M(),P=f("tr"),ie=f("td"),ie.textContent="Correct",fe=M(),$=f("td"),oe=S(e[4]),_e=S(`
                            (`),me=S(re),X=S("%)"),be=M(),x=f("tr"),ue=f("td"),ue.textContent="Correct with help",ke=M(),Z=f("td"),ce=S(e[3]),we=S(`
                            (`),te=S(ae),pe=S("%)"),ve=M(),R=f("tr"),G=f("td"),G.textContent="Incorrect",z=M(),de=f("td"),Qe=S(e[2]),Te=S(`
                            (`),Ge=S(qe),Be=S("%)"),Oe=M(),F&&F.c(),m(n,"class","col-md-5"),m(w,"class","font-monospace text-end"),m(I,"class","font-monospace text-end"),m(T,"class","font-monospace text-end"),m($,"class","font-monospace text-end"),m(Z,"class","font-monospace text-end"),m(de,"class","font-monospace text-end"),m(r,"class","table"),m(o,"class","col-md-7 mt-3"),m(t,"class","row mb-5")},m(Q,W){A(Q,t,W),l(t,n),l(n,s),e[15](s),l(t,i),l(t,o),l(o,r),l(r,a),l(r,b),l(r,h),l(h,d),l(d,_),l(d,g),l(d,w),l(w,k),l(h,u),l(h,p),l(p,C),l(p,c),l(p,I),l(I,v),l(I,q),l(I,N),l(I,y),l(h,E),l(h,Y),l(Y,V),l(Y,le),l(Y,T),l(T,B),l(T,O),l(T,se),l(T,J),l(h,H),l(h,P),l(P,ie),l(P,fe),l(P,$),l($,oe),l($,_e),l($,me),l($,X),l(h,be),l(h,x),l(x,ue),l(x,ke),l(x,Z),l(Z,ce),l(Z,we),l(Z,te),l(Z,pe),l(h,ve),l(h,R),l(R,G),l(R,z),l(R,de),l(de,Qe),l(de,Te),l(de,Ge),l(de,Be),l(o,Oe),F&&F.m(o,null)},p(Q,W){W&64&&j(k,Q[6]),W&32&&j(v,Q[5]),W&96&&D!==(D=Math.round(100*Q[5]/Q[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(N,D),W&2&&j(B,Q[1]),W&66&&U!==(U=Math.round(100*Q[1]/Q[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(se,U),W&16&&j(oe,Q[4]),W&48&&re!==(re=Math.round(100*Q[4]/Q[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(me,re),W&8&&j(ce,Q[3]),W&40&&ae!==(ae=Math.round(100*Q[3]/Q[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(te,ae),W&4&&j(Qe,Q[2]),W&36&&qe!==(qe=Math.round(100*Q[2]/Q[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(Ge,qe),Q[2]>0?F?F.p(Q,W):(F=Fe(Q),F.c(),F.m(o,null)):F&&(F.d(1),F=null)},d(Q){Q&&L(t),e[15](null),F&&F.d()}}}function pt(e){let t,n,s,i,o,r,a,b;return{c(){t=f("div"),n=f("div"),s=f("p"),i=S("Number of questions in this module: "),o=f("span"),r=f("i"),a=M(),b=S(e[6]),m(r,"class","bi bi-collection"),m(o,"class","badge text-bg-secondary"),m(n,"class","col-md-5"),m(t,"class","row")},m(h,d){A(h,t,d),l(t,n),l(n,s),l(s,i),l(s,o),l(o,r),l(o,a),l(o,b)},p(h,d){d&64&&j(b,h[6])},d(h){h&&L(t)}}}function Fe(e){let t,n,s,i,o,r,a,b,h,d,_=e[2]>=40&&We(e),g=e[2]>=70&&Ye(e);return{c(){t=f("div"),_&&_.c(),n=M(),g&&g.c(),s=M(),i=f("button"),o=f("i"),r=S(" Repeat "),a=S(e[2]),b=S(" incorrect"),m(o,"class","bi bi-repeat"),m(i,"class","btn btn-sm btn-outline-secondary"),m(i,"type","button"),m(t,"class","d-grid gap-2")},m(w,k){A(w,t,k),_&&_.m(t,null),l(t,n),g&&g.m(t,null),l(t,s),l(t,i),l(i,o),l(i,r),l(i,a),l(i,b),h||(d=K(i,"click",ne(e[18])),h=!0)},p(w,k){w[2]>=40?_?_.p(w,k):(_=We(w),_.c(),_.m(t,n)):_&&(_.d(1),_=null),w[2]>=70?g?g.p(w,k):(g=Ye(w),g.c(),g.m(t,s)):g&&(g.d(1),g=null),k&4&&j(a,w[2])},d(w){w&&L(t),_&&_.d(),g&&g.d(),h=!1,d()}}}function We(e){let t,n,s;return{c(){t=f("button"),t.innerHTML='<i class="bi bi-repeat"></i> Repeat 30 incorrect',m(t,"class","btn btn-sm btn-outline-secondary"),m(t,"type","button")},m(i,o){A(i,t,o),n||(s=K(t,"click",ne(e[16])),n=!0)},p:ee,d(i){i&&L(t),n=!1,s()}}}function Ye(e){let t,n,s;return{c(){t=f("button"),t.innerHTML='<i class="bi bi-repeat"></i> Repeat 60 incorrect',m(t,"class","btn btn-sm btn-outline-secondary"),m(t,"type","button")},m(i,o){A(i,t,o),n||(s=K(t,"click",ne(e[17])),n=!0)},p:ee,d(i){i&&L(t),n=!1,s()}}}function ht(e){let t;function n(o,r){return o[6]===o[1]?pt:mt}let s=n(e),i=s(e);return{c(){i.c(),t=Me()},m(o,r){i.m(o,r),A(o,t,r)},p(o,[r]){s===(s=n(o))&&i?i.p(o,r):(i.d(1),i=s(o),i&&(i.c(),i.m(t.parentNode,t)))},i:ee,o:ee,d(o){o&&L(t),i.d(o)}}}function gt(e,t,n){let s,i,o,r,a,b,h,d,_,{questionsInModule:g}=t,{answerChoices:w}=t,{moduleId:k}=t,u,p;function C(D){const N={module_id:k,question_ids:D};axios.post("/api/sessions/newfromquestionids",N).then(function(y){window.location.href="/sessions/"+y.data.id}).catch(function(y){alert(y)})}function c(D){he[D?"unshift":"push"](()=>{p=D,n(0,p)})}const I=()=>C(_.slice(0,30)),v=()=>C(_.slice(0,60)),q=()=>C(_);return e.$$set=D=>{"questionsInModule"in D&&n(9,g=D.questionsInModule),"answerChoices"in D&&n(10,w=D.answerChoices),"moduleId"in D&&n(11,k=D.moduleId)},e.$$.update=()=>{e.$$.dirty&512&&n(14,s=g.filter(D=>!D.is_invalid)),e.$$.dirty&17408&&n(13,i=w.filter(D=>s.some(({id:N})=>N===D.question_id))),e.$$.dirty&16384&&n(6,o=s.length),e.$$.dirty&8192&&n(5,r=i.length),e.$$.dirty&96&&n(1,a=o-r),e.$$.dirty&8192&&n(4,b=i.filter(D=>D.is_correct===1&&D.help_used===0).length),e.$$.dirty&8192&&n(3,h=i.filter(D=>D.is_correct===1&&D.help_used===1).length),e.$$.dirty&8192&&n(2,d=i.filter(D=>D.is_correct===0).length),e.$$.dirty&8192&&n(7,_=i.filter(D=>D.is_correct===0).map(D=>D.question_id)),e.$$.dirty&4127&&p&&(()=>{const D={type:"doughnut",data:{labels:["Correct","Correct with help","Incorrect","Unanswered"],datasets:[{label:"n",data:[b,h,d,a],backgroundColor:["#d4edda","#fff3cd","#f8d7da","#bbbbbb"],hoverOffet:4}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:null},plugins:{legend:{display:!1}}}};u&&u.destroy();var N=p.getContext("2d");n(12,u=new _t(N,D))})()},[p,a,d,h,b,r,o,_,C,g,w,k,u,i,s,c,I,v,q]}class bt extends Ue{constructor(t){super(),Ae(this,t,gt,ht,Le,{questionsInModule:9,answerChoices:10,moduleId:11})}}function Je(e,t,n){const s=e.slice();return s[15]=t[n],s}function Ke(e){let t;return{c(){t=f("p"),t.textContent="Loading ..."},m(n,s){A(n,t,s)},p:ee,d(n){n&&L(t)}}}function kt(e){let t,n=je(Ne(e[15].created_at),"dd.MM.yyyy")+"",s;return{c(){t=f("span"),s=S(n),m(t,"class","badge text-bg-light")},m(i,o){A(i,t,o),l(t,s)},p(i,o){o&16&&n!==(n=je(Ne(i[15].created_at),"dd.MM.yyyy")+"")&&j(s,n)},d(i){i&&L(t)}}}function wt(e){let t,n=je(Ne(e[15].exam_at),"dd.MM.yyyy")+"",s;return{c(){t=f("span"),s=S(n),m(t,"class","badge text-bg-light")},m(i,o){A(i,t,o),l(t,s)},p(i,o){o&16&&n!==(n=je(Ne(i[15].exam_at),"dd.MM.yyyy")+"")&&j(s,n)},d(i){i&&L(t)}}}function Xe(e){let t,n=e[5][e[15].id]+"",s;return{c(){t=new rt(!1),s=Me(),t.a=s},m(i,o){t.m(n,i,o),A(i,s,o)},p(i,o){o&48&&n!==(n=i[5][i[15].id]+"")&&t.p(n)},d(i){i&&(L(s),t.d())}}}function Ze(e){let t,n,s,i,o,r,a,b=e[15].questions.length+"",h,d,_,g,w,k,u,p,C,c=e[15].name+"",I,v,q,D,N,y,E,Y,V,le;function T(H,P){return H[15].exam_at?wt:kt}let B=T(e),O=B(e),U=e[5][e[15].id]&&Xe(e);function se(){return e[12](e[15])}function J(){return e[13](e[15])}return{c(){t=f("div"),n=f("div"),s=f("div"),O.c(),i=M(),o=f("span"),r=f("i"),a=M(),h=S(b),d=M(),U&&U.c(),_=M(),g=f("input"),u=M(),p=f("div"),C=f("h6"),I=S(c),v=M(),q=f("button"),q.innerHTML='<i class="bi bi-rocket-takeoff"></i> New session',D=M(),N=f("a"),y=S("Browse deck"),Y=M(),m(r,"class","bi bi-collection"),m(o,"class","badge text-bg-secondary"),m(o,"title","Number of questions"),m(g,"class","form-check-input float-end"),m(g,"type","checkbox"),g.value="",m(g,"id",w="selected"+e[15].id),g.checked=k=e[3].has(e[15].id),m(s,"class","card-header"),m(C,"class","card-title"),m(q,"type","button"),m(q,"class","btn btn-sm btn-primary"),m(N,"href",E="/decks/"+e[15].id),m(N,"class","card-link"),m(p,"class","card-body"),m(n,"class","card"),m(t,"class","col-lg-6 mb-1")},m(H,P){A(H,t,P),l(t,n),l(n,s),O.m(s,null),l(s,i),l(s,o),l(o,r),l(o,a),l(o,h),l(s,d),U&&U.m(s,null),l(s,_),l(s,g),l(n,u),l(n,p),l(p,C),l(C,I),l(p,v),l(p,q),l(p,D),l(p,N),l(N,y),l(t,Y),V||(le=[K(g,"click",se),K(q,"click",ne(J))],V=!0)},p(H,P){e=H,B===(B=T(e))&&O?O.p(e,P):(O.d(1),O=B(e),O&&(O.c(),O.m(s,i))),P&16&&b!==(b=e[15].questions.length+"")&&j(h,b),e[5][e[15].id]?U?U.p(e,P):(U=Xe(e),U.c(),U.m(s,_)):U&&(U.d(1),U=null),P&16&&w!==(w="selected"+e[15].id)&&m(g,"id",w),P&24&&k!==(k=e[3].has(e[15].id))&&(g.checked=k),P&16&&c!==(c=e[15].name+"")&&j(I,c),P&16&&E!==(E="/decks/"+e[15].id)&&m(N,"href",E)},d(H){H&&L(t),O.d(),U&&U.d(),V=!1,ot(le)}}}function vt(e){let t,n,s,i,o,r,a;function b(u){e[9](u)}function h(u){e[10](u)}function d(u){e[11](u)}let _={};e[0]!==void 0&&(_.moduleId=e[0]),e[7]!==void 0&&(_.questionsInModule=e[7]),e[6]!==void 0&&(_.answerChoices=e[6]),t=new bt({props:_}),he.push(()=>Se(t,"moduleId",b)),he.push(()=>Se(t,"questionsInModule",h)),he.push(()=>Se(t,"answerChoices",d));let g=ge(e[4]),w=[];for(let u=0;u<g.length;u+=1)w[u]=Ze(Je(e,g,u));let k=null;return g.length||(k=Ke()),{c(){He(t.$$.fragment),o=M();for(let u=0;u<w.length;u+=1)w[u].c();r=Me(),k&&k.c()},m(u,p){Re(t,u,p),A(u,o,p);for(let C=0;C<w.length;C+=1)w[C]&&w[C].m(u,p);A(u,r,p),k&&k.m(u,p),a=!0},p(u,[p]){const C={};if(!n&&p&1&&(n=!0,C.moduleId=u[0],De(()=>n=!1)),!s&&p&128&&(s=!0,C.questionsInModule=u[7],De(()=>s=!1)),!i&&p&64&&(i=!0,C.answerChoices=u[6],De(()=>i=!1)),t.$set(C),p&62){g=ge(u[4]);let c;for(c=0;c<g.length;c+=1){const I=Je(u,g,c);w[c]?w[c].p(I,p):(w[c]=Ze(I),w[c].c(),w[c].m(r.parentNode,r))}for(;c<w.length;c+=1)w[c].d(1);w.length=g.length,!g.length&&k?k.p(u,p):g.length?k&&(k.d(1),k=null):(k=Ke(),k.c(),k.m(r.parentNode,r))}},i(u){a||(Ie(t.$$.fragment,u),a=!0)},o(u){Ce(t.$$.fragment,u),a=!1},d(u){u&&(L(o),L(r)),Pe(t,u),Ve(w,u),k&&k.d(u)}}}function St(e,t,n){let s,i,o,{moduleId:r}=t,{createSession:a}=t,{selectDeck:b}=t,{userSelectedDecks:h}=t,d=[],_={};function g(c){if(!c){n(4,d=[]);return}axios.get("/api/decks?module="+c).then(function(I){n(4,d=I.data),d.sort(function(v,q){return v.exam_at===null?1:q.exam_at===null?-1:v.exam_at<q.exam_at})}).catch(function(I){alert(I)})}function w(c){r=c,n(0,r)}function k(c){s=c,n(7,s),n(4,d)}function u(c){i=c,n(6,i),n(8,_),n(4,d)}const p=c=>b(c.id),C=c=>a(c.id);return e.$$set=c=>{"moduleId"in c&&n(0,r=c.moduleId),"createSession"in c&&n(1,a=c.createSession),"selectDeck"in c&&n(2,b=c.selectDeck),"userSelectedDecks"in c&&n(3,h=c.userSelectedDecks)},e.$$.update=()=>{e.$$.dirty&16&&n(7,s=(()=>{var c=[];return d.forEach(I=>c.push(...I.questions)),c})()),e.$$.dirty&16&&(()=>{if(d.length===0)return;const c=d.map(I=>"decks[]="+I.id);axios.get("/api/stats/sessionsfordecks?"+c.join("&")).then(function(I){n(8,_=I.data)}).catch(function(I){alert(I)})})(),e.$$.dirty&256&&n(6,i=(()=>{var c=[];for(const I in _)c.push(..._[I].answer_choices);return c.sort(function(I,v){return I.created_at<v.created_at}),c})()),e.$$.dirty&1&&g(r),e.$$.dirty&272&&n(5,o=(()=>{var c={};if(!_)return c;for(const v of d){if(!_[v.id]){c[v.id]="";continue}const q=_[v.id],D=q.deck.questions.filter(E=>!E.is_invalid),N=q.answer_choices.filter(E=>D.some(({id:Y})=>Y===E.question_id)),y=ft(D.length,N);var I='style="color: #721c24; background-color: #f8d7da;"';y.correct>=60&&(I='style="color: #155724; background-color: #d4edda;"'),c[v.id]="<span "+I+` class="badge" data-bs-toggle="popover" data-bs-title="Popover title" data-bs-content="And here's some..." title="Correct answers in percent">`+y.correct+" %</span>"}return c})())},[r,a,b,h,d,o,i,s,_,w,k,u,p,C]}class Dt extends Ue{constructor(t){super(),Ae(this,t,St,vt,Le,{moduleId:0,createSession:1,selectDeck:2,userSelectedDecks:3})}}function $e(e){let t,n,s,i,o,r,a,b,h,d=e[1].length+"",_,g,w=e[1].length>1?"s":"",k,u,p,C=e[3].length+"",c,I,v=e[3].length>1?"s":"",q,D,N,y,E,Y,V,le,T,B,O,U,se,J,H,P,ie=e[3].length+"",fe,$,oe=e[3].length>1?"s":"",_e,re,me,X,be,x=e[5].length+"",ue,ke,Z=e[5].length>1?"s":"",ce,we,ae,te,pe,ve,R=e[5].length>0&&xe(e);return{c(){t=f("div"),n=f("div"),s=f("div"),i=f("p"),i.textContent="Create your own super deck:",o=M(),r=f("p"),a=S("You have "),b=f("strong"),h=S("selected "),_=S(d),g=S(" deck"),k=S(w),u=S(`
                    with `),p=f("strong"),c=S(C),I=S(" question"),q=S(v),D=M(),R&&R.c(),N=M(),y=f("div"),E=f("label"),E.textContent="Deck Name",Y=M(),V=f("input"),le=M(),T=f("div"),B=f("input"),O=M(),U=f("label"),U.textContent="Filter out duplicates",se=M(),J=f("div"),H=f("button"),P=S("Create deck ("),fe=S(ie),$=S(" question"),_e=S(oe),re=S(")"),me=M(),X=f("button"),be=S("Create deck ("),ue=S(x),ke=S(" image question"),ce=S(Z),we=S(")"),ae=M(),te=f("button"),te.textContent="Cancel",m(E,"for","name"),m(E,"class","form-label"),m(V,"type","text"),m(V,"class","form-control"),m(V,"id","name"),m(y,"class","mb-3"),m(B,"type","checkbox"),m(B,"class","form-check-input"),m(B,"id","checkboxRemoveDuplicates"),m(U,"class","form-check-label"),m(U,"for","checkboxRemoveDuplicates"),m(T,"class","mb-3 form-check"),m(H,"class","btn btn-sm btn-primary"),m(X,"class","btn btn-sm btn-primary"),m(te,"class","btn btn-sm btn-link"),m(J,"class","d-grid gap-2 d-md-block"),m(s,"class","alert alert-light"),m(s,"role","alert"),m(n,"class","col-md"),m(t,"class","row")},m(G,z){A(G,t,z),l(t,n),l(n,s),l(s,i),l(s,o),l(s,r),l(r,a),l(r,b),l(b,h),l(b,_),l(b,g),l(b,k),l(r,u),l(r,p),l(p,c),l(p,I),l(p,q),l(r,D),R&&R.m(r,null),l(s,N),l(s,y),l(y,E),l(y,Y),l(y,V),ze(V,e[4]),l(s,le),l(s,T),l(T,B),B.checked=e[2],l(T,O),l(T,U),l(s,se),l(s,J),l(J,H),l(H,P),l(H,fe),l(H,$),l(H,_e),l(H,re),l(J,me),l(J,X),l(X,be),l(X,ue),l(X,ke),l(X,ce),l(X,we),l(J,ae),l(J,te),pe||(ve=[K(V,"input",e[6]),K(V,"focus",Ct),K(B,"change",e[7]),K(H,"click",ne(e[8])),K(X,"click",ne(e[9])),K(te,"click",ne(e[10]))],pe=!0)},p(G,z){z&2&&d!==(d=G[1].length+"")&&j(_,d),z&2&&w!==(w=G[1].length>1?"s":"")&&j(k,w),z&8&&C!==(C=G[3].length+"")&&j(c,C),z&8&&v!==(v=G[3].length>1?"s":"")&&j(q,v),G[5].length>0?R?R.p(G,z):(R=xe(G),R.c(),R.m(r,null)):R&&(R.d(1),R=null),z&16&&V.value!==G[4]&&ze(V,G[4]),z&4&&(B.checked=G[2]),z&8&&ie!==(ie=G[3].length+"")&&j(fe,ie),z&8&&oe!==(oe=G[3].length>1?"s":"")&&j(_e,oe),z&32&&x!==(x=G[5].length+"")&&j(ue,x),z&32&&Z!==(Z=G[5].length>1?"s":"")&&j(ce,Z)},d(G){G&&L(t),R&&R.d(),pe=!1,ot(ve)}}}function xe(e){let t,n,s=e[5].length+"",i,o,r=e[5].length>1?"s":"",a,b;return{c(){t=S("/ "),n=f("strong"),i=S(s),o=S(" question"),a=S(r),b=S(" with images")},m(h,d){A(h,t,d),A(h,n,d),l(n,i),l(n,o),l(n,a),l(n,b)},p(h,d){d&32&&s!==(s=h[5].length+"")&&j(i,s),d&32&&r!==(r=h[5].length>1?"s":"")&&j(a,r)},d(h){h&&(L(t),L(n))}}}function It(e){let t,n=e[1].length>0&&$e(e);return{c(){n&&n.c(),t=Me()},m(s,i){n&&n.m(s,i),A(s,t,i)},p(s,[i]){s[1].length>0?n?n.p(s,i):(n=$e(s),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:ee,o:ee,d(s){s&&L(t),n&&n.d(s)}}}function et(e,t){var n={name:e,question_ids:t};axios.post("/api/decks",n).then(function(s){window.location.href="/decks/"+s.data.id}).catch(function(s){alert(s)})}const Ct=e=>e.target.select();function Mt(e,t,n){let s,i,{userSelectedDecks:o}=t,r=[],a="My new super deck",b=!0;function h(){if(o.size===0){n(1,r=[]);return}const u=[...o].map(p=>"decks[]="+p);axios.get("/api/decks?"+u.join("&")).then(function(p){n(1,r=p.data)}).catch(function(p){alert(p)})}function d(){a=this.value,n(4,a)}function _(){b=this.checked,n(2,b)}const g=()=>et(a,s.map(u=>u.id)),w=()=>et(a,i.map(u=>u.id)),k=()=>n(0,o=new Set);return e.$$set=u=>{"userSelectedDecks"in u&&n(0,o=u.userSelectedDecks)},e.$$.update=()=>{e.$$.dirty&1&&h(),e.$$.dirty&6&&n(3,s=(()=>{var u=[];return r.forEach(p=>u.push(...p.questions)),b?[...new Map(u.map(p=>[p.id,p])).values()]:u})()),e.$$.dirty&6&&n(5,i=(()=>{var u=[];return r.forEach(p=>{p.questions.forEach(C=>{C.images.length>0&&u.push(C)})}),b?[...new Map(u.map(p=>[p.id,p])).values()]:u})())},[o,r,b,s,a,i,d,_,g,w,k]}class qt extends Ue{constructor(t){super(),Ae(this,t,Mt,It,Le,{userSelectedDecks:0})}}function tt(e,t,n){const s=e.slice();return s[12]=t[n],s}function nt(e,t,n){const s=e.slice();return s[15]=t[n],s}function lt(e){let t,n,s=ge(e[2]),i=[];for(let o=0;o<s.length;o+=1)i[o]=st(nt(e,s,o));return{c(){t=f("ul");for(let o=0;o<i.length;o+=1)i[o].c();n=M(),m(t,"class","list-group m-2 me-0")},m(o,r){A(o,t,r);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(t,null);l(t,n)},p(o,r){if(r&37){s=ge(o[2]);let a;for(a=0;a<s.length;a+=1){const b=nt(o,s,a);i[a]?i[a].p(b,r):(i[a]=st(b),i[a].c(),i[a].m(t,n))}for(;a<i.length;a+=1)i[a].d(1);i.length=s.length}},d(o){o&&L(t),Ve(i,o)}}}function st(e){let t,n=e[15].name+"",s,i,o,r;function a(){return e[9](e[15])}return{c(){t=f("button"),s=S(n),m(t,"class",i="list-group-item list-group-item-action "+(e[0].last_module_id===e[15].id?"list-group-item-secondary":"list-group-item-light"))},m(b,h){A(b,t,h),l(t,s),o||(r=K(t,"click",ne(a)),o=!0)},p(b,h){e=b,h&4&&n!==(n=e[15].name+"")&&j(s,n),h&5&&i!==(i="list-group-item list-group-item-action "+(e[0].last_module_id===e[15].id?"list-group-item-secondary":"list-group-item-light"))&&m(t,"class",i)},d(b){b&&L(t),o=!1,r()}}}function it(e){let t,n=e[12].name+"",s,i,o,r,a,b;function h(){return e[8](e[12])}let d=e[0].last_subject_id===e[12].id&&lt(e);return{c(){t=f("button"),s=S(n),o=M(),d&&d.c(),r=Me(),m(t,"class",i="list-group-item list-group-item-action "+(e[0].last_subject_id===e[12].id?"list-group-item-dark":"list-group-item-light"))},m(_,g){A(_,t,g),l(t,s),A(_,o,g),d&&d.m(_,g),A(_,r,g),a||(b=K(t,"click",ne(h)),a=!0)},p(_,g){e=_,g&2&&n!==(n=e[12].name+"")&&j(s,n),g&3&&i!==(i="list-group-item list-group-item-action "+(e[0].last_subject_id===e[12].id?"list-group-item-dark":"list-group-item-light"))&&m(t,"class",i),e[0].last_subject_id===e[12].id?d?d.p(e,g):(d=lt(e),d.c(),d.m(r.parentNode,r)):d&&(d.d(1),d=null)},d(_){_&&(L(t),L(o),L(r)),d&&d.d(_),a=!1,b()}}}function yt(e){let t;return{c(){t=f("p"),t.textContent="No module selected."},m(n,s){A(n,t,s)},p:ee,i:ee,o:ee,d(n){n&&L(t)}}}function jt(e){let t,n,s;function i(r){e[11](r)}let o={moduleId:e[0].last_module_id,createSession:Ut,selectDeck:e[6]};return e[3]!==void 0&&(o.userSelectedDecks=e[3]),t=new Dt({props:o}),he.push(()=>Se(t,"userSelectedDecks",i)),{c(){He(t.$$.fragment)},m(r,a){Re(t,r,a),s=!0},p(r,a){const b={};a&1&&(b.moduleId=r[0].last_module_id),!n&&a&8&&(n=!0,b.userSelectedDecks=r[3],De(()=>n=!1)),t.$set(b)},i(r){s||(Ie(t.$$.fragment,r),s=!0)},o(r){Ce(t.$$.fragment,r),s=!1},d(r){Pe(t,r)}}}function Nt(e){let t,n,s,i,o,r,a,b,h,d,_,g,w=ge(e[1]),k=[];for(let v=0;v<w.length;v+=1)k[v]=it(tt(e,w,v));function u(v){e[10](v)}let p={};e[3]!==void 0&&(p.userSelectedDecks=e[3]),r=new qt({props:p}),he.push(()=>Se(r,"userSelectedDecks",u));const C=[jt,yt],c=[];function I(v,q){return v[0].last_module_id?0:1}return d=I(e),_=c[d]=C[d](e),{c(){t=f("div"),n=f("div"),s=f("ul");for(let v=0;v<k.length;v+=1)k[v].c();i=M(),o=f("div"),He(r.$$.fragment),b=M(),h=f("div"),_.c(),m(s,"class","list-group"),m(n,"class","col-md-4 mb-2"),m(h,"class","row"),m(o,"class","col-md-8"),m(t,"class","row")},m(v,q){A(v,t,q),l(t,n),l(n,s);for(let D=0;D<k.length;D+=1)k[D]&&k[D].m(s,null);l(t,i),l(t,o),Re(r,o,null),l(o,b),l(o,h),c[d].m(h,null),g=!0},p(v,[q]){if(q&55){w=ge(v[1]);let y;for(y=0;y<w.length;y+=1){const E=tt(v,w,y);k[y]?k[y].p(E,q):(k[y]=it(E),k[y].c(),k[y].m(s,null))}for(;y<k.length;y+=1)k[y].d(1);k.length=w.length}const D={};!a&&q&8&&(a=!0,D.userSelectedDecks=v[3],De(()=>a=!1)),r.$set(D);let N=d;d=I(v),d===N?c[d].p(v,q):(dt(),Ce(c[N],1,1,()=>{c[N]=null}),ut(),_=c[d],_?_.p(v,q):(_=c[d]=C[d](v),_.c()),Ie(_,1),_.m(h,null))},i(v){g||(Ie(r.$$.fragment,v),Ie(_),g=!0)},o(v){Ce(r.$$.fragment,v),Ce(_),g=!1},d(v){v&&L(t),Ve(k,v),Pe(r),c[d].d()}}}function Ut(e){var t={deck_id:e};axios.post("/api/sessions",t).then(function(n){window.location.href="/sessions/"+n.data.id}).catch(function(n){alert(n)})}function At(e,t,n){let s;ct(e,ye,u=>n(0,s=u));let i=[],o=[],r=[],a=new Set;at(()=>{axios.get("/api/modules").then(function(u){var p=u.data;n(7,i=p.filter((c,I,v)=>I===v.findIndex(q=>q.id===c.id)).sort(function(c,I){return c.name>I.name}));var C=i.map(c=>c.subject).filter(c=>!!c);n(1,o=C.filter((c,I,v)=>I===v.findIndex(q=>q.id===c.id)).sort(function(c,I){return c.name>I.name}))}).catch(function(u){alert(u)})});function b(u){var p={last_subject_id:u,last_module_id:0};axios.put("/api/users/me/settings",p).then(function(C){Ee(ye,s.last_subject_id=u,s),Ee(ye,s.last_module_id=0,s)}).catch(function(C){alert(C)})}function h(u){var p={last_module_id:u};axios.put("/api/users/me/settings",p).then(function(C){Ee(ye,s.last_module_id=u,s)}).catch(function(C){alert(C)})}function d(u){a.has(u)?a.delete(u):a.add(u),n(3,a=new Set([...a]))}const _=u=>b(u.id),g=u=>h(u.id);function w(u){a=u,n(3,a)}function k(u){a=u,n(3,a)}return e.$$.update=()=>{e.$$.dirty&129&&(s.last_subject_id,n(2,r=i.filter(u=>s.last_subject_id?u.subject?u.subject.id===s.last_subject_id:!1:!0)))},[s,o,r,a,b,h,d,i,_,g,w,k]}class Lt extends Ue{constructor(t){super(),Ae(this,t,At,Nt,Le,{})}}const Qt=document.getElementById("NewSessionView");new Lt({target:Qt});
