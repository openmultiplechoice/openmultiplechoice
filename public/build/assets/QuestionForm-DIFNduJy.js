import{S as De,i as Ne,s as me,n as ce,d as T,v as re,g as l,h as Z,j as J,a as E,c as o,l as W,f as d,t as ne,b as g,H as ae,k as se,w as Be,x as ze,z as Pe,A as je,p as ee,e as Ge,O as Je,M as he,E as pe,r as Ve,u as Ke,y as Ue,B as Xe,C as Ye,G as fe,I as We,J as be,q as Fe,m as Ze}from"./index-C5hKwDc9.js";import{e as le,u as ge,d as xe,o as $e}from"./each-JoEH9o9l.js";import{_ as ve}from"./lodash-DBMh2b1a.js";import{d as Oe,p as _e}from"./purify.es-CzHI0FGf.js";function et(n){let e,t,s,i,u,p,c,h,A,v,_,b,H,a,y,w,I,S,K,G,B,L,F,O,M,q,k,C,X,Y,U,x,R,D;return{c(){e=d("form"),t=d("div"),s=d("label"),i=ne("Answer text"),p=g(),c=d("input"),A=g(),v=d("trix-editor"),H=g(),a=new ae(!1),y=g(),w=d("div"),I=d("label"),S=ne("Answer hint (optional)"),G=g(),B=d("input"),F=g(),O=d("trix-editor"),k=g(),C=new ae(!1),X=g(),Y=d("div"),U=ne("A hint that will be shown once the user has answered the question."),l(s,"for",u="answerText"+n[0].id),l(s,"class","form-label"),l(c,"id",h="answerText"+n[0].id),l(c,"type","hidden"),J(v,"id",_="editor-answer"+n[0].id),J(v,"class","bg-light trix-content"),J(v,"input",b="answerText"+n[0].id),a.a=null,l(t,"class","mb-3"),l(I,"for",K="answerHint"+n[0].id+"t"),l(I,"class","form-label"),l(B,"id",L="answerHint"+n[0].id),l(B,"type","hidden"),J(O,"id",M="editor-answerHint"+n[0].id),J(O,"class","bg-light trix-content"),J(O,"input",q="answerHint"+n[0].id),C.a=X,l(Y,"id",x="answerHint"+n[0].id),l(Y,"class","form-text"),l(w,"class","mb-3"),l(e,"action","#")},m(r,m){E(r,e,m),o(e,t),o(t,s),o(s,i),o(t,p),o(t,c),Z(c,n[0].text),o(t,A),o(t,v),n[5](v),o(t,H),a.m(n[3],t),o(e,y),o(e,w),o(w,I),o(I,S),o(w,G),o(w,B),Z(B,n[0].hint),o(w,F),o(w,O),n[7](O),o(w,k),C.m(n[3],w),o(w,X),o(w,Y),o(Y,U),R||(D=[W(c,"input",n[4]),W(B,"input",n[6])],R=!0)},p(r,[m]){m&1&&u!==(u="answerText"+r[0].id)&&l(s,"for",u),m&1&&h!==(h="answerText"+r[0].id)&&l(c,"id",h),m&1&&Z(c,r[0].text),m&1&&_!==(_="editor-answer"+r[0].id)&&J(v,"id",_),m&1&&b!==(b="answerText"+r[0].id)&&J(v,"input",b),m&8&&a.p(r[3]),m&1&&K!==(K="answerHint"+r[0].id+"t")&&l(I,"for",K),m&1&&L!==(L="answerHint"+r[0].id)&&l(B,"id",L),m&1&&Z(B,r[0].hint),m&1&&M!==(M="editor-answerHint"+r[0].id)&&J(O,"id",M),m&1&&q!==(q="answerHint"+r[0].id)&&J(O,"input",q),m&8&&C.p(r[3]),m&1&&x!==(x="answerHint"+r[0].id)&&l(Y,"id",x)},i:ce,o:ce,d(r){r&&T(e),n[5](null),n[7](null),R=!1,re(D)}}}function tt(n,e,t){let{answer:s}=e,i,u,p="";function c(a){a.addEventListener("trix-change",function(){t(0,s.text=document.getElementById("answerText"+s.id).value,s),t(0,s.hint=document.getElementById("answerHint"+s.id).value,s),t(3,p='<p class="text-end">Saving ...</p>'),A()})}var h;function A(){h&&h.cancel(),h=Oe(()=>{axios.put("/api/answers/"+s.id,s).then(function(a){t(3,p='<p class="text-end">Saved <span class="text-success-dark">&check;</span></p>')}).catch(function(a){t(3,p='<p class="text-end">Saving ... <span class="text-danger-dark">failed!</span></p>'),alert(a)})},500,{maxWait:2e3}),h()}function v(){s.text=this.value,t(0,s)}function _(a){se[a?"unshift":"push"](()=>{i=a,t(1,i)})}function b(){s.hint=this.value,t(0,s)}function H(a){se[a?"unshift":"push"](()=>{u=a,t(2,u)})}return n.$$set=a=>{"answer"in a&&t(0,s=a.answer)},n.$$.update=()=>{n.$$.dirty&2&&i&&c(i),n.$$.dirty&4&&u&&c(u)},[s,i,u,p,v,_,b,H]}class it extends De{constructor(e){super(),Ne(this,e,tt,et,me,{answer:0})}}function we(n,e,t){const s=n.slice();return s[41]=e[t],s[42]=e,s[43]=t,s}function ke(n,e,t){const s=n.slice();return s[44]=e[t],s}function ye(n,e,t){const s=n.slice();return s[47]=e[t],s}function qe(n){let e,t,s;return{c(){e=d("button"),e.textContent="Close editor",l(e,"type","button"),l(e,"class","btn btn-outline-secondary btn-sm")},m(i,u){E(i,e,u),t||(s=W(e,"click",ee(function(){Je(n[2])&&n[2].apply(this,arguments)})),t=!0)},p(i,u){n=i},d(i){i&&T(e),t=!1,s()}}}function nt(n){let e,t,s,i,u,p,c,h,A,v=le(n[1]),_=[];for(let b=0;b<v.length;b+=1)_[b]=Ce(ye(n,v,b));return{c(){e=d("div"),t=d("div"),s=d("div"),s.innerHTML='<label for="case" class="col-form-label small fw-bold"><i class="bi bi-clipboard2-pulse"></i> CASE</label>',i=g(),u=d("div"),p=d("select"),c=d("option"),c.textContent="Select case";for(let b=0;b<_.length;b+=1)_[b].c();l(s,"class","col-auto"),c.__value="",Z(c,c.__value),l(p,"id","case"),l(p,"class","form-select"),n[9]===void 0&&We(()=>n[24].call(p)),l(u,"class","col-auto"),l(t,"class","row g-3 align-items-center"),l(e,"class","alert alert-light"),l(e,"role","alert")},m(b,H){E(b,e,H),o(e,t),o(t,s),o(t,i),o(t,u),o(u,p),o(p,c);for(let a=0;a<_.length;a+=1)_[a]&&_[a].m(p,null);fe(p,n[9],!0),h||(A=[W(p,"change",n[24]),W(p,"change",n[19])],h=!0)},p(b,H){if(H[0]&3){v=le(b[1]);let a;for(a=0;a<v.length;a+=1){const y=ye(b,v,a);_[a]?_[a].p(y,H):(_[a]=Ce(y),_[a].c(),_[a].m(p,null))}for(;a<_.length;a+=1)_[a].d(1);_.length=v.length}H[0]&514&&fe(p,b[9])},d(b){b&&T(e),Ze(_,b),h=!1,re(A)}}}function lt(n){let e,t,s,i,u=_e.sanitize(n[1].find(n[23]).text)+"",p,c,h,A,v;return{c(){e=d("div"),t=d("p"),t.innerHTML='<i class="bi bi-clipboard2-pulse"></i> CASE',s=g(),i=d("p"),p=g(),c=d("div"),h=d("button"),h.innerHTML='<i class="bi bi-trash"></i> Remove case',l(t,"class","small fw-bold"),l(i,"class","trix-content"),l(e,"class","alert alert-primary m-1"),l(e,"role","alert"),l(h,"type","button"),l(h,"class","btn btn-sm btn-light"),l(h,"title","Remove case"),l(c,"class","text-end m-1")},m(_,b){E(_,e,b),o(e,t),o(e,s),o(e,i),i.innerHTML=u,E(_,p,b),E(_,c,b),o(c,h),A||(v=W(h,"click",ee(n[20])),A=!0)},p(_,b){b[0]&3&&u!==(u=_e.sanitize(_[1].find(_[23]).text)+"")&&(i.innerHTML=u)},d(_){_&&(T(e),T(p),T(c)),A=!1,v()}}}function Ce(n){let e,t=ve.truncate(_e.sanitize(n[47].text,{ALLOWED_TAGS:[]}),{length:30})+"",s,i,u;return{c(){e=d("option"),s=ne(t),e.__value=i=n[47].id,Z(e,e.__value),e.selected=u=n[0].case_id==n[47].id},m(p,c){E(p,e,c),o(e,s)},p(p,c){c[0]&2&&t!==(t=ve.truncate(_e.sanitize(p[47].text,{ALLOWED_TAGS:[]}),{length:30})+"")&&Fe(s,t),c[0]&2&&i!==(i=p[47].id)&&(e.__value=i,Z(e,e.__value)),c[0]&3&&u!==(u=p[0].case_id==p[47].id)&&(e.selected=u)},d(p){p&&T(e)}}}function He(n){let e,t,s,i,u,p,c,h,A,v,_,b,H,a,y,w,I,S,K,G,B,L,F,O,M,q,k,C,X,Y,U,x,R,D,r,m,z,ue,te,$,de,ie,oe,f;function N(Q,j){if(Q[5]&&Q[0].case_id)return lt;if(Q[5]&&Q[1]&&Q[1].length>0)return nt}let P=N(n),V=P&&P(n);return{c(){V&&V.c(),e=g(),t=d("div"),s=d("label"),s.textContent="Question text",i=g(),u=d("input"),p=g(),c=d("trix-editor"),h=g(),A=new ae(!1),v=g(),_=d("div"),b=d("label"),b.textContent="Question hint (optional)",H=g(),a=d("input"),y=g(),w=d("trix-editor"),I=g(),S=new ae(!1),K=g(),G=d("div"),G.textContent="A hint that can be shown to the user if they are stuck.",B=g(),L=d("div"),F=d("label"),F.textContent="Question comment (optional)",O=g(),M=d("input"),q=g(),k=d("trix-editor"),C=g(),X=new ae(!1),Y=g(),U=d("div"),U.textContent=`A comment that will be shown once the user has answered the question.
                It can be used to explain the correct answer or provide additional
                information, for example sources.`,x=g(),R=d("div"),D=d("div"),r=d("input"),m=g(),z=d("label"),z.innerHTML='<i class="bi bi-cone-striped"></i> <strong>Invalid question</strong> - Is the answer unknown or disputed? Invalid questions remain in deck but are not counted into results.',ue=g(),te=d("div"),$=d("input"),de=g(),ie=d("label"),ie.innerHTML='<i class="bi bi-eraser-fill"></i> <strong>Needs review</strong> - Does this question need to be reviewed and improved? Questions marked for review remain in deck and are counted into results.',l(s,"for","questionText"),l(s,"class","form-label"),l(u,"id","questionText"),l(u,"type","hidden"),J(c,"id","editor-questionText"),J(c,"class","bg-light trix-content"),J(c,"input","questionText"),A.a=null,l(t,"class","mt-3 mb-3"),l(b,"for","questionHint"),l(b,"class","form-label"),l(a,"id","questionHint"),l(a,"type","hidden"),J(w,"id","editor-questionHint"),J(w,"class","bg-light trix-content"),J(w,"input","questionHint"),S.a=K,l(G,"id","questionHint"),l(G,"class","form-text"),l(_,"class","mt-3 mb-3"),l(F,"for","questionComment"),l(F,"class","form-label"),l(M,"id","questionComment"),l(M,"type","hidden"),J(k,"id","editor-questionComment"),J(k,"class","bg-light trix-content"),J(k,"input","questionComment"),X.a=Y,l(U,"id","questionHint"),l(U,"class","form-text"),l(L,"class","mt-3 mb-3"),l(r,"type","checkbox"),l(r,"class","form-check-input"),l(r,"id","checkInvalidQuestion"),l(z,"class","form-check-label"),l(z,"for","checkInvalidQuestion"),l(D,"class","form-check mb-3"),l($,"type","checkbox"),l($,"class","form-check-input"),l($,"id","checkNeedsReview"),l(ie,"class","form-check-label"),l(ie,"for","checkNeedsReview"),l(te,"class","form-check"),l(R,"class","mb-3 p-3 bg-light rounded")},m(Q,j){V&&V.m(Q,j),E(Q,e,j),E(Q,t,j),o(t,s),o(t,i),o(t,u),Z(u,n[0].text),o(t,p),o(t,c),n[26](c),o(t,h),A.m(n[10],t),E(Q,v,j),E(Q,_,j),o(_,b),o(_,H),o(_,a),Z(a,n[0].hint),o(_,y),o(_,w),n[28](w),o(_,I),S.m(n[10],_),o(_,K),o(_,G),E(Q,B,j),E(Q,L,j),o(L,F),o(L,O),o(L,M),Z(M,n[0].comment),o(L,q),o(L,k),n[30](k),o(L,C),X.m(n[10],L),o(L,Y),o(L,U),E(Q,x,j),E(Q,R,j),o(R,D),o(D,r),r.checked=n[0].is_invalid,o(D,m),o(D,z),o(R,ue),o(R,te),o(te,$),$.checked=n[0].needs_review,o(te,de),o(te,ie),oe||(f=[W(u,"input",n[25]),W(a,"input",n[27]),W(M,"input",n[29]),W(r,"change",n[31]),W(r,"click",ee(n[21])),W($,"change",n[32]),W($,"click",ee(n[22]))],oe=!0)},p(Q,j){P===(P=N(Q))&&V?V.p(Q,j):(V&&V.d(1),V=P&&P(Q),V&&(V.c(),V.m(e.parentNode,e))),j[0]&1&&Z(u,Q[0].text),j[0]&1024&&A.p(Q[10]),j[0]&1&&Z(a,Q[0].hint),j[0]&1024&&S.p(Q[10]),j[0]&1&&Z(M,Q[0].comment),j[0]&1024&&X.p(Q[10]),j[0]&1&&(r.checked=Q[0].is_invalid),j[0]&1&&($.checked=Q[0].needs_review)},d(Q){Q&&(T(e),T(t),T(v),T(_),T(B),T(L),T(x),T(R)),V&&V.d(Q),n[26](null),n[28](null),n[30](null),oe=!1,re(f)}}}function Te(n){let e;return{c(){e=d("div"),e.innerHTML='<div class="alert alert-warning" role="alert">Don&#39;t forget to set the correct answer!</div>',l(e,"class","col")},m(t,s){E(t,e,s)},d(t){t&&T(e)}}}function Ee(n){let e,t,s=n[44].comment+"",i;return{c(){e=d("div"),t=d("p"),i=ne(s),l(t,"class","card-text"),l(e,"class","card-body")},m(u,p){E(u,e,p),o(e,t),o(t,i)},p(u,p){p[0]&1&&s!==(s=u[44].comment+"")&&Fe(i,s)},d(u){u&&T(e)}}}function Ae(n,e){let t,s,i,u,p,c,h,A,v,_,b;function H(){return e[33](e[44])}let a=e[44].comment&&Ee(e);return{key:n,first:null,c(){t=d("div"),s=d("div"),i=d("div"),u=d("button"),u.innerHTML='<i class="bi bi-trash"></i>',p=g(),c=d("img"),A=g(),a&&a.c(),v=g(),l(u,"type","button"),l(u,"class","btn btn-sm btn-light"),l(i,"class","card-header bg-transparent"),he(c.src,h="/"+e[44].path)||l(c,"src",h),l(c,"class","card-img-top"),l(c,"alt",""),l(s,"class","card"),pe(s,"width","18rem"),l(t,"class","col"),this.first=t},m(y,w){E(y,t,w),o(t,s),o(s,i),o(i,u),o(s,p),o(s,c),o(s,A),a&&a.m(s,null),o(t,v),_||(b=W(u,"click",ee(H)),_=!0)},p(y,w){e=y,w[0]&1&&!he(c.src,h="/"+e[44].path)&&l(c,"src",h),e[44].comment?a?a.p(e,w):(a=Ee(e),a.c(),a.m(s,null)):a&&(a.d(1),a=null)},d(y){y&&T(t),a&&a.d(),_=!1,b()}}}function Le(n){let e,t,s,i,u;function p(){return n[35](n[41])}return{c(){e=d("button"),t=d("i"),l(t,"class","bi bi-check-lg"),l(e,"type","button"),l(e,"class",s="btn btn-sm "+(n[11]===n[41].id?"btn-success":"btn-light")),l(e,"title","Set as correct answer")},m(c,h){E(c,e,h),o(e,t),i||(u=W(e,"click",ee(p)),i=!0)},p(c,h){n=c,h[0]&2049&&s!==(s="btn btn-sm "+(n[11]===n[41].id?"btn-success":"btn-light"))&&l(e,"class",s)},d(c){c&&T(e),i=!1,u()}}}function Se(n,e){let t,s,i,u,p,c,h,A,v,_;function b(w){e[34](w,e[41],e[42],e[43])}let H={};e[41]!==void 0&&(H.answer=e[41]),s=new it({props:H}),se.push(()=>Ve(s,"answer",b));let a=e[0].type==="mc"&&Le(e);function y(){return e[36](e[41])}return{key:n,first:null,c(){t=d("div"),Ye(s.$$.fragment),u=g(),p=d("div"),a&&a.c(),c=g(),h=d("button"),h.innerHTML='<i class="bi bi-trash"></i>',l(h,"type","button"),l(h,"class","btn btn-sm btn-light"),l(h,"title","Delete answer"),l(p,"class","text-end mb-2"),l(t,"class","mt-3 mb-1 px-3 pt-2 pb-1 bg-light-subtle rounded"),pe(t,"border","2px dotted "+(e[11]===e[41].id?"green":"lightgray")),this.first=t},m(w,I){E(w,t,I),Xe(s,t,null),o(t,u),o(t,p),a&&a.m(p,null),o(p,c),o(p,h),A=!0,v||(_=W(h,"click",ee(y)),v=!0)},p(w,I){e=w;const S={};!i&&I[0]&1&&(i=!0,S.answer=e[41],Ue(()=>i=!1)),s.$set(S),e[0].type==="mc"?a?a.p(e,I):(a=Le(e),a.c(),a.m(p,c)):a&&(a.d(1),a=null),I[0]&2049&&pe(t,"border","2px dotted "+(e[11]===e[41].id?"green":"lightgray"))},i(w){A||(ze(s.$$.fragment,w),A=!0)},o(w){Be(s.$$.fragment,w),A=!1},d(w){w&&T(t),Ke(s),a&&a.d(),v=!1,_()}}}function Me(n){let e,t,s;return{c(){e=d("button"),e.textContent="Add answer",l(e,"class","btn btn-sm btn-primary")},m(i,u){E(i,e,u),t||(s=W(e,"click",n[16]),t=!0)},p:ce,d(i){i&&T(e),t=!1,s()}}}function Qe(n){let e,t,s,i,u,p,c,h,A,v,_,b,H,a,y,w,I,S,K,G,B,L,F,O,M=(n[0].answers.length<=1||n[0].type==="card")&&Ie(n),q=n[3]&&Re(n);return{c(){e=d("div"),e.innerHTML='<div class="col"><div class="mt-5 mb-5 border-dark" style="border-bottom: dotted; border-width: 1px;"></div></div>',t=g(),s=d("div"),i=d("div"),u=d("span"),u.textContent="ID",p=g(),c=d("input"),A=g(),v=d("div"),_=d("div"),_.innerHTML='<label for="questionType" class="col-form-label fw-bold">Question type:</label>',b=g(),H=d("div"),a=d("select"),M&&M.c(),y=d("option"),w=ne("mc"),K=g(),G=d("div"),G.innerHTML=`<span id="questionTypeHelp" class="form-text">Can be either multiple choice (MC) or card (CARD). <strong>Card Questions
                    can have only one or no answer.</strong></span>`,B=g(),q&&q.c(),L=Ge(),l(e,"class","row"),l(u,"class","input-group-text"),l(c,"type","text"),l(c,"class","form-control"),c.value=h=n[0].id,c.disabled=!0,c.readOnly=!0,l(i,"class","input-group mb-3"),l(_,"class","col-auto"),y.__value="mc",Z(y,y.__value),y.selected=I=n[0].type=="mc",l(a,"id","questionType"),l(a,"class","form-select font-monospace text-uppercase"),a.disabled=S=n[0].answers.length>1,n[0].type===void 0&&We(()=>n[37].call(a)),l(H,"class","col-auto"),l(G,"class","col-auto"),l(v,"class","row g-3 align-items-center"),l(s,"class","alert alert-light"),l(s,"role","alert")},m(k,C){E(k,e,C),E(k,t,C),E(k,s,C),o(s,i),o(i,u),o(i,p),o(i,c),o(s,A),o(s,v),o(v,_),o(v,b),o(v,H),o(H,a),M&&M.m(a,null),o(a,y),o(y,w),fe(a,n[0].type,!0),o(v,K),o(v,G),E(k,B,C),q&&q.m(k,C),E(k,L,C),F||(O=[W(a,"change",n[37]),W(a,"change",n[18])],F=!0)},p(k,C){C[0]&1&&h!==(h=k[0].id)&&c.value!==h&&(c.value=h),k[0].answers.length<=1||k[0].type==="card"?M?M.p(k,C):(M=Ie(k),M.c(),M.m(a,y)):M&&(M.d(1),M=null),C[0]&1&&I!==(I=k[0].type=="mc")&&(y.selected=I),C[0]&1&&S!==(S=k[0].answers.length>1)&&(a.disabled=S),C[0]&1&&fe(a,k[0].type),k[3]?q?q.p(k,C):(q=Re(k),q.c(),q.m(L.parentNode,L)):q&&(q.d(1),q=null)},d(k){k&&(T(e),T(t),T(s),T(B),T(L)),M&&M.d(),q&&q.d(k),F=!1,re(O)}}}function Ie(n){let e,t,s;return{c(){e=d("option"),t=ne("card"),e.__value="card",Z(e,e.__value),e.selected=s=n[0].type=="card"},m(i,u){E(i,e,u),o(e,t)},p(i,u){u[0]&1&&s!==(s=i[0].type=="card")&&(e.selected=s)},d(i){i&&T(e)}}}function Re(n){let e,t,s,i,u,p;return{c(){e=d("div"),t=d("p"),t.innerHTML="<strong>Delete question?</strong> Deleting a question will also delete all associated answers and images.",s=g(),i=d("button"),i.innerHTML='<i class="bi bi-trash"></i> Delete question',l(i,"type","button"),l(i,"class","btn btn-sm btn-danger"),l(e,"class","alert alert-light"),l(e,"role","alert")},m(c,h){E(c,e,h),o(e,t),o(e,s),o(e,i),u||(p=W(i,"click",ee(n[38])),u=!0)},p:ce,d(c){c&&T(e),u=!1,p()}}}function st(n){let e,t,s=n[0].id,i,u,p,c,h,A,v,_,b,H,a,y=[],w=new Map,I,S=[],K=new Map,G,B,L,F,O,M,q=n[2]&&qe(n),k=He(n),C=!n[11]&&n[0].type==="mc"&&Te(),X=le(n[0].images);const Y=r=>r[44].id;for(let r=0;r<X.length;r+=1){let m=ke(n,X,r),z=Y(m);w.set(z,y[r]=Ae(z,m))}let U=le(n[0].answers);const x=r=>r[41].id;for(let r=0;r<U.length;r+=1){let m=we(n,U,r),z=x(m);K.set(z,S[r]=Se(z,m))}let R=(n[0].type==="mc"||n[0].answers.length===0)&&Me(n),D=n[4]&&Qe(n);return{c(){e=d("form"),q&&q.c(),t=g(),k.c(),i=g(),u=d("div"),p=d("label"),p.textContent="Add image",c=g(),h=d("input"),v=g(),_=d("div"),_.textContent="Supported formats are JPEG, PNG, and WebP.",b=g(),C&&C.c(),H=g(),a=d("div");for(let r=0;r<y.length;r+=1)y[r].c();I=g();for(let r=0;r<S.length;r+=1)S[r].c();G=g(),R&&R.c(),B=g(),D&&D.c(),L=Ge(),l(p,"for","image"),l(p,"class","form-label"),l(h,"class","form-control"),l(h,"type","file"),l(h,"accept","image/jpeg, image/png, image/webp"),l(h,"id",A="imageInput"+n[0].id),l(h,"name","image"),l(_,"id","imageHelp"),l(_,"class","form-text"),l(u,"class","mb-3"),l(e,"action","#"),l(e,"class","mt-3"),l(a,"class","row row-cols-1 row-cols-lg-3 g4")},m(r,m){E(r,e,m),q&&q.m(e,null),o(e,t),k.m(e,null),o(e,i),o(e,u),o(u,p),o(u,c),o(u,h),o(u,v),o(u,_),E(r,b,m),C&&C.m(r,m),E(r,H,m),E(r,a,m);for(let z=0;z<y.length;z+=1)y[z]&&y[z].m(a,null);E(r,I,m);for(let z=0;z<S.length;z+=1)S[z]&&S[z].m(r,m);E(r,G,m),R&&R.m(r,m),E(r,B,m),D&&D.m(r,m),E(r,L,m),F=!0,O||(M=[W(h,"input",n[14]),W(e,"submit",ee(n[13]))],O=!0)},p(r,m){r[2]?q?q.p(r,m):(q=qe(r),q.c(),q.m(e,t)):q&&(q.d(1),q=null),m[0]&1&&me(s,s=r[0].id)?(k.d(1),k=He(r),k.c(),k.m(e,i)):k.p(r,m),(!F||m[0]&1&&A!==(A="imageInput"+r[0].id))&&l(h,"id",A),!r[11]&&r[0].type==="mc"?C||(C=Te(),C.c(),C.m(H.parentNode,H)):C&&(C.d(1),C=null),m[0]&32769&&(X=le(r[0].images),y=ge(y,m,Y,1,r,X,w,a,xe,Ae,null,ke)),m[0]&137217&&(U=le(r[0].answers),Pe(),S=ge(S,m,x,1,r,U,K,G.parentNode,$e,Se,G,we),je()),r[0].type==="mc"||r[0].answers.length===0?R?R.p(r,m):(R=Me(r),R.c(),R.m(B.parentNode,B)):R&&(R.d(1),R=null),r[4]?D?D.p(r,m):(D=Qe(r),D.c(),D.m(L.parentNode,L)):D&&(D.d(1),D=null)},i(r){if(!F){for(let m=0;m<U.length;m+=1)ze(S[m]);F=!0}},o(r){for(let m=0;m<S.length;m+=1)Be(S[m]);F=!1},d(r){r&&(T(e),T(b),T(H),T(a),T(I),T(G),T(B),T(L)),q&&q.d(),k.d(r),C&&C.d(r);for(let m=0;m<y.length;m+=1)y[m].d();for(let m=0;m<S.length;m+=1)S[m].d(r);R&&R.d(r),D&&D.d(r),O=!1,re(M)}}}function ot(n,e,t){let s,{question:i}=e,{cases:u}=e,{toggleEditor:p}=e,{handleQuestionRemove:c}=e,{showConfigEditor:h=!1}=e,{showCaseSelector:A=!1}=e,v,_,b,H,a="";function y(f){f.addEventListener("trix-change",function(){t(0,i.text=document.getElementById("questionText").value,i),t(0,i.comment=document.getElementById("questionComment").value,i),t(0,i.hint=document.getElementById("questionHint").value,i),t(10,a='<p class="text-end">Saving ...</p>'),S()})}function w(f){f!==i.correct_answer_id&&(t(0,i.correct_answer_id=f,i),axios.put("/api/questions/"+i.id,i).then(function(N){}).catch(function(N){alert(N)}))}var I;function S(){I&&I.cancel(),I=Oe(()=>{axios.put("/api/questions/"+i.id,i).then(function(f){t(10,a='<p class="text-end">Saved <span class="text-success-dark">&check;</span></p>')}).catch(function(f){t(10,a='<p class="text-end">Saving ... <span class="text-danger-dark">failed!</span></p>'),alert(f)})},500,{maxWait:2e3}),I()}function K(){var f=new FormData,N=document.getElementById("imageInput"+i.id);f.set("image",N.files[0]),axios.post("/api/questions/"+i.id+"/images",f,{headers:{"Content-Type":"multipart/form-data"}}).then(function(P){N.value="";var V=P.data;t(0,i.images=[...i.images,V],i)}).catch(function(P){N.value="",alert(P)})}function G(f){axios.delete("/api/images/"+f).then(function(N){t(0,i.images=i.images.filter(P=>P.id!==f),i)}).catch(function(N){alert(N)})}function B(){axios.post("/api/questions/"+i.id+"/answers",{}).then(function(f){t(0,i.answers=[...i.answers,f.data],i)}).catch(function(f){alert(f)})}function L(f){axios.delete("/api/answers/"+f).then(function(N){t(0,i.answers=i.answers.filter(P=>P.id!==f),i)}).catch(function(N){alert(N)})}function F(){axios.put("/api/questions/"+i.id,{type:i.type==="mc"?"mc":"card"}).then(function(f){t(0,i.type=f.data.type,i)}).catch(function(f){alert(f)})}function O(){axios.put("/api/questions/"+i.id,{case_id:H}).then(function(f){t(0,i.case_id=f.data.case_id,i);const N=u.find(P=>P.id===f.data.case_id);t(0,i.case=N,i),N.questions||(N.questions=[]),N.questions.push({id:i.id,case_id:N.id})}).catch(function(f){alert(f)})}function M(){axios.put("/api/questions/"+i.id,{case_id:null}).then(function(f){t(0,i.case_id=null,i),t(0,i.case=null,i),u.map(N=>{N.questions=N.questions.filter(P=>P.id!==i.id)})}).catch(function(f){alert(f)})}function q(){axios.put("/api/questions/"+i.id,{is_invalid:!i.is_invalid}).then(function(f){t(0,i.is_invalid=!i.is_invalid,i)}).catch(function(f){alert(f)})}function k(){axios.put("/api/questions/"+i.id,{needs_review:!i.needs_review}).then(function(f){t(0,i.needs_review=!i.needs_review,i)}).catch(function(f){alert(f)})}const C=f=>f.id===i.case_id;function X(){H=be(this),t(9,H),t(0,i),t(1,u)}function Y(){i.text=this.value,t(0,i)}function U(f){se[f?"unshift":"push"](()=>{v=f,t(6,v)})}function x(){i.hint=this.value,t(0,i)}function R(f){se[f?"unshift":"push"](()=>{b=f,t(8,b)})}function D(){i.comment=this.value,t(0,i)}function r(f){se[f?"unshift":"push"](()=>{_=f,t(7,_)})}function m(){i.is_invalid=this.checked,t(0,i)}function z(){i.needs_review=this.checked,t(0,i)}const ue=f=>{confirm("Are you sure you want to delete this image?")&&G(f.id)};function te(f,N,P,V){P[V]=f,t(0,i)}const $=f=>{w(f.id)},de=f=>{confirm("Are you sure you want to delete this answer?")&&L(f.id)};function ie(){i.type=be(this),t(0,i)}const oe=()=>{confirm("Are you sure you want to delete this question?")&&c(i.id)};return n.$$set=f=>{"question"in f&&t(0,i=f.question),"cases"in f&&t(1,u=f.cases),"toggleEditor"in f&&t(2,p=f.toggleEditor),"handleQuestionRemove"in f&&t(3,c=f.handleQuestionRemove),"showConfigEditor"in f&&t(4,h=f.showConfigEditor),"showCaseSelector"in f&&t(5,A=f.showCaseSelector)},n.$$.update=()=>{n.$$.dirty[0]&1&&t(11,s=i.correct_answer_id),n.$$.dirty[0]&64&&v&&y(v),n.$$.dirty[0]&128&&_&&y(_),n.$$.dirty[0]&256&&b&&y(b),n.$$.dirty[0]&1&&(i.case?t(9,H=i.case.id):t(9,H=""))},[i,u,p,c,h,A,v,_,b,H,a,s,w,S,K,G,B,L,F,O,M,q,k,C,X,Y,U,x,R,D,r,m,z,ue,te,$,de,ie,oe]}class ct extends De{constructor(e){super(),Ne(this,e,ot,st,me,{question:0,cases:1,toggleEditor:2,handleQuestionRemove:3,showConfigEditor:4,showCaseSelector:5},null,[-1,-1])}}export{ct as Q};
