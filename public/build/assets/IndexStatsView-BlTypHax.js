import{d as ft,p as gt,s as b,n as st,a as m,g as t,f as l,c as e,b as rt,t as M,m as U,i as a,e as i,h as ht,k as yt,u as Z,q as xt}from"./render-CYeZSKAW.js";import{o as kt,a as wt}from"./index-client-Dbvf6pRw.js";import{i as _}from"./if-CpEGQhVh.js";import{e as $,p as G,i as J}from"./event-modifiers-Bgjah3RO.js";import{h as V}from"./html-DxqZuNW-.js";import{a as K}from"./attributes-BHpBkK0Q.js";import{b as St}from"./this-YKSURJA9.js";import{r as qt}from"./legacy-client-DCyKqh61.js";import{c as Q}from"./NewSessionHelper-Ba9jtPTo.js";import{C as Lt}from"./auto-sRkgK8jz.js";import{f as W,p as It}from"./parseISO-NWqeT_ov.js";var Et=l('<span class="badge text-bg-light font-monospace" title="Number of questions"><i class="bi bi-collection"></i> <!></span>'),Nt=l('<div class="alert alert-light mx-1 my-2 p-1 text-truncate small" role="alert"><!> <button type="button" class="btn btn-sm btn-primary"><i class="bi bi-rocket-takeoff"></i></button> <a class="alert-link text-decoration-none"> </a></div>'),Ct=l('<div class="col-lg mt-3 text-truncate"><h6>New decks</h6> <!></div>'),Dt=l('<span class="badge text-bg-light font-monospace" title="Number of questions"><i class="bi bi-collection"></i> <!></span>'),Ht=l('<span class="badge text-bg-light font-monospace" title="Number of sessions"><i class="bi bi-rocket"></i> <!></span>'),At=l('<div class="alert alert-light mx-1 my-2 p-1 text-truncate small" role="alert"><!> <!> <button type="button" class="btn btn-sm btn-primary"><i class="bi bi-rocket-takeoff"></i></button> <a class="alert-link text-decoration-none"> </a></div>'),Bt=l('<div class="col-lg mt-3 text-truncate"><h6> </h6> <!></div>'),Mt=l('<span class="badge text-bg-light font-monospace" title="Number of questions"><i class="bi bi-collection"></i> <!></span>'),Ut=l('<div class="alert alert-light mx-1 my-2 p-1 text-truncate small" role="alert"><!> <button type="button" class="btn btn-sm btn-primary"><i class="bi bi-rocket-takeoff"></i></button> <a class="alert-link text-decoration-none"> </a></div>'),jt=l('<div class="col-lg mt-3 text-truncate"><h6>Last used decks</h6> <!></div>'),Ot=l('<div class="row"><!> <!> <!></div>'),Vt=l('<div class="d-flex justify-content-center mt-3 mb-3"><div class="spinner-border text-secondary" role="status"><span class="visually-hidden">Loading stats ...</span></div></div>'),Pt=l('<div class="alert alert-light text-center" role="alert"><i class="bi bi-cone-striped"></i> No stats available yet</div>'),Tt=l('<div class="row"><div class="col-md"><h4>Stats</h4></div></div> <!> <div id="stats" class="row mt-3 p-3"><div class="col-md"><canvas style="max-height: 300px;"></canvas></div></div> <div class="row"><div class="col-md"><span class="badge text-bg-light text-muted"> </span></div></div>',1);function Rt(it,ot){gt(ot,!0);let j=b(void 0),P=b(void 0),X,T=b(void 0),O=b(st({})),R=b(st({})),k=b(void 0),w=b(void 0),z=b(0),S=b(void 0);kt(()=>{Y(),X=setInterval(Y,120*1e3)}),wt(()=>{clearInterval(X)});function Y(){axios.get("/api/stats/activity").then(function(s){const r=s.data;m(O,r.answers_byhour,!0),m(R,r.users_byhour,!0),m(k,r.decks_new,!0),m(w,r.decks_popular,!0),m(z,r.decks_popular_timespan,!0),m(S,r.decks_last_used,!0),m(T,new Date,!0)}).catch(function(s){console.log(s)})}qt(()=>{t(j)&&t(O)&&t(R)&&(()=>{const s=Object.keys(t(O)),r=Object.values(t(O));if(r.reduce((o,p)=>o+p,0)===0){document.getElementById("stats").style.display="none";return}document.getElementById("stats").style.display="block";const C={type:"line",data:{labels:s,datasets:[{label:"Answers",data:r,backgroundColor:"rgba(255, 205, 86, 0.4)",borderColor:"rgba(255, 205, 86, 0.4)",fill:!0,showLine:!1,pointRadius:0,tension:.2},{label:"Users",data:Object.values(t(R)),backgroundColor:"rgba(54, 162, 235, 0.7)",borderColor:"rgba(54, 162, 235, 0.7)",fill:!0,showLine:!1,pointRadius:0,tension:.2}]},options:{plugins:{legend:{display:!1},tooltip:{callbacks:{title(o){return W(It(o[0].label),"dd.MM.yyyy HH:mm")}}}},responsive:!0,interaction:{intersect:!1},scales:{x:{display:!0,title:{display:!1,text:"Hour of the day"},ticks:{autoSkip:!0,maxTicksLimit:3,callback(o){const p=this.getLabelForValue(o);return W(p,"dd.MM.yyyy")}},grid:{display:!1},border:{display:!1}},y:{display:!0,title:{display:!1,text:"Number of answers"},ticks:{beginAtZero:!0,stepSize:1,maxTicksLimit:3,autoSkip:!0},border:{display:!1}}}}};t(P)&&t(P).destroy();var q=t(j).getContext("2d");m(P,new Lt(q,C),!0)})()});var tt=Tt(),at=e(rt(tt),2);{var nt=s=>{var r=Ot(),N=a(r);{var C=c=>{var f=Ct(),L=e(a(f),2);$(L,17,()=>t(k),J,(D,d)=>{var y=Nt(),v=a(y);{var I=n=>{var x=Et(),E=e(a(x),2);V(E,()=>t(d).questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")),i(n,x)};_(v,n=>{t(d).questions.length>0&&n(I)})}var g=e(v,2),H=Z(()=>G(()=>Q(t(d).id)));g.__click=function(...n){t(H)?.apply(this,n)};var h=e(g,2),A=a(h);M(()=>{K(h,"href",`/decks/${t(d).id??""}`),U(A,t(d).name)}),i(D,y)}),i(c,f)};_(N,c=>{t(k).length>0&&c(C)})}var q=e(N,2);{var o=c=>{var f=Bt(),L=a(f),D=a(L),d=e(L,2);$(d,17,()=>t(w),J,(y,v)=>{var I=At(),g=a(I);{var H=u=>{var B=Dt(),F=e(a(B),2);V(F,()=>t(v).questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")),i(u,B)};_(g,u=>{t(v).questions.length>0&&u(H)})}var h=e(g,2);{var A=u=>{var B=Ht(),F=e(a(B),2);V(F,()=>t(v).sessions_count.toString().padEnd(3," ").replace(/ /g,"&nbsp;")),i(u,B)};_(h,u=>{t(v).sessions_count&&u(A)})}var n=e(h,2),x=Z(()=>G(()=>Q(t(v).id)));n.__click=function(...u){t(x)?.apply(this,u)};var E=e(n,2),_t=a(E);M(()=>{K(E,"href",`/decks/${t(v).id??""}`),U(_t,t(v).name)}),i(y,I)}),M(()=>U(D,`Popular decks (last ${t(z)??""} days)`)),i(c,f)};_(q,c=>{t(w).length>0&&t(z)&&c(o)})}var p=e(q,2);{var mt=c=>{var f=jt(),L=e(a(f),2);$(L,17,()=>t(S),J,(D,d)=>{var y=Ut(),v=a(y);{var I=n=>{var x=Mt(),E=e(a(x),2);V(E,()=>t(d).questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")),i(n,x)};_(v,n=>{t(d).questions.length>0&&n(I)})}var g=e(v,2),H=Z(()=>G(()=>Q(t(d).id)));g.__click=function(...n){t(H)?.apply(this,n)};var h=e(g,2),A=a(h);M(()=>{K(h,"href",`/decks/${t(d).id??""}`),U(A,t(d).name)}),i(D,y)}),i(c,f)};_(p,c=>{t(S).length>0&&c(mt)})}i(s,r)},lt=s=>{var r=yt(),N=rt(r);{var C=o=>{var p=Vt();i(o,p)},q=o=>{var p=Pt();i(o,p)};_(N,o=>{!t(k)&&!t(w)&&!t(S)?o(C):o(q,!1)},!0)}i(s,r)};_(at,s=>{t(k)&&t(w)&&t(S)&&(t(k).length>0||t(w).length>0||t(S).length>0)?s(nt):s(lt,!1)})}var et=e(at,2),dt=a(et),vt=a(dt);St(vt,s=>m(j,s),()=>t(j));var ct=e(et,2),pt=a(ct),ut=a(pt),bt=a(ut);M(s=>U(bt,`Last updated: ${s??""}`),[()=>t(T)?W(t(T),"HH:mm"):"unknown"]),i(it,tt),ht()}ft(["click"]);const zt=document.getElementById("IndexStatsView");xt(Rt,{target:zt});
