import{S as je,i as Ae,s as Pe,e as we,b as A,n as $,d as P,k as ve,c as f,a as I,t as v,f as _,h as n,q as Q,l as J,p as ie,o as ue,B as Re,C as bt,H as gt,r as qe,u as Te,j as Le,G as ht,I as Xe,v as Be,w as Ue,D as Ke,y as de,z as We,x as fe,A as Ve,m as Ye,J as vt,K as wt,L as Oe}from"./index-CW_84yAU.js";import{e as be,u as Dt,o as St}from"./each-23V_io8F.js";import{C as Mt}from"./auto-TbvzFur0.js";import{s as Ct}from"./StatsHelper-B91isISU.js";import{c as It}from"./NewSessionHelper-Ba9jtPTo.js";import{f as Qe,p as Ge}from"./parseISO-JEmvXouO.js";import{U as He}from"./UserSettingsStore-D7Gisc9d.js";function yt(l){let e,s,t,i,o,c,a,r,u,d,m,w,b,g,p,k,y,h,L,D,C,q=Math.round(100*l[6]/l[7]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",j,M,N,G,O,T,B,x,Y,le=Math.round(100*l[2]/l[7]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",Z,E,z,H,R,U,S,V,oe,se=Math.round(100*l[5]/l[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",De,ge,Se,_e,Me,ne,ce,me,Ce,he=Math.round(100*l[4]/l[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",pe,Ie,Ne,ke,re,ye,ae,X,W,F=Math.round(100*l[3]/l[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",Ee,Fe,Je,ee=l[3]>0&&Ze(l);return{c(){e=f("div"),s=f("div"),t=f("canvas"),i=I(),o=f("div"),c=f("table"),a=f("thead"),r=I(),u=f("tbody"),d=f("tr"),m=f("td"),m.textContent="Questions",w=I(),b=f("td"),g=v(l[7]),p=I(),k=f("tr"),y=f("td"),y.textContent="Answered",h=I(),L=f("td"),D=v(l[6]),C=v(`
                            (`),j=v(q),M=v("%)"),N=I(),G=f("tr"),O=f("td"),O.textContent="Unanswered",T=I(),B=f("td"),x=v(l[2]),Y=v(`
                            (`),Z=v(le),E=v("%)"),z=I(),H=f("tr"),R=f("td"),R.textContent="Correct",U=I(),S=f("td"),V=v(l[5]),oe=v(`
                            (`),De=v(se),ge=v("%)"),Se=I(),_e=f("tr"),Me=f("td"),Me.textContent="Correct with help",ne=I(),ce=f("td"),me=v(l[4]),Ce=v(`
                            (`),pe=v(he),Ie=v("%)"),Ne=I(),ke=f("tr"),re=f("td"),re.textContent="Incorrect",ye=I(),ae=f("td"),X=v(l[3]),W=v(`
                            (`),Ee=v(F),Fe=v("%)"),Je=I(),ee&&ee.c(),_(s,"class","col-md-5"),_(b,"class","font-monospace text-end"),_(L,"class","font-monospace text-end"),_(B,"class","font-monospace text-end"),_(S,"class","font-monospace text-end"),_(ce,"class","font-monospace text-end"),_(ae,"class","font-monospace text-end"),_(c,"class","table"),_(o,"class","col-md-7 mt-3"),_(e,"class","row mb-5")},m(K,te){A(K,e,te),n(e,s),n(s,t),l[14](t),n(e,i),n(e,o),n(o,c),n(c,a),n(c,r),n(c,u),n(u,d),n(d,m),n(d,w),n(d,b),n(b,g),n(u,p),n(u,k),n(k,y),n(k,h),n(k,L),n(L,D),n(L,C),n(L,j),n(L,M),n(u,N),n(u,G),n(G,O),n(G,T),n(G,B),n(B,x),n(B,Y),n(B,Z),n(B,E),n(u,z),n(u,H),n(H,R),n(H,U),n(H,S),n(S,V),n(S,oe),n(S,De),n(S,ge),n(u,Se),n(u,_e),n(_e,Me),n(_e,ne),n(_e,ce),n(ce,me),n(ce,Ce),n(ce,pe),n(ce,Ie),n(u,Ne),n(u,ke),n(ke,re),n(ke,ye),n(ke,ae),n(ae,X),n(ae,W),n(ae,Ee),n(ae,Fe),n(o,Je),ee&&ee.m(o,null)},p(K,te){te&128&&Q(g,K[7]),te&64&&Q(D,K[6]),te&192&&q!==(q=Math.round(100*K[6]/K[7]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&Q(j,q),te&4&&Q(x,K[2]),te&132&&le!==(le=Math.round(100*K[2]/K[7]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&Q(Z,le),te&32&&Q(V,K[5]),te&96&&se!==(se=Math.round(100*K[5]/K[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&Q(De,se),te&16&&Q(me,K[4]),te&80&&he!==(he=Math.round(100*K[4]/K[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&Q(pe,he),te&8&&Q(X,K[3]),te&72&&F!==(F=Math.round(100*K[3]/K[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&Q(Ee,F),K[3]>0?ee?ee.p(K,te):(ee=Ze(K),ee.c(),ee.m(o,null)):ee&&(ee.d(1),ee=null)},d(K){K&&P(e),l[14](null),ee&&ee.d()}}}function Lt(l){let e,s,t,i,o,c,a,r;return{c(){e=f("div"),s=f("div"),t=f("p"),i=v("Number of questions (duplicates included): "),o=f("span"),c=f("i"),a=I(),r=v(l[7]),_(c,"class","bi bi-collection"),_(o,"class","badge text-bg-light font-monospace"),_(s,"class","col-md"),_(e,"class","row")},m(u,d){A(u,e,d),n(e,s),n(s,t),n(t,i),n(t,o),n(o,c),n(o,a),n(o,r)},p(u,d){d&128&&Q(r,u[7])},d(u){u&&P(e)}}}function Ze(l){let e,s,t,i,o,c,a,r,u,d,m=l[3]>=40&&$e(l),w=l[3]>=70&&xe(l);return{c(){e=f("div"),m&&m.c(),s=I(),w&&w.c(),t=I(),i=f("button"),o=f("i"),c=v(" Repeat "),a=v(l[3]),r=v(" incorrect"),_(o,"class","bi bi-repeat"),_(i,"class","btn btn-sm btn-outline-secondary"),_(i,"type","button"),_(e,"class","d-grid gap-2")},m(b,g){A(b,e,g),m&&m.m(e,null),n(e,s),w&&w.m(e,null),n(e,t),n(e,i),n(i,o),n(i,c),n(i,a),n(i,r),u||(d=J(i,"click",ie(l[17])),u=!0)},p(b,g){b[3]>=40?m?m.p(b,g):(m=$e(b),m.c(),m.m(e,s)):m&&(m.d(1),m=null),b[3]>=70?w?w.p(b,g):(w=xe(b),w.c(),w.m(e,t)):w&&(w.d(1),w=null),g&8&&Q(a,b[3])},d(b){b&&P(e),m&&m.d(),w&&w.d(),u=!1,d()}}}function $e(l){let e,s,t;return{c(){e=f("button"),e.innerHTML='<i class="bi bi-repeat"></i> Repeat 30 incorrect',_(e,"class","btn btn-sm btn-outline-secondary"),_(e,"type","button")},m(i,o){A(i,e,o),s||(t=J(e,"click",ie(l[15])),s=!0)},p:$,d(i){i&&P(e),s=!1,t()}}}function xe(l){let e,s,t;return{c(){e=f("button"),e.innerHTML='<i class="bi bi-repeat"></i> Repeat 60 incorrect',_(e,"class","btn btn-sm btn-outline-secondary"),_(e,"type","button")},m(i,o){A(i,e,o),s||(t=J(e,"click",ie(l[16])),s=!0)},p:$,d(i){i&&P(e),s=!1,t()}}}function qt(l){let e;function s(o,c){if(o[0]&&o[7]===o[2])return Lt;if(o[0])return yt}let t=s(l),i=t&&t(l);return{c(){i&&i.c(),e=we()},m(o,c){i&&i.m(o,c),A(o,e,c)},p(o,[c]){t===(t=s(o))&&i?i.p(o,c):(i&&i.d(1),i=t&&t(o),i&&(i.c(),i.m(e.parentNode,e)))},i:$,o:$,d(o){o&&P(e),i&&i.d(o)}}}function Ut(l,e,s){let t,i,o,c,a,r,u,{decks:d}=e,{moduleId:m}=e,w=[],b=[],g,p;function k(C){const q={module_id:m,question_ids:C};axios.post("/api/sessions/newfromquestionids",q).then(function(j){window.location.href="/sessions/"+j.data.id}).catch(function(j){alert(j)})}function y(C){ve[C?"unshift":"push"](()=>{p=C,s(1,p)})}const h=()=>k(u.slice(0,30)),L=()=>k(u.slice(0,60)),D=()=>k(u);return l.$$set=C=>{"decks"in C&&s(0,d=C.decks),"moduleId"in C&&s(10,m=C.moduleId)},l.$$.update=()=>{l.$$.dirty&2049&&(()=>{if(!d)return;const C=d.map(j=>j.questions).flat();s(11,w=C.filter(j=>!j.is_invalid));const q=[];for(const j of d){const M=j.sessions.sort((G,O)=>O.id-G.id);if(M.length===0)continue;const N=M[0];q.push(...N.answer_choices)}s(12,b=q.filter(j=>w.some(({id:M})=>M===j.question_id)))})(),l.$$.dirty&2048&&s(7,t=w.length),l.$$.dirty&4096&&s(6,i=b.length),l.$$.dirty&192&&s(2,o=t-i),l.$$.dirty&4096&&s(5,c=b.filter(C=>C.is_correct&&!C.help_used).length),l.$$.dirty&4096&&s(4,a=b.filter(C=>C.is_correct&&C.help_used).length),l.$$.dirty&4096&&s(3,r=b.filter(C=>!C.is_correct).length),l.$$.dirty&4096&&s(8,u=b.filter(C=>!C.is_correct).map(C=>C.question_id)),l.$$.dirty&8254&&p&&(()=>{const C={type:"doughnut",data:{labels:["Correct","Correct with help","Incorrect","Unanswered"],datasets:[{label:"n",data:[c,a,r,o],backgroundColor:["#d4edda","#fff3cd","#f8d7da","#bbbbbb"],hoverOffet:4}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:null},plugins:{legend:{display:!1}}}};g&&g.destroy();var q=p.getContext("2d");s(13,g=new Mt(q,C))})()},[d,p,o,r,a,c,i,t,u,k,m,w,b,g,y,h,L,D]}class Nt extends je{constructor(e){super(),Ae(this,e,Ut,qt,Pe,{decks:0,moduleId:10})}}function jt(l){let e,s=Qe(Ge(l[0].created_at),"dd.MM.yyyy")+"",t;return{c(){e=f("span"),t=v(s),_(e,"class","badge text-bg-light")},m(i,o){A(i,e,o),n(e,t)},p(i,o){o&1&&s!==(s=Qe(Ge(i[0].created_at),"dd.MM.yyyy")+"")&&Q(t,s)},d(i){i&&P(e)}}}function At(l){let e,s=Qe(Ge(l[0].exam_at),"dd.MM.yyyy")+"",t;return{c(){e=f("span"),t=v(s),_(e,"class","badge text-bg-light")},m(i,o){A(i,e,o),n(e,t)},p(i,o){o&1&&s!==(s=Qe(Ge(i[0].exam_at),"dd.MM.yyyy")+"")&&Q(t,s)},d(i){i&&P(e)}}}function et(l){let e,s,t,i=l[0].sessions.length+"",o;return{c(){e=f("span"),s=f("i"),t=I(),o=v(i),_(s,"class","bi bi-rocket"),_(e,"class","badge text-bg-light font-monospace"),_(e,"title","Number of sessions")},m(c,a){A(c,e,a),n(e,s),n(e,t),n(e,o)},p(c,a){a&1&&i!==(i=c[0].sessions.length+"")&&Q(o,i)},d(c){c&&P(e)}}}function tt(l){let e,s;return{c(){e=new gt(!1),s=we(),e.a=s},m(t,i){e.m(l[3],t,i),A(t,s,i)},p(t,i){i&8&&e.p(t[3])},d(t){t&&(P(s),e.d())}}}function Pt(l){let e,s,t,i,o,c,a,r=l[0].questions.length+"",u,d,m,w,b,g,p,k,y,h,L,D,C,q=l[0].name+"",j,M,N,G,O,T,B,x,Y;function le(R,U){return R[0].exam_at?At:jt}let Z=le(l),E=Z(l),z=l[0].sessions&&et(l),H=l[3]&&tt(l);return{c(){e=f("div"),s=f("div"),t=f("div"),E.c(),i=I(),o=f("span"),c=f("i"),a=I(),u=v(r),d=I(),z&&z.c(),m=I(),H&&H.c(),w=I(),b=f("button"),g=f("i"),g.innerHTML="",p=I(),k=f("input"),L=I(),D=f("div"),C=f("h6"),j=v(q),M=I(),N=f("button"),N.innerHTML='<i class="bi bi-rocket-takeoff"></i> Start session',G=I(),O=f("a"),T=v("Browse deck"),_(c,"class","bi bi-collection"),_(o,"class","badge text-bg-light font-monospace"),_(o,"title","Number of questions"),ue(g,"bi-bookmark-check-fill",l[4]),ue(g,"bi-bookmark",!l[4]),_(b,"class","btn btn-sm btn-link"),_(k,"type","checkbox"),_(k,"class","form-check-input float-end"),k.value="",_(k,"id",y="selected"+l[0].id),k.checked=h=l[2].has(l[0].id),_(t,"class","card-header"),_(C,"class","card-title"),_(N,"type","button"),_(N,"class","btn btn-sm btn-primary"),_(O,"href",B="/decks/"+l[0].id),_(O,"class","card-link"),_(D,"class","card-body"),_(s,"class","card"),_(e,"class","col-lg-6 mb-1")},m(R,U){A(R,e,U),n(e,s),n(s,t),E.m(t,null),n(t,i),n(t,o),n(o,c),n(o,a),n(o,u),n(t,d),z&&z.m(t,null),n(t,m),H&&H.m(t,null),n(t,w),n(t,b),n(b,g),n(t,p),n(t,k),n(s,L),n(s,D),n(D,C),n(C,j),n(D,M),n(D,N),n(D,G),n(D,O),n(O,T),x||(Y=[J(b,"click",l[5]),J(k,"click",l[6]),J(N,"click",ie(l[7]))],x=!0)},p(R,[U]){Z===(Z=le(R))&&E?E.p(R,U):(E.d(1),E=Z(R),E&&(E.c(),E.m(t,i))),U&1&&r!==(r=R[0].questions.length+"")&&Q(u,r),R[0].sessions?z?z.p(R,U):(z=et(R),z.c(),z.m(t,m)):z&&(z.d(1),z=null),R[3]?H?H.p(R,U):(H=tt(R),H.c(),H.m(t,w)):H&&(H.d(1),H=null),U&16&&ue(g,"bi-bookmark-check-fill",R[4]),U&16&&ue(g,"bi-bookmark",!R[4]),U&1&&y!==(y="selected"+R[0].id)&&_(k,"id",y),U&5&&h!==(h=R[2].has(R[0].id))&&(k.checked=h),U&1&&q!==(q=R[0].name+"")&&Q(j,q),U&1&&B!==(B="/decks/"+R[0].id)&&_(O,"href",B)},i:$,o:$,d(R){R&&P(e),E.d(),z&&z.d(),H&&H.d(),x=!1,Re(Y)}}}function Ht(l,e,s){let{deck:t}=e,{selectDeck:i}=e,{selectedDecks:o}=e,c,a=t.bookmarks.length>0;bt(()=>{const m=t.questions.filter(k=>!k.is_invalid),w=t.sessions.sort((k,y)=>y.id-k.id);if(w.length===0)return;const g=w[0].answer_choices.filter(k=>m.some(({id:y})=>y===k.question_id)),p=Ct(m.length,g);p.correct>=60?s(3,c='<span style="color: #155724; background-color: #d4edda;" class="badge" title="Correct answers in percent">'+p.correct+" %</span>"):s(3,c='<span style="color: #721c24; background-color: #f8d7da;" class="badge" title="Correct answers in percent">'+p.correct+" %</span>")});function r(){a?axios.delete("/api/decks/"+t.id+"/bookmark/"+t.bookmarks[0].id).then(function(m){m.status===204&&s(4,a=!1)}).catch(function(m){alert(m)}):axios.post("/api/decks/"+t.id+"/bookmark").then(function(m){m.status===200&&(s(4,a=!0),s(0,t.bookmarks=[m.data],t))}).catch(function(m){alert(m)})}const u=()=>i(t.id),d=()=>It(t.id);return l.$$set=m=>{"deck"in m&&s(0,t=m.deck),"selectDeck"in m&&s(1,i=m.selectDeck),"selectedDecks"in m&&s(2,o=m.selectedDecks)},[t,i,o,c,a,r,u,d]}class Qt extends je{constructor(e){super(),Ae(this,e,Ht,Pt,Pe,{deck:0,selectDeck:1,selectedDecks:2})}}function lt(l,e,s){const t=l.slice();return t[17]=e[s],t}function st(l,e,s){const t=l.slice();return t[20]=e[s],t[21]=e,t[22]=s,t}function Gt(l){let e;return{c(){e=f("div"),e.innerHTML='<div class="spinner-border text-secondary" role="status"><span class="visually-hidden">Loading decks ...</span></div>',_(e,"class","d-flex justify-content-center")},m(s,t){A(s,e,t)},p:$,i:$,o:$,d(s){s&&P(e)}}}function Rt(l){let e=[],s=new Map,t,i,o=be(l[3]);const c=r=>r[20].id;for(let r=0;r<o.length;r+=1){let u=st(l,o,r),d=c(u);s.set(d,e[r]=it(d,u))}let a=null;return o.length||(a=nt()),{c(){for(let r=0;r<e.length;r+=1)e[r].c();t=we(),a&&a.c()},m(r,u){for(let d=0;d<e.length;d+=1)e[d]&&e[d].m(r,u);A(r,t,u),a&&a.m(r,u),i=!0},p(r,u){u&14&&(o=be(r[3]),Ke(),e=Dt(e,u,c,1,r,o,s,t.parentNode,St,it,t,st),We(),!o.length&&a?a.p(r,u):o.length?a&&(a.d(1),a=null):(a=nt(),a.c(),a.m(t.parentNode,t)))},i(r){if(!i){for(let u=0;u<o.length;u+=1)fe(e[u]);i=!0}},o(r){for(let u=0;u<e.length;u+=1)de(e[u]);i=!1},d(r){r&&P(t);for(let u=0;u<e.length;u+=1)e[u].d(r);a&&a.d(r)}}}function nt(l){let e;return{c(){e=f("div"),e.innerHTML='<div class="alert alert-light">No decks found! Create a new deck <a href="/decks" class="alert-link">here</a>.</div> ',_(e,"class","col")},m(s,t){A(s,e,t)},p:$,d(s){s&&P(e)}}}function it(l,e){let s,t,i,o,c;function a(d){e[11](d,e[20],e[21],e[22])}function r(d){e[12](d)}let u={selectDeck:e[2]};return e[20]!==void 0&&(u.deck=e[20]),e[1]!==void 0&&(u.selectedDecks=e[1]),t=new Qt({props:u}),ve.push(()=>qe(t,"deck",a)),ve.push(()=>qe(t,"selectedDecks",r)),{key:l,first:null,c(){s=we(),Te(t.$$.fragment),this.first=s},m(d,m){A(d,s,m),Be(t,d,m),c=!0},p(d,m){e=d;const w={};m&4&&(w.selectDeck=e[2]),!i&&m&8&&(i=!0,w.deck=e[20],Ue(()=>i=!1)),!o&&m&2&&(o=!0,w.selectedDecks=e[1],Ue(()=>o=!1)),t.$set(w)},i(d){c||(fe(t.$$.fragment,d),c=!0)},o(d){de(t.$$.fragment,d),c=!1},d(d){d&&P(s),Ve(t,d)}}}function ot(l){let e,s,t,i,o,c=l[5].from+"",a,r,u,d=l[5].to+"",m,w,b,g=l[5].total+"",p,k,y,h=l[5].last_page>1&&ct(l);return{c(){e=f("div"),s=f("div"),t=f("p"),i=v("Showing "),o=f("span"),a=v(c),r=v(`
                to `),u=f("span"),m=v(d),w=v(`
                of `),b=f("span"),p=v(g),k=v(" decks"),y=I(),h&&h.c(),_(o,"class","fw-semibold"),_(u,"class","fw-semibold"),_(b,"class","fw-semibold"),_(t,"class","small text-muted"),_(s,"class","col"),_(e,"class","row sticky-bottom bg-white mt-3 pt-3")},m(L,D){A(L,e,D),n(e,s),n(s,t),n(t,i),n(t,o),n(o,a),n(t,r),n(t,u),n(u,m),n(t,w),n(t,b),n(b,p),n(t,k),n(e,y),h&&h.m(e,null)},p(L,D){D&32&&c!==(c=L[5].from+"")&&Q(a,c),D&32&&d!==(d=L[5].to+"")&&Q(m,d),D&32&&g!==(g=L[5].total+"")&&Q(p,g),L[5].last_page>1?h?h.p(L,D):(h=ct(L),h.c(),h.m(e,null)):h&&(h.d(1),h=null)},d(L){L&&P(e),h&&h.d()}}}function ct(l){let e,s,t,i,o,c,a,r,u,d,m,w=be(l[5].links.slice(1,l[5].links.length-1)),b=[];for(let g=0;g<w.length;g+=1)b[g]=at(lt(l,w,g));return{c(){e=f("div"),s=f("nav"),t=f("ul"),i=f("li"),o=f("button"),o.textContent="‹",c=I();for(let g=0;g<b.length;g+=1)b[g].c();a=I(),r=f("li"),u=f("button"),u.textContent="›",_(o,"class","page-link"),_(i,"class","page-item"),ue(i,"disabled",l[5].prev_page_url===null),_(u,"class","page-link"),_(r,"class","page-item"),ue(r,"disabled",l[5].next_page_url===null),_(t,"class","pagination"),_(e,"class","col")},m(g,p){A(g,e,p),n(e,s),n(s,t),n(t,i),n(i,o),n(t,c);for(let k=0;k<b.length;k+=1)b[k]&&b[k].m(t,null);n(t,a),n(t,r),n(r,u),d||(m=[J(o,"click",ie(l[13])),J(u,"click",ie(l[15]))],d=!0)},p(g,p){if(p&32&&ue(i,"disabled",g[5].prev_page_url===null),p&160){w=be(g[5].links.slice(1,g[5].links.length-1));let k;for(k=0;k<w.length;k+=1){const y=lt(g,w,k);b[k]?b[k].p(y,p):(b[k]=at(y),b[k].c(),b[k].m(t,a))}for(;k<b.length;k+=1)b[k].d(1);b.length=w.length}p&32&&ue(r,"disabled",g[5].next_page_url===null)},d(g){g&&P(e),Ye(b,g),d=!1,Re(m)}}}function at(l){let e,s,t=l[17].label+"",i,o,c;function a(){return l[14](l[17])}return{c(){e=f("li"),s=f("button"),i=v(t),_(s,"class","page-link"),_(e,"class","page-item d-none d-sm-block"),ue(e,"disabled",l[17].active||!l[17].url)},m(r,u){A(r,e,u),n(e,s),n(s,i),o||(c=J(s,"click",ie(a)),o=!0)},p(r,u){l=r,u&32&&t!==(t=l[17].label+"")&&Q(i,t),u&32&&ue(e,"disabled",l[17].active||!l[17].url)},d(r){r&&P(e),o=!1,c()}}}function Tt(l){let e,s,t,i,o,c,a,r,u,d,m,w,b,g,p,k,y,h,L,D,C,q,j,M,N,G,O,T,B,x,Y;function le(S){l[9](S)}function Z(S){l[10](S)}let E={};l[3]!==void 0&&(E.decks=l[3]),l[0]!==void 0&&(E.moduleId=l[0]),D=new Nt({props:E}),ve.push(()=>qe(D,"decks",le)),ve.push(()=>qe(D,"moduleId",Z));const z=[Rt,Gt],H=[];function R(S,V){return S[3]?0:1}N=R(l),G=H[N]=z[N](l);let U=l[5]&&l[5].total>0&&ot(l);return{c(){e=f("div"),s=f("div"),t=f("div"),i=f("span"),i.innerHTML='<i class="bi bi-archive"></i>',o=I(),c=f("select"),a=f("option"),r=v("Main decks"),d=f("option"),m=v("Your decks"),b=f("option"),g=v("User decks"),k=f("option"),y=v("Bookmarked decks"),L=I(),Te(D.$$.fragment),j=I(),M=f("div"),G.c(),O=I(),U&&U.c(),T=we(),_(i,"class","input-group-text"),a.__value="public-rw-listed",Le(a,a.__value),a.selected=u=l[4]==="public-rw-listed",d.__value="user",Le(d,d.__value),d.selected=w=l[4]==="user",b.__value="public",Le(b,b.__value),b.selected=p=l[4]==="public",k.__value="bookmarked",Le(k,k.__value),k.selected=h=l[4]==="bookmarked",_(c,"id","kind"),_(c,"class","form-select"),l[4]===void 0&&ht(()=>l[8].call(c)),_(t,"class","input-group"),_(s,"class","col"),_(e,"class","row mb-3"),_(M,"class","row")},m(S,V){A(S,e,V),n(e,s),n(s,t),n(t,i),n(t,o),n(t,c),n(c,a),n(a,r),n(c,d),n(d,m),n(c,b),n(b,g),n(c,k),n(k,y),Xe(c,l[4],!0),A(S,L,V),Be(D,S,V),A(S,j,V),A(S,M,V),H[N].m(M,null),A(S,O,V),U&&U.m(S,V),A(S,T,V),B=!0,x||(Y=[J(c,"change",l[8]),J(c,"change",l[6])],x=!0)},p(S,[V]){(!B||V&16&&u!==(u=S[4]==="public-rw-listed"))&&(a.selected=u),(!B||V&16&&w!==(w=S[4]==="user"))&&(d.selected=w),(!B||V&16&&p!==(p=S[4]==="public"))&&(b.selected=p),(!B||V&16&&h!==(h=S[4]==="bookmarked"))&&(k.selected=h),V&16&&Xe(c,S[4]);const oe={};!C&&V&8&&(C=!0,oe.decks=S[3],Ue(()=>C=!1)),!q&&V&1&&(q=!0,oe.moduleId=S[0],Ue(()=>q=!1)),D.$set(oe);let se=N;N=R(S),N===se?H[N].p(S,V):(Ke(),de(H[se],1,1,()=>{H[se]=null}),We(),G=H[N],G?G.p(S,V):(G=H[N]=z[N](S),G.c()),fe(G,1),G.m(M,null)),S[5]&&S[5].total>0?U?U.p(S,V):(U=ot(S),U.c(),U.m(T.parentNode,T)):U&&(U.d(1),U=null)},i(S){B||(fe(D.$$.fragment,S),fe(G),B=!0)},o(S){de(D.$$.fragment,S),de(G),B=!1},d(S){S&&(P(e),P(L),P(j),P(M),P(O),P(T)),Ve(D,S),H[N].d(),U&&U.d(S),x=!1,Re(Y)}}}function ze(l){return new URLSearchParams(window.location.search).get(l)}function Bt(l,e,s){let{moduleId:t}=e,{selectDeck:i}=e,{selectedDecks:o}=e,c,a=ze("kind")??"public-rw-listed",r=ze("page")??1,u;function d(){if(!t){s(3,c=[]);return}s(3,c=void 0);const D=new URL(window.location);D.searchParams.set("module",t),D.searchParams.set("kind",a),D.searchParams.set("page",r),window.history.replaceState({},"",D),axios.get("/api/decks?module="+t+"&kind="+a+"&page="+r).then(function(C){s(5,u=C.data),s(3,c=u.data),c.sort(function(q,j){return q.exam_at===null||j.exam_at===null?q.id<j.id?1:q.id>j.id?-1:0:q.exam_at<j.exam_at?1:q.exam_at>j.exam_at?-1:0})}).catch(function(C){alert(C)})}function m(D){r=D,d()}function w(){a=vt(this),s(4,a)}function b(D){c=D,s(3,c)}function g(D){t=D,s(0,t)}function p(D,C,q,j){q[j]=D,s(3,c)}function k(D){o=D,s(1,o)}const y=()=>{u.prev_page_url&&m(u.current_page-1)},h=D=>{D.url&&m(D.label)},L=()=>{u.next_page_url&&m(u.current_page+1)};return l.$$set=D=>{"moduleId"in D&&s(0,t=D.moduleId),"selectDeck"in D&&s(2,i=D.selectDeck),"selectedDecks"in D&&s(1,o=D.selectedDecks)},l.$$.update=()=>{l.$$.dirty&1&&(r=ze("page")??1,d())},[t,o,i,c,a,u,d,m,w,b,g,p,k,y,h,L]}class Vt extends je{constructor(e){super(),Ae(this,e,Bt,Tt,Pe,{moduleId:0,selectDeck:2,selectedDecks:1})}}function ut(l){let e,s,t,i,o,c,a,r,u,d=l[1].length+"",m,w,b=l[1].length>1?"s":"",g,p,k,y=l[3].length+"",h,L,D=l[3].length>1?"s":"",C,q,j,M=l[2]?"excluded":"included",N,G,O,T,B,x,Y,le,Z,E,z,H,R,U,S,V,oe=l[3].length+"",se,De,ge=l[3].length>1?"s":"",Se,_e,Me,ne,ce,me=l[5].length+"",Ce,he,pe=l[5].length>1?"s":"",Ie,Ne,ke,re,ye,ae,X=l[5].length>0&&rt(l);return{c(){e=f("div"),s=f("div"),t=f("div"),i=f("p"),i.textContent="Create your own super deck:",o=I(),c=f("p"),a=v("You have "),r=f("strong"),u=v("selected "),m=v(d),w=v(" deck"),g=v(b),p=v(`
                    with `),k=f("strong"),h=v(y),L=v(" question"),C=v(D),q=I(),X&&X.c(),j=v(`
                    (duplicates `),N=v(M),G=v(")"),O=I(),T=f("div"),B=f("label"),B.textContent="Deck Name",x=I(),Y=f("input"),le=I(),Z=f("div"),E=f("input"),z=I(),H=f("label"),H.textContent="Filter out duplicates",R=I(),U=f("div"),S=f("button"),V=v("Create deck ("),se=v(oe),De=v(" question"),Se=v(ge),_e=v(")"),Me=I(),ne=f("button"),ce=v("Create deck ("),Ce=v(me),he=v(" image question"),Ie=v(pe),Ne=v(")"),ke=I(),re=f("button"),re.textContent="Cancel",_(B,"for","name"),_(B,"class","form-label"),_(Y,"type","text"),_(Y,"class","form-control"),_(Y,"id","name"),_(T,"class","mb-3"),_(E,"type","checkbox"),_(E,"class","form-check-input"),_(E,"id","checkboxRemoveDuplicates"),_(H,"class","form-check-label"),_(H,"for","checkboxRemoveDuplicates"),_(Z,"class","mb-3 form-check"),_(S,"class","btn btn-sm btn-primary"),_(ne,"class","btn btn-sm btn-primary"),_(re,"class","btn btn-sm btn-link"),_(U,"class","d-grid gap-2 d-md-block"),_(t,"class","alert alert-light"),_(t,"role","alert"),_(s,"class","col-md"),_(e,"class","row")},m(W,F){A(W,e,F),n(e,s),n(s,t),n(t,i),n(t,o),n(t,c),n(c,a),n(c,r),n(r,u),n(r,m),n(r,w),n(r,g),n(c,p),n(c,k),n(k,h),n(k,L),n(k,C),n(c,q),X&&X.m(c,null),n(c,j),n(c,N),n(c,G),n(t,O),n(t,T),n(T,B),n(T,x),n(T,Y),Le(Y,l[4]),n(t,le),n(t,Z),n(Z,E),E.checked=l[2],n(Z,z),n(Z,H),n(t,R),n(t,U),n(U,S),n(S,V),n(S,se),n(S,De),n(S,Se),n(S,_e),n(U,Me),n(U,ne),n(ne,ce),n(ne,Ce),n(ne,he),n(ne,Ie),n(ne,Ne),n(U,ke),n(U,re),ye||(ae=[J(Y,"input",l[6]),J(Y,"focus",Ot),J(E,"change",l[7]),J(S,"click",ie(l[8])),J(ne,"click",ie(l[9])),J(re,"click",ie(l[10]))],ye=!0)},p(W,F){F&2&&d!==(d=W[1].length+"")&&Q(m,d),F&2&&b!==(b=W[1].length>1?"s":"")&&Q(g,b),F&8&&y!==(y=W[3].length+"")&&Q(h,y),F&8&&D!==(D=W[3].length>1?"s":"")&&Q(C,D),W[5].length>0?X?X.p(W,F):(X=rt(W),X.c(),X.m(c,j)):X&&(X.d(1),X=null),F&4&&M!==(M=W[2]?"excluded":"included")&&Q(N,M),F&16&&Y.value!==W[4]&&Le(Y,W[4]),F&4&&(E.checked=W[2]),F&8&&oe!==(oe=W[3].length+"")&&Q(se,oe),F&8&&ge!==(ge=W[3].length>1?"s":"")&&Q(Se,ge),F&32&&me!==(me=W[5].length+"")&&Q(Ce,me),F&32&&pe!==(pe=W[5].length>1?"s":"")&&Q(Ie,pe)},d(W){W&&P(e),X&&X.d(),ye=!1,Re(ae)}}}function rt(l){let e,s,t=l[5].length+"",i,o,c=l[5].length>1?"s":"",a,r;return{c(){e=v("/ "),s=f("strong"),i=v(t),o=v(" question"),a=v(c),r=v(" with images")},m(u,d){A(u,e,d),A(u,s,d),n(s,i),n(s,o),n(s,a),n(s,r)},p(u,d){d&32&&t!==(t=u[5].length+"")&&Q(i,t),d&32&&c!==(c=u[5].length>1?"s":"")&&Q(a,c)},d(u){u&&(P(e),P(s))}}}function Et(l){let e,s=l[1].length>0&&ut(l);return{c(){s&&s.c(),e=we()},m(t,i){s&&s.m(t,i),A(t,e,i)},p(t,[i]){t[1].length>0?s?s.p(t,i):(s=ut(t),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null)},i:$,o:$,d(t){t&&P(e),s&&s.d(t)}}}function dt(l,e){var s={name:l,question_ids:e};axios.post("/api/decks",s).then(function(t){window.location.href="/decks/"+t.data.id}).catch(function(t){alert(t)})}const Ot=l=>l.target.select();function zt(l,e,s){let t,i,{selectedDecks:o}=e,c=[],a="My new super deck",r=!0;function u(){if(o.size===0){s(1,c=[]);return}const p=[...o].map(k=>"decks[]="+k);axios.get("/api/decks?"+p.join("&")).then(function(k){s(1,c=k.data)}).catch(function(k){alert(k)})}function d(){a=this.value,s(4,a)}function m(){r=this.checked,s(2,r)}const w=()=>dt(a,t.map(p=>p.id)),b=()=>dt(a,i.map(p=>p.id)),g=()=>s(0,o=new Set);return l.$$set=p=>{"selectedDecks"in p&&s(0,o=p.selectedDecks)},l.$$.update=()=>{l.$$.dirty&1&&u(),l.$$.dirty&6&&s(3,t=(()=>{var p=[];return c.forEach(k=>p.push(...k.questions)),r?[...new Map(p.map(k=>[k.id,k])).values()]:p})()),l.$$.dirty&6&&s(5,i=(()=>{var p=[];return c.forEach(k=>{k.questions.forEach(y=>{y.images.length>0&&p.push(y)})}),r?[...new Map(p.map(k=>[k.id,k])).values()]:p})())},[o,c,r,t,a,i,d,m,w,b,g]}class Kt extends je{constructor(e){super(),Ae(this,e,zt,Et,Pe,{selectedDecks:0})}}function ft(l,e,s){const t=l.slice();return t[12]=e[s],t}function _t(l,e,s){const t=l.slice();return t[15]=e[s],t}function mt(l){let e,s,t=be(l[2]),i=[];for(let o=0;o<t.length;o+=1)i[o]=pt(_t(l,t,o));return{c(){e=f("ul");for(let o=0;o<i.length;o+=1)i[o].c();s=I(),_(e,"class","list-group m-2 me-0")},m(o,c){A(o,e,c);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(e,null);n(e,s)},p(o,c){if(c&37){t=be(o[2]);let a;for(a=0;a<t.length;a+=1){const r=_t(o,t,a);i[a]?i[a].p(r,c):(i[a]=pt(r),i[a].c(),i[a].m(e,s))}for(;a<i.length;a+=1)i[a].d(1);i.length=t.length}},d(o){o&&P(e),Ye(i,o)}}}function pt(l){let e,s=l[15].name+"",t,i,o,c;function a(){return l[9](l[15])}return{c(){e=f("button"),t=v(s),_(e,"data-bs-target","#offcanvasModuleSelection"),_(e,"data-bs-dismiss","offcanvas"),_(e,"class",i="list-group-item list-group-item-action "+(l[0].last_module_id===l[15].id?"list-group-item-secondary":"list-group-item-light"))},m(r,u){A(r,e,u),n(e,t),o||(c=J(e,"click",ie(a)),o=!0)},p(r,u){l=r,u&4&&s!==(s=l[15].name+"")&&Q(t,s),u&5&&i!==(i="list-group-item list-group-item-action "+(l[0].last_module_id===l[15].id?"list-group-item-secondary":"list-group-item-light"))&&_(e,"class",i)},d(r){r&&P(e),o=!1,c()}}}function kt(l){let e,s=l[12].name+"",t,i,o,c,a,r;function u(){return l[8](l[12])}let d=l[0].last_subject_id===l[12].id&&mt(l);return{c(){e=f("button"),t=v(s),o=I(),d&&d.c(),c=we(),_(e,"class",i="list-group-item list-group-item-action "+(l[0].last_subject_id===l[12].id?"list-group-item-dark":"list-group-item-light"))},m(m,w){A(m,e,w),n(e,t),A(m,o,w),d&&d.m(m,w),A(m,c,w),a||(r=J(e,"click",ie(u)),a=!0)},p(m,w){l=m,w&2&&s!==(s=l[12].name+"")&&Q(t,s),w&3&&i!==(i="list-group-item list-group-item-action "+(l[0].last_subject_id===l[12].id?"list-group-item-dark":"list-group-item-light"))&&_(e,"class",i),l[0].last_subject_id===l[12].id?d?d.p(l,w):(d=mt(l),d.c(),d.m(c.parentNode,c)):d&&(d.d(1),d=null)},d(m){m&&(P(e),P(o),P(c)),d&&d.d(m),a=!1,r()}}}function Wt(l){let e;return{c(){e=f("div"),e.textContent="No module selected",_(e,"class","alert alert-light text-center"),_(e,"role","alert")},m(s,t){A(s,e,t)},p:$,i:$,o:$,d(s){s&&P(e)}}}function Yt(l){let e,s,t;function i(c){l[11](c)}let o={moduleId:l[0].last_module_id,selectDeck:l[6]};return l[3]!==void 0&&(o.selectedDecks=l[3]),e=new Vt({props:o}),ve.push(()=>qe(e,"selectedDecks",i)),{c(){Te(e.$$.fragment)},m(c,a){Be(e,c,a),t=!0},p(c,a){const r={};a&1&&(r.moduleId=c[0].last_module_id),!s&&a&8&&(s=!0,r.selectedDecks=c[3],Ue(()=>s=!1)),e.$set(r)},i(c){t||(fe(e.$$.fragment,c),t=!0)},o(c){de(e.$$.fragment,c),t=!1},d(c){Ve(e,c)}}}function Ft(l){let e,s,t,i,o,c,a,r,u,d,m,w,b,g,p,k,y=be(l[1]),h=[];for(let M=0;M<y.length;M+=1)h[M]=kt(ft(l,y,M));function L(M){l[10](M)}let D={};l[3]!==void 0&&(D.selectedDecks=l[3]),m=new Kt({props:D}),ve.push(()=>qe(m,"selectedDecks",L));const C=[Yt,Wt],q=[];function j(M,N){return M[0].last_module_id?0:1}return g=j(l),p=q[g]=C[g](l),{c(){e=f("div"),e.innerHTML='<div class="col-12 d-grid mb-2"><button type="button" class="btn btn-sm btn-primary d-lg-none my-2" data-bs-toggle="offcanvas" data-bs-target="#offcanvasModuleSelection" aria-controls="offcanvasModuleSelection">Switch module</button></div>',s=I(),t=f("div"),i=f("div"),o=f("div"),o.innerHTML='<h5 id="offcanvasAddToDeckLabel">Choose subject and module</h5> <button type="button" class="btn-close text-reset" data-bs-target="#offcanvasModuleSelection" data-bs-dismiss="offcanvas" aria-label="Close"></button>',c=I(),a=f("div"),r=f("ul");for(let M=0;M<h.length;M+=1)h[M].c();u=I(),d=f("div"),Te(m.$$.fragment),b=I(),p.c(),_(e,"class","row"),_(o,"class","offcanvas-header"),_(r,"class","list-group w-100"),_(a,"class","offcanvas-body"),_(i,"class","col-lg-4 offcanvas-lg offcanvas-start"),_(i,"tabindex","-1"),_(i,"id","offcanvasModuleSelection"),_(d,"class","col-12 col-lg-8"),_(t,"class","row")},m(M,N){A(M,e,N),A(M,s,N),A(M,t,N),n(t,i),n(i,o),n(i,c),n(i,a),n(a,r);for(let G=0;G<h.length;G+=1)h[G]&&h[G].m(r,null);n(t,u),n(t,d),Be(m,d,null),n(d,b),q[g].m(d,null),k=!0},p(M,[N]){if(N&55){y=be(M[1]);let T;for(T=0;T<y.length;T+=1){const B=ft(M,y,T);h[T]?h[T].p(B,N):(h[T]=kt(B),h[T].c(),h[T].m(r,null))}for(;T<h.length;T+=1)h[T].d(1);h.length=y.length}const G={};!w&&N&8&&(w=!0,G.selectedDecks=M[3],Ue(()=>w=!1)),m.$set(G);let O=g;g=j(M),g===O?q[g].p(M,N):(Ke(),de(q[O],1,1,()=>{q[O]=null}),We(),p=q[g],p?p.p(M,N):(p=q[g]=C[g](M),p.c()),fe(p,1),p.m(d,null))},i(M){k||(fe(m.$$.fragment,M),fe(p),k=!0)},o(M){de(m.$$.fragment,M),de(p),k=!1},d(M){M&&(P(e),P(s),P(t)),Ye(h,M),Ve(m),q[g].d()}}}function Jt(l,e,s){let t;wt(l,He,p=>s(0,t=p));let i=[],o=[],c=[],a=new Set;bt(()=>{axios.get("/api/modules").then(function(p){var k=p.data;s(7,i=k.filter((h,L,D)=>L===D.findIndex(C=>C.id===h.id)).sort(function(h,L){return h.name>L.name?1:h.name<L.name?-1:0}));var y=i.map(h=>h.subject).filter(h=>!!h);s(1,o=y.filter((h,L,D)=>L===D.findIndex(C=>C.id===h.id)).sort(function(h,L){return h.name>L.name?1:h.name<L.name?-1:0}))}).catch(function(p){alert(p)})});function r(p){var k={last_subject_id:p,last_module_id:0};axios.put("/api/users/me/settings",k).then(function(y){const h=new URL(window.location);h.searchParams.delete("module"),h.searchParams.delete("page"),window.history.replaceState({},"",h),Oe(He,t.last_subject_id=p,t),Oe(He,t.last_module_id=0,t)}).catch(function(y){alert(y)})}function u(p){var k={last_module_id:p};axios.put("/api/users/me/settings",k).then(function(y){const h=new URL(window.location);h.searchParams.set("module",p),h.searchParams.set("page",1),window.history.replaceState({},"",h),Oe(He,t.last_module_id=p,t)}).catch(function(y){alert(y)})}function d(p){a.has(p)?a.delete(p):a.add(p),s(3,a=new Set([...a]))}const m=p=>r(p.id),w=p=>u(p.id);function b(p){a=p,s(3,a)}function g(p){a=p,s(3,a)}return l.$$.update=()=>{l.$$.dirty&129&&(t.last_subject_id,s(2,c=i.filter(p=>t.last_subject_id?p.subject?p.subject.id===t.last_subject_id:!1:!0)))},[t,o,c,a,r,u,d,i,m,w,b,g]}class Xt extends je{constructor(e){super(),Ae(this,e,Jt,Ft,Pe,{})}}const Zt=document.getElementById("NewSessionView");new Xt({target:Zt});
