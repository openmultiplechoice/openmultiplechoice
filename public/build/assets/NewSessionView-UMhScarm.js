import{S as je,i as Ae,s as Pe,e as qe,b as T,n as le,d as V,k as he,c as u,a as U,t as g,f as r,h as s,q as H,l as Z,p as se,B as He,C as mt,H as kt,r as ye,u as Te,j as Ne,G as ht,I as Ye,v as Ve,w as Le,D as pt,z as gt,x as ge,y as ke,A as Ee,o as Ie,m as ze,J as bt,K as vt,L as Oe}from"./index-CW_84yAU.js";import{e as fe,u as wt,o as Dt}from"./each-23V_io8F.js";import{C as St}from"./auto-TbvzFur0.js";import{s as Mt}from"./StatsHelper-B91isISU.js";import{c as Ct}from"./NewSessionHelper-Ba9jtPTo.js";import{f as Ge,p as Re}from"./parseISO-JEmvXouO.js";import{U as Qe}from"./UserSettingsStore-D7Gisc9d.js";function It(e){let t,n,l,i,o,c,a,m,d,f,p,h,k,M,_,I,y,v,P,w,b,C=Math.round(100*e[5]/e[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",Q,D,R,G,K,B,z,O,q,j=Math.round(100*e[1]/e[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",N,L,E,S,A,W,$,be,_e,ce=Math.round(100*e[4]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",ve,me,we,ae,De,te,ne,ue,Se,pe=Math.round(100*e[3]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",re,Me,Ue,de,oe,Ce,ie,X,F,J=Math.round(100*e[2]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",Be,Ke,We,x=e[2]>0&&Fe(e);return{c(){t=u("div"),n=u("div"),l=u("canvas"),i=U(),o=u("div"),c=u("table"),a=u("thead"),m=U(),d=u("tbody"),f=u("tr"),p=u("td"),p.textContent="Questions",h=U(),k=u("td"),M=g(e[6]),_=U(),I=u("tr"),y=u("td"),y.textContent="Answered",v=U(),P=u("td"),w=g(e[5]),b=g(`
                            (`),Q=g(C),D=g("%)"),R=U(),G=u("tr"),K=u("td"),K.textContent="Unanswered",B=U(),z=u("td"),O=g(e[1]),q=g(`
                            (`),N=g(j),L=g("%)"),E=U(),S=u("tr"),A=u("td"),A.textContent="Correct",W=U(),$=u("td"),be=g(e[4]),_e=g(`
                            (`),ve=g(ce),me=g("%)"),we=U(),ae=u("tr"),De=u("td"),De.textContent="Correct with help",te=U(),ne=u("td"),ue=g(e[3]),Se=g(`
                            (`),re=g(pe),Me=g("%)"),Ue=U(),de=u("tr"),oe=u("td"),oe.textContent="Incorrect",Ce=U(),ie=u("td"),X=g(e[2]),F=g(`
                            (`),Be=g(J),Ke=g("%)"),We=U(),x&&x.c(),r(n,"class","col-md-5"),r(k,"class","font-monospace text-end"),r(P,"class","font-monospace text-end"),r(z,"class","font-monospace text-end"),r($,"class","font-monospace text-end"),r(ne,"class","font-monospace text-end"),r(ie,"class","font-monospace text-end"),r(c,"class","table"),r(o,"class","col-md-7 mt-3"),r(t,"class","row mb-5")},m(Y,ee){T(Y,t,ee),s(t,n),s(n,l),e[14](l),s(t,i),s(t,o),s(o,c),s(c,a),s(c,m),s(c,d),s(d,f),s(f,p),s(f,h),s(f,k),s(k,M),s(d,_),s(d,I),s(I,y),s(I,v),s(I,P),s(P,w),s(P,b),s(P,Q),s(P,D),s(d,R),s(d,G),s(G,K),s(G,B),s(G,z),s(z,O),s(z,q),s(z,N),s(z,L),s(d,E),s(d,S),s(S,A),s(S,W),s(S,$),s($,be),s($,_e),s($,ve),s($,me),s(d,we),s(d,ae),s(ae,De),s(ae,te),s(ae,ne),s(ne,ue),s(ne,Se),s(ne,re),s(ne,Me),s(d,Ue),s(d,de),s(de,oe),s(de,Ce),s(de,ie),s(ie,X),s(ie,F),s(ie,Be),s(ie,Ke),s(o,We),x&&x.m(o,null)},p(Y,ee){ee&64&&H(M,Y[6]),ee&32&&H(w,Y[5]),ee&96&&C!==(C=Math.round(100*Y[5]/Y[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&H(Q,C),ee&2&&H(O,Y[1]),ee&66&&j!==(j=Math.round(100*Y[1]/Y[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&H(N,j),ee&16&&H(be,Y[4]),ee&48&&ce!==(ce=Math.round(100*Y[4]/Y[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&H(ve,ce),ee&8&&H(ue,Y[3]),ee&40&&pe!==(pe=Math.round(100*Y[3]/Y[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&H(re,pe),ee&4&&H(X,Y[2]),ee&36&&J!==(J=Math.round(100*Y[2]/Y[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&H(Be,J),Y[2]>0?x?x.p(Y,ee):(x=Fe(Y),x.c(),x.m(o,null)):x&&(x.d(1),x=null)},d(Y){Y&&V(t),e[14](null),x&&x.d()}}}function yt(e){let t,n,l,i,o,c,a,m;return{c(){t=u("div"),n=u("div"),l=u("p"),i=g("Number of questions (duplicates included): "),o=u("span"),c=u("i"),a=U(),m=g(e[6]),r(c,"class","bi bi-collection"),r(o,"class","badge text-bg-light font-monospace"),r(n,"class","col-md"),r(t,"class","row")},m(d,f){T(d,t,f),s(t,n),s(n,l),s(l,i),s(l,o),s(o,c),s(o,a),s(o,m)},p(d,f){f&64&&H(m,d[6])},d(d){d&&V(t)}}}function Fe(e){let t,n,l,i,o,c,a,m,d,f,p=e[2]>=40&&Je(e),h=e[2]>=70&&Xe(e);return{c(){t=u("div"),p&&p.c(),n=U(),h&&h.c(),l=U(),i=u("button"),o=u("i"),c=g(" Repeat "),a=g(e[2]),m=g(" incorrect"),r(o,"class","bi bi-repeat"),r(i,"class","btn btn-sm btn-outline-secondary"),r(i,"type","button"),r(t,"class","d-grid gap-2")},m(k,M){T(k,t,M),p&&p.m(t,null),s(t,n),h&&h.m(t,null),s(t,l),s(t,i),s(i,o),s(i,c),s(i,a),s(i,m),d||(f=Z(i,"click",se(e[17])),d=!0)},p(k,M){k[2]>=40?p?p.p(k,M):(p=Je(k),p.c(),p.m(t,n)):p&&(p.d(1),p=null),k[2]>=70?h?h.p(k,M):(h=Xe(k),h.c(),h.m(t,l)):h&&(h.d(1),h=null),M&4&&H(a,k[2])},d(k){k&&V(t),p&&p.d(),h&&h.d(),d=!1,f()}}}function Je(e){let t,n,l;return{c(){t=u("button"),t.innerHTML='<i class="bi bi-repeat"></i> Repeat 30 incorrect',r(t,"class","btn btn-sm btn-outline-secondary"),r(t,"type","button")},m(i,o){T(i,t,o),n||(l=Z(t,"click",se(e[15])),n=!0)},p:le,d(i){i&&V(t),n=!1,l()}}}function Xe(e){let t,n,l;return{c(){t=u("button"),t.innerHTML='<i class="bi bi-repeat"></i> Repeat 60 incorrect',r(t,"class","btn btn-sm btn-outline-secondary"),r(t,"type","button")},m(i,o){T(i,t,o),n||(l=Z(t,"click",se(e[16])),n=!0)},p:le,d(i){i&&V(t),n=!1,l()}}}function Lt(e){let t;function n(o,c){return o[6]===o[1]?yt:It}let l=n(e),i=l(e);return{c(){i.c(),t=qe()},m(o,c){i.m(o,c),T(o,t,c)},p(o,[c]){l===(l=n(o))&&i?i.p(o,c):(i.d(1),i=l(o),i&&(i.c(),i.m(t.parentNode,t)))},i:le,o:le,d(o){o&&V(t),i.d(o)}}}function qt(e,t,n){let l,i,o,c,a,m,d,{decks:f}=t,{moduleId:p}=t,h=[],k=[],M,_;function I(b){const C={module_id:p,question_ids:b};axios.post("/api/sessions/newfromquestionids",C).then(function(Q){window.location.href="/sessions/"+Q.data.id}).catch(function(Q){alert(Q)})}function y(b){he[b?"unshift":"push"](()=>{_=b,n(0,_)})}const v=()=>I(d.slice(0,30)),P=()=>I(d.slice(0,60)),w=()=>I(d);return e.$$set=b=>{"decks"in b&&n(9,f=b.decks),"moduleId"in b&&n(10,p=b.moduleId)},e.$$.update=()=>{e.$$.dirty&2560&&(()=>{const b=f.map(Q=>Q.questions).flat();n(11,h=b.filter(Q=>!Q.is_invalid));const C=[];for(const Q of f){const D=Q.sessions.sort((G,K)=>K.id-G.id);if(D.length===0)continue;const R=D[0];C.push(...R.answer_choices)}n(12,k=C.filter(Q=>h.some(({id:D})=>D===Q.question_id)))})(),e.$$.dirty&2048&&n(6,l=h.length),e.$$.dirty&4096&&n(5,i=k.length),e.$$.dirty&96&&n(1,o=l-i),e.$$.dirty&4096&&n(4,c=k.filter(b=>b.is_correct&&!b.help_used).length),e.$$.dirty&4096&&n(3,a=k.filter(b=>b.is_correct&&b.help_used).length),e.$$.dirty&4096&&n(2,m=k.filter(b=>!b.is_correct).length),e.$$.dirty&4096&&n(7,d=k.filter(b=>!b.is_correct).map(b=>b.question_id)),e.$$.dirty&8223&&_&&(()=>{const b={type:"doughnut",data:{labels:["Correct","Correct with help","Incorrect","Unanswered"],datasets:[{label:"n",data:[c,a,m,o],backgroundColor:["#d4edda","#fff3cd","#f8d7da","#bbbbbb"],hoverOffet:4}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:null},plugins:{legend:{display:!1}}}};M&&M.destroy();var C=_.getContext("2d");n(13,M=new St(C,b))})()},[_,o,m,a,c,i,l,d,I,f,p,h,k,M,y,v,P,w]}class Ut extends je{constructor(t){super(),Ae(this,t,qt,Lt,Pe,{decks:9,moduleId:10})}}function Nt(e){let t,n=Ge(Re(e[0].created_at),"dd.MM.yyyy")+"",l;return{c(){t=u("span"),l=g(n),r(t,"class","badge text-bg-light")},m(i,o){T(i,t,o),s(t,l)},p(i,o){o&1&&n!==(n=Ge(Re(i[0].created_at),"dd.MM.yyyy")+"")&&H(l,n)},d(i){i&&V(t)}}}function jt(e){let t,n=Ge(Re(e[0].exam_at),"dd.MM.yyyy")+"",l;return{c(){t=u("span"),l=g(n),r(t,"class","badge text-bg-light")},m(i,o){T(i,t,o),s(t,l)},p(i,o){o&1&&n!==(n=Ge(Re(i[0].exam_at),"dd.MM.yyyy")+"")&&H(l,n)},d(i){i&&V(t)}}}function Ze(e){let t,n,l,i=e[0].sessions.length+"",o;return{c(){t=u("span"),n=u("i"),l=U(),o=g(i),r(n,"class","bi bi-rocket"),r(t,"class","badge text-bg-light font-monospace"),r(t,"title","Number of sessions")},m(c,a){T(c,t,a),s(t,n),s(t,l),s(t,o)},p(c,a){a&1&&i!==(i=c[0].sessions.length+"")&&H(o,i)},d(c){c&&V(t)}}}function $e(e){let t,n;return{c(){t=new kt(!1),n=qe(),t.a=n},m(l,i){t.m(e[3],l,i),T(l,n,i)},p(l,i){i&8&&t.p(l[3])},d(l){l&&(V(n),t.d())}}}function At(e){let t,n,l,i,o,c,a,m=e[0].questions.length+"",d,f,p,h,k,M,_,I,y,v,P=e[0].name+"",w,b,C,Q,D,R,G,K,B;function z(L,E){return L[0].exam_at?jt:Nt}let O=z(e),q=O(e),j=e[0].sessions&&Ze(e),N=e[3]&&$e(e);return{c(){t=u("div"),n=u("div"),l=u("div"),q.c(),i=U(),o=u("span"),c=u("i"),a=U(),d=g(m),f=U(),j&&j.c(),p=U(),N&&N.c(),h=U(),k=u("input"),I=U(),y=u("div"),v=u("h6"),w=g(P),b=U(),C=u("button"),C.innerHTML='<i class="bi bi-rocket-takeoff"></i> Start session',Q=U(),D=u("a"),R=g("Browse deck"),r(c,"class","bi bi-collection"),r(o,"class","badge text-bg-light font-monospace"),r(o,"title","Number of questions"),r(k,"type","checkbox"),r(k,"class","form-check-input float-end"),k.value="",r(k,"id",M="selected"+e[0].id),k.checked=_=e[2].has(e[0].id),r(l,"class","card-header"),r(v,"class","card-title"),r(C,"type","button"),r(C,"class","btn btn-sm btn-primary"),r(D,"href",G="/decks/"+e[0].id),r(D,"class","card-link"),r(y,"class","card-body"),r(n,"class","card"),r(t,"class","col-lg-6 mb-1")},m(L,E){T(L,t,E),s(t,n),s(n,l),q.m(l,null),s(l,i),s(l,o),s(o,c),s(o,a),s(o,d),s(l,f),j&&j.m(l,null),s(l,p),N&&N.m(l,null),s(l,h),s(l,k),s(n,I),s(n,y),s(y,v),s(v,w),s(y,b),s(y,C),s(y,Q),s(y,D),s(D,R),K||(B=[Z(k,"click",e[4]),Z(C,"click",se(e[5]))],K=!0)},p(L,[E]){O===(O=z(L))&&q?q.p(L,E):(q.d(1),q=O(L),q&&(q.c(),q.m(l,i))),E&1&&m!==(m=L[0].questions.length+"")&&H(d,m),L[0].sessions?j?j.p(L,E):(j=Ze(L),j.c(),j.m(l,p)):j&&(j.d(1),j=null),L[3]?N?N.p(L,E):(N=$e(L),N.c(),N.m(l,h)):N&&(N.d(1),N=null),E&1&&M!==(M="selected"+L[0].id)&&r(k,"id",M),E&5&&_!==(_=L[2].has(L[0].id))&&(k.checked=_),E&1&&P!==(P=L[0].name+"")&&H(w,P),E&1&&G!==(G="/decks/"+L[0].id)&&r(D,"href",G)},i:le,o:le,d(L){L&&V(t),q.d(),j&&j.d(),N&&N.d(),K=!1,He(B)}}}function Pt(e,t,n){let{deck:l}=t,{selectDeck:i}=t,{selectedDecks:o}=t,c;mt(()=>{const d=l.questions.filter(M=>!M.is_invalid),f=l.sessions.sort((M,_)=>_.id-M.id);if(f.length===0)return;const h=f[0].answer_choices.filter(M=>d.some(({id:_})=>_===M.question_id)),k=Mt(d.length,h);k.correct>=60?n(3,c='<span style="color: #155724; background-color: #d4edda;" class="badge" title="Correct answers in percent">'+k.correct+" %</span>"):n(3,c='<span style="color: #721c24; background-color: #f8d7da;" class="badge" title="Correct answers in percent">'+k.correct+" %</span>")});const a=()=>i(l.id),m=()=>Ct(l.id);return e.$$set=d=>{"deck"in d&&n(0,l=d.deck),"selectDeck"in d&&n(1,i=d.selectDeck),"selectedDecks"in d&&n(2,o=d.selectedDecks)},[l,i,o,c,a,m]}class Qt extends je{constructor(t){super(),Ae(this,t,Pt,At,Pe,{deck:0,selectDeck:1,selectedDecks:2})}}function xe(e,t,n){const l=e.slice();return l[17]=t[n],l}function et(e,t,n){const l=e.slice();return l[20]=t[n],l[21]=t,l[22]=n,l}function tt(e){let t;return{c(){t=u("div"),t.innerHTML='<div class="alert alert-light">No decks found! Create a new deck <a href="/decks" class="alert-link">here</a>.</div> ',r(t,"class","col")},m(n,l){T(n,t,l)},p:le,d(n){n&&V(t)}}}function lt(e,t){let n,l,i,o,c;function a(f){t[11](f,t[20],t[21],t[22])}function m(f){t[12](f)}let d={selectDeck:t[2]};return t[20]!==void 0&&(d.deck=t[20]),t[1]!==void 0&&(d.selectedDecks=t[1]),l=new Qt({props:d}),he.push(()=>ye(l,"deck",a)),he.push(()=>ye(l,"selectedDecks",m)),{key:e,first:null,c(){n=qe(),Te(l.$$.fragment),this.first=n},m(f,p){T(f,n,p),Ve(l,f,p),c=!0},p(f,p){t=f;const h={};p&4&&(h.selectDeck=t[2]),!i&&p&8&&(i=!0,h.deck=t[20],Le(()=>i=!1)),!o&&p&2&&(o=!0,h.selectedDecks=t[1],Le(()=>o=!1)),l.$set(h)},i(f){c||(ge(l.$$.fragment,f),c=!0)},o(f){ke(l.$$.fragment,f),c=!1},d(f){f&&V(n),Ee(l,f)}}}function st(e){let t,n,l,i,o,c=e[5].from+"",a,m,d,f=e[5].to+"",p,h,k,M=e[5].total+"",_,I,y,v,P,w,b,C,Q,D,R,G,K,B,z=fe(e[5].links.slice(1,e[5].links.length-1)),O=[];for(let q=0;q<z.length;q+=1)O[q]=nt(xe(e,z,q));return{c(){t=u("div"),n=u("div"),l=u("p"),i=g("Showing "),o=u("span"),a=g(c),m=g(`
                to `),d=u("span"),p=g(f),h=g(`
                of `),k=u("span"),_=g(M),I=g(" decks"),y=U(),v=u("div"),P=u("nav"),w=u("ul"),b=u("li"),C=u("button"),C.textContent="‹",Q=U();for(let q=0;q<O.length;q+=1)O[q].c();D=U(),R=u("li"),G=u("button"),G.textContent="›",r(o,"class","fw-semibold"),r(d,"class","fw-semibold"),r(k,"class","fw-semibold"),r(l,"class","small text-muted"),r(n,"class","col"),r(C,"class","page-link"),r(b,"class","page-item"),Ie(b,"disabled",e[5].prev_page_url===null),r(G,"class","page-link"),r(R,"class","page-item"),Ie(R,"disabled",e[5].next_page_url===null),r(w,"class","pagination"),r(v,"class","col"),r(t,"class","row sticky-bottom bg-white mt-3 pt-3")},m(q,j){T(q,t,j),s(t,n),s(n,l),s(l,i),s(l,o),s(o,a),s(l,m),s(l,d),s(d,p),s(l,h),s(l,k),s(k,_),s(l,I),s(t,y),s(t,v),s(v,P),s(P,w),s(w,b),s(b,C),s(w,Q);for(let N=0;N<O.length;N+=1)O[N]&&O[N].m(w,null);s(w,D),s(w,R),s(R,G),K||(B=[Z(C,"click",se(e[13])),Z(G,"click",se(e[15]))],K=!0)},p(q,j){if(j&32&&c!==(c=q[5].from+"")&&H(a,c),j&32&&f!==(f=q[5].to+"")&&H(p,f),j&32&&M!==(M=q[5].total+"")&&H(_,M),j&32&&Ie(b,"disabled",q[5].prev_page_url===null),j&160){z=fe(q[5].links.slice(1,q[5].links.length-1));let N;for(N=0;N<z.length;N+=1){const L=xe(q,z,N);O[N]?O[N].p(L,j):(O[N]=nt(L),O[N].c(),O[N].m(w,D))}for(;N<O.length;N+=1)O[N].d(1);O.length=z.length}j&32&&Ie(R,"disabled",q[5].next_page_url===null)},d(q){q&&V(t),ze(O,q),K=!1,He(B)}}}function nt(e){let t,n,l=e[17].label+"",i,o,c;function a(){return e[14](e[17])}return{c(){t=u("li"),n=u("button"),i=g(l),r(n,"class","page-link"),r(t,"class","page-item d-none d-sm-block"),Ie(t,"disabled",e[17].active||!e[17].url)},m(m,d){T(m,t,d),s(t,n),s(n,i),o||(c=Z(n,"click",se(a)),o=!0)},p(m,d){e=m,d&32&&l!==(l=e[17].label+"")&&H(i,l),d&32&&Ie(t,"disabled",e[17].active||!e[17].url)},d(m){m&&V(t),o=!1,c()}}}function Gt(e){let t,n,l,i,o,c,a,m,d,f,p,h,k,M,_,I,y,v,P,w,b,C=[],Q=new Map,D,R,G,K,B;function z(S){e[9](S)}function O(S){e[10](S)}let q={};e[3]!==void 0&&(q.decks=e[3]),e[0]!==void 0&&(q.moduleId=e[0]),y=new Ut({props:q}),he.push(()=>ye(y,"decks",z)),he.push(()=>ye(y,"moduleId",O));let j=fe(e[3]);const N=S=>S[20].id;for(let S=0;S<j.length;S+=1){let A=et(e,j,S),W=N(A);Q.set(W,C[S]=lt(W,A))}let L=null;j.length||(L=tt());let E=e[5]&&e[5].total>1&&st(e);return{c(){t=u("div"),n=u("div"),l=u("div"),i=u("span"),i.innerHTML='<i class="bi bi-archive"></i>',o=U(),c=u("select"),a=u("option"),m=g("Main decks"),f=u("option"),p=g("Your decks"),k=u("option"),M=g("User decks"),I=U(),Te(y.$$.fragment),w=U(),b=u("div");for(let S=0;S<C.length;S+=1)C[S].c();L&&L.c(),D=U(),E&&E.c(),R=qe(),r(i,"class","input-group-text"),a.__value="public-rw-listed",Ne(a,a.__value),a.selected=d=e[4]==="public-rw-listed",f.__value="user",Ne(f,f.__value),f.selected=h=e[4]==="user",k.__value="public",Ne(k,k.__value),k.selected=_=e[4]==="public",r(c,"id","kind"),r(c,"class","form-select"),e[4]===void 0&&ht(()=>e[8].call(c)),r(l,"class","input-group"),r(n,"class","col"),r(t,"class","row mb-3"),r(b,"class","row")},m(S,A){T(S,t,A),s(t,n),s(n,l),s(l,i),s(l,o),s(l,c),s(c,a),s(a,m),s(c,f),s(f,p),s(c,k),s(k,M),Ye(c,e[4],!0),T(S,I,A),Ve(y,S,A),T(S,w,A),T(S,b,A);for(let W=0;W<C.length;W+=1)C[W]&&C[W].m(b,null);L&&L.m(b,null),T(S,D,A),E&&E.m(S,A),T(S,R,A),G=!0,K||(B=[Z(c,"change",e[8]),Z(c,"change",e[6])],K=!0)},p(S,[A]){(!G||A&16&&d!==(d=S[4]==="public-rw-listed"))&&(a.selected=d),(!G||A&16&&h!==(h=S[4]==="user"))&&(f.selected=h),(!G||A&16&&_!==(_=S[4]==="public"))&&(k.selected=_),A&16&&Ye(c,S[4]);const W={};!v&&A&8&&(v=!0,W.decks=S[3],Le(()=>v=!1)),!P&&A&1&&(P=!0,W.moduleId=S[0],Le(()=>P=!1)),y.$set(W),A&14&&(j=fe(S[3]),pt(),C=wt(C,A,N,1,S,j,Q,b,Dt,lt,null,et),gt(),!j.length&&L?L.p(S,A):j.length?L&&(L.d(1),L=null):(L=tt(),L.c(),L.m(b,null))),S[5]&&S[5].total>1?E?E.p(S,A):(E=st(S),E.c(),E.m(R.parentNode,R)):E&&(E.d(1),E=null)},i(S){if(!G){ge(y.$$.fragment,S);for(let A=0;A<j.length;A+=1)ge(C[A]);G=!0}},o(S){ke(y.$$.fragment,S);for(let A=0;A<C.length;A+=1)ke(C[A]);G=!1},d(S){S&&(V(t),V(I),V(w),V(b),V(D),V(R)),Ee(y,S);for(let A=0;A<C.length;A+=1)C[A].d();L&&L.d(),E&&E.d(S),K=!1,He(B)}}}function it(e){return new URLSearchParams(window.location.search).get(e)}function Rt(e,t,n){let{moduleId:l}=t,{selectDeck:i}=t,{selectedDecks:o}=t,c=[],a=it("kind")??"public-rw-listed",m=it("page")??1,d;function f(){if(!l){n(3,c=[]);return}const w=new URL(window.location);w.searchParams.set("module",l),w.searchParams.set("kind",a),w.searchParams.set("page",m),window.history.replaceState({},"",w),axios.get("/api/decks?module="+l+"&kind="+a+"&page="+m).then(function(b){n(5,d=b.data),n(3,c=d.data),c.sort(function(C,Q){return C.exam_at===null?1:Q.exam_at===null?-1:C.exam_at<Q.exam_at?1:C.exam_at>Q.exam_at?-1:0})}).catch(function(b){alert(b)})}function p(w){m=w,f()}function h(){a=bt(this),n(4,a)}function k(w){c=w,n(3,c)}function M(w){l=w,n(0,l)}function _(w,b,C,Q){C[Q]=w,n(3,c)}function I(w){o=w,n(1,o)}const y=()=>{d.prev_page_url&&p(d.current_page-1)},v=w=>{w.url&&p(w.label)},P=()=>{d.next_page_url&&p(d.current_page+1)};return e.$$set=w=>{"moduleId"in w&&n(0,l=w.moduleId),"selectDeck"in w&&n(2,i=w.selectDeck),"selectedDecks"in w&&n(1,o=w.selectedDecks)},e.$$.update=()=>{e.$$.dirty&1&&f()},[l,o,i,c,a,d,f,p,h,k,M,_,I,y,v,P]}class Ht extends je{constructor(t){super(),Ae(this,t,Rt,Gt,Pe,{moduleId:0,selectDeck:2,selectedDecks:1})}}function ot(e){let t,n,l,i,o,c,a,m,d,f=e[1].length+"",p,h,k=e[1].length>1?"s":"",M,_,I,y=e[3].length+"",v,P,w=e[3].length>1?"s":"",b,C,Q,D=e[2]?"excluded":"included",R,G,K,B,z,O,q,j,N,L,E,S,A,W,$,be,_e=e[3].length+"",ce,ve,me=e[3].length>1?"s":"",we,ae,De,te,ne,ue=e[5].length+"",Se,pe,re=e[5].length>1?"s":"",Me,Ue,de,oe,Ce,ie,X=e[5].length>0&&ct(e);return{c(){t=u("div"),n=u("div"),l=u("div"),i=u("p"),i.textContent="Create your own super deck:",o=U(),c=u("p"),a=g("You have "),m=u("strong"),d=g("selected "),p=g(f),h=g(" deck"),M=g(k),_=g(`
                    with `),I=u("strong"),v=g(y),P=g(" question"),b=g(w),C=U(),X&&X.c(),Q=g(`
                    (duplicates `),R=g(D),G=g(")"),K=U(),B=u("div"),z=u("label"),z.textContent="Deck Name",O=U(),q=u("input"),j=U(),N=u("div"),L=u("input"),E=U(),S=u("label"),S.textContent="Filter out duplicates",A=U(),W=u("div"),$=u("button"),be=g("Create deck ("),ce=g(_e),ve=g(" question"),we=g(me),ae=g(")"),De=U(),te=u("button"),ne=g("Create deck ("),Se=g(ue),pe=g(" image question"),Me=g(re),Ue=g(")"),de=U(),oe=u("button"),oe.textContent="Cancel",r(z,"for","name"),r(z,"class","form-label"),r(q,"type","text"),r(q,"class","form-control"),r(q,"id","name"),r(B,"class","mb-3"),r(L,"type","checkbox"),r(L,"class","form-check-input"),r(L,"id","checkboxRemoveDuplicates"),r(S,"class","form-check-label"),r(S,"for","checkboxRemoveDuplicates"),r(N,"class","mb-3 form-check"),r($,"class","btn btn-sm btn-primary"),r(te,"class","btn btn-sm btn-primary"),r(oe,"class","btn btn-sm btn-link"),r(W,"class","d-grid gap-2 d-md-block"),r(l,"class","alert alert-light"),r(l,"role","alert"),r(n,"class","col-md"),r(t,"class","row")},m(F,J){T(F,t,J),s(t,n),s(n,l),s(l,i),s(l,o),s(l,c),s(c,a),s(c,m),s(m,d),s(m,p),s(m,h),s(m,M),s(c,_),s(c,I),s(I,v),s(I,P),s(I,b),s(c,C),X&&X.m(c,null),s(c,Q),s(c,R),s(c,G),s(l,K),s(l,B),s(B,z),s(B,O),s(B,q),Ne(q,e[4]),s(l,j),s(l,N),s(N,L),L.checked=e[2],s(N,E),s(N,S),s(l,A),s(l,W),s(W,$),s($,be),s($,ce),s($,ve),s($,we),s($,ae),s(W,De),s(W,te),s(te,ne),s(te,Se),s(te,pe),s(te,Me),s(te,Ue),s(W,de),s(W,oe),Ce||(ie=[Z(q,"input",e[6]),Z(q,"focus",Vt),Z(L,"change",e[7]),Z($,"click",se(e[8])),Z(te,"click",se(e[9])),Z(oe,"click",se(e[10]))],Ce=!0)},p(F,J){J&2&&f!==(f=F[1].length+"")&&H(p,f),J&2&&k!==(k=F[1].length>1?"s":"")&&H(M,k),J&8&&y!==(y=F[3].length+"")&&H(v,y),J&8&&w!==(w=F[3].length>1?"s":"")&&H(b,w),F[5].length>0?X?X.p(F,J):(X=ct(F),X.c(),X.m(c,Q)):X&&(X.d(1),X=null),J&4&&D!==(D=F[2]?"excluded":"included")&&H(R,D),J&16&&q.value!==F[4]&&Ne(q,F[4]),J&4&&(L.checked=F[2]),J&8&&_e!==(_e=F[3].length+"")&&H(ce,_e),J&8&&me!==(me=F[3].length>1?"s":"")&&H(we,me),J&32&&ue!==(ue=F[5].length+"")&&H(Se,ue),J&32&&re!==(re=F[5].length>1?"s":"")&&H(Me,re)},d(F){F&&V(t),X&&X.d(),Ce=!1,He(ie)}}}function ct(e){let t,n,l=e[5].length+"",i,o,c=e[5].length>1?"s":"",a,m;return{c(){t=g("/ "),n=u("strong"),i=g(l),o=g(" question"),a=g(c),m=g(" with images")},m(d,f){T(d,t,f),T(d,n,f),s(n,i),s(n,o),s(n,a),s(n,m)},p(d,f){f&32&&l!==(l=d[5].length+"")&&H(i,l),f&32&&c!==(c=d[5].length>1?"s":"")&&H(a,c)},d(d){d&&(V(t),V(n))}}}function Tt(e){let t,n=e[1].length>0&&ot(e);return{c(){n&&n.c(),t=qe()},m(l,i){n&&n.m(l,i),T(l,t,i)},p(l,[i]){l[1].length>0?n?n.p(l,i):(n=ot(l),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:le,o:le,d(l){l&&V(t),n&&n.d(l)}}}function at(e,t){var n={name:e,question_ids:t};axios.post("/api/decks",n).then(function(l){window.location.href="/decks/"+l.data.id}).catch(function(l){alert(l)})}const Vt=e=>e.target.select();function Et(e,t,n){let l,i,{selectedDecks:o}=t,c=[],a="My new super deck",m=!0;function d(){if(o.size===0){n(1,c=[]);return}const _=[...o].map(I=>"decks[]="+I);axios.get("/api/decks?"+_.join("&")).then(function(I){n(1,c=I.data)}).catch(function(I){alert(I)})}function f(){a=this.value,n(4,a)}function p(){m=this.checked,n(2,m)}const h=()=>at(a,l.map(_=>_.id)),k=()=>at(a,i.map(_=>_.id)),M=()=>n(0,o=new Set);return e.$$set=_=>{"selectedDecks"in _&&n(0,o=_.selectedDecks)},e.$$.update=()=>{e.$$.dirty&1&&d(),e.$$.dirty&6&&n(3,l=(()=>{var _=[];return c.forEach(I=>_.push(...I.questions)),m?[...new Map(_.map(I=>[I.id,I])).values()]:_})()),e.$$.dirty&6&&n(5,i=(()=>{var _=[];return c.forEach(I=>{I.questions.forEach(y=>{y.images.length>0&&_.push(y)})}),m?[...new Map(_.map(I=>[I.id,I])).values()]:_})())},[o,c,m,l,a,i,f,p,h,k,M]}class Bt extends je{constructor(t){super(),Ae(this,t,Et,Tt,Pe,{selectedDecks:0})}}function ut(e,t,n){const l=e.slice();return l[12]=t[n],l}function rt(e,t,n){const l=e.slice();return l[15]=t[n],l}function dt(e){let t,n,l=fe(e[2]),i=[];for(let o=0;o<l.length;o+=1)i[o]=ft(rt(e,l,o));return{c(){t=u("ul");for(let o=0;o<i.length;o+=1)i[o].c();n=U(),r(t,"class","list-group m-2 me-0")},m(o,c){T(o,t,c);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(t,null);s(t,n)},p(o,c){if(c&37){l=fe(o[2]);let a;for(a=0;a<l.length;a+=1){const m=rt(o,l,a);i[a]?i[a].p(m,c):(i[a]=ft(m),i[a].c(),i[a].m(t,n))}for(;a<i.length;a+=1)i[a].d(1);i.length=l.length}},d(o){o&&V(t),ze(i,o)}}}function ft(e){let t,n=e[15].name+"",l,i,o,c;function a(){return e[9](e[15])}return{c(){t=u("button"),l=g(n),r(t,"data-bs-target","#offcanvasModuleSelection"),r(t,"data-bs-dismiss","offcanvas"),r(t,"class",i="list-group-item list-group-item-action "+(e[0].last_module_id===e[15].id?"list-group-item-secondary":"list-group-item-light"))},m(m,d){T(m,t,d),s(t,l),o||(c=Z(t,"click",se(a)),o=!0)},p(m,d){e=m,d&4&&n!==(n=e[15].name+"")&&H(l,n),d&5&&i!==(i="list-group-item list-group-item-action "+(e[0].last_module_id===e[15].id?"list-group-item-secondary":"list-group-item-light"))&&r(t,"class",i)},d(m){m&&V(t),o=!1,c()}}}function _t(e){let t,n=e[12].name+"",l,i,o,c,a,m;function d(){return e[8](e[12])}let f=e[0].last_subject_id===e[12].id&&dt(e);return{c(){t=u("button"),l=g(n),o=U(),f&&f.c(),c=qe(),r(t,"class",i="list-group-item list-group-item-action "+(e[0].last_subject_id===e[12].id?"list-group-item-dark":"list-group-item-light"))},m(p,h){T(p,t,h),s(t,l),T(p,o,h),f&&f.m(p,h),T(p,c,h),a||(m=Z(t,"click",se(d)),a=!0)},p(p,h){e=p,h&2&&n!==(n=e[12].name+"")&&H(l,n),h&3&&i!==(i="list-group-item list-group-item-action "+(e[0].last_subject_id===e[12].id?"list-group-item-dark":"list-group-item-light"))&&r(t,"class",i),e[0].last_subject_id===e[12].id?f?f.p(e,h):(f=dt(e),f.c(),f.m(c.parentNode,c)):f&&(f.d(1),f=null)},d(p){p&&(V(t),V(o),V(c)),f&&f.d(p),a=!1,m()}}}function Ot(e){let t;return{c(){t=u("p"),t.textContent="No module selected."},m(n,l){T(n,t,l)},p:le,i:le,o:le,d(n){n&&V(t)}}}function zt(e){let t,n,l;function i(c){e[11](c)}let o={moduleId:e[0].last_module_id,selectDeck:e[6]};return e[3]!==void 0&&(o.selectedDecks=e[3]),t=new Ht({props:o}),he.push(()=>ye(t,"selectedDecks",i)),{c(){Te(t.$$.fragment)},m(c,a){Ve(t,c,a),l=!0},p(c,a){const m={};a&1&&(m.moduleId=c[0].last_module_id),!n&&a&8&&(n=!0,m.selectedDecks=c[3],Le(()=>n=!1)),t.$set(m)},i(c){l||(ge(t.$$.fragment,c),l=!0)},o(c){ke(t.$$.fragment,c),l=!1},d(c){Ee(t,c)}}}function Kt(e){let t,n,l,i,o,c,a,m,d,f,p,h,k,M,_,I,y=fe(e[1]),v=[];for(let D=0;D<y.length;D+=1)v[D]=_t(ut(e,y,D));function P(D){e[10](D)}let w={};e[3]!==void 0&&(w.selectedDecks=e[3]),p=new Bt({props:w}),he.push(()=>ye(p,"selectedDecks",P));const b=[zt,Ot],C=[];function Q(D,R){return D[0].last_module_id?0:1}return M=Q(e),_=C[M]=b[M](e),{c(){t=u("div"),t.innerHTML='<div class="col-12 d-grid mb-2"><button type="button" class="btn btn-sm btn-primary d-lg-none my-2" data-bs-toggle="offcanvas" data-bs-target="#offcanvasModuleSelection" aria-controls="offcanvasModuleSelection">Switch module</button></div>',n=U(),l=u("div"),i=u("div"),o=u("div"),o.innerHTML='<h5 id="offcanvasAddToDeckLabel">Choose subject and module</h5> <button type="button" class="btn-close text-reset" data-bs-target="#offcanvasModuleSelection" data-bs-dismiss="offcanvas" aria-label="Close"></button>',c=U(),a=u("div"),m=u("ul");for(let D=0;D<v.length;D+=1)v[D].c();d=U(),f=u("div"),Te(p.$$.fragment),k=U(),_.c(),r(t,"class","row"),r(o,"class","offcanvas-header"),r(m,"class","list-group w-100"),r(a,"class","offcanvas-body"),r(i,"class","col-lg-4 offcanvas-lg offcanvas-start"),r(i,"tabindex","-1"),r(i,"id","offcanvasModuleSelection"),r(f,"class","col-12 col-lg-8"),r(l,"class","row")},m(D,R){T(D,t,R),T(D,n,R),T(D,l,R),s(l,i),s(i,o),s(i,c),s(i,a),s(a,m);for(let G=0;G<v.length;G+=1)v[G]&&v[G].m(m,null);s(l,d),s(l,f),Ve(p,f,null),s(f,k),C[M].m(f,null),I=!0},p(D,[R]){if(R&55){y=fe(D[1]);let B;for(B=0;B<y.length;B+=1){const z=ut(D,y,B);v[B]?v[B].p(z,R):(v[B]=_t(z),v[B].c(),v[B].m(m,null))}for(;B<v.length;B+=1)v[B].d(1);v.length=y.length}const G={};!h&&R&8&&(h=!0,G.selectedDecks=D[3],Le(()=>h=!1)),p.$set(G);let K=M;M=Q(D),M===K?C[M].p(D,R):(pt(),ke(C[K],1,1,()=>{C[K]=null}),gt(),_=C[M],_?_.p(D,R):(_=C[M]=b[M](D),_.c()),ge(_,1),_.m(f,null))},i(D){I||(ge(p.$$.fragment,D),ge(_),I=!0)},o(D){ke(p.$$.fragment,D),ke(_),I=!1},d(D){D&&(V(t),V(n),V(l)),ze(v,D),Ee(p),C[M].d()}}}function Wt(e,t,n){let l;vt(e,Qe,_=>n(0,l=_));let i=[],o=[],c=[],a=new Set;mt(()=>{axios.get("/api/modules").then(function(_){var I=_.data;n(7,i=I.filter((v,P,w)=>P===w.findIndex(b=>b.id===v.id)).sort(function(v,P){return v.name>P.name?1:v.name<P.name?-1:0}));var y=i.map(v=>v.subject).filter(v=>!!v);n(1,o=y.filter((v,P,w)=>P===w.findIndex(b=>b.id===v.id)).sort(function(v,P){return v.name>P.name?1:v.name<P.name?-1:0}))}).catch(function(_){alert(_)})});function m(_){var I={last_subject_id:_,last_module_id:0};axios.put("/api/users/me/settings",I).then(function(y){Oe(Qe,l.last_subject_id=_,l),Oe(Qe,l.last_module_id=0,l);const v=new URL(window.location);v.searchParams.delete("module"),v.searchParams.delete("page"),window.history.replaceState({},"",v)}).catch(function(y){alert(y)})}function d(_){var I={last_module_id:_};axios.put("/api/users/me/settings",I).then(function(y){Oe(Qe,l.last_module_id=_,l);const v=new URL(window.location);v.searchParams.set("module",_),v.searchParams.set("page",1),window.history.replaceState({},"",v)}).catch(function(y){alert(y)})}function f(_){a.has(_)?a.delete(_):a.add(_),n(3,a=new Set([...a]))}const p=_=>m(_.id),h=_=>d(_.id);function k(_){a=_,n(3,a)}function M(_){a=_,n(3,a)}return e.$$.update=()=>{e.$$.dirty&129&&(l.last_subject_id,n(2,c=i.filter(_=>l.last_subject_id?_.subject?_.subject.id===l.last_subject_id:!1:!0)))},[l,o,c,a,m,d,f,i,p,h,k,M]}class Yt extends je{constructor(t){super(),Ae(this,t,Wt,Kt,Pe,{})}}const Ft=document.getElementById("NewSessionView");new Yt({target:Ft});
