import{S as je,i as Ae,s as Pe,e as Ue,b as G,n as ne,d as H,k as ve,c as u,a as I,t as v,f as r,h as s,q as Q,l as X,p as ie,o as ce,B as Re,C as pt,H as bt,r as qe,u as Te,j as Le,G as ht,I as Fe,v as Be,w as ye,D as kt,z as gt,x as be,y as he,A as Ve,m as Ke,J as vt,K as wt,L as Oe}from"./index-CW_84yAU.js";import{e as pe,u as Dt,o as St}from"./each-23V_io8F.js";import{C as Mt}from"./auto-TbvzFur0.js";import{s as Ct}from"./StatsHelper-B91isISU.js";import{c as It}from"./NewSessionHelper-Ba9jtPTo.js";import{f as Ge,p as He}from"./parseISO-JEmvXouO.js";import{U as Qe}from"./UserSettingsStore-D7Gisc9d.js";function Lt(e){let t,n,l,i,o,a,c,k,f,d,_,w,g,b,m,p,L,h,y,D,C,N=Math.round(100*e[5]/e[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",P,M,j,O,z,R,T,x,Y,le=Math.round(100*e[1]/e[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",$,E,B,V,q,A,S,U,F,re=Math.round(100*e[4]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",we,ke,De,de,Se,se,oe,fe,Me,ge=Math.round(100*e[3]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",_e,Ce,Ne,me,ue,Ie,ae,Z,W,J=Math.round(100*e[2]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",Ee,We,Ye,ee=e[2]>0&&Je(e);return{c(){t=u("div"),n=u("div"),l=u("canvas"),i=I(),o=u("div"),a=u("table"),c=u("thead"),k=I(),f=u("tbody"),d=u("tr"),_=u("td"),_.textContent="Questions",w=I(),g=u("td"),b=v(e[6]),m=I(),p=u("tr"),L=u("td"),L.textContent="Answered",h=I(),y=u("td"),D=v(e[5]),C=v(`
                            (`),P=v(N),M=v("%)"),j=I(),O=u("tr"),z=u("td"),z.textContent="Unanswered",R=I(),T=u("td"),x=v(e[1]),Y=v(`
                            (`),$=v(le),E=v("%)"),B=I(),V=u("tr"),q=u("td"),q.textContent="Correct",A=I(),S=u("td"),U=v(e[4]),F=v(`
                            (`),we=v(re),ke=v("%)"),De=I(),de=u("tr"),Se=u("td"),Se.textContent="Correct with help",se=I(),oe=u("td"),fe=v(e[3]),Me=v(`
                            (`),_e=v(ge),Ce=v("%)"),Ne=I(),me=u("tr"),ue=u("td"),ue.textContent="Incorrect",Ie=I(),ae=u("td"),Z=v(e[2]),W=v(`
                            (`),Ee=v(J),We=v("%)"),Ye=I(),ee&&ee.c(),r(n,"class","col-md-5"),r(g,"class","font-monospace text-end"),r(y,"class","font-monospace text-end"),r(T,"class","font-monospace text-end"),r(S,"class","font-monospace text-end"),r(oe,"class","font-monospace text-end"),r(ae,"class","font-monospace text-end"),r(a,"class","table"),r(o,"class","col-md-7 mt-3"),r(t,"class","row mb-5")},m(K,te){G(K,t,te),s(t,n),s(n,l),e[14](l),s(t,i),s(t,o),s(o,a),s(a,c),s(a,k),s(a,f),s(f,d),s(d,_),s(d,w),s(d,g),s(g,b),s(f,m),s(f,p),s(p,L),s(p,h),s(p,y),s(y,D),s(y,C),s(y,P),s(y,M),s(f,j),s(f,O),s(O,z),s(O,R),s(O,T),s(T,x),s(T,Y),s(T,$),s(T,E),s(f,B),s(f,V),s(V,q),s(V,A),s(V,S),s(S,U),s(S,F),s(S,we),s(S,ke),s(f,De),s(f,de),s(de,Se),s(de,se),s(de,oe),s(oe,fe),s(oe,Me),s(oe,_e),s(oe,Ce),s(f,Ne),s(f,me),s(me,ue),s(me,Ie),s(me,ae),s(ae,Z),s(ae,W),s(ae,Ee),s(ae,We),s(o,Ye),ee&&ee.m(o,null)},p(K,te){te&64&&Q(b,K[6]),te&32&&Q(D,K[5]),te&96&&N!==(N=Math.round(100*K[5]/K[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&Q(P,N),te&2&&Q(x,K[1]),te&66&&le!==(le=Math.round(100*K[1]/K[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&Q($,le),te&16&&Q(U,K[4]),te&48&&re!==(re=Math.round(100*K[4]/K[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&Q(we,re),te&8&&Q(fe,K[3]),te&40&&ge!==(ge=Math.round(100*K[3]/K[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&Q(_e,ge),te&4&&Q(Z,K[2]),te&36&&J!==(J=Math.round(100*K[2]/K[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&Q(Ee,J),K[2]>0?ee?ee.p(K,te):(ee=Je(K),ee.c(),ee.m(o,null)):ee&&(ee.d(1),ee=null)},d(K){K&&H(t),e[14](null),ee&&ee.d()}}}function qt(e){let t,n,l,i,o,a,c,k;return{c(){t=u("div"),n=u("div"),l=u("p"),i=v("Number of questions (duplicates included): "),o=u("span"),a=u("i"),c=I(),k=v(e[6]),r(a,"class","bi bi-collection"),r(o,"class","badge text-bg-light font-monospace"),r(n,"class","col-md"),r(t,"class","row")},m(f,d){G(f,t,d),s(t,n),s(n,l),s(l,i),s(l,o),s(o,a),s(o,c),s(o,k)},p(f,d){d&64&&Q(k,f[6])},d(f){f&&H(t)}}}function Je(e){let t,n,l,i,o,a,c,k,f,d,_=e[2]>=40&&Xe(e),w=e[2]>=70&&Ze(e);return{c(){t=u("div"),_&&_.c(),n=I(),w&&w.c(),l=I(),i=u("button"),o=u("i"),a=v(" Repeat "),c=v(e[2]),k=v(" incorrect"),r(o,"class","bi bi-repeat"),r(i,"class","btn btn-sm btn-outline-secondary"),r(i,"type","button"),r(t,"class","d-grid gap-2")},m(g,b){G(g,t,b),_&&_.m(t,null),s(t,n),w&&w.m(t,null),s(t,l),s(t,i),s(i,o),s(i,a),s(i,c),s(i,k),f||(d=X(i,"click",ie(e[17])),f=!0)},p(g,b){g[2]>=40?_?_.p(g,b):(_=Xe(g),_.c(),_.m(t,n)):_&&(_.d(1),_=null),g[2]>=70?w?w.p(g,b):(w=Ze(g),w.c(),w.m(t,l)):w&&(w.d(1),w=null),b&4&&Q(c,g[2])},d(g){g&&H(t),_&&_.d(),w&&w.d(),f=!1,d()}}}function Xe(e){let t,n,l;return{c(){t=u("button"),t.innerHTML='<i class="bi bi-repeat"></i> Repeat 30 incorrect',r(t,"class","btn btn-sm btn-outline-secondary"),r(t,"type","button")},m(i,o){G(i,t,o),n||(l=X(t,"click",ie(e[15])),n=!0)},p:ne,d(i){i&&H(t),n=!1,l()}}}function Ze(e){let t,n,l;return{c(){t=u("button"),t.innerHTML='<i class="bi bi-repeat"></i> Repeat 60 incorrect',r(t,"class","btn btn-sm btn-outline-secondary"),r(t,"type","button")},m(i,o){G(i,t,o),n||(l=X(t,"click",ie(e[16])),n=!0)},p:ne,d(i){i&&H(t),n=!1,l()}}}function yt(e){let t;function n(o,a){return o[6]===o[1]?qt:Lt}let l=n(e),i=l(e);return{c(){i.c(),t=Ue()},m(o,a){i.m(o,a),G(o,t,a)},p(o,[a]){l===(l=n(o))&&i?i.p(o,a):(i.d(1),i=l(o),i&&(i.c(),i.m(t.parentNode,t)))},i:ne,o:ne,d(o){o&&H(t),i.d(o)}}}function Ut(e,t,n){let l,i,o,a,c,k,f,{decks:d}=t,{moduleId:_}=t,w=[],g=[],b,m;function p(C){const N={module_id:_,question_ids:C};axios.post("/api/sessions/newfromquestionids",N).then(function(P){window.location.href="/sessions/"+P.data.id}).catch(function(P){alert(P)})}function L(C){ve[C?"unshift":"push"](()=>{m=C,n(0,m)})}const h=()=>p(f.slice(0,30)),y=()=>p(f.slice(0,60)),D=()=>p(f);return e.$$set=C=>{"decks"in C&&n(9,d=C.decks),"moduleId"in C&&n(10,_=C.moduleId)},e.$$.update=()=>{e.$$.dirty&2560&&(()=>{const C=d.map(P=>P.questions).flat();n(11,w=C.filter(P=>!P.is_invalid));const N=[];for(const P of d){const M=P.sessions.sort((O,z)=>z.id-O.id);if(M.length===0)continue;const j=M[0];N.push(...j.answer_choices)}n(12,g=N.filter(P=>w.some(({id:M})=>M===P.question_id)))})(),e.$$.dirty&2048&&n(6,l=w.length),e.$$.dirty&4096&&n(5,i=g.length),e.$$.dirty&96&&n(1,o=l-i),e.$$.dirty&4096&&n(4,a=g.filter(C=>C.is_correct&&!C.help_used).length),e.$$.dirty&4096&&n(3,c=g.filter(C=>C.is_correct&&C.help_used).length),e.$$.dirty&4096&&n(2,k=g.filter(C=>!C.is_correct).length),e.$$.dirty&4096&&n(7,f=g.filter(C=>!C.is_correct).map(C=>C.question_id)),e.$$.dirty&8223&&m&&(()=>{const C={type:"doughnut",data:{labels:["Correct","Correct with help","Incorrect","Unanswered"],datasets:[{label:"n",data:[a,c,k,o],backgroundColor:["#d4edda","#fff3cd","#f8d7da","#bbbbbb"],hoverOffet:4}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:null},plugins:{legend:{display:!1}}}};b&&b.destroy();var N=m.getContext("2d");n(13,b=new Mt(N,C))})()},[m,o,k,c,a,i,l,f,p,d,_,w,g,b,L,h,y,D]}class Nt extends je{constructor(t){super(),Ae(this,t,Ut,yt,Pe,{decks:9,moduleId:10})}}function jt(e){let t,n=Ge(He(e[0].created_at),"dd.MM.yyyy")+"",l;return{c(){t=u("span"),l=v(n),r(t,"class","badge text-bg-light")},m(i,o){G(i,t,o),s(t,l)},p(i,o){o&1&&n!==(n=Ge(He(i[0].created_at),"dd.MM.yyyy")+"")&&Q(l,n)},d(i){i&&H(t)}}}function At(e){let t,n=Ge(He(e[0].exam_at),"dd.MM.yyyy")+"",l;return{c(){t=u("span"),l=v(n),r(t,"class","badge text-bg-light")},m(i,o){G(i,t,o),s(t,l)},p(i,o){o&1&&n!==(n=Ge(He(i[0].exam_at),"dd.MM.yyyy")+"")&&Q(l,n)},d(i){i&&H(t)}}}function $e(e){let t,n,l,i=e[0].sessions.length+"",o;return{c(){t=u("span"),n=u("i"),l=I(),o=v(i),r(n,"class","bi bi-rocket"),r(t,"class","badge text-bg-light font-monospace"),r(t,"title","Number of sessions")},m(a,c){G(a,t,c),s(t,n),s(t,l),s(t,o)},p(a,c){c&1&&i!==(i=a[0].sessions.length+"")&&Q(o,i)},d(a){a&&H(t)}}}function xe(e){let t,n;return{c(){t=new bt(!1),n=Ue(),t.a=n},m(l,i){t.m(e[3],l,i),G(l,n,i)},p(l,i){i&8&&t.p(l[3])},d(l){l&&(H(n),t.d())}}}function Pt(e){let t,n,l,i,o,a,c,k=e[0].questions.length+"",f,d,_,w,g,b,m,p,L,h,y,D,C,N=e[0].name+"",P,M,j,O,z,R,T,x,Y;function le(q,A){return q[0].exam_at?At:jt}let $=le(e),E=$(e),B=e[0].sessions&&$e(e),V=e[3]&&xe(e);return{c(){t=u("div"),n=u("div"),l=u("div"),E.c(),i=I(),o=u("span"),a=u("i"),c=I(),f=v(k),d=I(),B&&B.c(),_=I(),V&&V.c(),w=I(),g=u("button"),b=u("i"),b.innerHTML="",m=I(),p=u("input"),y=I(),D=u("div"),C=u("h6"),P=v(N),M=I(),j=u("button"),j.innerHTML='<i class="bi bi-rocket-takeoff"></i> Start session',O=I(),z=u("a"),R=v("Browse deck"),r(a,"class","bi bi-collection"),r(o,"class","badge text-bg-light font-monospace"),r(o,"title","Number of questions"),ce(b,"bi-bookmark-check-fill",e[4]),ce(b,"bi-bookmark",!e[4]),r(g,"class","btn btn-sm btn-link"),r(p,"type","checkbox"),r(p,"class","form-check-input float-end"),p.value="",r(p,"id",L="selected"+e[0].id),p.checked=h=e[2].has(e[0].id),r(l,"class","card-header"),r(C,"class","card-title"),r(j,"type","button"),r(j,"class","btn btn-sm btn-primary"),r(z,"href",T="/decks/"+e[0].id),r(z,"class","card-link"),r(D,"class","card-body"),r(n,"class","card"),r(t,"class","col-lg-6 mb-1")},m(q,A){G(q,t,A),s(t,n),s(n,l),E.m(l,null),s(l,i),s(l,o),s(o,a),s(o,c),s(o,f),s(l,d),B&&B.m(l,null),s(l,_),V&&V.m(l,null),s(l,w),s(l,g),s(g,b),s(l,m),s(l,p),s(n,y),s(n,D),s(D,C),s(C,P),s(D,M),s(D,j),s(D,O),s(D,z),s(z,R),x||(Y=[X(g,"click",e[5]),X(p,"click",e[6]),X(j,"click",ie(e[7]))],x=!0)},p(q,[A]){$===($=le(q))&&E?E.p(q,A):(E.d(1),E=$(q),E&&(E.c(),E.m(l,i))),A&1&&k!==(k=q[0].questions.length+"")&&Q(f,k),q[0].sessions?B?B.p(q,A):(B=$e(q),B.c(),B.m(l,_)):B&&(B.d(1),B=null),q[3]?V?V.p(q,A):(V=xe(q),V.c(),V.m(l,w)):V&&(V.d(1),V=null),A&16&&ce(b,"bi-bookmark-check-fill",q[4]),A&16&&ce(b,"bi-bookmark",!q[4]),A&1&&L!==(L="selected"+q[0].id)&&r(p,"id",L),A&5&&h!==(h=q[2].has(q[0].id))&&(p.checked=h),A&1&&N!==(N=q[0].name+"")&&Q(P,N),A&1&&T!==(T="/decks/"+q[0].id)&&r(z,"href",T)},i:ne,o:ne,d(q){q&&H(t),E.d(),B&&B.d(),V&&V.d(),x=!1,Re(Y)}}}function Qt(e,t,n){let{deck:l}=t,{selectDeck:i}=t,{selectedDecks:o}=t,a,c=l.bookmarks.length>0;pt(()=>{const _=l.questions.filter(p=>!p.is_invalid),w=l.sessions.sort((p,L)=>L.id-p.id);if(w.length===0)return;const b=w[0].answer_choices.filter(p=>_.some(({id:L})=>L===p.question_id)),m=Ct(_.length,b);m.correct>=60?n(3,a='<span style="color: #155724; background-color: #d4edda;" class="badge" title="Correct answers in percent">'+m.correct+" %</span>"):n(3,a='<span style="color: #721c24; background-color: #f8d7da;" class="badge" title="Correct answers in percent">'+m.correct+" %</span>")});function k(){c?axios.delete("/api/decks/"+l.id+"/bookmark/"+l.bookmarks[0].id).then(function(_){_.status===204&&n(4,c=!1)}).catch(function(_){alert(_)}):axios.post("/api/decks/"+l.id+"/bookmark").then(function(_){_.status===200&&(n(4,c=!0),n(0,l.bookmarks=[_.data],l))}).catch(function(_){alert(_)})}const f=()=>i(l.id),d=()=>It(l.id);return e.$$set=_=>{"deck"in _&&n(0,l=_.deck),"selectDeck"in _&&n(1,i=_.selectDeck),"selectedDecks"in _&&n(2,o=_.selectedDecks)},[l,i,o,a,c,k,f,d]}class Gt extends je{constructor(t){super(),Ae(this,t,Qt,Pt,Pe,{deck:0,selectDeck:1,selectedDecks:2})}}function et(e,t,n){const l=e.slice();return l[17]=t[n],l}function tt(e,t,n){const l=e.slice();return l[20]=t[n],l[21]=t,l[22]=n,l}function lt(e){let t;return{c(){t=u("div"),t.innerHTML='<div class="alert alert-light">No decks found! Create a new deck <a href="/decks" class="alert-link">here</a>.</div> ',r(t,"class","col")},m(n,l){G(n,t,l)},p:ne,d(n){n&&H(t)}}}function st(e,t){let n,l,i,o,a;function c(d){t[11](d,t[20],t[21],t[22])}function k(d){t[12](d)}let f={selectDeck:t[2]};return t[20]!==void 0&&(f.deck=t[20]),t[1]!==void 0&&(f.selectedDecks=t[1]),l=new Gt({props:f}),ve.push(()=>qe(l,"deck",c)),ve.push(()=>qe(l,"selectedDecks",k)),{key:e,first:null,c(){n=Ue(),Te(l.$$.fragment),this.first=n},m(d,_){G(d,n,_),Be(l,d,_),a=!0},p(d,_){t=d;const w={};_&4&&(w.selectDeck=t[2]),!i&&_&8&&(i=!0,w.deck=t[20],ye(()=>i=!1)),!o&&_&2&&(o=!0,w.selectedDecks=t[1],ye(()=>o=!1)),l.$set(w)},i(d){a||(be(l.$$.fragment,d),a=!0)},o(d){he(l.$$.fragment,d),a=!1},d(d){d&&H(n),Ve(l,d)}}}function nt(e){let t,n,l,i,o,a=e[5].from+"",c,k,f,d=e[5].to+"",_,w,g,b=e[5].total+"",m,p,L,h=e[5].last_page>1&&it(e);return{c(){t=u("div"),n=u("div"),l=u("p"),i=v("Showing "),o=u("span"),c=v(a),k=v(`
                to `),f=u("span"),_=v(d),w=v(`
                of `),g=u("span"),m=v(b),p=v(" decks"),L=I(),h&&h.c(),r(o,"class","fw-semibold"),r(f,"class","fw-semibold"),r(g,"class","fw-semibold"),r(l,"class","small text-muted"),r(n,"class","col"),r(t,"class","row sticky-bottom bg-white mt-3 pt-3")},m(y,D){G(y,t,D),s(t,n),s(n,l),s(l,i),s(l,o),s(o,c),s(l,k),s(l,f),s(f,_),s(l,w),s(l,g),s(g,m),s(l,p),s(t,L),h&&h.m(t,null)},p(y,D){D&32&&a!==(a=y[5].from+"")&&Q(c,a),D&32&&d!==(d=y[5].to+"")&&Q(_,d),D&32&&b!==(b=y[5].total+"")&&Q(m,b),y[5].last_page>1?h?h.p(y,D):(h=it(y),h.c(),h.m(t,null)):h&&(h.d(1),h=null)},d(y){y&&H(t),h&&h.d()}}}function it(e){let t,n,l,i,o,a,c,k,f,d,_,w=pe(e[5].links.slice(1,e[5].links.length-1)),g=[];for(let b=0;b<w.length;b+=1)g[b]=ot(et(e,w,b));return{c(){t=u("div"),n=u("nav"),l=u("ul"),i=u("li"),o=u("button"),o.textContent="‹",a=I();for(let b=0;b<g.length;b+=1)g[b].c();c=I(),k=u("li"),f=u("button"),f.textContent="›",r(o,"class","page-link"),r(i,"class","page-item"),ce(i,"disabled",e[5].prev_page_url===null),r(f,"class","page-link"),r(k,"class","page-item"),ce(k,"disabled",e[5].next_page_url===null),r(l,"class","pagination"),r(t,"class","col")},m(b,m){G(b,t,m),s(t,n),s(n,l),s(l,i),s(i,o),s(l,a);for(let p=0;p<g.length;p+=1)g[p]&&g[p].m(l,null);s(l,c),s(l,k),s(k,f),d||(_=[X(o,"click",ie(e[13])),X(f,"click",ie(e[15]))],d=!0)},p(b,m){if(m&32&&ce(i,"disabled",b[5].prev_page_url===null),m&160){w=pe(b[5].links.slice(1,b[5].links.length-1));let p;for(p=0;p<w.length;p+=1){const L=et(b,w,p);g[p]?g[p].p(L,m):(g[p]=ot(L),g[p].c(),g[p].m(l,c))}for(;p<g.length;p+=1)g[p].d(1);g.length=w.length}m&32&&ce(k,"disabled",b[5].next_page_url===null)},d(b){b&&H(t),Ke(g,b),d=!1,Re(_)}}}function ot(e){let t,n,l=e[17].label+"",i,o,a;function c(){return e[14](e[17])}return{c(){t=u("li"),n=u("button"),i=v(l),r(n,"class","page-link"),r(t,"class","page-item d-none d-sm-block"),ce(t,"disabled",e[17].active||!e[17].url)},m(k,f){G(k,t,f),s(t,n),s(n,i),o||(a=X(n,"click",ie(c)),o=!0)},p(k,f){e=k,f&32&&l!==(l=e[17].label+"")&&Q(i,l),f&32&&ce(t,"disabled",e[17].active||!e[17].url)},d(k){k&&H(t),o=!1,a()}}}function Ht(e){let t,n,l,i,o,a,c,k,f,d,_,w,g,b,m,p,L,h,y,D,C,N,P,M,j=[],O=new Map,z,R,T,x,Y;function le(S){e[9](S)}function $(S){e[10](S)}let E={};e[3]!==void 0&&(E.decks=e[3]),e[0]!==void 0&&(E.moduleId=e[0]),D=new Nt({props:E}),ve.push(()=>qe(D,"decks",le)),ve.push(()=>qe(D,"moduleId",$));let B=pe(e[3]);const V=S=>S[20].id;for(let S=0;S<B.length;S+=1){let U=tt(e,B,S),F=V(U);O.set(F,j[S]=st(F,U))}let q=null;B.length||(q=lt());let A=e[5]&&e[5].total>0&&nt(e);return{c(){t=u("div"),n=u("div"),l=u("div"),i=u("span"),i.innerHTML='<i class="bi bi-archive"></i>',o=I(),a=u("select"),c=u("option"),k=v("Main decks"),d=u("option"),_=v("Your decks"),g=u("option"),b=v("User decks"),p=u("option"),L=v("Bookmarked decks"),y=I(),Te(D.$$.fragment),P=I(),M=u("div");for(let S=0;S<j.length;S+=1)j[S].c();q&&q.c(),z=I(),A&&A.c(),R=Ue(),r(i,"class","input-group-text"),c.__value="public-rw-listed",Le(c,c.__value),c.selected=f=e[4]==="public-rw-listed",d.__value="user",Le(d,d.__value),d.selected=w=e[4]==="user",g.__value="public",Le(g,g.__value),g.selected=m=e[4]==="public",p.__value="bookmarked",Le(p,p.__value),p.selected=h=e[4]==="bookmarked",r(a,"id","kind"),r(a,"class","form-select"),e[4]===void 0&&ht(()=>e[8].call(a)),r(l,"class","input-group"),r(n,"class","col"),r(t,"class","row mb-3"),r(M,"class","row")},m(S,U){G(S,t,U),s(t,n),s(n,l),s(l,i),s(l,o),s(l,a),s(a,c),s(c,k),s(a,d),s(d,_),s(a,g),s(g,b),s(a,p),s(p,L),Fe(a,e[4],!0),G(S,y,U),Be(D,S,U),G(S,P,U),G(S,M,U);for(let F=0;F<j.length;F+=1)j[F]&&j[F].m(M,null);q&&q.m(M,null),G(S,z,U),A&&A.m(S,U),G(S,R,U),T=!0,x||(Y=[X(a,"change",e[8]),X(a,"change",e[6])],x=!0)},p(S,[U]){(!T||U&16&&f!==(f=S[4]==="public-rw-listed"))&&(c.selected=f),(!T||U&16&&w!==(w=S[4]==="user"))&&(d.selected=w),(!T||U&16&&m!==(m=S[4]==="public"))&&(g.selected=m),(!T||U&16&&h!==(h=S[4]==="bookmarked"))&&(p.selected=h),U&16&&Fe(a,S[4]);const F={};!C&&U&8&&(C=!0,F.decks=S[3],ye(()=>C=!1)),!N&&U&1&&(N=!0,F.moduleId=S[0],ye(()=>N=!1)),D.$set(F),U&14&&(B=pe(S[3]),kt(),j=Dt(j,U,V,1,S,B,O,M,St,st,null,tt),gt(),!B.length&&q?q.p(S,U):B.length?q&&(q.d(1),q=null):(q=lt(),q.c(),q.m(M,null))),S[5]&&S[5].total>0?A?A.p(S,U):(A=nt(S),A.c(),A.m(R.parentNode,R)):A&&(A.d(1),A=null)},i(S){if(!T){be(D.$$.fragment,S);for(let U=0;U<B.length;U+=1)be(j[U]);T=!0}},o(S){he(D.$$.fragment,S);for(let U=0;U<j.length;U+=1)he(j[U]);T=!1},d(S){S&&(H(t),H(y),H(P),H(M),H(z),H(R)),Ve(D,S);for(let U=0;U<j.length;U+=1)j[U].d();q&&q.d(),A&&A.d(S),x=!1,Re(Y)}}}function ze(e){return new URLSearchParams(window.location.search).get(e)}function Rt(e,t,n){let{moduleId:l}=t,{selectDeck:i}=t,{selectedDecks:o}=t,a=[],c=ze("kind")??"public-rw-listed",k=ze("page")??1,f;function d(){if(!l){n(3,a=[]);return}const D=new URL(window.location);D.searchParams.set("module",l),D.searchParams.set("kind",c),D.searchParams.set("page",k),window.history.replaceState({},"",D),axios.get("/api/decks?module="+l+"&kind="+c+"&page="+k).then(function(C){n(5,f=C.data),n(3,a=f.data),a.sort(function(N,P){return N.exam_at===null||P.exam_at===null?N.id<P.id?1:N.id>P.id?-1:0:N.exam_at<P.exam_at?1:N.exam_at>P.exam_at?-1:0})}).catch(function(C){alert(C)})}function _(D){k=D,d()}function w(){c=vt(this),n(4,c)}function g(D){a=D,n(3,a)}function b(D){l=D,n(0,l)}function m(D,C,N,P){N[P]=D,n(3,a)}function p(D){o=D,n(1,o)}const L=()=>{f.prev_page_url&&_(f.current_page-1)},h=D=>{D.url&&_(D.label)},y=()=>{f.next_page_url&&_(f.current_page+1)};return e.$$set=D=>{"moduleId"in D&&n(0,l=D.moduleId),"selectDeck"in D&&n(2,i=D.selectDeck),"selectedDecks"in D&&n(1,o=D.selectedDecks)},e.$$.update=()=>{e.$$.dirty&1&&(k=ze("page")??1,d())},[l,o,i,a,c,f,d,_,w,g,b,m,p,L,h,y]}class Tt extends je{constructor(t){super(),Ae(this,t,Rt,Ht,Pe,{moduleId:0,selectDeck:2,selectedDecks:1})}}function at(e){let t,n,l,i,o,a,c,k,f,d=e[1].length+"",_,w,g=e[1].length>1?"s":"",b,m,p,L=e[3].length+"",h,y,D=e[3].length>1?"s":"",C,N,P,M=e[2]?"excluded":"included",j,O,z,R,T,x,Y,le,$,E,B,V,q,A,S,U,F=e[3].length+"",re,we,ke=e[3].length>1?"s":"",De,de,Se,se,oe,fe=e[5].length+"",Me,ge,_e=e[5].length>1?"s":"",Ce,Ne,me,ue,Ie,ae,Z=e[5].length>0&&ct(e);return{c(){t=u("div"),n=u("div"),l=u("div"),i=u("p"),i.textContent="Create your own super deck:",o=I(),a=u("p"),c=v("You have "),k=u("strong"),f=v("selected "),_=v(d),w=v(" deck"),b=v(g),m=v(`
                    with `),p=u("strong"),h=v(L),y=v(" question"),C=v(D),N=I(),Z&&Z.c(),P=v(`
                    (duplicates `),j=v(M),O=v(")"),z=I(),R=u("div"),T=u("label"),T.textContent="Deck Name",x=I(),Y=u("input"),le=I(),$=u("div"),E=u("input"),B=I(),V=u("label"),V.textContent="Filter out duplicates",q=I(),A=u("div"),S=u("button"),U=v("Create deck ("),re=v(F),we=v(" question"),De=v(ke),de=v(")"),Se=I(),se=u("button"),oe=v("Create deck ("),Me=v(fe),ge=v(" image question"),Ce=v(_e),Ne=v(")"),me=I(),ue=u("button"),ue.textContent="Cancel",r(T,"for","name"),r(T,"class","form-label"),r(Y,"type","text"),r(Y,"class","form-control"),r(Y,"id","name"),r(R,"class","mb-3"),r(E,"type","checkbox"),r(E,"class","form-check-input"),r(E,"id","checkboxRemoveDuplicates"),r(V,"class","form-check-label"),r(V,"for","checkboxRemoveDuplicates"),r($,"class","mb-3 form-check"),r(S,"class","btn btn-sm btn-primary"),r(se,"class","btn btn-sm btn-primary"),r(ue,"class","btn btn-sm btn-link"),r(A,"class","d-grid gap-2 d-md-block"),r(l,"class","alert alert-light"),r(l,"role","alert"),r(n,"class","col-md"),r(t,"class","row")},m(W,J){G(W,t,J),s(t,n),s(n,l),s(l,i),s(l,o),s(l,a),s(a,c),s(a,k),s(k,f),s(k,_),s(k,w),s(k,b),s(a,m),s(a,p),s(p,h),s(p,y),s(p,C),s(a,N),Z&&Z.m(a,null),s(a,P),s(a,j),s(a,O),s(l,z),s(l,R),s(R,T),s(R,x),s(R,Y),Le(Y,e[4]),s(l,le),s(l,$),s($,E),E.checked=e[2],s($,B),s($,V),s(l,q),s(l,A),s(A,S),s(S,U),s(S,re),s(S,we),s(S,De),s(S,de),s(A,Se),s(A,se),s(se,oe),s(se,Me),s(se,ge),s(se,Ce),s(se,Ne),s(A,me),s(A,ue),Ie||(ae=[X(Y,"input",e[6]),X(Y,"focus",Vt),X(E,"change",e[7]),X(S,"click",ie(e[8])),X(se,"click",ie(e[9])),X(ue,"click",ie(e[10]))],Ie=!0)},p(W,J){J&2&&d!==(d=W[1].length+"")&&Q(_,d),J&2&&g!==(g=W[1].length>1?"s":"")&&Q(b,g),J&8&&L!==(L=W[3].length+"")&&Q(h,L),J&8&&D!==(D=W[3].length>1?"s":"")&&Q(C,D),W[5].length>0?Z?Z.p(W,J):(Z=ct(W),Z.c(),Z.m(a,P)):Z&&(Z.d(1),Z=null),J&4&&M!==(M=W[2]?"excluded":"included")&&Q(j,M),J&16&&Y.value!==W[4]&&Le(Y,W[4]),J&4&&(E.checked=W[2]),J&8&&F!==(F=W[3].length+"")&&Q(re,F),J&8&&ke!==(ke=W[3].length>1?"s":"")&&Q(De,ke),J&32&&fe!==(fe=W[5].length+"")&&Q(Me,fe),J&32&&_e!==(_e=W[5].length>1?"s":"")&&Q(Ce,_e)},d(W){W&&H(t),Z&&Z.d(),Ie=!1,Re(ae)}}}function ct(e){let t,n,l=e[5].length+"",i,o,a=e[5].length>1?"s":"",c,k;return{c(){t=v("/ "),n=u("strong"),i=v(l),o=v(" question"),c=v(a),k=v(" with images")},m(f,d){G(f,t,d),G(f,n,d),s(n,i),s(n,o),s(n,c),s(n,k)},p(f,d){d&32&&l!==(l=f[5].length+"")&&Q(i,l),d&32&&a!==(a=f[5].length>1?"s":"")&&Q(c,a)},d(f){f&&(H(t),H(n))}}}function Bt(e){let t,n=e[1].length>0&&at(e);return{c(){n&&n.c(),t=Ue()},m(l,i){n&&n.m(l,i),G(l,t,i)},p(l,[i]){l[1].length>0?n?n.p(l,i):(n=at(l),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:ne,o:ne,d(l){l&&H(t),n&&n.d(l)}}}function ut(e,t){var n={name:e,question_ids:t};axios.post("/api/decks",n).then(function(l){window.location.href="/decks/"+l.data.id}).catch(function(l){alert(l)})}const Vt=e=>e.target.select();function Et(e,t,n){let l,i,{selectedDecks:o}=t,a=[],c="My new super deck",k=!0;function f(){if(o.size===0){n(1,a=[]);return}const m=[...o].map(p=>"decks[]="+p);axios.get("/api/decks?"+m.join("&")).then(function(p){n(1,a=p.data)}).catch(function(p){alert(p)})}function d(){c=this.value,n(4,c)}function _(){k=this.checked,n(2,k)}const w=()=>ut(c,l.map(m=>m.id)),g=()=>ut(c,i.map(m=>m.id)),b=()=>n(0,o=new Set);return e.$$set=m=>{"selectedDecks"in m&&n(0,o=m.selectedDecks)},e.$$.update=()=>{e.$$.dirty&1&&f(),e.$$.dirty&6&&n(3,l=(()=>{var m=[];return a.forEach(p=>m.push(...p.questions)),k?[...new Map(m.map(p=>[p.id,p])).values()]:m})()),e.$$.dirty&6&&n(5,i=(()=>{var m=[];return a.forEach(p=>{p.questions.forEach(L=>{L.images.length>0&&m.push(L)})}),k?[...new Map(m.map(p=>[p.id,p])).values()]:m})())},[o,a,k,l,c,i,d,_,w,g,b]}class Ot extends je{constructor(t){super(),Ae(this,t,Et,Bt,Pe,{selectedDecks:0})}}function rt(e,t,n){const l=e.slice();return l[12]=t[n],l}function dt(e,t,n){const l=e.slice();return l[15]=t[n],l}function ft(e){let t,n,l=pe(e[2]),i=[];for(let o=0;o<l.length;o+=1)i[o]=_t(dt(e,l,o));return{c(){t=u("ul");for(let o=0;o<i.length;o+=1)i[o].c();n=I(),r(t,"class","list-group m-2 me-0")},m(o,a){G(o,t,a);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(t,null);s(t,n)},p(o,a){if(a&37){l=pe(o[2]);let c;for(c=0;c<l.length;c+=1){const k=dt(o,l,c);i[c]?i[c].p(k,a):(i[c]=_t(k),i[c].c(),i[c].m(t,n))}for(;c<i.length;c+=1)i[c].d(1);i.length=l.length}},d(o){o&&H(t),Ke(i,o)}}}function _t(e){let t,n=e[15].name+"",l,i,o,a;function c(){return e[9](e[15])}return{c(){t=u("button"),l=v(n),r(t,"data-bs-target","#offcanvasModuleSelection"),r(t,"data-bs-dismiss","offcanvas"),r(t,"class",i="list-group-item list-group-item-action "+(e[0].last_module_id===e[15].id?"list-group-item-secondary":"list-group-item-light"))},m(k,f){G(k,t,f),s(t,l),o||(a=X(t,"click",ie(c)),o=!0)},p(k,f){e=k,f&4&&n!==(n=e[15].name+"")&&Q(l,n),f&5&&i!==(i="list-group-item list-group-item-action "+(e[0].last_module_id===e[15].id?"list-group-item-secondary":"list-group-item-light"))&&r(t,"class",i)},d(k){k&&H(t),o=!1,a()}}}function mt(e){let t,n=e[12].name+"",l,i,o,a,c,k;function f(){return e[8](e[12])}let d=e[0].last_subject_id===e[12].id&&ft(e);return{c(){t=u("button"),l=v(n),o=I(),d&&d.c(),a=Ue(),r(t,"class",i="list-group-item list-group-item-action "+(e[0].last_subject_id===e[12].id?"list-group-item-dark":"list-group-item-light"))},m(_,w){G(_,t,w),s(t,l),G(_,o,w),d&&d.m(_,w),G(_,a,w),c||(k=X(t,"click",ie(f)),c=!0)},p(_,w){e=_,w&2&&n!==(n=e[12].name+"")&&Q(l,n),w&3&&i!==(i="list-group-item list-group-item-action "+(e[0].last_subject_id===e[12].id?"list-group-item-dark":"list-group-item-light"))&&r(t,"class",i),e[0].last_subject_id===e[12].id?d?d.p(e,w):(d=ft(e),d.c(),d.m(a.parentNode,a)):d&&(d.d(1),d=null)},d(_){_&&(H(t),H(o),H(a)),d&&d.d(_),c=!1,k()}}}function zt(e){let t;return{c(){t=u("p"),t.textContent="No module selected."},m(n,l){G(n,t,l)},p:ne,i:ne,o:ne,d(n){n&&H(t)}}}function Kt(e){let t,n,l;function i(a){e[11](a)}let o={moduleId:e[0].last_module_id,selectDeck:e[6]};return e[3]!==void 0&&(o.selectedDecks=e[3]),t=new Tt({props:o}),ve.push(()=>qe(t,"selectedDecks",i)),{c(){Te(t.$$.fragment)},m(a,c){Be(t,a,c),l=!0},p(a,c){const k={};c&1&&(k.moduleId=a[0].last_module_id),!n&&c&8&&(n=!0,k.selectedDecks=a[3],ye(()=>n=!1)),t.$set(k)},i(a){l||(be(t.$$.fragment,a),l=!0)},o(a){he(t.$$.fragment,a),l=!1},d(a){Ve(t,a)}}}function Wt(e){let t,n,l,i,o,a,c,k,f,d,_,w,g,b,m,p,L=pe(e[1]),h=[];for(let M=0;M<L.length;M+=1)h[M]=mt(rt(e,L,M));function y(M){e[10](M)}let D={};e[3]!==void 0&&(D.selectedDecks=e[3]),_=new Ot({props:D}),ve.push(()=>qe(_,"selectedDecks",y));const C=[Kt,zt],N=[];function P(M,j){return M[0].last_module_id?0:1}return b=P(e),m=N[b]=C[b](e),{c(){t=u("div"),t.innerHTML='<div class="col-12 d-grid mb-2"><button type="button" class="btn btn-sm btn-primary d-lg-none my-2" data-bs-toggle="offcanvas" data-bs-target="#offcanvasModuleSelection" aria-controls="offcanvasModuleSelection">Switch module</button></div>',n=I(),l=u("div"),i=u("div"),o=u("div"),o.innerHTML='<h5 id="offcanvasAddToDeckLabel">Choose subject and module</h5> <button type="button" class="btn-close text-reset" data-bs-target="#offcanvasModuleSelection" data-bs-dismiss="offcanvas" aria-label="Close"></button>',a=I(),c=u("div"),k=u("ul");for(let M=0;M<h.length;M+=1)h[M].c();f=I(),d=u("div"),Te(_.$$.fragment),g=I(),m.c(),r(t,"class","row"),r(o,"class","offcanvas-header"),r(k,"class","list-group w-100"),r(c,"class","offcanvas-body"),r(i,"class","col-lg-4 offcanvas-lg offcanvas-start"),r(i,"tabindex","-1"),r(i,"id","offcanvasModuleSelection"),r(d,"class","col-12 col-lg-8"),r(l,"class","row")},m(M,j){G(M,t,j),G(M,n,j),G(M,l,j),s(l,i),s(i,o),s(i,a),s(i,c),s(c,k);for(let O=0;O<h.length;O+=1)h[O]&&h[O].m(k,null);s(l,f),s(l,d),Be(_,d,null),s(d,g),N[b].m(d,null),p=!0},p(M,[j]){if(j&55){L=pe(M[1]);let R;for(R=0;R<L.length;R+=1){const T=rt(M,L,R);h[R]?h[R].p(T,j):(h[R]=mt(T),h[R].c(),h[R].m(k,null))}for(;R<h.length;R+=1)h[R].d(1);h.length=L.length}const O={};!w&&j&8&&(w=!0,O.selectedDecks=M[3],ye(()=>w=!1)),_.$set(O);let z=b;b=P(M),b===z?N[b].p(M,j):(kt(),he(N[z],1,1,()=>{N[z]=null}),gt(),m=N[b],m?m.p(M,j):(m=N[b]=C[b](M),m.c()),be(m,1),m.m(d,null))},i(M){p||(be(_.$$.fragment,M),be(m),p=!0)},o(M){he(_.$$.fragment,M),he(m),p=!1},d(M){M&&(H(t),H(n),H(l)),Ke(h,M),Ve(_),N[b].d()}}}function Yt(e,t,n){let l;wt(e,Qe,m=>n(0,l=m));let i=[],o=[],a=[],c=new Set;pt(()=>{axios.get("/api/modules").then(function(m){var p=m.data;n(7,i=p.filter((h,y,D)=>y===D.findIndex(C=>C.id===h.id)).sort(function(h,y){return h.name>y.name?1:h.name<y.name?-1:0}));var L=i.map(h=>h.subject).filter(h=>!!h);n(1,o=L.filter((h,y,D)=>y===D.findIndex(C=>C.id===h.id)).sort(function(h,y){return h.name>y.name?1:h.name<y.name?-1:0}))}).catch(function(m){alert(m)})});function k(m){var p={last_subject_id:m,last_module_id:0};axios.put("/api/users/me/settings",p).then(function(L){const h=new URL(window.location);h.searchParams.delete("module"),h.searchParams.delete("page"),window.history.replaceState({},"",h),Oe(Qe,l.last_subject_id=m,l),Oe(Qe,l.last_module_id=0,l)}).catch(function(L){alert(L)})}function f(m){var p={last_module_id:m};axios.put("/api/users/me/settings",p).then(function(L){const h=new URL(window.location);h.searchParams.set("module",m),h.searchParams.set("page",1),window.history.replaceState({},"",h),Oe(Qe,l.last_module_id=m,l)}).catch(function(L){alert(L)})}function d(m){c.has(m)?c.delete(m):c.add(m),n(3,c=new Set([...c]))}const _=m=>k(m.id),w=m=>f(m.id);function g(m){c=m,n(3,c)}function b(m){c=m,n(3,c)}return e.$$.update=()=>{e.$$.dirty&129&&(l.last_subject_id,n(2,a=i.filter(m=>l.last_subject_id?m.subject?m.subject.id===l.last_subject_id:!1:!0)))},[l,o,a,c,k,f,d,i,_,w,g,b]}class Ft extends je{constructor(t){super(),Ae(this,t,Yt,Wt,Pe,{})}}const Jt=document.getElementById("NewSessionView");new Ft({target:Jt});
