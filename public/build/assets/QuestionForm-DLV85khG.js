import{z as Xt,A as Zt,B as $t,C as ei,D as ti,E as ii,F as ni,G as si,U as ai,H as oi,h as k,g as o,I as ri,p as _t,m as M,l as ie,a as yt,i as wt,f as Q,s as u,j as l,t as H,u as v,k as f,d as K,e as xt,r as ci,b as _e,c as U,w as Fe,n as li}from"./lifecycle-BvmTvt_c.js";import{o as kt}from"./index-client-DUeXGvoC.js";import{s as G,a as z,b as Ne,e as T,p as J,c as vt,g as di,f as Ue,i as ui}from"./event-modifiers-C9-V6teM.js";import{h as ce}from"./html-DWUw1S_J.js";import{p as ae,s as B}from"./props-DkMS-7Z0.js";import{s as fi}from"./style-BxdPOk1g.js";import{b as xe,a as pt}from"./input-CvY2ozlN.js";import{b as mt}from"./select-DOPylVjq.js";import{b as ke}from"./this-DymA9FIw.js";import{_ as ht}from"./lodash-DjGC5Q8M.js";import{d as Et,p as He}from"./purify.es-Dnvgf1Dd.js";function vi(t,i,n){var e=t,s=ai,d,m,r=null,h=Xt()?Zt:$t;function x(){d&&oi(d),r!==null&&(r.lastChild.remove(),e.before(r),r=null),d=m}ei(()=>{if(h(s,s=i())){var g=e,b=si();b&&(r=document.createDocumentFragment(),r.append(g=ti())),m=ii(()=>n(g)),b?ni.add_callback(x):x()}})}function pi(t){var i=ri(0);return function(){return arguments.length===1?(k(i,o(i)+1),arguments[0]):(o(i),t())}}const ze=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Ge(t,i,n,e){t.addEventListener?t.addEventListener(i,n,e):t.attachEvent&&t.attachEvent("on".concat(i),n)}function ye(t,i,n,e){t.removeEventListener?t.removeEventListener(i,n,e):t.detachEvent&&t.detachEvent("on".concat(i),n)}function Ct(t,i){const n=i.slice(0,i.length-1);for(let e=0;e<n.length;e++)n[e]=t[n[e].toLowerCase()];return n}function At(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");const i=t.split(",");let n=i.lastIndexOf("");for(;n>=0;)i[n-1]+=",",i.splice(n,1),n=i.lastIndexOf("");return i}function mi(t,i){const n=t.length>=i.length?t:i,e=t.length>=i.length?i:t;let s=!0;for(let d=0;d<n.length;d++)e.indexOf(n[d])===-1&&(s=!1);return s}const Ce={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,arrowup:38,arrowdown:40,arrowleft:37,arrowright:39,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":ze?173:189,"=":ze?61:187,";":ze?59:186,"'":222,"{":219,"}":221,"[":219,"]":221,"\\":220},R={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,meta:91,command:91},we={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},O={16:!1,18:!1,17:!1,91:!1},y={};for(let t=1;t<20;t++)Ce["f".concat(t)]=111+t;let _=[],Ee=null,qt="all";const X=new Map,le=t=>Ce[t.toLowerCase()]||R[t.toLowerCase()]||t.toUpperCase().charCodeAt(0),hi=t=>Object.keys(Ce).find(i=>Ce[i]===t),bi=t=>Object.keys(R).find(i=>R[i]===t);function Kt(t){qt=t||"all"}function Ae(){return qt||"all"}function gi(){return _.slice(0)}function _i(){return _.map(t=>hi(t)||bi(t)||String.fromCharCode(t))}function yi(){const t=[];return Object.keys(y).forEach(i=>{y[i].forEach(n=>{let{key:e,scope:s,mods:d,shortcut:m}=n;t.push({scope:s,shortcut:m,mods:d,keys:e.split("+").map(r=>le(r))})})}),t}function wi(t){const i=t.target||t.srcElement,{tagName:n}=i;let e=!0;const s=n==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(i.type);return(i.isContentEditable||(s||n==="TEXTAREA"||n==="SELECT")&&!i.readOnly)&&(e=!1),e}function xi(t){return typeof t=="string"&&(t=le(t)),_.indexOf(t)!==-1}function ki(t,i){let n,e;t||(t=Ae());for(const s in y)if(Object.prototype.hasOwnProperty.call(y,s))for(n=y[s],e=0;e<n.length;)n[e].scope===t?n.splice(e,1).forEach(m=>{let{element:r}=m;return Ye(r)}):e++;Ae()===t&&Kt(i||"all")}function Ei(t){let i=t.keyCode||t.which||t.charCode;t.key&&t.key.toLowerCase()==="capslock"&&(i=le(t.key));const n=_.indexOf(i);if(n>=0&&_.splice(n,1),t.key&&t.key.toLowerCase()==="meta"&&_.splice(0,_.length),(i===93||i===224)&&(i=91),i in O){O[i]=!1;for(const e in R)R[e]===i&&(Z[e]=!1)}}function Ot(t){if(typeof t>"u")Object.keys(y).forEach(s=>{Array.isArray(y[s])&&y[s].forEach(d=>Qe(d)),delete y[s]}),Ye(null);else if(Array.isArray(t))t.forEach(s=>{s.key&&Qe(s)});else if(typeof t=="object")t.key&&Qe(t);else if(typeof t=="string"){for(var i=arguments.length,n=new Array(i>1?i-1:0),e=1;e<i;e++)n[e-1]=arguments[e];let[s,d]=n;typeof s=="function"&&(d=s,s=""),Qe({key:t,scope:s,method:d,splitKey:"+"})}}const Qe=t=>{let{key:i,scope:n,method:e,splitKey:s="+"}=t;At(i).forEach(m=>{const r=m.split(s),h=r.length,x=r[h-1],g=x==="*"?"*":le(x);if(!y[g])return;n||(n=Ae());const b=h>1?Ct(R,r):[],E=[];y[g]=y[g].filter(C=>{const D=(e?C.method===e:!0)&&C.scope===n&&mi(C.mods,b);return D&&E.push(C.element),!D}),E.forEach(C=>Ye(C))})};function bt(t,i,n,e){if(i.element!==e)return;let s;if(i.scope===n||i.scope==="all"){s=i.mods.length>0;for(const d in O)Object.prototype.hasOwnProperty.call(O,d)&&(!O[d]&&i.mods.indexOf(+d)>-1||O[d]&&i.mods.indexOf(+d)===-1)&&(s=!1);(i.mods.length===0&&!O[16]&&!O[18]&&!O[17]&&!O[91]||s||i.shortcut==="*")&&(i.keys=[],i.keys=i.keys.concat(_),i.method(t,i)===!1&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)))}}function gt(t,i){const n=y["*"];let e=t.keyCode||t.which||t.charCode;if(t.key&&t.key.toLowerCase()==="capslock"||!Z.filter.call(this,t))return;if((e===93||e===224)&&(e=91),_.indexOf(e)===-1&&e!==229&&_.push(e),["metaKey","ctrlKey","altKey","shiftKey"].forEach(r=>{const h=we[r];t[r]&&_.indexOf(h)===-1?_.push(h):!t[r]&&_.indexOf(h)>-1?_.splice(_.indexOf(h),1):r==="metaKey"&&t[r]&&(_=_.filter(x=>x in we||x===e))}),e in O){O[e]=!0;for(const r in R)if(Object.prototype.hasOwnProperty.call(R,r)){const h=we[R[r]];Z[r]=t[h]}if(!n)return}for(const r in O)Object.prototype.hasOwnProperty.call(O,r)&&(O[r]=t[we[r]]);t.getModifierState&&!(t.altKey&&!t.ctrlKey)&&t.getModifierState("AltGraph")&&(_.indexOf(17)===-1&&_.push(17),_.indexOf(18)===-1&&_.push(18),O[17]=!0,O[18]=!0);const s=Ae();if(n)for(let r=0;r<n.length;r++)n[r].scope===s&&(t.type==="keydown"&&n[r].keydown||t.type==="keyup"&&n[r].keyup)&&bt(t,n[r],s,i);if(!(e in y))return;const d=y[e],m=d.length;for(let r=0;r<m;r++)if((t.type==="keydown"&&d[r].keydown||t.type==="keyup"&&d[r].keyup)&&d[r].key){const h=d[r],{splitKey:x}=h,g=h.key.split(x),b=[];for(let E=0;E<g.length;E++)b.push(le(g[E]));b.sort().join("")===_.sort().join("")&&bt(t,h,s,i)}}function Z(t,i,n){_=[];const e=At(t);let s=[],d="all",m=document,r=0,h=!1,x=!0,g="+",b=!1,E=!1;for(n===void 0&&typeof i=="function"&&(n=i),Object.prototype.toString.call(i)==="[object Object]"&&(i.scope&&(d=i.scope),i.element&&(m=i.element),i.keyup&&(h=i.keyup),i.keydown!==void 0&&(x=i.keydown),i.capture!==void 0&&(b=i.capture),typeof i.splitKey=="string"&&(g=i.splitKey),i.single===!0&&(E=!0)),typeof i=="string"&&(d=i),E&&Ot(t,d);r<e.length;r++)t=e[r].split(g),s=[],t.length>1&&(s=Ct(R,t)),t=t[t.length-1],t=t==="*"?"*":le(t),t in y||(y[t]=[]),y[t].push({keyup:h,keydown:x,scope:d,mods:s,shortcut:e[r],method:n,key:e[r],splitKey:g,element:m});if(typeof m<"u"&&window){if(!X.has(m)){const C=function(){let D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return gt(D,m)},S=function(){let D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;gt(D,m),Ei(D)};X.set(m,{keydownListener:C,keyupListenr:S,capture:b}),Ge(m,"keydown",C,b),Ge(m,"keyup",S,b)}if(!Ee){const C=()=>{_=[]};Ee={listener:C,capture:b},Ge(window,"focus",C,b)}}}function Ci(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(y).forEach(n=>{y[n].filter(s=>s.scope===i&&s.shortcut===t).forEach(s=>{s&&s.method&&s.method()})})}function Ye(t){const i=Object.values(y).flat();if(i.findIndex(e=>{let{element:s}=e;return s===t})<0){const{keydownListener:e,keyupListenr:s,capture:d}=X.get(t)||{};e&&s&&(ye(t,"keyup",s,d),ye(t,"keydown",e,d),X.delete(t))}if((i.length<=0||X.size<=0)&&(Object.keys(X).forEach(s=>{const{keydownListener:d,keyupListenr:m,capture:r}=X.get(s)||{};d&&m&&(ye(s,"keyup",m,r),ye(s,"keydown",d,r),X.delete(s))}),X.clear(),Object.keys(y).forEach(s=>delete y[s]),Ee)){const{listener:s,capture:d}=Ee;ye(window,"focus",s,d),Ee=null}}const We={getPressedKeyString:_i,setScope:Kt,getScope:Ae,deleteScope:ki,getPressedKeyCodes:gi,getAllKeyCodes:yi,isPressed:xi,filter:wi,trigger:Ci,unbind:Ot,keyMap:Ce,modifier:R,modifierMap:we};for(const t in We)Object.prototype.hasOwnProperty.call(We,t)&&(Z[t]=We[t]);if(typeof window<"u"){const t=window.hotkeys;Z.noConflict=i=>(i&&window.hotkeys===Z&&(window.hotkeys=t),Z),window.hotkeys=Z}var Ai=Q('<form action="#"><div class="mb-3"><label class="form-label">Answer text</label> <input type="hidden"/> <trix-editor></trix-editor> <!></div> <div class="accordion my-2 "><div class="accordion-item"><h2 class="accordion-header"><button type="button" data-bs-toggle="collapse" aria-expanded="false">Answer hint (optional)</button></h2> <div><div class="accordion-body"><div class="mb-3"><input type="hidden"/> <trix-editor></trix-editor> <!> <div class="form-text">A hint that will be shown once the user has answered the question.</div></div></div></div></div></div></form>',2);function qi(t,i){_t(i,!1);let n=ae(i,"answer",12),e=M(),s=M(),d=M(),m=M("");kt(()=>{const A=document.getElementById("collapseAnswerHint"+n().id);A&&A.addEventListener("shown.bs.collapse",()=>{o(s)&&o(s).focus()}),k(d,!!n().hint)});function r(A){A.addEventListener("trix-change",function(){n(n().text=document.getElementById("answerText"+n().id).value,!0),n(n().hint=document.getElementById("answerHint"+n().id).value,!0),k(m,'<p class="text-end">Saving ...</p>'),x()})}var h;function x(){h&&h.cancel(),h=Et(()=>{axios.put("/api/answers/"+n().id,n()).then(function(A){k(m,'<p class="text-end">Saved <span class="text-success-dark">&check;</span></p>')}).catch(function(A){k(m,'<p class="text-end">Saving ... <span class="text-danger-dark">failed!</span></p>'),alert(A)})},500,{maxWait:2e3}),h()}ie(()=>o(e),()=>{o(e)&&r(o(e))}),ie(()=>o(s),()=>{o(s)&&r(o(s))}),yt(),wt();var g=Ai(),b=l(g),E=l(b),C=u(E,2),S=u(C,2);H(()=>G(S,"id",`editor-answer${f(n()),v(()=>n().id)??""}`)),B(S,1,"bg-light trix-content"),H(()=>G(S,"input",`answerText${f(n()),v(()=>n().id)??""}`)),ke(S,A=>k(e,A),()=>o(e));var D=u(S,2);ce(D,()=>o(m));var oe=u(b,2),$=l(oe),qe=l($),ne=l(qe),de=u(qe,2),re=l(de),Ke=l(re),ue=l(Ke),se=u(ue,2);H(()=>G(se,"id",`editor-answerHint${f(n()),v(()=>n().id)??""}`)),B(se,1,"bg-light trix-content"),H(()=>G(se,"input",`answerHint${f(n()),v(()=>n().id)??""}`)),ke(se,A=>k(s,A),()=>o(s));var fe=u(se,2);ce(fe,()=>o(m));var Ie=u(fe,2);H(()=>{z(E,"for",`answerText${f(n()),v(()=>n().id)??""}`),z(C,"id",`answerText${f(n()),v(()=>n().id)??""}`),z(oe,"id",`accordionAnswerHint${f(n()),v(()=>n().id)??""}`),B(ne,1,`accordion-button text-black bg-white py-2 px-3 ${o(d)?"":"collapsed"}`),z(ne,"data-bs-target",`#collapseAnswerHint${f(n()),v(()=>n().id)??""}`),z(ne,"aria-controls",`#collapseAnswerHint${f(n()),v(()=>n().id)??""}`),z(de,"id",`collapseAnswerHint${f(n()),v(()=>n().id)??""}`),B(de,1,`accordion-collapse collapse ${o(d)?"show":""}`),z(ue,"id",`answerHint${f(n()),v(()=>n().id)??""}`),z(Ie,"id",`answerHint${f(n()),v(()=>n().id)??""}`)}),xe(C,()=>n().text,A=>n(n().text=A,!0)),xe(ue,()=>n().hint,A=>n(n().hint=A,!0)),K(t,g),xt()}var Ve=pi(()=>Z),Ki=Q('<button type="button" class="btn btn-outline-secondary btn-sm">Close editor</button>'),Oi=Q('<div class="alert alert-secondary m-1" role="alert"><p class="small fw-bold"><i class="bi bi-clipboard2-pulse"></i> CASE</p> <p class="trix-content"><!></p></div> <div class="text-end m-1"><button type="button" class="btn btn-sm btn-light" title="Remove case"><i class="bi bi-trash"></i> Remove case</button></div>',1),Li=Q("<option> </option>"),Hi=Q('<div class="alert alert-light" role="alert"><div class="row g-3 align-items-center"><div class="col-auto"><label for="case" class="col-form-label small fw-bold"><i class="bi bi-clipboard2-pulse"></i> CASE</label></div> <div class="col-auto"><select id="case" class="form-select"><option>Select case</option><!></select></div></div></div>'),Qi=Q(`<!> <div class="mt-3 mb-2"><label for="questionText" class="form-label">Question text</label> <input id="questionText" type="hidden"/> <trix-editor></trix-editor> <!></div> <div class="accordion my-2 " id="accordionQuestionHint"><div class="accordion-item"><h2 class="accordion-header"><button type="button" data-bs-toggle="collapse" data-bs-target="#collapseQuestionHint" aria-expanded="false" aria-controls="collapseQuestionHint">Question hint (optional)</button></h2> <div id="collapseQuestionHint"><div class="accordion-body"><div class="mt-3 mb-3"><input id="questionHint" type="hidden"/> <trix-editor></trix-editor> <!> <div id="questionHint" class="form-text">A hint that can be shown to the user if they are stuck.</div></div></div></div></div></div> <div class="accordion my-2" id="accordionQuestionComment"><div class="accordion-item"><h2 class="accordion-header"><button type="button" data-bs-toggle="collapse" data-bs-target="#collapseQuestionComment" aria-expanded="false" aria-controls="collapseQuestionComment">Question comment (optional)</button></h2> <div id="collapseQuestionComment"><div class="accordion-body"><div class="mt-3 mb-3"><input id="questionComment" type="hidden"/> <trix-editor></trix-editor> <!> <div id="questionHint" class="form-text">A comment that will be shown once the user has answered the question.
                                It can be used to explain the correct answer or provide additional
                                information, for example sources.</div></div></div></div></div></div> <div class="mb-3 p-3 bg-light rounded"><div class="form-check mb-3"><input type="checkbox" class="form-check-input" id="checkInvalidQuestion"/> <label class="form-check-label" for="checkInvalidQuestion"><i class="bi bi-cone-striped"></i> <strong>Invalid question</strong> - Is the answer unknown or disputed? Invalid questions remain in deck but are not counted into results.</label></div> <div class="form-check"><input type="checkbox" class="form-check-input" id="checkNeedsReview"/> <label class="form-check-label" for="checkNeedsReview"><i class="bi bi-eraser-fill"></i> <strong>Needs review</strong> - Does this question need to be reviewed and improved? Questions marked for review remain in deck and are counted into results.</label></div></div>`,3),Ii=Q(`<div class="col"><div class="alert alert-warning" role="alert">Don't forget to set the correct answer!</div></div>`),Si=Q('<div class="card-body"><p class="card-text"> </p></div>'),Di=Q('<div class="col"><div class="card" style="width: 18rem"><div class="card-header bg-transparent"><button type="button" class="btn btn-sm btn-light"><i class="bi bi-trash"></i></button></div> <img class="card-img-top" alt=""/> <!></div></div>'),Ti=Q('<button type="button" title="Set as correct answer"><i class="bi bi-check-lg"></i></button>'),Mi=Q('<div class="mt-3 mb-1 px-3 pt-2 pb-1 bg-light-subtle rounded"><!> <div class="text-end mb-2"><!> <button type="button" class="btn btn-sm btn-light" title="Delete answer"><i class="bi bi-trash"></i></button></div></div>'),ji=Q('<div class="sticky-bottom bg-white mt-3" style="z-index: 10;"><div class="row py-3"><div class="col"><button class="btn btn-sm btn-primary" title="Add a new answer (Shortcut: Alt+A)">Add answer</button></div></div></div>'),Bi=Q("<option>card</option>"),Pi=Q('<div class="alert alert-light" role="alert"><p><strong>Delete question?</strong> Deleting a question will also delete all associated answers and images.</p> <button type="button" class="btn btn-sm btn-danger"><i class="bi bi-trash"></i> Delete question</button></div>'),Ri=Q(`<div class="row"><div class="col"><div class="mb-3 border-dark" style="border-bottom: dotted; border-width: 1px;"></div></div></div> <div class="alert alert-light" role="alert"><div class="input-group mb-3"><span class="input-group-text">ID</span> <input type="text" class="form-control" disabled readonly=""/></div> <div class="row g-3 align-items-center"><div class="col-auto"><label for="questionType" class="col-form-label fw-bold">Question type:</label></div> <div class="col-auto"><select id="questionType" class="form-select font-monospace text-uppercase"><!><option>mc</option></select></div> <div class="col-auto"><span id="questionTypeHelp" class="form-text">Can be either multiple choice (MC) or card (CARD). <strong>Card Questions
                    can have only one or no answer.</strong></span></div></div></div> <!>`,1),Fi=Q('<form action="#" class="mt-3"><!> <!> <div class="mb-3"><label for="image" class="form-label">Add image</label> <input class="form-control" type="file" accept="image/jpeg, image/png, image/webp" name="image"/> <div id="imageHelp" class="form-text">Supported formats are JPEG, PNG, and WebP.</div></div></form> <!> <div class="row row-cols-1 row-cols-lg-3 g4"></div> <!> <!> <!>',1);function en(t,i){_t(i,!1);const n=M();let e=ae(i,"question",12),s=ae(i,"cases",8),d=ae(i,"toggleEditor",8),m=ae(i,"handleQuestionRemove",8),r=ae(i,"showConfigEditor",8,!1),h=ae(i,"showCaseSelector",8,!1),x=M(),g=M(),b=M(),E=M(),C=0,S=M(),D=M(),oe=M(),$=M("");const qe=1e3;kt(()=>{Ve(Ve().filter=function(){return!0}),Ve()("alt+A",function(p){p.preventDefault();const q=Date.now();q-C>qe&&(fe(),C=q)});const a=document.getElementById("collapseQuestionHint");a&&a.addEventListener("shown.bs.collapse",()=>{o(b)&&o(b).focus()});const c=document.getElementById("collapseQuestionComment");c&&c.addEventListener("shown.bs.collapse",()=>{o(g)&&o(g).focus()})});function ne(a){a.addEventListener("trix-change",function(){e(e().text=document.getElementById("questionText").value,!0),e(e().comment=document.getElementById("questionComment").value,!0),e(e().hint=document.getElementById("questionHint").value,!0),k($,'<p class="text-end">Saving ...</p>'),Ke()})}function de(a){a!==e().correct_answer_id&&(e(e().correct_answer_id=a,!0),axios.put("/api/questions/"+e().id,e()).then(function(c){}).catch(function(c){alert(c)}))}var re;function Ke(){re&&re.cancel(),re=Et(()=>{axios.put("/api/questions/"+e().id,e()).then(function(a){k($,'<p class="text-end">Saved <span class="text-success-dark">&check;</span></p>')}).catch(function(a){k($,'<p class="text-end">Saving ... <span class="text-danger-dark">failed!</span></p>'),alert(a)})},500,{maxWait:2e3}),re()}function ue(){var a=new FormData,c=document.getElementById("imageInput"+e().id);a.set("image",c.files[0]),axios.post("/api/questions/"+e().id+"/images",a,{headers:{"Content-Type":"multipart/form-data"}}).then(function(p){c.value="";var q=p.data;e(e().images=[...e().images,q],!0)}).catch(function(p){c.value="",alert(p)})}function se(a){axios.delete("/api/images/"+a).then(function(c){e(e().images=e().images.filter(p=>p.id!==a),!0)}).catch(function(c){alert(c)})}function fe(){axios.post("/api/questions/"+e().id+"/answers",{}).then(function(a){e(e().answers=[...e().answers,a.data],!0),ci().then(()=>{const c=document.getElementById("editor-answer"+a.data.id);c&&c.focus()})}).catch(function(a){alert(a)})}function Ie(a){axios.delete("/api/answers/"+a).then(function(c){e(e().answers=e().answers.filter(p=>p.id!==a),!0)}).catch(function(c){alert(c)})}function A(){axios.put("/api/questions/"+e().id,{type:e().type==="mc"?"mc":"card"}).then(function(a){e(e().type=a.data.type,!0)}).catch(function(a){alert(a)})}function Lt(){axios.put("/api/questions/"+e().id,{case_id:o(E)}).then(function(a){e(e().case_id=a.data.case_id,!0);const c=s().find(p=>p.id===a.data.case_id);e(e().case=c,!0),c.questions||(c.questions=[]),c.questions.push({id:e().id,case_id:c.id})}).catch(function(a){alert(a)})}function Ht(){axios.put("/api/questions/"+e().id,{case_id:null}).then(function(a){e(e().case_id=null,!0),e(e().case=null,!0),s().map(c=>{c.questions=c.questions.filter(p=>p.id!==e().id)})}).catch(function(a){alert(a)})}function Qt(){axios.put("/api/questions/"+e().id,{is_invalid:!e().is_invalid}).then(function(a){e(e().is_invalid=!e().is_invalid,!0)}).catch(function(a){alert(a)})}function It(){axios.put("/api/questions/"+e().id,{needs_review:!e().needs_review}).then(function(a){e(e().needs_review=!e().needs_review,!0)}).catch(function(a){alert(a)})}ie(()=>f(e()),()=>{k(n,e().correct_answer_id)}),ie(()=>o(x),()=>{o(x)&&ne(o(x))}),ie(()=>o(g),()=>{o(g)&&ne(o(g))}),ie(()=>o(b),()=>{o(b)&&ne(o(b))}),ie(()=>f(e()),()=>{e().case?k(E,e().case.id):k(E,"")}),ie(()=>(f(e()),o(oe)),()=>{e().id!==o(oe)&&(k(oe,e().id),k(S,!!e().hint),k(D,!!e().comment))}),yt(),wt();var Je=Fi(),Se=_e(Je),Xe=l(Se);{var St=a=>{var c=Ki();T("click",c,J(function(...p){d()?.apply(this,p)})),K(a,c)};U(Xe,a=>{d()&&a(St)})}var Ze=u(Xe,2);vi(Ze,()=>(f(e()),v(()=>e().id)),a=>{var c=Qi(),p=_e(c);{var q=w=>{var he=Oi(),Oe=_e(he),Te=u(l(Oe),2),be=l(Te);ce(be,()=>(f(He),f(s()),f(e()),v(()=>He.sanitize(s().find(je=>je.id===e().case_id).text))));var Le=u(Oe,2),Me=l(Le);T("click",Me,J(Ht)),K(w,he)},P=w=>{var he=li(),Oe=_e(he);{var Te=be=>{var Le=Hi(),Me=l(Le),je=u(l(Me),2),Be=l(je);H(()=>{o(E),Fe(()=>{s(),e()})});var Pe=l(Be);Pe.value=Pe.__value="";var Vt=u(Pe);Ne(Vt,1,s,ui,(Re,te)=>{var ge=Li(),Yt=l(ge),ft={};H(Jt=>{Ue(ge,(f(e()),o(te),v(()=>e().case_id==o(te).id))),vt(Yt,Jt),ft!==(ft=(o(te),v(()=>o(te).id)))&&(ge.value=(ge.__value=(o(te),v(()=>o(te).id)))??"")},[()=>(f(ht),f(He),o(te),v(()=>ht.truncate(He.sanitize(o(te).text,{ALLOWED_TAGS:[]}),{length:30})))]),K(Re,ge)}),mt(Be,()=>o(E),Re=>k(E,Re)),T("change",Be,Lt),K(be,Le)};U(Oe,be=>{f(h()),f(s()),v(()=>h()&&s()&&s().length>0)&&be(Te)},!0)}K(w,he)};U(p,w=>{f(h()),f(e()),v(()=>h()&&e().case_id)?w(q):w(P,!1)})}var W=u(p,2),V=u(l(W),2),I=u(V,2);G(I,"id","editor-questionText"),B(I,1,"bg-light trix-content"),G(I,"input","questionText"),ke(I,w=>k(x,w),()=>o(x));var ee=u(I,2);ce(ee,()=>o($));var F=u(W,2),L=l(F),N=l(L),ve=l(N),j=u(N,2),Y=l(j),De=l(Y),st=l(De),pe=u(st,2);G(pe,"id","editor-questionHint"),B(pe,1,"bg-light trix-content"),G(pe,"input","questionHint"),ke(pe,w=>k(b,w),()=>o(b));var Pt=u(pe,2);ce(Pt,()=>o($));var at=u(F,2),Rt=l(at),ot=l(Rt),Ft=l(ot),rt=u(ot,2),Nt=l(rt),Ut=l(Nt),ct=l(Ut),me=u(ct,2);G(me,"id","editor-questionComment"),B(me,1,"bg-light trix-content"),G(me,"input","questionComment"),ke(me,w=>k(g,w),()=>o(g));var zt=u(me,2);ce(zt,()=>o($));var Gt=u(at,2),lt=l(Gt),dt=l(lt),Wt=u(lt,2),ut=l(Wt);H(()=>{B(ve,1,`accordion-button text-black bg-white py-2 px-3 ${o(S)?"":"collapsed"}`),B(j,1,`accordion-collapse collapse ${o(S)?"show":""}`),B(Ft,1,`accordion-button text-black bg-white py-2 px-3 ${o(D)?"":"collapsed"}`),B(rt,1,`accordion-collapse collapse ${o(D)?"show":""}`)}),xe(V,()=>e().text,w=>e(e().text=w,!0)),xe(st,()=>e().hint,w=>e(e().hint=w,!0)),xe(ct,()=>e().comment,w=>e(e().comment=w,!0)),pt(dt,()=>e().is_invalid,w=>e(e().is_invalid=w,!0)),T("click",dt,J(Qt)),pt(ut,()=>e().needs_review,w=>e(e().needs_review=w,!0)),T("click",ut,J(It)),K(a,c)});var Dt=u(Ze,2),$e=u(l(Dt),2),et=u(Se,2);{var Tt=a=>{var c=Ii();K(a,c)};U(et,a=>{o(n),f(e()),v(()=>!o(n)&&e().type==="mc")&&a(Tt)})}var tt=u(et,2);Ne(tt,5,()=>(f(e()),v(()=>e().images)),a=>a.id,(a,c)=>{var p=Di(),q=l(p),P=l(q),W=l(P),V=u(P,2),I=u(V,2);{var ee=F=>{var L=Si(),N=l(L),ve=l(N);H(()=>vt(ve,(o(c),v(()=>o(c).comment)))),K(F,L)};U(I,F=>{o(c),v(()=>o(c).comment)&&F(ee)})}H(()=>z(V,"src",`/${o(c),v(()=>o(c).path)??""}`)),T("click",W,J(()=>{confirm("Are you sure you want to delete this image?")&&se(o(c).id)})),K(a,p)});var it=u(tt,2);Ne(it,1,()=>(f(e()),v(()=>e().answers)),a=>a.id,(a,c,p)=>{var q=Mi();let P;var W=l(q);qi(W,{get answer(){return(f(e()),v(()=>e().answers))[p]},set answer(L){(f(e()),v(()=>e().answers))[p]=L,Fe(()=>e())},$$legacy:!0});var V=u(W,2),I=l(V);{var ee=L=>{var N=Ti();H(()=>B(N,1,`btn btn-sm ${o(n),(f(e()),v(()=>e().answers))[p],v(()=>o(n)===(f(e()),v(()=>e().answers))[p].id?"btn-success":"btn-light")??""}`)),T("click",N,J(()=>{de((f(e()),v(()=>e().answers))[p].id)})),K(L,N)};U(I,L=>{f(e()),v(()=>e().type==="mc")&&L(ee)})}var F=u(I,2);H(L=>P=fi(q,"",P,L),[()=>({border:(o(n),(f(e()),v(()=>e().answers))[p],v(()=>"2px dotted "+(o(n)===(f(e()),v(()=>e().answers))[p].id?"green":"lightgray")))})]),T("click",F,J(()=>{confirm("Are you sure you want to delete this answer?")&&Ie((f(e()),v(()=>e().answers))[p].id)})),K(a,q)});var nt=u(it,2);{var Mt=a=>{var c=ji(),p=l(c),q=l(p),P=l(q);T("click",P,fe),K(a,c)};U(nt,a=>{f(e()),v(()=>e().type==="mc"||e().answers.length===0)&&a(Mt)})}var jt=u(nt,2);{var Bt=a=>{var c=Ri(),p=u(_e(c),2),q=l(p),P=u(l(q),2),W=u(q,2),V=u(l(W),2),I=l(V);H(()=>{e(),Fe(()=>{})});var ee=l(I);{var F=j=>{var Y=Bi();Y.value=Y.__value="card",H(()=>Ue(Y,(f(e()),v(()=>e().type=="card")))),K(j,Y)};U(ee,j=>{f(e()),v(()=>e().answers.length<=1||e().type==="card")&&j(F)})}var L=u(ee);L.value=L.__value="mc";var N=u(p,2);{var ve=j=>{var Y=Pi(),De=u(l(Y),2);T("click",De,J(()=>{confirm("Are you sure you want to delete this question?")&&m()(e().id)})),K(j,Y)};U(N,j=>{m()&&j(ve)})}H(()=>{di(P,(f(e()),v(()=>e().id))),I.disabled=(f(e()),v(()=>e().answers.length>1)),Ue(L,(f(e()),v(()=>e().type=="mc")))}),mt(I,()=>e().type,j=>e(e().type=j,!0)),T("change",I,A),K(a,c)};U(jt,a=>{r()&&a(Bt)})}H(()=>z($e,"id",`imageInput${f(e()),v(()=>e().id)??""}`)),T("input",$e,ue),T("submit",Se,J(Ke)),K(t,Je),xt()}export{en as Q,Z as h,vi as k,pi as r};
