import{S as fe,i as ae,s as de,e as ke,a as I,n as L,d as Q,b as h,c as p,G as qe,h as b,l as X,g as U,t as W,j as le,p as ce,k as D,q as ze,f as Be,H as Ee,A as Ne,x as A,y as J,w as v,E as De,m as j,o as Y,u as Z,v as O,z as x,B as K,F as ve,C as z,r as je}from"./index-DgDIGCFR.js";import{p as Ie,d as Oe}from"./purify.es-BxOHINE-.js";import{M as Re}from"./Messages-DuDDf_hX.js";import{C as We}from"./auto-C08LIDt6.js";import{S as Je}from"./SessionProgressBar-CqGfgLl-.js";import{e as Qe}from"./each-CvUUWvvD.js";import{h as he,S as Ke}from"./SessionQuestionView-BEdhDOyL.js";import{s as Xe}from"./StatsHelper-B91isISU.js";import{U as we}from"./UserSettingsStore-CHRhuN6R.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./format-Dvme3Z7b.js";import"./parseISO-Bm-E8o14.js";import"./QuestionForm-CJ81FxSt.js";function Pe(n){let s,e,i,r,l;return{c(){s=h("div"),e=h("img"),p(e,"class","img-fluid"),qe(e.src,i="/"+n[0])||p(e,"src",i),p(e,"alt","Magic GIF"),p(s,"class","img-fullscreen d-flex justify-content-center align-items-center svelte-116gbkt")},m(t,f){I(t,s,f),b(s,e),r||(l=X(s,"click",n[2]),r=!0)},p(t,f){f&1&&!qe(e.src,i="/"+t[0])&&p(e,"src",i)},d(t){t&&Q(s),r=!1,l()}}}function Ye(n){let s,e=n[0]&&n[1]&&Pe(n);return{c(){e&&e.c(),s=ke()},m(i,r){e&&e.m(i,r),I(i,s,r)},p(i,[r]){i[0]&&i[1]?e?e.p(i,r):(e=Pe(i),e.c(),e.m(s.parentNode,s)):e&&(e.d(1),e=null)},i:L,o:L,d(i){i&&Q(s),e&&e.d(i)}}}function Ze(n,s,e){let{magicGIFPath:i=""}=s;var r=!0;function l(){e(1,r=!r)}return n.$$set=t=>{"magicGIFPath"in t&&e(0,i=t.magicGIFPath)},[i,r,l]}class xe extends fe{constructor(s){super(),ae(this,s,Ze,Ye,de,{magicGIFPath:0})}}function Ce(n){let s,e,i;return{c(){s=h("button"),s.innerHTML='<i class="bi bi-repeat"></i> Repeat incorrect',p(s,"class","btn btn-sm btn-outline-secondary"),p(s,"type","button")},m(r,l){I(r,s,l),e||(i=X(s,"click",ce(n[5])),e=!0)},p:L,d(r){r&&Q(s),e=!1,i()}}}function $e(n){let s,e,i,r,l,t,f,u=n[0].correct+"",o,d,w,P,k,H,C,m,g,c=n[0].incorrect>0&&Ce(n);return{c(){s=h("div"),e=h("div"),i=h("canvas"),r=U(),l=h("div"),t=h("p"),f=h("span"),o=W(u),d=W("%"),w=W(" correct"),P=U(),k=h("div"),H=h("a"),H.innerHTML='<i class="bi bi-rocket-takeoff"></i> New session',C=U(),c&&c.c(),m=U(),g=h("a"),g.textContent="Home",p(e,"class","col-md"),p(f,"class","fs-4 font-monospace"),p(t,"class","mt-3 text-dark"),p(H,"href","/sessions/create"),p(H,"class","btn btn-sm btn-primary"),p(g,"href","/"),p(g,"class","btn btn-sm btn-outline-secondary"),p(k,"class","d-grid gap-2"),p(l,"class","col-md"),p(s,"class","row mb-5")},m(M,R){I(M,s,R),b(s,e),b(e,i),n[4](i),b(s,r),b(s,l),b(l,t),b(t,f),b(f,o),b(f,d),b(t,w),b(l,P),b(l,k),b(k,H),b(k,C),c&&c.m(k,null),b(k,m),b(k,g)},p(M,[R]){R&1&&u!==(u=M[0].correct+"")&&le(o,u),M[0].incorrect>0?c?c.p(M,R):(c=Ce(M),c.c(),c.m(k,m)):c&&(c.d(1),c=null)},i:L,o:L,d(M){M&&Q(s),n[4](null),c&&c.d()}}}function es(n){axios.post("/api/sessions/"+n+"/newfromincorrect").then(function(s){window.location.href="/sessions/"+s.data.id}).catch(function(s){alert(s)})}function ss(n,s,e){let{progressPercentage:i}=s,{sessionId:r}=s,l,t;function f(o){D[o?"unshift":"push"](()=>{l=o,e(2,l)})}const u=()=>es(r);return n.$$set=o=>{"progressPercentage"in o&&e(0,i=o.progressPercentage),"sessionId"in o&&e(1,r=o.sessionId)},n.$$.update=()=>{n.$$.dirty&13&&l&&(()=>{if(t)return;const o={type:"doughnut",data:{labels:["Correct","Correct with help","Incorrect"],datasets:[{label:"%",data:[i.correct,i.correctWithHelp,i.incorrect],backgroundColor:["#d4edda","#fff3cd","#f8d7da"],hoverOffet:4}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:null}}};t&&t.destroy();var d=l.getContext("2d");e(3,t=new We(d,o))})()},[i,r,l,t,f,u]}class ns extends fe{constructor(s){super(),ae(this,s,ss,$e,de,{progressPercentage:0,sessionId:1})}}function Me(n,s,e){const i=n.slice();return i[4]=s[e],i[6]=e,i}function Ae(n){let s;return{c(){s=h("li"),s.textContent="Loading ...",p(s,"class","svelte-za7w49")},m(e,i){I(e,s,i)},p:L,d(e){e&&Q(s)}}}function is(n){let s,e=n[6]+1+"",i;return{c(){s=W("Question Nr. "),i=W(e)},m(r,l){I(r,s,l),I(r,i,l)},p:L,d(r){r&&(Q(s),Q(i))}}}function ts(n){let s=Ie.sanitize(n[4].text).replace(/<\/?[^>]+(>|$)/g,"")+"",e;return{c(){e=W(s)},m(i,r){I(i,e,r)},p(i,r){r&1&&s!==(s=Ie.sanitize(i[4].text).replace(/<\/?[^>]+(>|$)/g,"")+"")&&le(e,s)},d(i){i&&Q(e)}}}function Se(n){let s,e,i,r=n[1](n[4])+"",l,t,f,u,o,d;function w(C,m){return C[4].text?ts:is}let P=w(n),k=P(n);function H(){return n[3](n[4])}return{c(){s=h("li"),e=h("small"),i=new Ee(!1),l=U(),k.c(),t=U(),i.a=l,p(s,"class",f="list-group-item list-group-item-action text-overflow "+(n[4].id===n[0].session.current_question_id?"list-group-item-dark":"list-group-item-light")+" svelte-za7w49"),p(s,"id",u="question"+n[4].id)},m(C,m){I(C,s,m),b(s,e),i.m(r,e),b(e,l),k.m(e,null),b(s,t),o||(d=X(s,"click",H),o=!0)},p(C,m){n=C,m&3&&r!==(r=n[1](n[4])+"")&&i.p(r),P===(P=w(n))&&k?k.p(n,m):(k.d(1),k=P(n),k&&(k.c(),k.m(e,null))),m&1&&f!==(f="list-group-item list-group-item-action text-overflow "+(n[4].id===n[0].session.current_question_id?"list-group-item-dark":"list-group-item-light")+" svelte-za7w49")&&p(s,"class",f),m&1&&u!==(u="question"+n[4].id)&&p(s,"id",u)},d(C){C&&Q(s),k.d(),o=!1,d()}}}function os(n){let s,e,i=Qe(n[0].deck.questions),r=[];for(let t=0;t<i.length;t+=1)r[t]=Se(Me(n,i,t));let l=null;return i.length||(l=Ae()),{c(){s=h("div"),e=h("ul");for(let t=0;t<r.length;t+=1)r[t].c();l&&l.c(),p(e,"class","list-group"),p(s,"class","overflow-scroll"),ze(s,"max-height","85vh")},m(t,f){I(t,s,f),b(s,e);for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(e,null);l&&l.m(e,null)},p(t,[f]){if(f&3){i=Qe(t[0].deck.questions);let u;for(u=0;u<i.length;u+=1){const o=Me(t,i,u);r[u]?r[u].p(o,f):(r[u]=Se(o),r[u].c(),r[u].m(e,null))}for(;u<r.length;u+=1)r[u].d(1);r.length=i.length,!i.length&&l?l.p(t,f):i.length?l&&(l.d(1),l=null):(l=Ae(),l.c(),l.m(e,null))}},i:L,o:L,d(t){t&&Q(s),Be(r,t),l&&l.d()}}}function rs(n,s,e){let i,{data:r}=s,{examMode:l}=s;const t=f=>e(0,r.session.current_question_id=f.id,r);return n.$$set=f=>{"data"in f&&e(0,r=f.data),"examMode"in f&&e(2,l=f.examMode)},n.$$.update=()=>{n.$$.dirty&1&&(r.session.current_question_id,(()=>{var f=document.getElementById("question"+r.session.current_question_id);f&&f.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})})()),n.$$.dirty&5&&e(1,i=function(f){var u=r.session.answer_choices.find(o=>o.question_id===f.id);return u?l?'<span class="text-dark fw-bold">&cross;</span>':u.is_correct?u.help_used?'<span class="text-warning-dark fw-bold">&check;</span>':'<span class="text-success-dark fw-bold">&check;</span>':'<span class="text-danger-dark fw-bold">&cross;</span>':'<span class="text-dark fw-bold">&rightarrow;</span>'})},[r,i,l,t]}class us extends fe{constructor(s){super(),ae(this,s,rs,os,de,{data:0,examMode:2})}}function ls(n){let s;return{c(){s=h("div"),s.innerHTML="",p(s,"class","col-6")},m(e,i){I(e,s,i)},p:L,d(e){e&&Q(s)}}}function cs(n){let s,e,i,r;return{c(){s=h("div"),e=h("button"),e.innerHTML='<span class="fw-bold">←</span> Previous',p(e,"class","btn btn-sm btn-light w-100"),p(s,"class","col-6")},m(l,t){I(l,s,t),b(s,e),i||(r=X(e,"click",ce(n[2])),i=!0)},p:L,d(l){l&&Q(s),i=!1,r()}}}function fs(n){let s;return{c(){s=h("div"),s.innerHTML="",p(s,"class","col-6")},m(e,i){I(e,s,i)},p:L,d(e){e&&Q(s)}}}function as(n){let s,e,i,r,l,t,f;return{c(){s=h("div"),e=h("button"),i=W("Next "),r=h("span"),r.textContent="→",p(r,"class","fw-bold"),p(e,"class",l="btn btn-sm "+(n[1]?"btn-warning":"btn-light")+" w-100"),p(s,"class","col-6")},m(u,o){I(u,s,o),b(s,e),b(e,i),b(e,r),t||(f=X(e,"click",ce(n[3])),t=!0)},p(u,o){o&2&&l!==(l="btn btn-sm "+(u[1]?"btn-warning":"btn-light")+" w-100")&&p(e,"class",l)},d(u){u&&Q(s),t=!1,f()}}}function ds(n){let s,e;function i(o,d){return o[0].session.current_question_id&&o[0].session.current_question_id!=o[0].deck.questions[0].id?cs:ls}let r=i(n),l=r(n);function t(o,d){return o[0].session.current_question_id!=o[0].deck.questions[o[0].deck.questions.length-1].id?as:fs}let f=t(n),u=f(n);return{c(){s=h("div"),l.c(),e=U(),u.c(),p(s,"class","row mb-3 pt-1 pb-1 sticky-top bg-white")},m(o,d){I(o,s,d),l.m(s,null),b(s,e),u.m(s,null)},p(o,[d]){r===(r=i(o))&&l?l.p(o,d):(l.d(1),l=r(o),l&&(l.c(),l.m(s,e))),f===(f=t(o))&&u?u.p(o,d):(u.d(1),u=f(o),u&&(u.c(),u.m(s,null)))},i:L,o:L,d(o){o&&Q(s),l.d(),u.d()}}}function _s(n,s,e){let{data:i}=s,{currentQuestionId:r}=s,{currentQuestionAnswered:l}=s;Ne(()=>{he("left","questions",function(o,d){f()}),he("right","questions",function(o,d){u()}),he.setScope("questions")});function t(o){return i.deck.questions.findIndex(d=>d.id===o)}function f(){var o=t(r),d=i.deck.questions[o-1];d&&e(0,i.session.current_question_id=d.id,i)}function u(){var o=t(r),d=i.deck.questions[o+1];d&&e(0,i.session.current_question_id=d.id,i)}return n.$$set=o=>{"data"in o&&e(0,i=o.data),"currentQuestionId"in o&&e(4,r=o.currentQuestionId),"currentQuestionAnswered"in o&&e(1,l=o.currentQuestionAnswered)},[i,l,f,u,r]}class gs extends fe{constructor(s){super(),ae(this,s,_s,ds,de,{data:0,currentQuestionId:4,currentQuestionAnswered:1})}}function ms(n){let s;return{c(){s=h("p"),s.textContent="Loading ..."},m(e,i){I(e,s,i)},p:L,i:L,o:L,d(e){e&&Q(s)}}}function ps(n){let s,e,i,r,l,t,f,u,o,d,w,P,k,H=n[0].deck.name+"",C,m,g,c,M,R,N,ne,B,E,ie,te,oe,_e,T,re,ge,S=!n[13]&&!n[3]&&ye(n),y=n[3]&&Fe(n),F=n[5]&&Ge(n);function me(_){n[28](_)}function pe(_){n[29](_)}function be(_){n[30](_)}let $={};n[0]!==void 0&&($.data=n[0]),n[0].session.current_question_id!==void 0&&($.currentQuestionId=n[0].session.current_question_id),n[9]!==void 0&&($.currentQuestionAnswered=n[9]),E=new gs({props:$}),D.push(()=>j(E,"data",me)),D.push(()=>j(E,"currentQuestionId",pe)),D.push(()=>j(E,"currentQuestionAnswered",be));let G=n[10]&&He(n);return{c(){s=h("div"),e=h("div"),i=h("p"),r=h("button"),r.innerHTML='<i class="bi bi-layout-sidebar"></i>',l=U(),t=h("button"),t.innerHTML='<i class="bi bi-exclamation-square"></i>',f=U(),u=h("span"),o=W(n[11]),d=W("/"),w=W(n[12]),P=U(),k=h("strong"),C=W(H),m=U(),g=h("div"),c=h("div"),S&&S.c(),M=U(),y&&y.c(),R=U(),N=h("div"),F&&F.c(),ne=U(),B=h("div"),Y(E.$$.fragment),_e=U(),G&&G.c(),p(r,"class","btn btn-sm d-none d-sm-none d-md-none d-lg-inline bg-light"),p(r,"title","Toggle sidebar"),p(t,"class","btn btn-sm"),p(t,"title","Toggle exam mode"),z(t,"bg-light",!n[4]),z(t,"bg-dark-subtle",n[4]),p(u,"class","ms-1 float-end fw-bold font-monospace badge text-dark"),z(u,"text-bg-light",!n[1]||n[13]),z(u,"bg-success",!n[13]&&!n[10].is_invalid&&n[1]&&n[1].is_correct),z(u,"bg-danger",!n[13]&&!n[10].is_invalid&&n[1]&&!n[1].is_correct),p(i,"class","text-overflow svelte-1gfmo48"),p(e,"class","col mb-1"),p(s,"class","row"),p(c,"class","col mb-1"),p(g,"class","row"),p(B,"class","col-md-12"),z(B,"col-lg-9",n[5]),z(B,"col-lg-10",!n[5]),z(B,"offset-lg-1",!n[5]),p(N,"class","row mt-3")},m(_,q){I(_,s,q),b(s,e),b(e,i),b(i,r),b(i,l),b(i,t),b(i,f),b(i,u),b(u,o),b(u,d),b(u,w),b(i,P),b(i,k),b(k,C),I(_,m,q),I(_,g,q),b(g,c),S&&S.m(c,null),b(c,M),y&&y.m(c,null),I(_,R,q),I(_,N,q),F&&F.m(N,null),b(N,ne),b(N,B),Z(E,B,null),b(B,_e),G&&G.m(B,null),T=!0,re||(ge=[X(r,"click",ce(n[22])),X(t,"click",ce(n[23]))],re=!0)},p(_,q){(!T||q[0]&16)&&z(t,"bg-light",!_[4]),(!T||q[0]&16)&&z(t,"bg-dark-subtle",_[4]),(!T||q[0]&2048)&&le(o,_[11]),(!T||q[0]&4096)&&le(w,_[12]),(!T||q[0]&8194)&&z(u,"text-bg-light",!_[1]||_[13]),(!T||q[0]&9218)&&z(u,"bg-success",!_[13]&&!_[10].is_invalid&&_[1]&&_[1].is_correct),(!T||q[0]&9218)&&z(u,"bg-danger",!_[13]&&!_[10].is_invalid&&_[1]&&!_[1].is_correct),(!T||q[0]&1)&&H!==(H=_[0].deck.name+"")&&le(C,H),!_[13]&&!_[3]?S?(S.p(_,q),q[0]&8200&&v(S,1)):(S=ye(_),S.c(),v(S,1),S.m(c,M)):S&&(K(),A(S,1,1,()=>{S=null}),J()),_[3]?y?(y.p(_,q),q[0]&8&&v(y,1)):(y=Fe(_),y.c(),v(y,1),y.m(c,null)):y&&(K(),A(y,1,1,()=>{y=null}),J()),_[5]?F?(F.p(_,q),q[0]&32&&v(F,1)):(F=Ge(_),F.c(),v(F,1),F.m(N,ne)):F&&(K(),A(F,1,1,()=>{F=null}),J());const ee={};!ie&&q[0]&1&&(ie=!0,ee.data=_[0],O(()=>ie=!1)),!te&&q[0]&1&&(te=!0,ee.currentQuestionId=_[0].session.current_question_id,O(()=>te=!1)),!oe&&q[0]&512&&(oe=!0,ee.currentQuestionAnswered=_[9],O(()=>oe=!1)),E.$set(ee),_[10]?G?(G.p(_,q),q[0]&1024&&v(G,1)):(G=He(_),G.c(),v(G,1),G.m(B,null)):G&&(K(),A(G,1,1,()=>{G=null}),J()),(!T||q[0]&32)&&z(B,"col-lg-9",_[5]),(!T||q[0]&32)&&z(B,"col-lg-10",!_[5]),(!T||q[0]&32)&&z(B,"offset-lg-1",!_[5])},i(_){T||(v(S),v(y),v(F),v(E.$$.fragment,_),v(G),T=!0)},o(_){A(S),A(y),A(F),A(E.$$.fragment,_),A(G),T=!1},d(_){_&&(Q(s),Q(m),Q(g),Q(R),Q(N)),S&&S.d(),y&&y.d(),F&&F.d(),x(E),G&&G.d(),re=!1,je(ge)}}}function ye(n){let s,e,i;function r(t){n[24](t)}let l={};return n[2]!==void 0&&(l.progressPercentage=n[2]),s=new Je({props:l}),D.push(()=>j(s,"progressPercentage",r)),{c(){Y(s.$$.fragment)},m(t,f){Z(s,t,f),i=!0},p(t,f){const u={};!e&&f[0]&4&&(e=!0,u.progressPercentage=t[2],O(()=>e=!1)),s.$set(u)},i(t){i||(v(s.$$.fragment,t),i=!0)},o(t){A(s.$$.fragment,t),i=!1},d(t){x(s,t)}}}function Fe(n){let s,e,i;function r(t){n[25](t)}let l={sessionId:n[0].session.id};return n[2]!==void 0&&(l.progressPercentage=n[2]),s=new ns({props:l}),D.push(()=>j(s,"progressPercentage",r)),{c(){Y(s.$$.fragment)},m(t,f){Z(s,t,f),i=!0},p(t,f){const u={};f[0]&1&&(u.sessionId=t[0].session.id),!e&&f[0]&4&&(e=!0,u.progressPercentage=t[2],O(()=>e=!1)),s.$set(u)},i(t){i||(v(s.$$.fragment,t),i=!0)},o(t){A(s.$$.fragment,t),i=!1},d(t){x(s,t)}}}function Ge(n){let s,e,i,r,l;function t(o){n[26](o)}function f(o){n[27](o)}let u={};return n[0]!==void 0&&(u.data=n[0]),n[13]!==void 0&&(u.examMode=n[13]),e=new us({props:u}),D.push(()=>j(e,"data",t)),D.push(()=>j(e,"examMode",f)),{c(){s=h("div"),Y(e.$$.fragment),p(s,"class","col-lg-3 d-none d-lg-block")},m(o,d){I(o,s,d),Z(e,s,null),l=!0},p(o,d){const w={};!i&&d[0]&1&&(i=!0,w.data=o[0],O(()=>i=!1)),!r&&d[0]&8192&&(r=!0,w.examMode=o[13],O(()=>r=!1)),e.$set(w)},i(o){l||(v(e.$$.fragment,o),l=!0)},o(o){A(e.$$.fragment,o),l=!1},d(o){o&&Q(s),x(e)}}}function He(n){let s,e,i,r,l,t,f,u,o;function d(g){n[31](g)}function w(g){n[32](g)}function P(g){n[33](g)}function k(g){n[34](g)}function H(g){n[35](g)}let C={submitAnswer:n[15],deleteAnswer:n[16],updateCurrentQuestionData:n[14]};n[10]!==void 0&&(C.question=n[10]),n[9]!==void 0&&(C.questionAnswered=n[9]),n[7]!==void 0&&(C.helpUsed=n[7]),n[1]!==void 0&&(C.answerChoice=n[1]),n[13]!==void 0&&(C.examMode=n[13]),s=new Ke({props:C}),D.push(()=>j(s,"question",d)),D.push(()=>j(s,"questionAnswered",w)),D.push(()=>j(s,"helpUsed",P)),D.push(()=>j(s,"answerChoice",k)),D.push(()=>j(s,"examMode",H));let m=!n[13]&&n[9]&&Te(n);return{c(){Y(s.$$.fragment),f=U(),m&&m.c(),u=ke()},m(g,c){Z(s,g,c),I(g,f,c),m&&m.m(g,c),I(g,u,c),o=!0},p(g,c){const M={};!e&&c[0]&1024&&(e=!0,M.question=g[10],O(()=>e=!1)),!i&&c[0]&512&&(i=!0,M.questionAnswered=g[9],O(()=>i=!1)),!r&&c[0]&128&&(r=!0,M.helpUsed=g[7],O(()=>r=!1)),!l&&c[0]&2&&(l=!0,M.answerChoice=g[1],O(()=>l=!1)),!t&&c[0]&8192&&(t=!0,M.examMode=g[13],O(()=>t=!1)),s.$set(M),!g[13]&&g[9]?m?(m.p(g,c),c[0]&8704&&v(m,1)):(m=Te(g),m.c(),v(m,1),m.m(u.parentNode,u)):m&&(K(),A(m,1,1,()=>{m=null}),J())},i(g){o||(v(s.$$.fragment,g),v(m),o=!0)},o(g){A(s.$$.fragment,g),A(m),o=!1},d(g){g&&(Q(f),Q(u)),x(s,g),m&&m.d(g)}}}function Te(n){let s,e,i;function r(t){n[36](t)}let l={};return n[10].id!==void 0&&(l.questionId=n[10].id),s=new Re({props:l}),D.push(()=>j(s,"questionId",r)),{c(){Y(s.$$.fragment)},m(t,f){Z(s,t,f),i=!0},p(t,f){const u={};!e&&f[0]&1024&&(e=!0,u.questionId=t[10].id,O(()=>e=!1)),s.$set(u)},i(t){i||(v(s.$$.fragment,t),i=!0)},o(t){A(s.$$.fragment,t),i=!1},d(t){x(s,t)}}}function Ue(n){let s,e,i;function r(t){n[37](t)}let l={};return n[8]!==void 0&&(l.magicGIFPath=n[8]),s=new xe({props:l}),D.push(()=>j(s,"magicGIFPath",r)),{c(){Y(s.$$.fragment)},m(t,f){Z(s,t,f),i=!0},p(t,f){const u={};!e&&f[0]&256&&(e=!0,u.magicGIFPath=t[8],O(()=>e=!1)),s.$set(u)},i(t){i||(v(s.$$.fragment,t),i=!0)},o(t){A(s.$$.fragment,t),i=!1},d(t){x(s,t)}}}function bs(n){let s,e,i,r,l;const t=[ps,ms],f=[];function u(d,w){return d[0]?0:1}s=u(n),e=f[s]=t[s](n);let o=!n[13]&&Ue(n);return{c(){e.c(),i=U(),o&&o.c(),r=ke()},m(d,w){f[s].m(d,w),I(d,i,w),o&&o.m(d,w),I(d,r,w),l=!0},p(d,w){let P=s;s=u(d),s===P?f[s].p(d,w):(K(),A(f[P],1,1,()=>{f[P]=null}),J(),e=f[s],e?e.p(d,w):(e=f[s]=t[s](d),e.c()),v(e,1),e.m(i.parentNode,i)),d[13]?o&&(K(),A(o,1,1,()=>{o=null}),J()):o?(o.p(d,w),w[0]&8192&&v(o,1)):(o=Ue(d),o.c(),v(o,1),o.m(r.parentNode,r))},i(d){l||(v(e),v(o),l=!0)},o(d){A(e),A(o),l=!1},d(d){d&&(Q(i),Q(r)),f[s].d(d),o&&o.d(d)}}}function hs(n,s,e){let i,r,l,t,f,u,o,d,w,P,k,H,C,m;De(n,we,a=>e(6,m=a));let{id:g}=s;var c,M=!1,R="",N=-1;Ne(()=>{axios.get("/api/sessions/"+g).then(function(a){e(0,c=a.data)}).catch(function(a){alert(a)})});function ne(){return axios.get("/api/questions/"+o.id).then(function(a){var V=c.deck.questions.findIndex(ue=>ue.id===o.id),se=a.data;e(0,c.deck.questions[V]=se,c),B(se)}).catch(function(a){alert(a)})}function B(a){if(a.type!=="card"){var V=c.session.answer_choices.findIndex(se=>se.question_id===a.id);V!==-1&&e(0,c.session.answer_choices[V].is_correct=c.session.answer_choices[V].answer_id===a.correct_answer_id,c)}}var E;function ie(){E&&E.cancel(),E=Oe(()=>{axios.put("/api/sessions/"+c.session.id,c.session).then(function(a){}).catch(function(a){alert(a)})},1e3,{maxWait:2e3}),E()}function te(a){if(!P){var V=!1;o.type==="card"?V=!!a:V=o.correct_answer_id===a;var se={question_id:w,answer_id:a,is_correct:V,help_used:M};axios.post("/api/sessions/"+g+"/answerchoices",se).then(function(ue){e(0,c.session.answer_choices=[...c.session.answer_choices,ue.data],c)}).catch(function(ue){alert(ue)})}}function oe(){P&&(e(1,f=c.session.answer_choices.find(a=>a.question_id===w)),u&&axios.delete("/api/sessions/"+g+"/answerchoices/"+f.id).then(function(a){e(0,c.session.answer_choices=[...c.session.answer_choices.filter(V=>V.question_id!==w)],c)}).catch(function(a){alert(a)}))}const _e=()=>{ve(we,m.session_show_sidebar=!m.session_show_sidebar,m)},T=()=>{ve(we,m.session_exam_mode=!m.session_exam_mode,m)};function re(a){k=a,e(2,k),e(0,c),e(21,t),e(20,u)}function ge(a){k=a,e(2,k),e(0,c),e(21,t),e(20,u)}function S(a){c=a,e(0,c)}function y(a){i=a,e(13,i),e(3,d),e(6,m),e(0,c),e(21,t),e(20,u)}function F(a){c=a,e(0,c)}function me(a){n.$$.not_equal(c.session.current_question_id,a)&&(c.session.current_question_id=a,e(0,c))}function pe(a){P=a,e(9,P),e(0,c),e(1,f),e(19,w)}function be(a){o=a,e(10,o),e(0,c)}function $(a){P=a,e(9,P),e(0,c),e(1,f),e(19,w)}function G(a){M=a,e(7,M)}function _(a){f=a,e(1,f),e(0,c),e(19,w)}function q(a){i=a,e(13,i),e(3,d),e(6,m),e(0,c),e(21,t),e(20,u)}function ee(a){n.$$.not_equal(o.id,a)&&(o.id=a,e(10,o),e(0,c))}function Ve(a){R=a,e(8,R),e(2,k),e(18,N),e(0,c),e(21,t),e(20,u)}return n.$$set=a=>{"id"in a&&e(17,g=a.id)},n.$$.update=()=>{n.$$.dirty[0]&1&&e(21,t=c?c.deck.questions.filter(a=>!a.is_invalid):null),n.$$.dirty[0]&2097153&&e(20,u=c?c.session.answer_choices.filter(a=>t.some(({id:V})=>V===a.question_id)):null),n.$$.dirty[0]&3145729&&e(3,d=c?t.length===u.length:!1),n.$$.dirty[0]&72&&e(13,i=d?!1:m.session_exam_mode),n.$$.dirty[0]&64&&e(5,r=m.session_show_sidebar),n.$$.dirty[0]&64&&e(4,l=m.session_exam_mode),n.$$.dirty[0]&32&&axios.put("/api/users/me/settings",{session_show_sidebar:r}).then(function(a){}).catch(function(a){alert(a)}),n.$$.dirty[0]&16&&axios.put("/api/users/me/settings",{session_exam_mode:l}).then(function(a){}).catch(function(a){alert(a)}),n.$$.dirty[0]&1&&e(19,w=c?c.session.current_question_id:-1),n.$$.dirty[0]&524289&&e(1,f=c?c.session.answer_choices.find(a=>a.question_id===w):null),n.$$.dirty[0]&1&&e(10,o=c?c.deck.questions.find(a=>a.id===c.session.current_question_id):null),n.$$.dirty[0]&8&&d&&e(13,i=!1),n.$$.dirty[0]&524288&&ie(),n.$$.dirty[0]&3&&e(9,P=c?!!f:!1),n.$$.dirty[0]&3145729&&e(2,k=c?Xe(t.length,u):null),n.$$.dirty[0]&1&&e(12,H=c?c.deck.questions.length:0),n.$$.dirty[0]&1&&e(11,C=c?c.deck.questions.findIndex(a=>a.id==c.session.current_question_id)+1:null),n.$$.dirty[0]&262148&&(()=>{if(k){var a=k.correct;if(a<60){e(18,N=a);return}if(N===-1){e(18,N=a);return}N<60&&(e(18,N=a),axios.get("/api/magic-gif").then(function(V){e(8,R="magic-gifs/"+V.data.id)}).catch(function(V){}))}})()},[c,f,k,d,l,r,m,M,R,P,o,C,H,i,ne,te,oe,g,N,w,u,t,_e,T,re,ge,S,y,F,me,pe,be,$,G,_,q,ee,Ve]}class ws extends fe{constructor(s){super(),ae(this,s,hs,bs,de,{id:17},null,[-1,-1])}}const Le=document.getElementById("SessionView");new ws({target:Le,props:{id:Le.dataset.sessionId}});
