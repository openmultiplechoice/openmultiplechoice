import{d as T,p as B,f as h,a as E,u as v,g as a,j as n,c,i as H,t as U,m as I,e as m,h as O,k as q,b as D,s as W,r as p,q as X}from"./if-GZgNzgdl.js";import{o as Y}from"./index-client-CpfOMyFP.js";import{a as x,p as Z,e as $,i as ss}from"./event-modifiers-CaIg6h4B.js";import{s as es}from"./class-BfJg_ovI.js";import{S as ts}from"./SessionProgressBar-BpNUm9E2.js";import{s as as}from"./StatsHelper-B91isISU.js";import{f as ns}from"./formatDistance-C5pjvq49.js";import{p as M,f as is}from"./parseISO-BGu1X6cY.js";import"./style-BtOSwUPa.js";var rs=h('<button class="btn btn-sm btn-outline-secondary flex-fill" style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;" type="button"><i class="bi bi-repeat"></i> Repeat incorrect</button>'),os=h('<div class="mt-1 mb-2 p-2 rounded-2 border shadow-sm session-hover svelte-jzwx3l"><!> <div class="row mt-1"><div class="col-md-5 text-truncate"><strong> </strong></div> <div class="col-md-4 d-flex gap-1"><a style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;"><i class="bi bi-rocket-takeoff"></i> Open</a> <!> <a class="btn btn-sm btn-outline-secondary" style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;"><i class="bi bi-three-dots-vertical"></i></a></div> <div class="col-md-3 text-muted align-bottom"><span class="float-end d-none d-sm-none d-md-inline"><small> </small></span> <span class="d-inline d-sm-inline d-md-none"><small> </small></span></div></div></div>');function ds(y,s){B(s,!0);let i=v(()=>ns(M(s.session.created_at),new Date)),f=v(()=>is(M(s.session.created_at),"dd.MM.yyyy HH:mm")),b=v(()=>s.session?s.session.deck.questions.filter(t=>!t.is_invalid):null),r=v(()=>s.session?as(a(b).length,s.session.answerchoices.filter(t=>a(b).some(({id:o})=>o===t.question_id))):null);function w(t){axios.post("/api/sessions/"+t+"/newfromincorrect").then(function(o){window.location.href="/sessions/"+o.data.id}).catch(function(o){alert(o)})}var e=os(),d=n(e);ts(d,{get progressPercentage(){return a(r)},set progressPercentage(t){E(r,t)}});var k=c(d,2),l=n(k),u=n(l),g=n(u),_=c(l,2),S=n(_);let P;var z=c(S,2);{var L=t=>{var o=rs(),J=v(()=>Z(()=>w(s.session.id)));o.__click=function(...K){a(J)?.apply(this,K)},m(t,o)};H(z,t=>{a(r).unanswered===0&&a(r).incorrect>0&&t(L)})}var N=c(z,2),V=c(_,2),j=n(V),Q=n(j),R=n(Q),C=c(j,2),F=n(C),G=n(F);U(t=>{x(l,"title",s.session.name),I(g,s.session.name),x(S,"href",`/sessions/${s.session.id??""}`),P=es(S,1,"btn btn-sm flex-fill",null,P,t),x(N,"href",`/sessions/${s.session.id??""}/edit`),x(V,"title",a(f)),I(R,`${a(i)??""} ago`),I(G,`${a(i)??""} ago`)},[()=>({"btn-primary":a(r).unanswered,"btn-outline-secondary":!a(r).unanswered})]),m(y,e),O()}T(["click"]);var ls=h('<div class="alert alert-light text-center" role="alert">No sessions yet <i class="bi bi-rocket"></i></div>'),cs=h('<div class="d-flex justify-content-center"><div class="spinner-border text-secondary" role="status"><span class="visually-hidden">Loading sessions ...</span></div></div>');function ms(y,s){B(s,!0);var i=W(void 0);Y(()=>{axios.get("/api/sessions?take=10&user-id="+s.userId).then(function(e){E(i,e.data,!0)}).catch(function(e){alert(e)})});var f=q(),b=D(f);{var r=e=>{var d=q(),k=D(d);$(k,17,()=>p(i),ss,(l,u,g)=>{ds(l,{get session(){return p(i)[g]},set session(_){p(i)[g]=_}})},l=>{var u=ls();m(l,u)}),m(e,d)},w=e=>{var d=cs();m(e,d)};H(b,e=>{p(i)?e(r):e(w,!1)})}m(y,f),O()}const A=document.getElementById("IndexSessionView");X(ms,{target:A,props:{userId:A.dataset.userId}});
