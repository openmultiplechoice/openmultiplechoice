import{S as ye,i as je,s as Ue,b as m,g as C,t as v,c as h,a as Q,h as l,j,n as ee,d as G,l as X,p as ie,k as he,m as we,o as Ee,e as Ae,u as He,v as ve,w as Se,x as De,z as Re,f as Pe,r as ot,H as rt,D as ze,y as ut,E as ct,A as at,B as dt,F as Ge}from"./index-lwMDWDKL.js";import{e as pe}from"./each-_vP4lz_n.js";import{s as ft}from"./StatsHelper-9ER37DPz.js";import{C as _t}from"./auto-ovie_dKz.js";import{f as Ce,p as qe}from"./parseISO-rY9c-aYN.js";import{U as Me}from"./UserSettingsStore-q9gu1FOY.js";function Fe(e){let t,n,s,i,r,u,a,w,p,d,_=e[2]>=40&&We(e),g=e[2]>=70&&Ye(e);return{c(){t=m("div"),_&&_.c(),n=C(),g&&g.c(),s=C(),i=m("button"),r=m("i"),u=v(" Repeat "),a=v(e[2]),w=v(" incorrect"),h(r,"class","bi bi-repeat"),h(i,"class","btn btn-sm btn-outline-secondary"),h(i,"type","button"),h(t,"class","d-grid gap-2")},m(k,f){Q(k,t,f),_&&_.m(t,null),l(t,n),g&&g.m(t,null),l(t,s),l(t,i),l(i,r),l(i,u),l(i,a),l(i,w),p||(d=X(i,"click",ie(e[18])),p=!0)},p(k,f){k[2]>=40?_?_.p(k,f):(_=We(k),_.c(),_.m(t,n)):_&&(_.d(1),_=null),k[2]>=70?g?g.p(k,f):(g=Ye(k),g.c(),g.m(t,s)):g&&(g.d(1),g=null),f&4&&j(a,k[2])},d(k){k&&G(t),_&&_.d(),g&&g.d(),p=!1,d()}}}function We(e){let t,n,s;return{c(){t=m("button"),t.innerHTML='<i class="bi bi-repeat"></i> Repeat 30 incorrect',h(t,"class","btn btn-sm btn-outline-secondary"),h(t,"type","button")},m(i,r){Q(i,t,r),n||(s=X(t,"click",ie(e[16])),n=!0)},p:ee,d(i){i&&G(t),n=!1,s()}}}function Ye(e){let t,n,s;return{c(){t=m("button"),t.innerHTML='<i class="bi bi-repeat"></i> Repeat 60 incorrect',h(t,"class","btn btn-sm btn-outline-secondary"),h(t,"type","button")},m(i,r){Q(i,t,r),n||(s=X(t,"click",ie(e[17])),n=!0)},p:ee,d(i){i&&G(t),n=!1,s()}}}function mt(e){let t,n,s,i,r,u,a,w,p,d,_,g,k,f,o,I,M,c,S,b,q,D=Math.round(100*e[5]/e[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",L,y,R,F,V,Z,A,U,oe,W=Math.round(100*e[1]/e[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",B,H,Y,te,ne,de,$,se,fe,re=Math.round(100*e[4]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",_e,J,ge,x,ue,ke,K,ce,be,le=Math.round(100*e[3]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",me,T,E,P,Le,Ve,ae,Ne,Te,Ie=Math.round(100*e[2]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",Qe,Be,Oe,O=e[2]>0&&Fe(e);return{c(){t=m("div"),n=m("div"),s=m("canvas"),i=C(),r=m("div"),u=m("table"),a=m("thead"),w=C(),p=m("tbody"),d=m("tr"),_=m("td"),_.textContent="Questions",g=C(),k=m("td"),f=v(e[6]),o=C(),I=m("tr"),M=m("td"),M.textContent="Answered questions",c=C(),S=m("td"),b=v(e[5]),q=v(`
                        (`),L=v(D),y=v("%)"),R=C(),F=m("tr"),V=m("td"),V.textContent="Unanswered questions",Z=C(),A=m("td"),U=v(e[1]),oe=v(`
                        (`),B=v(W),H=v("%)"),Y=C(),te=m("tr"),ne=m("td"),ne.textContent="Correct answers",de=C(),$=m("td"),se=v(e[4]),fe=v(`
                        (`),_e=v(re),J=v("%)"),ge=C(),x=m("tr"),ue=m("td"),ue.textContent="Correct answers with help",ke=C(),K=m("td"),ce=v(e[3]),be=v(`
                        (`),me=v(le),T=v("%)"),E=C(),P=m("tr"),Le=m("td"),Le.textContent="Incorrect answers",Ve=C(),ae=m("td"),Ne=v(e[2]),Te=v(`
                        (`),Qe=v(Ie),Be=v("%)"),Oe=C(),O&&O.c(),h(n,"class","col-md-5"),h(k,"class","font-monospace text-end"),h(S,"class","font-monospace text-end"),h(A,"class","font-monospace text-end"),h($,"class","font-monospace text-end"),h(K,"class","font-monospace text-end"),h(ae,"class","font-monospace text-end"),h(u,"class","table"),h(r,"class","col-md-7 mt-3"),h(t,"class","row mb-5")},m(N,z){Q(N,t,z),l(t,n),l(n,s),e[15](s),l(t,i),l(t,r),l(r,u),l(u,a),l(u,w),l(u,p),l(p,d),l(d,_),l(d,g),l(d,k),l(k,f),l(p,o),l(p,I),l(I,M),l(I,c),l(I,S),l(S,b),l(S,q),l(S,L),l(S,y),l(p,R),l(p,F),l(F,V),l(F,Z),l(F,A),l(A,U),l(A,oe),l(A,B),l(A,H),l(p,Y),l(p,te),l(te,ne),l(te,de),l(te,$),l($,se),l($,fe),l($,_e),l($,J),l(p,ge),l(p,x),l(x,ue),l(x,ke),l(x,K),l(K,ce),l(K,be),l(K,me),l(K,T),l(p,E),l(p,P),l(P,Le),l(P,Ve),l(P,ae),l(ae,Ne),l(ae,Te),l(ae,Qe),l(ae,Be),l(r,Oe),O&&O.m(r,null)},p(N,[z]){z&64&&j(f,N[6]),z&32&&j(b,N[5]),z&96&&D!==(D=Math.round(100*N[5]/N[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(L,D),z&2&&j(U,N[1]),z&66&&W!==(W=Math.round(100*N[1]/N[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(B,W),z&16&&j(se,N[4]),z&48&&re!==(re=Math.round(100*N[4]/N[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(_e,re),z&8&&j(ce,N[3]),z&40&&le!==(le=Math.round(100*N[3]/N[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(me,le),z&4&&j(Ne,N[2]),z&36&&Ie!==(Ie=Math.round(100*N[2]/N[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(Qe,Ie),N[2]>0?O?O.p(N,z):(O=Fe(N),O.c(),O.m(r,null)):O&&(O.d(1),O=null)},i:ee,o:ee,d(N){N&&G(t),e[15](null),O&&O.d()}}}function ht(e,t,n){let s,i,r,u,a,w,p,d,_,{questionsInModule:g}=t,{answerChoices:k}=t,{moduleId:f}=t,o,I;function M(D){const L={module_id:f,question_ids:D};axios.post("/api/sessions/newfromquestionids",L).then(function(y){window.location.href="/sessions/"+y.data.id}).catch(function(y){alert(y)})}function c(D){he[D?"unshift":"push"](()=>{I=D,n(0,I)})}const S=()=>M(_.slice(0,30)),b=()=>M(_.slice(0,60)),q=()=>M(_);return e.$$set=D=>{"questionsInModule"in D&&n(9,g=D.questionsInModule),"answerChoices"in D&&n(10,k=D.answerChoices),"moduleId"in D&&n(11,f=D.moduleId)},e.$$.update=()=>{e.$$.dirty&512&&n(14,s=g.filter(D=>!D.is_invalid)),e.$$.dirty&17408&&n(13,i=k.filter(D=>s.some(({id:L})=>L===D.question_id))),e.$$.dirty&16384&&n(6,r=s.length),e.$$.dirty&8192&&n(5,u=i.length),e.$$.dirty&96&&n(1,a=r-u),e.$$.dirty&8192&&n(4,w=i.filter(D=>D.is_correct===1&&D.help_used===0).length),e.$$.dirty&8192&&n(3,p=i.filter(D=>D.is_correct===1&&D.help_used===1).length),e.$$.dirty&8192&&n(2,d=i.filter(D=>D.is_correct===0).length),e.$$.dirty&8192&&n(7,_=i.filter(D=>D.is_correct===0).map(D=>D.question_id)),e.$$.dirty&4127&&I&&(()=>{const D={type:"doughnut",data:{labels:["Correct","Correct with help","Incorrect","Unanswered"],datasets:[{label:"n",data:[w,p,d,a],backgroundColor:["#d4edda","#fff3cd","#f8d7da","#bbbbbb"],hoverOffet:4}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:null}}};o&&o.destroy();var L=I.getContext("2d");n(12,o=new _t(L,D))})()},[I,a,d,p,w,u,r,_,M,g,k,f,o,i,s,c,S,b,q]}class pt extends ye{constructor(t){super(),je(this,t,ht,mt,Ue,{questionsInModule:9,answerChoices:10,moduleId:11})}}function Je(e,t,n){const s=e.slice();return s[15]=t[n],s}function Ke(e){let t;return{c(){t=m("p"),t.textContent="Loading ..."},m(n,s){Q(n,t,s)},p:ee,d(n){n&&G(t)}}}function gt(e){let t,n=Ce(qe(e[15].created_at),"dd/MM/yyyy")+"",s;return{c(){t=m("span"),s=v(n),h(t,"class","badge text-bg-light")},m(i,r){Q(i,t,r),l(t,s)},p(i,r){r&16&&n!==(n=Ce(qe(i[15].created_at),"dd/MM/yyyy")+"")&&j(s,n)},d(i){i&&G(t)}}}function kt(e){let t,n=Ce(qe(e[15].exam_at),"dd/MM/yyyy")+"",s;return{c(){t=m("span"),s=v(n),h(t,"class","badge text-bg-light")},m(i,r){Q(i,t,r),l(t,s)},p(i,r){r&16&&n!==(n=Ce(qe(i[15].exam_at),"dd/MM/yyyy")+"")&&j(s,n)},d(i){i&&G(t)}}}function Xe(e){let t,n=e[5][e[15].id]+"",s;return{c(){t=new rt(!1),s=Ae(),t.a=s},m(i,r){t.m(n,i,r),Q(i,s,r)},p(i,r){r&48&&n!==(n=i[5][i[15].id]+"")&&t.p(n)},d(i){i&&(G(s),t.d())}}}function Ze(e){let t,n,s,i,r,u=e[15].questions.length+"",a,w,p,d,_,g,k,f,o,I=e[15].name+"",M,c,S,b,q,D,L,y,R,F;function V(B,H){return B[15].exam_at?kt:gt}let Z=V(e),A=Z(e),U=e[5][e[15].id]&&Xe(e);function oe(){return e[12](e[15])}function W(){return e[13](e[15])}return{c(){t=m("div"),n=m("div"),s=m("div"),A.c(),i=C(),r=m("span"),a=v(u),w=C(),U&&U.c(),p=C(),d=m("input"),k=C(),f=m("div"),o=m("h6"),M=v(I),c=C(),S=m("button"),S.innerHTML='<i class="bi bi-rocket-takeoff"></i> New session',b=C(),q=m("a"),D=v("Browse deck"),y=C(),h(r,"class","badge text-bg-secondary"),h(r,"title","Number of questions"),h(d,"class","form-check-input float-end"),h(d,"type","checkbox"),d.value="",h(d,"id",_="selected"+e[15].id),d.checked=g=e[3].has(e[15].id),h(s,"class","card-header"),h(o,"class","card-title"),h(S,"type","button"),h(S,"class","btn btn-sm btn-primary"),h(q,"href",L="/decks/"+e[15].id),h(q,"class","card-link"),h(f,"class","card-body"),h(n,"class","card"),h(t,"class","col-lg-6 mb-1")},m(B,H){Q(B,t,H),l(t,n),l(n,s),A.m(s,null),l(s,i),l(s,r),l(r,a),l(s,w),U&&U.m(s,null),l(s,p),l(s,d),l(n,k),l(n,f),l(f,o),l(o,M),l(f,c),l(f,S),l(f,b),l(f,q),l(q,D),l(t,y),R||(F=[X(d,"click",oe),X(S,"click",ie(W))],R=!0)},p(B,H){e=B,Z===(Z=V(e))&&A?A.p(e,H):(A.d(1),A=Z(e),A&&(A.c(),A.m(s,i))),H&16&&u!==(u=e[15].questions.length+"")&&j(a,u),e[5][e[15].id]?U?U.p(e,H):(U=Xe(e),U.c(),U.m(s,p)):U&&(U.d(1),U=null),H&16&&_!==(_="selected"+e[15].id)&&h(d,"id",_),H&24&&g!==(g=e[3].has(e[15].id))&&(d.checked=g),H&16&&I!==(I=e[15].name+"")&&j(M,I),H&16&&L!==(L="/decks/"+e[15].id)&&h(q,"href",L)},d(B){B&&G(t),A.d(),U&&U.d(),R=!1,ot(F)}}}function bt(e){let t,n,s,i,r,u,a;function w(o){e[9](o)}function p(o){e[10](o)}function d(o){e[11](o)}let _={};e[0]!==void 0&&(_.moduleId=e[0]),e[7]!==void 0&&(_.questionsInModule=e[7]),e[6]!==void 0&&(_.answerChoices=e[6]),t=new pt({props:_}),he.push(()=>we(t,"moduleId",w)),he.push(()=>we(t,"questionsInModule",p)),he.push(()=>we(t,"answerChoices",d));let g=pe(e[4]),k=[];for(let o=0;o<g.length;o+=1)k[o]=Ze(Je(e,g,o));let f=null;return g.length||(f=Ke()),{c(){Ee(t.$$.fragment),r=C();for(let o=0;o<k.length;o+=1)k[o].c();u=Ae(),f&&f.c()},m(o,I){He(t,o,I),Q(o,r,I);for(let M=0;M<k.length;M+=1)k[M]&&k[M].m(o,I);Q(o,u,I),f&&f.m(o,I),a=!0},p(o,[I]){const M={};if(!n&&I&1&&(n=!0,M.moduleId=o[0],ve(()=>n=!1)),!s&&I&128&&(s=!0,M.questionsInModule=o[7],ve(()=>s=!1)),!i&&I&64&&(i=!0,M.answerChoices=o[6],ve(()=>i=!1)),t.$set(M),I&62){g=pe(o[4]);let c;for(c=0;c<g.length;c+=1){const S=Je(o,g,c);k[c]?k[c].p(S,I):(k[c]=Ze(S),k[c].c(),k[c].m(u.parentNode,u))}for(;c<k.length;c+=1)k[c].d(1);k.length=g.length,!g.length&&f?f.p(o,I):g.length?f&&(f.d(1),f=null):(f=Ke(),f.c(),f.m(u.parentNode,u))}},i(o){a||(Se(t.$$.fragment,o),a=!0)},o(o){De(t.$$.fragment,o),a=!1},d(o){o&&(G(r),G(u)),Re(t,o),Pe(k,o),f&&f.d(o)}}}function wt(e,t,n){let s,i,r,{moduleId:u}=t,{createSession:a}=t,{selectDeck:w}=t,{userSelectedDecks:p}=t,d=[],_={};function g(c){if(!c){n(4,d=[]);return}axios.get("/api/decks?module="+c).then(function(S){n(4,d=S.data),d.sort(function(b,q){return b.exam_at===null?1:q.exam_at===null?-1:b.exam_at<q.exam_at})}).catch(function(S){alert(S)})}function k(c){u=c,n(0,u)}function f(c){s=c,n(7,s),n(4,d)}function o(c){i=c,n(6,i),n(8,_),n(4,d)}const I=c=>w(c.id),M=c=>a(c.id);return e.$$set=c=>{"moduleId"in c&&n(0,u=c.moduleId),"createSession"in c&&n(1,a=c.createSession),"selectDeck"in c&&n(2,w=c.selectDeck),"userSelectedDecks"in c&&n(3,p=c.userSelectedDecks)},e.$$.update=()=>{e.$$.dirty&16&&n(7,s=(()=>{var c=[];return d.forEach(S=>c.push(...S.questions)),c})()),e.$$.dirty&16&&(()=>{if(d.length===0)return;const c=d.map(S=>"decks[]="+S.id);axios.get("/api/stats?"+c.join("&")).then(function(S){n(8,_=S.data)}).catch(function(S){alert(S)})})(),e.$$.dirty&256&&n(6,i=(()=>{var c=[];for(const S in _)c.push(..._[S].answer_choices);return c.sort(function(S,b){return S.created_at<b.created_at}),c})()),e.$$.dirty&1&&g(u),e.$$.dirty&272&&n(5,r=(()=>{var c={};if(!_)return c;for(const b of d){if(!_[b.id]){c[b.id]="";continue}const q=_[b.id],D=q.deck.questions.filter(R=>!R.is_invalid),L=q.answer_choices.filter(R=>D.some(({id:F})=>F===R.question_id)),y=ft(D.length,L);var S='style="color: #721c24; background-color: #f8d7da;"';y.correct>=60&&(S='style="color: #155724; background-color: #d4edda;"'),c[b.id]="<span "+S+` class="badge" data-bs-toggle="popover" data-bs-title="Popover title" data-bs-content="And here's some..." title="Correct answers in percent">`+y.correct+" %</span>"}return c})())},[u,a,w,p,d,r,i,s,_,k,f,o,I,M]}class vt extends ye{constructor(t){super(),je(this,t,wt,bt,Ue,{moduleId:0,createSession:1,selectDeck:2,userSelectedDecks:3})}}function $e(e){let t,n,s,i,r,u,a,w,p,d=e[0].length+"",_,g,k=e[0].length>1?"s":"",f,o,I,M=e[2].length+"",c,S,b=e[2].length>1?"s":"",q,D,L,y,R,F,V,Z,A,U,oe,W,B,H,Y,te,ne=e[2].length+"",de,$,se=e[2].length>1?"s":"",fe,re,_e,J,ge,x=e[4].length+"",ue,ke,K=e[4].length>1?"s":"",ce,be,le,me,T=e[4].length>0&&xe(e);return{c(){t=m("div"),n=m("div"),s=m("div"),i=m("p"),i.textContent="Create your own super deck:",r=C(),u=m("p"),a=v("You have "),w=m("strong"),p=v("selected "),_=v(d),g=v(" deck"),f=v(k),o=v(`
                    with `),I=m("strong"),c=v(M),S=v(" question"),q=v(b),D=C(),T&&T.c(),L=C(),y=m("div"),R=m("label"),R.textContent="Deck Name",F=C(),V=m("input"),Z=C(),A=m("div"),U=m("input"),oe=C(),W=m("label"),W.textContent="Filter out duplicates",B=C(),H=m("div"),Y=m("button"),te=v("Create deck ("),de=v(ne),$=v(" question"),fe=v(se),re=v(")"),_e=C(),J=m("button"),ge=v("Create deck ("),ue=v(x),ke=v(" image question"),ce=v(K),be=v(")"),h(R,"for","name"),h(R,"class","form-label"),h(V,"type","text"),h(V,"class","form-control"),h(V,"id","name"),h(y,"class","mb-3"),h(U,"type","checkbox"),h(U,"class","form-check-input"),h(U,"id","checkboxRemoveDuplicates"),h(W,"class","form-check-label"),h(W,"for","checkboxRemoveDuplicates"),h(A,"class","mb-3 form-check"),h(Y,"class","btn btn-sm btn-primary"),h(J,"class","btn btn-sm btn-primary"),h(H,"class","d-grid gap-2 d-md-block"),h(s,"class","alert alert-light"),h(s,"role","alert"),h(n,"class","col-md"),h(t,"class","row")},m(E,P){Q(E,t,P),l(t,n),l(n,s),l(s,i),l(s,r),l(s,u),l(u,a),l(u,w),l(w,p),l(w,_),l(w,g),l(w,f),l(u,o),l(u,I),l(I,c),l(I,S),l(I,q),l(u,D),T&&T.m(u,null),l(s,L),l(s,y),l(y,R),l(y,F),l(y,V),ze(V,e[3]),l(s,Z),l(s,A),l(A,U),U.checked=e[1],l(A,oe),l(A,W),l(s,B),l(s,H),l(H,Y),l(Y,te),l(Y,de),l(Y,$),l(Y,fe),l(Y,re),l(H,_e),l(H,J),l(J,ge),l(J,ue),l(J,ke),l(J,ce),l(J,be),le||(me=[X(V,"input",e[6]),X(V,"focus",Dt),X(U,"change",e[7]),X(Y,"click",ie(e[8])),X(J,"click",ie(e[9]))],le=!0)},p(E,P){P&1&&d!==(d=E[0].length+"")&&j(_,d),P&1&&k!==(k=E[0].length>1?"s":"")&&j(f,k),P&4&&M!==(M=E[2].length+"")&&j(c,M),P&4&&b!==(b=E[2].length>1?"s":"")&&j(q,b),E[4].length>0?T?T.p(E,P):(T=xe(E),T.c(),T.m(u,null)):T&&(T.d(1),T=null),P&8&&V.value!==E[3]&&ze(V,E[3]),P&2&&(U.checked=E[1]),P&4&&ne!==(ne=E[2].length+"")&&j(de,ne),P&4&&se!==(se=E[2].length>1?"s":"")&&j(fe,se),P&16&&x!==(x=E[4].length+"")&&j(ue,x),P&16&&K!==(K=E[4].length>1?"s":"")&&j(ce,K)},d(E){E&&G(t),T&&T.d(),le=!1,ot(me)}}}function xe(e){let t,n,s=e[4].length+"",i,r,u=e[4].length>1?"s":"",a,w;return{c(){t=v("/ "),n=m("strong"),i=v(s),r=v(" question"),a=v(u),w=v(" with images")},m(p,d){Q(p,t,d),Q(p,n,d),l(n,i),l(n,r),l(n,a),l(n,w)},p(p,d){d&16&&s!==(s=p[4].length+"")&&j(i,s),d&16&&u!==(u=p[4].length>1?"s":"")&&j(a,u)},d(p){p&&(G(t),G(n))}}}function St(e){let t,n=e[0].length>0&&$e(e);return{c(){n&&n.c(),t=Ae()},m(s,i){n&&n.m(s,i),Q(s,t,i)},p(s,[i]){s[0].length>0?n?n.p(s,i):(n=$e(s),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:ee,o:ee,d(s){s&&G(t),n&&n.d(s)}}}function et(e,t){var n={name:e,question_ids:t};axios.post("/api/decks",n).then(function(s){window.location.href="/decks/"+s.data.id}).catch(function(s){alert(s)})}const Dt=e=>e.target.select();function It(e,t,n){let s,i,{userSelectedDecks:r}=t,u=[],a="My new super deck",w=!0;function p(){if(r.size===0){n(0,u=[]);return}const f=[...r].map(o=>"decks[]="+o);axios.get("/api/decks?"+f.join("&")).then(function(o){n(0,u=o.data)}).catch(function(o){alert(o)})}function d(){a=this.value,n(3,a)}function _(){w=this.checked,n(1,w)}const g=()=>et(a,s.map(f=>f.id)),k=()=>et(a,i.map(f=>f.id));return e.$$set=f=>{"userSelectedDecks"in f&&n(5,r=f.userSelectedDecks)},e.$$.update=()=>{e.$$.dirty&32&&p(),e.$$.dirty&3&&n(2,s=(()=>{var f=[];return u.forEach(o=>f.push(...o.questions)),w?[...new Map(f.map(o=>[o.id,o])).values()]:f})()),e.$$.dirty&3&&n(4,i=(()=>{var f=[];return u.forEach(o=>{o.questions.forEach(I=>{I.images.length>0&&f.push(I)})}),w?[...new Map(f.map(o=>[o.id,o])).values()]:f})())},[u,w,s,a,i,r,d,_,g,k]}class Mt extends ye{constructor(t){super(),je(this,t,It,St,Ue,{userSelectedDecks:5})}}function tt(e,t,n){const s=e.slice();return s[12]=t[n],s}function nt(e,t,n){const s=e.slice();return s[15]=t[n],s}function st(e){let t,n,s=pe(e[2]),i=[];for(let r=0;r<s.length;r+=1)i[r]=lt(nt(e,s,r));return{c(){t=m("ul");for(let r=0;r<i.length;r+=1)i[r].c();n=C(),h(t,"class","list-group m-2 me-0")},m(r,u){Q(r,t,u);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(t,null);l(t,n)},p(r,u){if(u&37){s=pe(r[2]);let a;for(a=0;a<s.length;a+=1){const w=nt(r,s,a);i[a]?i[a].p(w,u):(i[a]=lt(w),i[a].c(),i[a].m(t,n))}for(;a<i.length;a+=1)i[a].d(1);i.length=s.length}},d(r){r&&G(t),Pe(i,r)}}}function lt(e){let t,n=e[15].name+"",s,i,r,u;function a(){return e[9](e[15])}return{c(){t=m("button"),s=v(n),h(t,"class",i="list-group-item list-group-item-action "+(e[0].last_module_id===e[15].id?"list-group-item-secondary":"list-group-item-light"))},m(w,p){Q(w,t,p),l(t,s),r||(u=X(t,"click",ie(a)),r=!0)},p(w,p){e=w,p&4&&n!==(n=e[15].name+"")&&j(s,n),p&5&&i!==(i="list-group-item list-group-item-action "+(e[0].last_module_id===e[15].id?"list-group-item-secondary":"list-group-item-light"))&&h(t,"class",i)},d(w){w&&G(t),r=!1,u()}}}function it(e){let t,n=e[12].name+"",s,i,r,u,a,w;function p(){return e[8](e[12])}let d=e[0].last_subject_id===e[12].id&&st(e);return{c(){t=m("button"),s=v(n),r=C(),d&&d.c(),u=Ae(),h(t,"class",i="list-group-item list-group-item-action "+(e[0].last_subject_id===e[12].id?"list-group-item-dark":"list-group-item-light"))},m(_,g){Q(_,t,g),l(t,s),Q(_,r,g),d&&d.m(_,g),Q(_,u,g),a||(w=X(t,"click",ie(p)),a=!0)},p(_,g){e=_,g&2&&n!==(n=e[12].name+"")&&j(s,n),g&3&&i!==(i="list-group-item list-group-item-action "+(e[0].last_subject_id===e[12].id?"list-group-item-dark":"list-group-item-light"))&&h(t,"class",i),e[0].last_subject_id===e[12].id?d?d.p(e,g):(d=st(e),d.c(),d.m(u.parentNode,u)):d&&(d.d(1),d=null)},d(_){_&&(G(t),G(r),G(u)),d&&d.d(_),a=!1,w()}}}function Ct(e){let t;return{c(){t=m("p"),t.textContent="No module selected."},m(n,s){Q(n,t,s)},p:ee,i:ee,o:ee,d(n){n&&G(t)}}}function qt(e){let t,n,s;function i(u){e[11](u)}let r={moduleId:e[0].last_module_id,createSession:jt,selectDeck:e[6]};return e[3]!==void 0&&(r.userSelectedDecks=e[3]),t=new vt({props:r}),he.push(()=>we(t,"userSelectedDecks",i)),{c(){Ee(t.$$.fragment)},m(u,a){He(t,u,a),s=!0},p(u,a){const w={};a&1&&(w.moduleId=u[0].last_module_id),!n&&a&8&&(n=!0,w.userSelectedDecks=u[3],ve(()=>n=!1)),t.$set(w)},i(u){s||(Se(t.$$.fragment,u),s=!0)},o(u){De(t.$$.fragment,u),s=!1},d(u){Re(t,u)}}}function yt(e){let t,n,s,i,r,u,a,w,p,d,_,g,k=pe(e[1]),f=[];for(let b=0;b<k.length;b+=1)f[b]=it(tt(e,k,b));function o(b){e[10](b)}let I={};e[3]!==void 0&&(I.userSelectedDecks=e[3]),u=new Mt({props:I}),he.push(()=>we(u,"userSelectedDecks",o));const M=[qt,Ct],c=[];function S(b,q){return b[0].last_module_id?0:1}return d=S(e),_=c[d]=M[d](e),{c(){t=m("div"),n=m("div"),s=m("ul");for(let b=0;b<f.length;b+=1)f[b].c();i=C(),r=m("div"),Ee(u.$$.fragment),w=C(),p=m("div"),_.c(),h(s,"class","list-group"),h(n,"class","col-md-4 mb-2"),h(p,"class","row"),h(r,"class","col-md-8"),h(t,"class","row")},m(b,q){Q(b,t,q),l(t,n),l(n,s);for(let D=0;D<f.length;D+=1)f[D]&&f[D].m(s,null);l(t,i),l(t,r),He(u,r,null),l(r,w),l(r,p),c[d].m(p,null),g=!0},p(b,[q]){if(q&55){k=pe(b[1]);let y;for(y=0;y<k.length;y+=1){const R=tt(b,k,y);f[y]?f[y].p(R,q):(f[y]=it(R),f[y].c(),f[y].m(s,null))}for(;y<f.length;y+=1)f[y].d(1);f.length=k.length}const D={};!a&&q&8&&(a=!0,D.userSelectedDecks=b[3],ve(()=>a=!1)),u.$set(D);let L=d;d=S(b),d===L?c[d].p(b,q):(dt(),De(c[L],1,1,()=>{c[L]=null}),ut(),_=c[d],_?_.p(b,q):(_=c[d]=M[d](b),_.c()),Se(_,1),_.m(p,null))},i(b){g||(Se(u.$$.fragment,b),Se(_),g=!0)},o(b){De(u.$$.fragment,b),De(_),g=!1},d(b){b&&G(t),Pe(f,b),Re(u),c[d].d()}}}function jt(e){var t={deck_id:e};axios.post("/api/sessions",t).then(function(n){window.location.href="/sessions/"+n.data.id}).catch(function(n){alert(n)})}function Ut(e,t,n){let s;ct(e,Me,o=>n(0,s=o));let i=[],r=[],u=[],a=new Set;at(()=>{axios.get("/api/modules").then(function(o){var I=o.data;n(7,i=I.filter((c,S,b)=>S===b.findIndex(q=>q.id===c.id)).sort(function(c,S){return c.name>S.name}));var M=i.map(c=>c.subject).filter(c=>!!c);n(1,r=M.filter((c,S,b)=>S===b.findIndex(q=>q.id===c.id)).sort(function(c,S){return c.name>S.name}))}).catch(function(o){alert(o)})});function w(o){var I={last_subject_id:o,last_module_id:0};axios.put("/api/users/me/settings",I).then(function(M){Ge(Me,s.last_subject_id=o,s),Ge(Me,s.last_module_id=0,s)}).catch(function(M){alert(M)})}function p(o){var I={last_module_id:o};axios.put("/api/users/me/settings",I).then(function(M){Ge(Me,s.last_module_id=o,s)}).catch(function(M){alert(M)})}function d(o){a.has(o)?a.delete(o):a.add(o),n(3,a=new Set([...a]))}const _=o=>w(o.id),g=o=>p(o.id);function k(o){a=o,n(3,a)}function f(o){a=o,n(3,a)}return e.$$.update=()=>{e.$$.dirty&129&&(s.last_subject_id,n(2,u=i.filter(o=>s.last_subject_id?o.subject?o.subject.id===s.last_subject_id:!1:!0)))},[s,r,u,a,w,p,d,i,_,g,k,f]}class At extends ye{constructor(t){super(),je(this,t,Ut,yt,Ue,{})}}const Lt=document.getElementById("NewSessionView");new At({target:Lt});
