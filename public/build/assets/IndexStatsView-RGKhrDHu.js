import{S as Z,i as G,s as J,g,b as m,q as K,c as p,a as k,h as f,n as M,d as v,A as Q,k as W,f as U,t as q,l as z,p as F,j as S}from"./index-B80I9K_4.js";import{e as H}from"./each-DkBj6IvG.js";import{c as A}from"./NewSessionHelper-Ba9jtPTo.js";import{C as X}from"./auto-B1JLC99t.js";import{f as T,p as Y}from"./parseISO-Ds5nI7_t.js";function j(l,e,o){const n=l.slice();return n[10]=e[o],n}function I(l,e,o){const n=l.slice();return n[10]=e[o],n}function $(l){let e;return{c(){e=m("p"),e.textContent="No stats available yet"},m(o,n){k(o,e,n)},p:M,d(o){o&&v(e)}}}function x(l){let e,o,n=l[1].length>0&&O(l),s=l[2].length>0&&D(l);return{c(){e=m("div"),n&&n.c(),o=g(),s&&s.c(),p(e,"class","row")},m(i,t){k(i,e,t),n&&n.m(e,null),f(e,o),s&&s.m(e,null)},p(i,t){i[1].length>0?n?n.p(i,t):(n=O(i),n.c(),n.m(e,o)):n&&(n.d(1),n=null),i[2].length>0?s?s.p(i,t):(s=D(i),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(i){i&&v(e),n&&n.d(),s&&s.d()}}}function O(l){let e,o,n,s=H(l[1]),i=[];for(let t=0;t<s.length;t+=1)i[t]=B(I(l,s,t));return{c(){e=m("div"),o=m("h6"),o.textContent="New decks",n=g();for(let t=0;t<i.length;t+=1)i[t].c();p(e,"class","col-md-6 mt-3")},m(t,r){k(t,e,r),f(e,o),f(e,n);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(e,null)},p(t,r){if(r&2){s=H(t[1]);let a;for(a=0;a<s.length;a+=1){const c=I(t,s,a);i[a]?i[a].p(c,r):(i[a]=B(c),i[a].c(),i[a].m(e,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=s.length}},d(t){t&&v(e),U(i,t)}}}function V(l){let e,o,n,s=l[10].questions.length+"",i;return{c(){e=m("span"),o=m("i"),n=g(),i=q(s),p(o,"class","bi bi-collection"),p(e,"class","badge text-bg-light"),p(e,"title","Number of questions")},m(t,r){k(t,e,r),f(e,o),f(e,n),f(e,i)},p(t,r){r&2&&s!==(s=t[10].questions.length+"")&&S(i,s)},d(t){t&&v(e)}}}function B(l){let e,o,n,s,i,t=l[10].name+"",r,a,c,h,_,b=l[10].questions.length>0&&V(l);function u(){return l[7](l[10])}return{c(){e=m("div"),b&&b.c(),o=g(),n=m("button"),n.innerHTML='<i class="bi bi-rocket-takeoff"></i>',s=g(),i=m("a"),r=q(t),c=g(),p(n,"type","button"),p(n,"class","btn btn-sm btn-primary"),p(i,"href",a="/decks/"+l[10].id),p(i,"class","alert-link text-overflow svelte-1gfmo48"),p(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),p(e,"role","alert")},m(d,y){k(d,e,y),b&&b.m(e,null),f(e,o),f(e,n),f(e,s),f(e,i),f(i,r),f(e,c),h||(_=z(n,"click",F(u)),h=!0)},p(d,y){l=d,l[10].questions.length>0?b?b.p(l,y):(b=V(l),b.c(),b.m(e,o)):b&&(b.d(1),b=null),y&2&&t!==(t=l[10].name+"")&&S(r,t),y&2&&a!==(a="/decks/"+l[10].id)&&p(i,"href",a)},d(d){d&&v(e),b&&b.d(),h=!1,_()}}}function D(l){let e,o,n,s,i,t,r=H(l[2]),a=[];for(let c=0;c<r.length;c+=1)a[c]=R(j(l,r,c));return{c(){e=m("div"),o=m("h6"),n=q("Popular decks (last "),s=q(l[3]),i=q(" days)"),t=g();for(let c=0;c<a.length;c+=1)a[c].c();p(e,"class","col-md-6 mt-3")},m(c,h){k(c,e,h),f(e,o),f(o,n),f(o,s),f(o,i),f(e,t);for(let _=0;_<a.length;_+=1)a[_]&&a[_].m(e,null)},p(c,h){if(h&8&&S(s,c[3]),h&4){r=H(c[2]);let _;for(_=0;_<r.length;_+=1){const b=j(c,r,_);a[_]?a[_].p(b,h):(a[_]=R(b),a[_].c(),a[_].m(e,null))}for(;_<a.length;_+=1)a[_].d(1);a.length=r.length}},d(c){c&&v(e),U(a,c)}}}function P(l){let e,o,n,s=l[10].questions.length+"",i;return{c(){e=m("span"),o=m("i"),n=g(),i=q(s),p(o,"class","bi bi-collection"),p(e,"class","badge text-bg-light"),p(e,"title","Number of questions")},m(t,r){k(t,e,r),f(e,o),f(e,n),f(e,i)},p(t,r){r&4&&s!==(s=t[10].questions.length+"")&&S(i,s)},d(t){t&&v(e)}}}function E(l){let e,o,n,s=l[10].sessions_count+"",i;return{c(){e=m("span"),o=m("i"),n=g(),i=q(s),p(o,"class","bi bi-rocket"),p(e,"class","badge text-bg-light"),p(e,"title","Number of sessions")},m(t,r){k(t,e,r),f(e,o),f(e,n),f(e,i)},p(t,r){r&4&&s!==(s=t[10].sessions_count+"")&&S(i,s)},d(t){t&&v(e)}}}function R(l){let e,o,n,s,i,t,r=l[10].name+"",a,c,h,_,b,u=l[10].questions.length>0&&P(l),d=l[10].sessions_count&&E(l);function y(){return l[8](l[10])}return{c(){e=m("div"),u&&u.c(),o=g(),d&&d.c(),n=g(),s=m("button"),s.innerHTML='<i class="bi bi-rocket-takeoff"></i>',i=g(),t=m("a"),a=q(r),h=g(),p(s,"type","button"),p(s,"class","btn btn-sm btn-primary"),p(t,"href",c="/decks/"+l[10].id),p(t,"class","alert-link"),p(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),p(e,"role","alert")},m(C,w){k(C,e,w),u&&u.m(e,null),f(e,o),d&&d.m(e,null),f(e,n),f(e,s),f(e,i),f(e,t),f(t,a),f(e,h),_||(b=z(s,"click",F(y)),_=!0)},p(C,w){l=C,l[10].questions.length>0?u?u.p(l,w):(u=P(l),u.c(),u.m(e,o)):u&&(u.d(1),u=null),l[10].sessions_count?d?d.p(l,w):(d=E(l),d.c(),d.m(e,n)):d&&(d.d(1),d=null),w&4&&r!==(r=l[10].name+"")&&S(a,r),w&4&&c!==(c="/decks/"+l[10].id)&&p(t,"href",c)},d(C){C&&v(e),u&&u.d(),d&&d.d(),_=!1,b()}}}function ee(l){let e,o,n,s;function i(a,c){return a[1]&&a[2]?x:$}let t=i(l),r=t(l);return{c(){r.c(),e=g(),o=m("div"),n=m("div"),s=m("canvas"),K(s,"max-height","300px"),p(n,"class","col-md"),p(o,"class","row mt-3 p-3")},m(a,c){r.m(a,c),k(a,e,c),k(a,o,c),f(o,n),f(n,s),l[9](s)},p(a,[c]){t===(t=i(a))&&r?r.p(a,c):(r.d(1),r=t(a),r&&(r.c(),r.m(e.parentNode,e)))},i:M,o:M,d(a){a&&(v(e),v(o)),r.d(a),l[9](null)}}}function te(l,e,o){let n,s,i={},t={},r=[],a=[],c=0;Q(()=>{axios.get("/api/stats/activity").then(function(u){const d=u.data;o(5,i=d.answers_byhour),o(6,t=d.users_byhour),o(1,r=d.decks_new),o(2,a=d.decks_popular),o(3,c=d.decks_popular_timespan)}).catch(function(u){console.log(u)})});const h=u=>A(u.id),_=u=>A(u.id);function b(u){W[u?"unshift":"push"](()=>{n=u,o(0,n)})}return l.$$.update=()=>{l.$$.dirty&113&&n&&i&&t&&(()=>{const u=Object.keys(i),d=Object.values(i);if(d.reduce((N,L)=>N+L,0)===0)return;const C={type:"line",data:{labels:u,datasets:[{label:"Answers",data:d,backgroundColor:"rgba(255, 205, 86, 0.4)",borderColor:"rgba(255, 205, 86, 0.4)",fill:!0,showLine:!1,pointRadius:0,tension:.2},{label:"Users",data:Object.values(t),backgroundColor:"rgba(54, 162, 235, 0.7)",borderColor:"rgba(54, 162, 235, 0.7)",fill:!0,showLine:!1,pointRadius:0,tension:.2}]},options:{plugins:{legend:{display:!1},tooltip:{callbacks:{title(N){return T(Y(N[0].label),"dd.MM.yyyy HH:mm")}}}},responsive:!0,interaction:{intersect:!1},scales:{x:{display:!0,title:{display:!1,text:"Hour of the day"},ticks:{autoSkip:!0,maxTicksLimit:3,callback(N){const L=this.getLabelForValue(N);return T(L,"dd.MM.yyyy")}},grid:{display:!1},border:{display:!1}},y:{display:!0,title:{display:!1,text:"Number of answers"},ticks:{beginAtZero:!0,stepSize:1,maxTicksLimit:4,autoSkip:!0},border:{display:!1}}}}};s&&s.destroy();var w=n.getContext("2d");o(4,s=new X(w,C))})()},[n,r,a,c,s,i,t,h,_,b]}class le extends Z{constructor(e){super(),G(this,e,te,ee,J,{})}}const se=document.getElementById("IndexStatsView");new le({target:se});
