import{S as x,i as ee,s as te,c as m,a as v,t as E,f,E as le,b as S,h as c,q as I,n as A,d as q,C as se,F as ne,k as ie,m as B,l as U,p as O,H as N}from"./index-CW_84yAU.js";import{e as L}from"./each-23V_io8F.js";import{c as D}from"./NewSessionHelper-Ba9jtPTo.js";import{C as ae}from"./auto-TbvzFur0.js";import{f as M,p as oe}from"./parseISO-JEmvXouO.js";function V(s,e,o){const r=s.slice();return r[15]=e[o],r}function j(s,e,o){const r=s.slice();return r[15]=e[o],r}function P(s,e,o){const r=s.slice();return r[15]=e[o],r}function re(s){let e;return{c(){e=m("p"),e.textContent="No stats available yet"},m(o,r){S(o,e,r)},p:A,d(o){o&&q(e)}}}function fe(s){let e,o,r,i=s[2].length>0&&F(s),l=s[3].length>0&&s[4]&&Z(s),t=s[5].length>0&&Q(s);return{c(){e=m("div"),i&&i.c(),o=v(),l&&l.c(),r=v(),t&&t.c(),f(e,"class","row")},m(a,n){S(a,e,n),i&&i.m(e,null),c(e,o),l&&l.m(e,null),c(e,r),t&&t.m(e,null)},p(a,n){a[2].length>0?i?i.p(a,n):(i=F(a),i.c(),i.m(e,o)):i&&(i.d(1),i=null),a[3].length>0&&a[4]?l?l.p(a,n):(l=Z(a),l.c(),l.m(e,r)):l&&(l.d(1),l=null),a[5].length>0?t?t.p(a,n):(t=Q(a),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},d(a){a&&q(e),i&&i.d(),l&&l.d(),t&&t.d()}}}function F(s){let e,o,r,i=L(s[2]),l=[];for(let t=0;t<i.length;t+=1)l[t]=z(P(s,i,t));return{c(){e=m("div"),o=m("h6"),o.textContent="New decks",r=v();for(let t=0;t<l.length;t+=1)l[t].c();f(e,"class","col-lg mt-3 text-overflow svelte-1gfmo48")},m(t,a){S(t,e,a),c(e,o),c(e,r);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(t,a){if(a&4){i=L(t[2]);let n;for(n=0;n<i.length;n+=1){const d=P(t,i,n);l[n]?l[n].p(d,a):(l[n]=z(d),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=i.length}},d(t){t&&q(e),B(l,t)}}}function R(s){let e,o,r,i,l=s[15].questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"";return{c(){e=m("span"),o=m("i"),r=v(),i=new N(!1),f(o,"class","bi bi-collection"),i.a=null,f(e,"class","badge text-bg-light font-monospace"),f(e,"title","Number of questions")},m(t,a){S(t,e,a),c(e,o),c(e,r),i.m(l,e)},p(t,a){a&4&&l!==(l=t[15].questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"")&&i.p(l)},d(t){t&&q(e)}}}function z(s){let e,o,r,i,l,t=s[15].name+"",a,n,d,h,p,u=s[15].questions.length>0&&R(s);function k(){return s[9](s[15])}return{c(){e=m("div"),u&&u.c(),o=v(),r=m("button"),r.innerHTML='<i class="bi bi-rocket-takeoff"></i>',i=v(),l=m("a"),a=E(t),d=v(),f(r,"type","button"),f(r,"class","btn btn-sm btn-primary"),f(l,"href",n="/decks/"+s[15].id),f(l,"class","alert-link text-overflow svelte-1gfmo48"),f(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),f(e,"role","alert")},m(_,w){S(_,e,w),u&&u.m(e,null),c(e,o),c(e,r),c(e,i),c(e,l),c(l,a),c(e,d),h||(p=U(r,"click",O(k)),h=!0)},p(_,w){s=_,s[15].questions.length>0?u?u.p(s,w):(u=R(s),u.c(),u.m(e,o)):u&&(u.d(1),u=null),w&4&&t!==(t=s[15].name+"")&&I(a,t),w&4&&n!==(n="/decks/"+s[15].id)&&f(l,"href",n)},d(_){_&&q(e),u&&u.d(),h=!1,p()}}}function Z(s){let e,o,r,i,l,t,a=L(s[3]),n=[];for(let d=0;d<a.length;d+=1)n[d]=K(j(s,a,d));return{c(){e=m("div"),o=m("h6"),r=E("Popular decks (last "),i=E(s[4]),l=E(" days)"),t=v();for(let d=0;d<n.length;d+=1)n[d].c();f(e,"class","col-lg mt-3 text-overflow svelte-1gfmo48")},m(d,h){S(d,e,h),c(e,o),c(o,r),c(o,i),c(o,l),c(e,t);for(let p=0;p<n.length;p+=1)n[p]&&n[p].m(e,null)},p(d,h){if(h&16&&I(i,d[4]),h&8){a=L(d[3]);let p;for(p=0;p<a.length;p+=1){const u=j(d,a,p);n[p]?n[p].p(u,h):(n[p]=K(u),n[p].c(),n[p].m(e,null))}for(;p<n.length;p+=1)n[p].d(1);n.length=a.length}},d(d){d&&q(e),B(n,d)}}}function G(s){let e,o,r,i,l=s[15].questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"";return{c(){e=m("span"),o=m("i"),r=v(),i=new N(!1),f(o,"class","bi bi-collection"),i.a=null,f(e,"class","badge text-bg-light font-monospace"),f(e,"title","Number of questions")},m(t,a){S(t,e,a),c(e,o),c(e,r),i.m(l,e)},p(t,a){a&8&&l!==(l=t[15].questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"")&&i.p(l)},d(t){t&&q(e)}}}function J(s){let e,o,r,i,l=s[15].sessions_count.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"";return{c(){e=m("span"),o=m("i"),r=v(),i=new N(!1),f(o,"class","bi bi-rocket"),i.a=null,f(e,"class","badge text-bg-light font-monospace"),f(e,"title","Number of sessions")},m(t,a){S(t,e,a),c(e,o),c(e,r),i.m(l,e)},p(t,a){a&8&&l!==(l=t[15].sessions_count.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"")&&i.p(l)},d(t){t&&q(e)}}}function K(s){let e,o,r,i,l,t,a=s[15].name+"",n,d,h,p,u,k=s[15].questions.length>0&&G(s),_=s[15].sessions_count&&J(s);function w(){return s[10](s[15])}return{c(){e=m("div"),k&&k.c(),o=v(),_&&_.c(),r=v(),i=m("button"),i.innerHTML='<i class="bi bi-rocket-takeoff"></i>',l=v(),t=m("a"),n=E(a),h=v(),f(i,"type","button"),f(i,"class","btn btn-sm btn-primary"),f(t,"href",d="/decks/"+s[15].id),f(t,"class","alert-link"),f(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),f(e,"role","alert")},m(y,b){S(y,e,b),k&&k.m(e,null),c(e,o),_&&_.m(e,null),c(e,r),c(e,i),c(e,l),c(e,t),c(t,n),c(e,h),p||(u=U(i,"click",O(w)),p=!0)},p(y,b){s=y,s[15].questions.length>0?k?k.p(s,b):(k=G(s),k.c(),k.m(e,o)):k&&(k.d(1),k=null),s[15].sessions_count?_?_.p(s,b):(_=J(s),_.c(),_.m(e,r)):_&&(_.d(1),_=null),b&8&&a!==(a=s[15].name+"")&&I(n,a),b&8&&d!==(d="/decks/"+s[15].id)&&f(t,"href",d)},d(y){y&&q(e),k&&k.d(),_&&_.d(),p=!1,u()}}}function Q(s){let e,o,r,i=L(s[5]),l=[];for(let t=0;t<i.length;t+=1)l[t]=X(V(s,i,t));return{c(){e=m("div"),o=m("h6"),o.textContent="Last used decks",r=v();for(let t=0;t<l.length;t+=1)l[t].c();f(e,"class","col-lg mt-3 text-overflow svelte-1gfmo48")},m(t,a){S(t,e,a),c(e,o),c(e,r);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(t,a){if(a&32){i=L(t[5]);let n;for(n=0;n<i.length;n+=1){const d=V(t,i,n);l[n]?l[n].p(d,a):(l[n]=X(d),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=i.length}},d(t){t&&q(e),B(l,t)}}}function W(s){let e,o,r,i,l=s[15].questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"";return{c(){e=m("span"),o=m("i"),r=v(),i=new N(!1),f(o,"class","bi bi-collection"),i.a=null,f(e,"class","badge text-bg-light font-monospace"),f(e,"title","Number of questions")},m(t,a){S(t,e,a),c(e,o),c(e,r),i.m(l,e)},p(t,a){a&32&&l!==(l=t[15].questions.length.toString().padEnd(3," ").replace(/ /g,"&nbsp;")+"")&&i.p(l)},d(t){t&&q(e)}}}function X(s){let e,o,r,i,l,t=s[15].name+"",a,n,d,h,p,u=s[15].questions.length>0&&W(s);function k(){return s[11](s[15])}return{c(){e=m("div"),u&&u.c(),o=v(),r=m("button"),r.innerHTML='<i class="bi bi-rocket-takeoff"></i>',i=v(),l=m("a"),a=E(t),d=v(),f(r,"type","button"),f(r,"class","btn btn-sm btn-primary"),f(l,"href",n="/decks/"+s[15].id),f(l,"class","alert-link"),f(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),f(e,"role","alert")},m(_,w){S(_,e,w),u&&u.m(e,null),c(e,o),c(e,r),c(e,i),c(e,l),c(l,a),c(e,d),h||(p=U(r,"click",O(k)),h=!0)},p(_,w){s=_,s[15].questions.length>0?u?u.p(s,w):(u=W(s),u.c(),u.m(e,o)):u&&(u.d(1),u=null),w&32&&t!==(t=s[15].name+"")&&I(a,t),w&32&&n!==(n="/decks/"+s[15].id)&&f(l,"href",n)},d(_){_&&q(e),u&&u.d(),h=!1,p()}}}function ce(s){let e,o,r,i,l,t,a,n,d,h,p,u=(s[1]?M(s[1],"HH:mm"):"unknown")+"",k;function _(b,g){return b[2]&&b[3]&&b[5]?fe:re}let w=_(s),y=w(s);return{c(){e=m("div"),e.innerHTML='<div class="col-md"><h4>Stats</h4></div>',o=v(),y.c(),r=v(),i=m("div"),l=m("div"),t=m("canvas"),a=v(),n=m("div"),d=m("div"),h=m("span"),p=E("Last updated: "),k=E(u),f(e,"class","row"),le(t,"max-height","300px"),f(l,"class","col-md"),f(i,"id","stats"),f(i,"class","row mt-3 p-3"),f(h,"class","badge text-bg-light text-muted"),f(d,"class","col-md"),f(n,"class","row")},m(b,g){S(b,e,g),S(b,o,g),y.m(b,g),S(b,r,g),S(b,i,g),c(i,l),c(l,t),s[12](t),S(b,a,g),S(b,n,g),c(n,d),c(d,h),c(h,p),c(h,k)},p(b,[g]){w===(w=_(b))&&y?y.p(b,g):(y.d(1),y=w(b),y&&(y.c(),y.m(r.parentNode,r))),g&2&&u!==(u=(b[1]?M(b[1],"HH:mm"):"unknown")+"")&&I(k,u)},i:A,o:A,d(b){b&&(q(e),q(o),q(r),q(i),q(a),q(n)),y.d(b),s[12](null)}}}function ue(s,e,o){let r,i,l,t,a={},n={},d=[],h=[],p=0,u=[];se(()=>{k(),l=setInterval(k,2*60*1e3)}),ne(()=>{clearInterval(l)});function k(){axios.get("/api/stats/activity").then(function(g){const H=g.data;o(7,a=H.answers_byhour),o(8,n=H.users_byhour),o(2,d=H.decks_new),o(3,h=H.decks_popular),o(4,p=H.decks_popular_timespan),o(5,u=H.decks_last_used),o(1,t=new Date)}).catch(function(g){console.log(g)})}const _=g=>D(g.id),w=g=>D(g.id),y=g=>D(g.id);function b(g){ie[g?"unshift":"push"](()=>{r=g,o(0,r)})}return s.$$.update=()=>{s.$$.dirty&449&&r&&a&&n&&(()=>{const g=Object.keys(a),H=Object.values(a);if(H.reduce((C,T)=>C+T,0)===0){document.getElementById("stats").style.display="none";return}document.getElementById("stats").style.display="block";const Y={type:"line",data:{labels:g,datasets:[{label:"Answers",data:H,backgroundColor:"rgba(255, 205, 86, 0.4)",borderColor:"rgba(255, 205, 86, 0.4)",fill:!0,showLine:!1,pointRadius:0,tension:.2},{label:"Users",data:Object.values(n),backgroundColor:"rgba(54, 162, 235, 0.7)",borderColor:"rgba(54, 162, 235, 0.7)",fill:!0,showLine:!1,pointRadius:0,tension:.2}]},options:{plugins:{legend:{display:!1},tooltip:{callbacks:{title(C){return M(oe(C[0].label),"dd.MM.yyyy HH:mm")}}}},responsive:!0,interaction:{intersect:!1},scales:{x:{display:!0,title:{display:!1,text:"Hour of the day"},ticks:{autoSkip:!0,maxTicksLimit:3,callback(C){const T=this.getLabelForValue(C);return M(T,"dd.MM.yyyy")}},grid:{display:!1},border:{display:!1}},y:{display:!0,title:{display:!1,text:"Number of answers"},ticks:{beginAtZero:!0,stepSize:1,maxTicksLimit:4,autoSkip:!0},border:{display:!1}}}}};i&&i.destroy();var $=r.getContext("2d");o(6,i=new ae($,Y))})()},[r,t,d,h,p,u,i,a,n,_,w,y,b]}class de extends x{constructor(e){super(),ee(this,e,ue,ce,te,{})}}const pe=document.getElementById("IndexStatsView");new de({target:pe});
