import{S as ye,i as je,s as Ue,b as h,g as C,t as w,c as g,a as Q,h as l,j,n as ee,d as G,l as X,p as ie,k as he,m as we,o as He,e as Ae,x as Re,y as ve,z as Se,A as De,C as Pe,f as Ve,r as ot,H as rt,B as ut,I as ct,D as at,E as dt,J as Ge}from"./index-CfkxbGBF.js";import{e as pe}from"./each-11-GcuRw.js";import{s as ft}from"./StatsHelper-9ER37DPz.js";import{C as _t}from"./auto-ovie_dKz.js";import{f as Ce,p as qe}from"./parseISO-XzB07L2D.js";import{U as Me}from"./UserSettingsStore--bDKyU3G.js";function We(e){let t,n,s,i,o,r,a,v,k,d,_=e[2]>=40&&Fe(e),f=e[2]>=70&&Je(e);return{c(){t=h("div"),_&&_.c(),n=C(),f&&f.c(),s=C(),i=h("button"),o=h("i"),r=w(" Repeat "),a=w(e[2]),v=w(" incorrect"),g(o,"class","bi bi-repeat"),g(i,"class","btn btn-sm btn-outline-secondary"),g(i,"type","button"),g(t,"class","d-grid gap-2")},m(m,p){Q(m,t,p),_&&_.m(t,null),l(t,n),f&&f.m(t,null),l(t,s),l(t,i),l(i,o),l(i,r),l(i,a),l(i,v),k||(d=X(i,"click",ie(e[18])),k=!0)},p(m,p){m[2]>=40?_?_.p(m,p):(_=Fe(m),_.c(),_.m(t,n)):_&&(_.d(1),_=null),m[2]>=70?f?f.p(m,p):(f=Je(m),f.c(),f.m(t,s)):f&&(f.d(1),f=null),p&4&&j(a,m[2])},d(m){m&&G(t),_&&_.d(),f&&f.d(),k=!1,d()}}}function Fe(e){let t,n,s;return{c(){t=h("button"),t.innerHTML='<i class="bi bi-repeat"></i> Repeat 30 incorrect',g(t,"class","btn btn-sm btn-outline-secondary"),g(t,"type","button")},m(i,o){Q(i,t,o),n||(s=X(t,"click",ie(e[16])),n=!0)},p:ee,d(i){i&&G(t),n=!1,s()}}}function Je(e){let t,n,s;return{c(){t=h("button"),t.innerHTML='<i class="bi bi-repeat"></i> Repeat 60 incorrect',g(t,"class","btn btn-sm btn-outline-secondary"),g(t,"type","button")},m(i,o){Q(i,t,o),n||(s=X(t,"click",ie(e[17])),n=!0)},p:ee,d(i){i&&G(t),n=!1,s()}}}function mt(e){let t,n,s,i,o,r,a,v,k,d,_,f,m,p,u,I,M,c,S,b,q,D=Math.round(100*e[5]/e[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",L,y,H,W,T,Z,A,U,oe,F=Math.round(100*e[1]/e[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",B,E,J,te,ne,de,$,se,fe,re=Math.round(100*e[4]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",_e,Y,ge,x,ue,ke,K,ce,be,le=Math.round(100*e[3]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",me,V,R,P,Le,Te,ae,Ne,Be,Ie=Math.round(100*e[2]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",Qe,Oe,ze,O=e[2]>0&&We(e);return{c(){t=h("div"),n=h("div"),s=h("canvas"),i=C(),o=h("div"),r=h("table"),a=h("thead"),v=C(),k=h("tbody"),d=h("tr"),_=h("td"),_.textContent="Questions",f=C(),m=h("td"),p=w(e[6]),u=C(),I=h("tr"),M=h("td"),M.textContent="Answered questions",c=C(),S=h("td"),b=w(e[5]),q=w(`
                        (`),L=w(D),y=w("%)"),H=C(),W=h("tr"),T=h("td"),T.textContent="Unanswered questions",Z=C(),A=h("td"),U=w(e[1]),oe=w(`
                        (`),B=w(F),E=w("%)"),J=C(),te=h("tr"),ne=h("td"),ne.textContent="Correct answers",de=C(),$=h("td"),se=w(e[4]),fe=w(`
                        (`),_e=w(re),Y=w("%)"),ge=C(),x=h("tr"),ue=h("td"),ue.textContent="Correct answers with help",ke=C(),K=h("td"),ce=w(e[3]),be=w(`
                        (`),me=w(le),V=w("%)"),R=C(),P=h("tr"),Le=h("td"),Le.textContent="Incorrect answers",Te=C(),ae=h("td"),Ne=w(e[2]),Be=w(`
                        (`),Qe=w(Ie),Oe=w("%)"),ze=C(),O&&O.c(),g(n,"class","col-md-5"),g(m,"class","font-monospace text-end"),g(S,"class","font-monospace text-end"),g(A,"class","font-monospace text-end"),g($,"class","font-monospace text-end"),g(K,"class","font-monospace text-end"),g(ae,"class","font-monospace text-end"),g(r,"class","table"),g(o,"class","col-md-7 mt-3"),g(t,"class","row mb-5")},m(N,z){Q(N,t,z),l(t,n),l(n,s),e[15](s),l(t,i),l(t,o),l(o,r),l(r,a),l(r,v),l(r,k),l(k,d),l(d,_),l(d,f),l(d,m),l(m,p),l(k,u),l(k,I),l(I,M),l(I,c),l(I,S),l(S,b),l(S,q),l(S,L),l(S,y),l(k,H),l(k,W),l(W,T),l(W,Z),l(W,A),l(A,U),l(A,oe),l(A,B),l(A,E),l(k,J),l(k,te),l(te,ne),l(te,de),l(te,$),l($,se),l($,fe),l($,_e),l($,Y),l(k,ge),l(k,x),l(x,ue),l(x,ke),l(x,K),l(K,ce),l(K,be),l(K,me),l(K,V),l(k,R),l(k,P),l(P,Le),l(P,Te),l(P,ae),l(ae,Ne),l(ae,Be),l(ae,Qe),l(ae,Oe),l(o,ze),O&&O.m(o,null)},p(N,[z]){z&64&&j(p,N[6]),z&32&&j(b,N[5]),z&96&&D!==(D=Math.round(100*N[5]/N[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(L,D),z&2&&j(U,N[1]),z&66&&F!==(F=Math.round(100*N[1]/N[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(B,F),z&16&&j(se,N[4]),z&48&&re!==(re=Math.round(100*N[4]/N[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(_e,re),z&8&&j(ce,N[3]),z&40&&le!==(le=Math.round(100*N[3]/N[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(me,le),z&4&&j(Ne,N[2]),z&36&&Ie!==(Ie=Math.round(100*N[2]/N[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(Qe,Ie),N[2]>0?O?O.p(N,z):(O=We(N),O.c(),O.m(o,null)):O&&(O.d(1),O=null)},i:ee,o:ee,d(N){N&&G(t),e[15](null),O&&O.d()}}}function ht(e,t,n){let s,i,o,r,a,v,k,d,_,{questionsInModule:f}=t,{answerChoices:m}=t,{moduleId:p}=t,u,I;function M(D){const L={module_id:p,question_ids:D};axios.post("/api/sessions/newfromquestionids",L).then(function(y){window.location.href="/sessions/"+y.data.id}).catch(function(y){alert(y)})}function c(D){he[D?"unshift":"push"](()=>{I=D,n(0,I)})}const S=()=>M(_.slice(0,30)),b=()=>M(_.slice(0,60)),q=()=>M(_);return e.$$set=D=>{"questionsInModule"in D&&n(9,f=D.questionsInModule),"answerChoices"in D&&n(10,m=D.answerChoices),"moduleId"in D&&n(11,p=D.moduleId)},e.$$.update=()=>{e.$$.dirty&512&&n(14,s=f.filter(D=>!D.is_invalid)),e.$$.dirty&17408&&n(13,i=m.filter(D=>s.some(({id:L})=>L===D.question_id))),e.$$.dirty&16384&&n(6,o=s.length),e.$$.dirty&8192&&n(5,r=i.length),e.$$.dirty&96&&n(1,a=o-r),e.$$.dirty&8192&&n(4,v=i.filter(D=>D.is_correct===1&&D.help_used===0).length),e.$$.dirty&8192&&n(3,k=i.filter(D=>D.is_correct===1&&D.help_used===1).length),e.$$.dirty&8192&&n(2,d=i.filter(D=>D.is_correct===0).length),e.$$.dirty&8192&&n(7,_=i.filter(D=>D.is_correct===0).map(D=>D.question_id)),e.$$.dirty&4127&&I&&(()=>{const D={type:"doughnut",data:{labels:["Correct","Correct with help","Incorrect","Unanswered"],datasets:[{label:"n",data:[v,k,d,a],backgroundColor:["#d4edda","#fff3cd","#f8d7da","#bbbbbb"],hoverOffet:4}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:null}}};u&&u.destroy();var L=I.getContext("2d");n(12,u=new _t(L,D))})()},[I,a,d,k,v,r,o,_,M,f,m,p,u,i,s,c,S,b,q]}class pt extends ye{constructor(t){super(),je(this,t,ht,mt,Ue,{questionsInModule:9,answerChoices:10,moduleId:11})}}function Ye(e,t,n){const s=e.slice();return s[15]=t[n],s}function Ke(e){let t;return{c(){t=h("p"),t.textContent="Loading ..."},m(n,s){Q(n,t,s)},p:ee,d(n){n&&G(t)}}}function gt(e){let t,n=Ce(qe(e[15].created_at),"dd/MM/yyyy")+"",s;return{c(){t=h("span"),s=w(n),g(t,"class","badge text-bg-light")},m(i,o){Q(i,t,o),l(t,s)},p(i,o){o&16&&n!==(n=Ce(qe(i[15].created_at),"dd/MM/yyyy")+"")&&j(s,n)},d(i){i&&G(t)}}}function kt(e){let t,n=Ce(qe(e[15].exam_at),"dd/MM/yyyy")+"",s;return{c(){t=h("span"),s=w(n),g(t,"class","badge text-bg-light")},m(i,o){Q(i,t,o),l(t,s)},p(i,o){o&16&&n!==(n=Ce(qe(i[15].exam_at),"dd/MM/yyyy")+"")&&j(s,n)},d(i){i&&G(t)}}}function Xe(e){let t,n=e[5][e[15].id]+"",s;return{c(){t=new rt(!1),s=Ae(),t.a=s},m(i,o){t.m(n,i,o),Q(i,s,o)},p(i,o){o&48&&n!==(n=i[5][i[15].id]+"")&&t.p(n)},d(i){i&&(G(s),t.d())}}}function Ze(e){let t,n,s,i,o,r=e[15].questions.length+"",a,v,k,d,_,f,m,p,u,I=e[15].name+"",M,c,S,b,q,D,L,y,H,W;function T(B,E){return B[15].exam_at?kt:gt}let Z=T(e),A=Z(e),U=e[5][e[15].id]&&Xe(e);function oe(){return e[12](e[15])}function F(){return e[13](e[15])}return{c(){t=h("div"),n=h("div"),s=h("div"),A.c(),i=C(),o=h("span"),a=w(r),v=C(),U&&U.c(),k=C(),d=h("input"),m=C(),p=h("div"),u=h("h6"),M=w(I),c=C(),S=h("button"),S.innerHTML='<i class="bi bi-rocket-takeoff"></i> New session',b=C(),q=h("a"),D=w("Browse deck"),y=C(),g(o,"class","badge text-bg-secondary"),g(o,"title","Number of questions"),g(d,"class","form-check-input float-end"),g(d,"type","checkbox"),d.value="",g(d,"id",_="selected"+e[15].id),d.checked=f=e[3].has(e[15].id),g(s,"class","card-header"),g(u,"class","card-title"),g(S,"type","button"),g(S,"class","btn btn-sm btn-primary"),g(q,"href",L="/decks/"+e[15].id),g(q,"class","card-link"),g(p,"class","card-body"),g(n,"class","card"),g(t,"class","col-lg-6 mb-1")},m(B,E){Q(B,t,E),l(t,n),l(n,s),A.m(s,null),l(s,i),l(s,o),l(o,a),l(s,v),U&&U.m(s,null),l(s,k),l(s,d),l(n,m),l(n,p),l(p,u),l(u,M),l(p,c),l(p,S),l(p,b),l(p,q),l(q,D),l(t,y),H||(W=[X(d,"click",oe),X(S,"click",ie(F))],H=!0)},p(B,E){e=B,Z===(Z=T(e))&&A?A.p(e,E):(A.d(1),A=Z(e),A&&(A.c(),A.m(s,i))),E&16&&r!==(r=e[15].questions.length+"")&&j(a,r),e[5][e[15].id]?U?U.p(e,E):(U=Xe(e),U.c(),U.m(s,k)):U&&(U.d(1),U=null),E&16&&_!==(_="selected"+e[15].id)&&g(d,"id",_),E&24&&f!==(f=e[3].has(e[15].id))&&(d.checked=f),E&16&&I!==(I=e[15].name+"")&&j(M,I),E&16&&L!==(L="/decks/"+e[15].id)&&g(q,"href",L)},d(B){B&&G(t),A.d(),U&&U.d(),H=!1,ot(W)}}}function bt(e){let t,n,s,i,o,r,a;function v(u){e[9](u)}function k(u){e[10](u)}function d(u){e[11](u)}let _={};e[0]!==void 0&&(_.moduleId=e[0]),e[7]!==void 0&&(_.questionsInModule=e[7]),e[6]!==void 0&&(_.answerChoices=e[6]),t=new pt({props:_}),he.push(()=>we(t,"moduleId",v)),he.push(()=>we(t,"questionsInModule",k)),he.push(()=>we(t,"answerChoices",d));let f=pe(e[4]),m=[];for(let u=0;u<f.length;u+=1)m[u]=Ze(Ye(e,f,u));let p=null;return f.length||(p=Ke()),{c(){He(t.$$.fragment),o=C();for(let u=0;u<m.length;u+=1)m[u].c();r=Ae(),p&&p.c()},m(u,I){Re(t,u,I),Q(u,o,I);for(let M=0;M<m.length;M+=1)m[M]&&m[M].m(u,I);Q(u,r,I),p&&p.m(u,I),a=!0},p(u,[I]){const M={};if(!n&&I&1&&(n=!0,M.moduleId=u[0],ve(()=>n=!1)),!s&&I&128&&(s=!0,M.questionsInModule=u[7],ve(()=>s=!1)),!i&&I&64&&(i=!0,M.answerChoices=u[6],ve(()=>i=!1)),t.$set(M),I&62){f=pe(u[4]);let c;for(c=0;c<f.length;c+=1){const S=Ye(u,f,c);m[c]?m[c].p(S,I):(m[c]=Ze(S),m[c].c(),m[c].m(r.parentNode,r))}for(;c<m.length;c+=1)m[c].d(1);m.length=f.length,!f.length&&p?p.p(u,I):f.length?p&&(p.d(1),p=null):(p=Ke(),p.c(),p.m(r.parentNode,r))}},i(u){a||(Se(t.$$.fragment,u),a=!0)},o(u){De(t.$$.fragment,u),a=!1},d(u){u&&(G(o),G(r)),Pe(t,u),Ve(m,u),p&&p.d(u)}}}function wt(e,t,n){let s,i,o,{moduleId:r}=t,{createSession:a}=t,{selectDeck:v}=t,{userSelectedDecks:k}=t,d=[],_={};function f(c){if(!c){n(4,d=[]);return}axios.get("/api/decks?module="+c).then(function(S){n(4,d=S.data),d.sort(function(b,q){return b.exam_at===null?1:q.exam_at===null?-1:b.exam_at<q.exam_at})}).catch(function(S){alert(S)})}function m(c){r=c,n(0,r)}function p(c){s=c,n(7,s),n(4,d)}function u(c){i=c,n(6,i),n(8,_),n(4,d)}const I=c=>v(c.id),M=c=>a(c.id);return e.$$set=c=>{"moduleId"in c&&n(0,r=c.moduleId),"createSession"in c&&n(1,a=c.createSession),"selectDeck"in c&&n(2,v=c.selectDeck),"userSelectedDecks"in c&&n(3,k=c.userSelectedDecks)},e.$$.update=()=>{e.$$.dirty&16&&n(7,s=(()=>{var c=[];return d.forEach(S=>c.push(...S.questions)),c})()),e.$$.dirty&16&&(()=>{if(d.length===0)return;const c=d.map(S=>"decks[]="+S.id);axios.get("/api/stats?"+c.join("&")).then(function(S){n(8,_=S.data)}).catch(function(S){alert(S)})})(),e.$$.dirty&256&&n(6,i=(()=>{var c=[];for(const S in _)c.push(..._[S].answer_choices);return c.sort(function(S,b){return S.created_at<b.created_at}),c})()),e.$$.dirty&1&&f(r),e.$$.dirty&272&&n(5,o=(()=>{var c={};if(!_)return c;for(const b of d){if(!_[b.id]){c[b.id]="";continue}const q=_[b.id],D=q.deck.questions.filter(H=>!H.is_invalid),L=q.answer_choices.filter(H=>D.some(({id:W})=>W===H.question_id)),y=ft(D.length,L);var S='style="color: #721c24; background-color: #f8d7da;"';y.correct>=60&&(S='style="color: #155724; background-color: #d4edda;"'),c[b.id]="<span "+S+` class="badge" data-bs-toggle="popover" data-bs-title="Popover title" data-bs-content="And here's some..." title="Correct answers in percent">`+y.correct+" %</span>"}return c})())},[r,a,v,k,d,o,i,s,_,m,p,u,I,M]}class vt extends ye{constructor(t){super(),je(this,t,wt,bt,Ue,{moduleId:0,createSession:1,selectDeck:2,userSelectedDecks:3})}}function $e(e){let t,n,s,i,o,r,a,v,k,d=e[0].length+"",_,f,m=e[0].length>1?"s":"",p,u,I,M=e[2].length+"",c,S,b=e[2].length>1?"s":"",q,D,L,y,H,W,T,Z,A,U,oe,F,B,E,J,te,ne=e[2].length+"",de,$,se=e[2].length>1?"s":"",fe,re,_e,Y,ge,x=e[3].length+"",ue,ke,K=e[3].length>1?"s":"",ce,be,le,me,V=e[3].length>0&&xe(e);return{c(){t=h("div"),n=h("div"),s=h("div"),i=h("p"),i.textContent="Create your own super deck:",o=C(),r=h("p"),a=w("You have "),v=h("strong"),k=w("selected "),_=w(d),f=w(" deck"),p=w(m),u=w(`
                    with `),I=h("strong"),c=w(M),S=w(" question"),q=w(b),D=C(),V&&V.c(),L=C(),y=h("div"),H=h("label"),H.textContent="Deck Name",W=C(),T=h("input"),Z=C(),A=h("div"),U=h("input"),oe=C(),F=h("label"),F.textContent="Filter out duplicates",B=C(),E=h("div"),J=h("button"),te=w("Create deck ("),de=w(ne),$=w(" question"),fe=w(se),re=w(")"),_e=C(),Y=h("button"),ge=w("Create deck ("),ue=w(x),ke=w(" image question"),ce=w(K),be=w(")"),g(H,"for","name"),g(H,"class","form-label"),g(T,"type","text"),g(T,"class","form-control"),g(T,"id","name"),T.value=Ee,g(y,"class","mb-3"),g(U,"type","checkbox"),g(U,"class","form-check-input"),g(U,"id","checkboxRemoveDuplicates"),g(F,"class","form-check-label"),g(F,"for","checkboxRemoveDuplicates"),g(A,"class","mb-3 form-check"),g(J,"class","btn btn-sm btn-primary"),g(Y,"class","btn btn-sm btn-primary"),g(E,"class","d-grid gap-2 d-md-block"),g(s,"class","alert alert-light"),g(s,"role","alert"),g(n,"class","col-md"),g(t,"class","row")},m(R,P){Q(R,t,P),l(t,n),l(n,s),l(s,i),l(s,o),l(s,r),l(r,a),l(r,v),l(v,k),l(v,_),l(v,f),l(v,p),l(r,u),l(r,I),l(I,c),l(I,S),l(I,q),l(r,D),V&&V.m(r,null),l(s,L),l(s,y),l(y,H),l(y,W),l(y,T),l(s,Z),l(s,A),l(A,U),U.checked=e[1],l(A,oe),l(A,F),l(s,B),l(s,E),l(E,J),l(J,te),l(J,de),l(J,$),l(J,fe),l(J,re),l(E,_e),l(E,Y),l(Y,ge),l(Y,ue),l(Y,ke),l(Y,ce),l(Y,be),le||(me=[X(T,"focus",Dt),X(U,"change",e[5]),X(J,"click",ie(e[6])),X(Y,"click",ie(e[7]))],le=!0)},p(R,P){P&1&&d!==(d=R[0].length+"")&&j(_,d),P&1&&m!==(m=R[0].length>1?"s":"")&&j(p,m),P&4&&M!==(M=R[2].length+"")&&j(c,M),P&4&&b!==(b=R[2].length>1?"s":"")&&j(q,b),R[3].length>0?V?V.p(R,P):(V=xe(R),V.c(),V.m(r,null)):V&&(V.d(1),V=null),P&2&&(U.checked=R[1]),P&4&&ne!==(ne=R[2].length+"")&&j(de,ne),P&4&&se!==(se=R[2].length>1?"s":"")&&j(fe,se),P&8&&x!==(x=R[3].length+"")&&j(ue,x),P&8&&K!==(K=R[3].length>1?"s":"")&&j(ce,K)},d(R){R&&G(t),V&&V.d(),le=!1,ot(me)}}}function xe(e){let t,n,s=e[3].length+"",i,o,r=e[3].length>1?"s":"",a,v;return{c(){t=w("/ "),n=h("strong"),i=w(s),o=w(" question"),a=w(r),v=w(" with images")},m(k,d){Q(k,t,d),Q(k,n,d),l(n,i),l(n,o),l(n,a),l(n,v)},p(k,d){d&8&&s!==(s=k[3].length+"")&&j(i,s),d&8&&r!==(r=k[3].length>1?"s":"")&&j(a,r)},d(k){k&&(G(t),G(n))}}}function St(e){let t,n=e[0].length>0&&$e(e);return{c(){n&&n.c(),t=Ae()},m(s,i){n&&n.m(s,i),Q(s,t,i)},p(s,[i]){s[0].length>0?n?n.p(s,i):(n=$e(s),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:ee,o:ee,d(s){s&&G(t),n&&n.d(s)}}}let Ee="My new super deck";function et(e,t){var n={name:e,question_ids:t};axios.post("/api/decks",n).then(function(s){window.location.href="/decks/"+s.data.id}).catch(function(s){alert(s)})}const Dt=e=>e.target.select();function It(e,t,n){let s,i,{userSelectedDecks:o}=t,r=[],a=!0;function v(){if(o.size===0){n(0,r=[]);return}const f=[...o].map(m=>"decks[]="+m);axios.get("/api/decks?"+f.join("&")).then(function(m){n(0,r=m.data)}).catch(function(m){alert(m)})}function k(){a=this.checked,n(1,a)}const d=()=>et(Ee,s.map(f=>f.id)),_=()=>et(Ee,i.map(f=>f.id));return e.$$set=f=>{"userSelectedDecks"in f&&n(4,o=f.userSelectedDecks)},e.$$.update=()=>{e.$$.dirty&16&&v(),e.$$.dirty&3&&n(2,s=(()=>{var f=[];return r.forEach(m=>f.push(...m.questions)),a?[...new Map(f.map(m=>[m.id,m])).values()]:f})()),e.$$.dirty&3&&n(3,i=(()=>{var f=[];return r.forEach(m=>{m.questions.forEach(p=>{p.images.length>0&&f.push(p)})}),a?[...new Map(f.map(m=>[m.id,m])).values()]:f})())},[r,a,s,i,o,k,d,_]}class Mt extends ye{constructor(t){super(),je(this,t,It,St,Ue,{userSelectedDecks:4})}}function tt(e,t,n){const s=e.slice();return s[12]=t[n],s}function nt(e,t,n){const s=e.slice();return s[15]=t[n],s}function st(e){let t,n,s=pe(e[2]),i=[];for(let o=0;o<s.length;o+=1)i[o]=lt(nt(e,s,o));return{c(){t=h("ul");for(let o=0;o<i.length;o+=1)i[o].c();n=C(),g(t,"class","list-group m-2 me-0")},m(o,r){Q(o,t,r);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(t,null);l(t,n)},p(o,r){if(r&37){s=pe(o[2]);let a;for(a=0;a<s.length;a+=1){const v=nt(o,s,a);i[a]?i[a].p(v,r):(i[a]=lt(v),i[a].c(),i[a].m(t,n))}for(;a<i.length;a+=1)i[a].d(1);i.length=s.length}},d(o){o&&G(t),Ve(i,o)}}}function lt(e){let t,n=e[15].name+"",s,i,o,r;function a(){return e[9](e[15])}return{c(){t=h("button"),s=w(n),g(t,"class",i="list-group-item list-group-item-action "+(e[0].last_module_id===e[15].id?"list-group-item-secondary":"list-group-item-light"))},m(v,k){Q(v,t,k),l(t,s),o||(r=X(t,"click",ie(a)),o=!0)},p(v,k){e=v,k&4&&n!==(n=e[15].name+"")&&j(s,n),k&5&&i!==(i="list-group-item list-group-item-action "+(e[0].last_module_id===e[15].id?"list-group-item-secondary":"list-group-item-light"))&&g(t,"class",i)},d(v){v&&G(t),o=!1,r()}}}function it(e){let t,n=e[12].name+"",s,i,o,r,a,v;function k(){return e[8](e[12])}let d=e[0].last_subject_id===e[12].id&&st(e);return{c(){t=h("button"),s=w(n),o=C(),d&&d.c(),r=Ae(),g(t,"class",i="list-group-item list-group-item-action "+(e[0].last_subject_id===e[12].id?"list-group-item-dark":"list-group-item-light"))},m(_,f){Q(_,t,f),l(t,s),Q(_,o,f),d&&d.m(_,f),Q(_,r,f),a||(v=X(t,"click",ie(k)),a=!0)},p(_,f){e=_,f&2&&n!==(n=e[12].name+"")&&j(s,n),f&3&&i!==(i="list-group-item list-group-item-action "+(e[0].last_subject_id===e[12].id?"list-group-item-dark":"list-group-item-light"))&&g(t,"class",i),e[0].last_subject_id===e[12].id?d?d.p(e,f):(d=st(e),d.c(),d.m(r.parentNode,r)):d&&(d.d(1),d=null)},d(_){_&&(G(t),G(o),G(r)),d&&d.d(_),a=!1,v()}}}function Ct(e){let t;return{c(){t=h("p"),t.textContent="No module selected."},m(n,s){Q(n,t,s)},p:ee,i:ee,o:ee,d(n){n&&G(t)}}}function qt(e){let t,n,s;function i(r){e[11](r)}let o={moduleId:e[0].last_module_id,createSession:jt,selectDeck:e[6]};return e[3]!==void 0&&(o.userSelectedDecks=e[3]),t=new vt({props:o}),he.push(()=>we(t,"userSelectedDecks",i)),{c(){He(t.$$.fragment)},m(r,a){Re(t,r,a),s=!0},p(r,a){const v={};a&1&&(v.moduleId=r[0].last_module_id),!n&&a&8&&(n=!0,v.userSelectedDecks=r[3],ve(()=>n=!1)),t.$set(v)},i(r){s||(Se(t.$$.fragment,r),s=!0)},o(r){De(t.$$.fragment,r),s=!1},d(r){Pe(t,r)}}}function yt(e){let t,n,s,i,o,r,a,v,k,d,_,f,m=pe(e[1]),p=[];for(let b=0;b<m.length;b+=1)p[b]=it(tt(e,m,b));function u(b){e[10](b)}let I={};e[3]!==void 0&&(I.userSelectedDecks=e[3]),r=new Mt({props:I}),he.push(()=>we(r,"userSelectedDecks",u));const M=[qt,Ct],c=[];function S(b,q){return b[0].last_module_id?0:1}return d=S(e),_=c[d]=M[d](e),{c(){t=h("div"),n=h("div"),s=h("ul");for(let b=0;b<p.length;b+=1)p[b].c();i=C(),o=h("div"),He(r.$$.fragment),v=C(),k=h("div"),_.c(),g(s,"class","list-group"),g(n,"class","col-md-4 mb-2"),g(k,"class","row"),g(o,"class","col-md-8"),g(t,"class","row")},m(b,q){Q(b,t,q),l(t,n),l(n,s);for(let D=0;D<p.length;D+=1)p[D]&&p[D].m(s,null);l(t,i),l(t,o),Re(r,o,null),l(o,v),l(o,k),c[d].m(k,null),f=!0},p(b,[q]){if(q&55){m=pe(b[1]);let y;for(y=0;y<m.length;y+=1){const H=tt(b,m,y);p[y]?p[y].p(H,q):(p[y]=it(H),p[y].c(),p[y].m(s,null))}for(;y<p.length;y+=1)p[y].d(1);p.length=m.length}const D={};!a&&q&8&&(a=!0,D.userSelectedDecks=b[3],ve(()=>a=!1)),r.$set(D);let L=d;d=S(b),d===L?c[d].p(b,q):(dt(),De(c[L],1,1,()=>{c[L]=null}),ut(),_=c[d],_?_.p(b,q):(_=c[d]=M[d](b),_.c()),Se(_,1),_.m(k,null))},i(b){f||(Se(r.$$.fragment,b),Se(_),f=!0)},o(b){De(r.$$.fragment,b),De(_),f=!1},d(b){b&&G(t),Ve(p,b),Pe(r),c[d].d()}}}function jt(e){var t={deck_id:e};axios.post("/api/sessions",t).then(function(n){window.location.href="/sessions/"+n.data.id}).catch(function(n){alert(n)})}function Ut(e,t,n){let s;ct(e,Me,u=>n(0,s=u));let i=[],o=[],r=[],a=new Set;at(()=>{axios.get("/api/modules").then(function(u){var I=u.data;n(7,i=I.filter((c,S,b)=>S===b.findIndex(q=>q.id===c.id)).sort(function(c,S){return c.name>S.name}));var M=i.map(c=>c.subject).filter(c=>!!c);n(1,o=M.filter((c,S,b)=>S===b.findIndex(q=>q.id===c.id)).sort(function(c,S){return c.name>S.name}))}).catch(function(u){alert(u)})});function v(u){var I={last_subject_id:u,last_module_id:0};axios.put("/api/users/me/settings",I).then(function(M){Ge(Me,s.last_subject_id=u,s),Ge(Me,s.last_module_id=0,s)}).catch(function(M){alert(M)})}function k(u){var I={last_module_id:u};axios.put("/api/users/me/settings",I).then(function(M){Ge(Me,s.last_module_id=u,s)}).catch(function(M){alert(M)})}function d(u){a.has(u)?a.delete(u):a.add(u),n(3,a=new Set([...a]))}const _=u=>v(u.id),f=u=>k(u.id);function m(u){a=u,n(3,a)}function p(u){a=u,n(3,a)}return e.$$.update=()=>{e.$$.dirty&129&&(s.last_subject_id,n(2,r=i.filter(u=>s.last_subject_id?u.subject?u.subject.id===s.last_subject_id:!1:!0)))},[s,o,r,a,v,k,d,i,_,f,m,p]}class At extends ye{constructor(t){super(),je(this,t,Ut,yt,Ue,{})}}const Lt=document.getElementById("NewSessionView");new At({target:Lt});
