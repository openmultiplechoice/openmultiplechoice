import{S as z,i as F,s as Z,g as h,b as _,q as G,c as u,a as g,h as f,n as A,d as k,A as J,k as K,f as E,t as C,l as P,p as R,j as S}from"./index-CovtvcR3.js";import{e as L}from"./each-CtuGQY9F.js";import{C as Q}from"./auto-DTdYmgno.js";import{f as W}from"./format-BpMs57Gc.js";function H(s,e,o){const a=s.slice();return a[9]=e[o],a}function M(s,e,o){const a=s.slice();return a[9]=e[o],a}function X(s){let e;return{c(){e=_("p"),e.textContent="No stats available yet"},m(o,a){g(o,e,a)},p:A,d(o){o&&k(e)}}}function Y(s){let e,o,a=s[1].length>0&&T(s),i=s[2].length>0&&B(s);return{c(){e=_("div"),a&&a.c(),o=h(),i&&i.c(),u(e,"class","row mt-3")},m(l,t){g(l,e,t),a&&a.m(e,null),f(e,o),i&&i.m(e,null)},p(l,t){l[1].length>0?a?a.p(l,t):(a=T(l),a.c(),a.m(e,o)):a&&(a.d(1),a=null),l[2].length>0?i?i.p(l,t):(i=B(l),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(l){l&&k(e),a&&a.d(),i&&i.d()}}}function T(s){let e,o,a,i=L(s[1]),l=[];for(let t=0;t<i.length;t+=1)l[t]=V(M(s,i,t));return{c(){e=_("div"),o=_("h6"),o.textContent="New decks",a=h();for(let t=0;t<l.length;t+=1)l[t].c();u(e,"class","col-md-6")},m(t,r){g(t,e,r),f(e,o),f(e,a);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(t,r){if(r&2){i=L(t[1]);let n;for(n=0;n<i.length;n+=1){const b=M(t,i,n);l[n]?l[n].p(b,r):(l[n]=V(b),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=i.length}},d(t){t&&k(e),E(l,t)}}}function j(s){let e,o,a,i=s[9].questions.length+"",l;return{c(){e=_("span"),o=_("i"),a=h(),l=C(i),u(o,"class","bi bi-collection"),u(e,"class","badge text-bg-light"),u(e,"title","Number of questions")},m(t,r){g(t,e,r),f(e,o),f(e,a),f(e,l)},p(t,r){r&2&&i!==(i=t[9].questions.length+"")&&S(l,i)},d(t){t&&k(e)}}}function V(s){let e,o,a,i,l,t=s[9].name+"",r,n,b,y,w,c=s[9].questions.length>0&&j(s);function d(){return s[6](s[9])}return{c(){e=_("div"),c&&c.c(),o=h(),a=_("button"),a.innerHTML='<i class="bi bi-rocket-takeoff"></i>',i=h(),l=_("a"),r=C(t),b=h(),u(a,"type","button"),u(a,"class","btn btn-sm btn-primary"),u(l,"href",n="/decks/"+s[9].id),u(l,"class","alert-link text-overflow svelte-1gfmo48"),u(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),u(e,"role","alert")},m(p,v){g(p,e,v),c&&c.m(e,null),f(e,o),f(e,a),f(e,i),f(e,l),f(l,r),f(e,b),y||(w=P(a,"click",R(d)),y=!0)},p(p,v){s=p,s[9].questions.length>0?c?c.p(s,v):(c=j(s),c.c(),c.m(e,o)):c&&(c.d(1),c=null),v&2&&t!==(t=s[9].name+"")&&S(r,t),v&2&&n!==(n="/decks/"+s[9].id)&&u(l,"href",n)},d(p){p&&k(e),c&&c.d(),y=!1,w()}}}function B(s){let e,o,a,i=L(s[2]),l=[];for(let t=0;t<i.length;t+=1)l[t]=O(H(s,i,t));return{c(){e=_("div"),o=_("h6"),o.textContent="Popular decks",a=h();for(let t=0;t<l.length;t+=1)l[t].c();u(e,"class","col-md-6")},m(t,r){g(t,e,r),f(e,o),f(e,a);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(t,r){if(r&4){i=L(t[2]);let n;for(n=0;n<i.length;n+=1){const b=H(t,i,n);l[n]?l[n].p(b,r):(l[n]=O(b),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=i.length}},d(t){t&&k(e),E(l,t)}}}function D(s){let e,o,a,i=s[9].questions.length+"",l;return{c(){e=_("span"),o=_("i"),a=h(),l=C(i),u(o,"class","bi bi-collection"),u(e,"class","badge text-bg-light"),u(e,"title","Number of questions")},m(t,r){g(t,e,r),f(e,o),f(e,a),f(e,l)},p(t,r){r&4&&i!==(i=t[9].questions.length+"")&&S(l,i)},d(t){t&&k(e)}}}function I(s){let e,o,a,i=s[9].sessions.length+"",l;return{c(){e=_("span"),o=_("i"),a=h(),l=C(i),u(o,"class","bi bi-rocket"),u(e,"class","badge text-bg-light"),u(e,"title","Number of sessions")},m(t,r){g(t,e,r),f(e,o),f(e,a),f(e,l)},p(t,r){r&4&&i!==(i=t[9].sessions.length+"")&&S(l,i)},d(t){t&&k(e)}}}function O(s){let e,o,a,i,l,t,r=s[9].name+"",n,b,y,w,c,d=s[9].questions.length>0&&D(s),p=s[9].sessions.length>0&&I(s);function v(){return s[7](s[9])}return{c(){e=_("div"),d&&d.c(),o=h(),p&&p.c(),a=h(),i=_("button"),i.innerHTML='<i class="bi bi-rocket-takeoff"></i>',l=h(),t=_("a"),n=C(r),y=h(),u(i,"type","button"),u(i,"class","btn btn-sm btn-primary"),u(t,"href",b="/decks/"+s[9].id),u(t,"class","alert-link"),u(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),u(e,"role","alert")},m(q,m){g(q,e,m),d&&d.m(e,null),f(e,o),p&&p.m(e,null),f(e,a),f(e,i),f(e,l),f(e,t),f(t,n),f(e,y),w||(c=P(i,"click",R(v)),w=!0)},p(q,m){s=q,s[9].questions.length>0?d?d.p(s,m):(d=D(s),d.c(),d.m(e,o)):d&&(d.d(1),d=null),s[9].sessions.length>0?p?p.p(s,m):(p=I(s),p.c(),p.m(e,a)):p&&(p.d(1),p=null),m&4&&r!==(r=s[9].name+"")&&S(n,r),m&4&&b!==(b="/decks/"+s[9].id)&&u(t,"href",b)},d(q){q&&k(e),d&&d.d(),p&&p.d(),w=!1,c()}}}function $(s){let e,o,a,i;function l(n,b){return n[1]&&n[2]?Y:X}let t=l(s),r=t(s);return{c(){r.c(),e=h(),o=_("div"),a=_("div"),i=_("canvas"),G(i,"max-height","300px"),u(a,"class","col-md"),u(o,"class","row mt-3 p-3")},m(n,b){r.m(n,b),g(n,e,b),g(n,o,b),f(o,a),f(a,i),s[8](i)},p(n,[b]){t===(t=l(n))&&r?r.p(n,b):(r.d(1),r=t(n),r&&(r.c(),r.m(e.parentNode,e)))},i:A,o:A,d(n){n&&(k(e),k(o)),r.d(n),s[8](null)}}}function U(s){var e={deck_id:s};axios.post("/api/sessions",e).then(function(o){window.location.href="/sessions/"+o.data.id}).catch(function(o){alert(o)})}function x(s,e,o){let a,i,l={},t={},r=[],n=[];J(()=>{axios.get("/api/stats/activity").then(function(c){const d=c.data;o(4,l=d.answers_byhour),o(5,t=d.users_byhour),o(1,r=d.decks_new),o(2,n=d.decks_popular)}).catch(function(c){console.log(c)})});const b=c=>U(c.id),y=c=>U(c.id);function w(c){K[c?"unshift":"push"](()=>{a=c,o(0,a)})}return s.$$.update=()=>{s.$$.dirty&57&&a&&l&&t&&(()=>{const c=Object.keys(l),d=Object.values(l);if(d.reduce((m,N)=>m+N,0)===0)return;const v={type:"line",data:{labels:c,datasets:[{label:"Answers",data:d,backgroundColor:"rgba(255, 205, 86, 0.4)",borderColor:"rgba(255, 205, 86, 0.4)",fill:!0,showLine:!1,pointRadius:0,tension:.2},{label:"Users",data:Object.values(t),backgroundColor:"rgba(54, 162, 235, 0.7)",borderColor:"rgba(54, 162, 235, 0.7)",fill:!0,showLine:!1,pointRadius:0,tension:.2}]},options:{plugins:{legend:{display:!1},tooltip:{callbacks:{title(m){return new Date(m[0].label.concat(" UTC")).toLocaleString()}}}},responsive:!0,interaction:{intersect:!1},scales:{x:{display:!0,title:{display:!1,text:"Hour of the day"},ticks:{autoSkip:!0,maxTicksLimit:3,callback(m){const N=this.getLabelForValue(m);return W(N,"dd.MM.yyyy")}},grid:{display:!1},border:{display:!1}},y:{display:!0,title:{display:!1,text:"Number of answers"},ticks:{beginAtZero:!0,stepSize:1,maxTicksLimit:5,autoSkip:!0},border:{display:!1}}}}};i&&i.destroy();var q=a.getContext("2d");o(3,i=new Q(q,v))})()},[a,r,n,i,l,t,b,y,w]}class ee extends z{constructor(e){super(),F(this,e,x,$,Z,{})}}const te=document.getElementById("IndexStatsView");new ee({target:te});
