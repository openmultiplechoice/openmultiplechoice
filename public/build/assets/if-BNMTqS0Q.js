import{z as d,a9 as p,ai as n,aa as _,$ as l,a1 as u,ay as m,a2 as v,x as b,az as k}from"./render-CKlhfUir.js";class g{anchor;#t=new Map;#s=new Map;#e=new Map;#a=new Set;#i=!0;constructor(e,s=!0){this.anchor=e,this.#i=s}#f=()=>{var e=d;if(this.#t.has(e)){var s=this.#t.get(e),t=this.#s.get(s);if(t)p(t),this.#a.delete(s);else{var r=this.#e.get(s);r&&(this.#s.set(s,r.effect),this.#e.delete(s),r.fragment.lastChild.remove(),this.anchor.before(r.fragment),t=r.effect)}for(const[a,i]of this.#t){if(this.#t.delete(a),a===e)break;const f=this.#e.get(i);f&&(n(f.effect),this.#e.delete(i))}for(const[a,i]of this.#s){if(a===s||this.#a.has(a))continue;const f=()=>{if(Array.from(this.#t.values()).includes(a)){var h=document.createDocumentFragment();m(i,h),h.append(l()),this.#e.set(a,{effect:i,fragment:h})}else n(i);this.#a.delete(a),this.#s.delete(a)};this.#i||!t?(this.#a.add(a),_(i,f,!1)):f()}}};#r=e=>{this.#t.delete(e);const s=Array.from(this.#t.values());for(const[t,r]of this.#e)s.includes(t)||(n(r.effect),this.#e.delete(t))};ensure(e,s){var t=d,r=v();if(s&&!this.#s.has(e)&&!this.#e.has(e))if(r){var a=document.createDocumentFragment(),i=l();a.append(i),this.#e.set(e,{effect:u(()=>s(i)),fragment:a})}else this.#s.set(e,u(()=>s(this.anchor)));if(this.#t.set(t,e),r){for(const[f,c]of this.#s)f===e?t.skipped_effects.delete(c):t.skipped_effects.add(c);for(const[f,c]of this.#e)f===e?t.skipped_effects.delete(c.effect):t.skipped_effects.add(c.effect);t.oncommit(this.#f),t.ondiscard(this.#r)}else this.#f()}}function A(o,e,s=!1){var t=new g(o),r=s?k:0;function a(i,f){t.ensure(i,f)}b(()=>{var i=!1;e((f,c=!0)=>{i=!0,a(c,f)}),i||a(!1,null)},r)}export{g as B,A as i};
