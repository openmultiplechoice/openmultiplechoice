import{x as Ut,p as pt,g as o,s as M,a as w,f as L,c as u,i as d,t as C,e as E,h as mt,d as zt,n as Gt,b as me,u as F,l as ct,r as Wt,j as Vt}from"./render-DmmYWkZq.js";import{o as ht}from"./index-client-CSM4NHHy.js";import{B as Yt,i as N}from"./if-qgMZekRM.js";import{e as Re,p as Y,i as Jt}from"./event-modifiers-B-z6qf1-.js";import{h as oe}from"./html-ChNwDKpL.js";import{s as U,a as D,d as Xt,c as Fe}from"./attributes-Cp2PrCir.js";import{s as j}from"./class-BfJg_ovI.js";import{s as Zt}from"./style-BtOSwUPa.js";import{b as be,a as dt}from"./input-DNeqJamd.js";import{b as lt}from"./select-C4dWo_UH.js";import{b as ge}from"./this-BZVWBAzr.js";import{p as Oe}from"./props-Bo30g3de.js";import{r as ne}from"./legacy-client-oIJ-7bi0.js";import{_ as $t}from"./lodash-d8dSvcKh.js";import{d as _t,p as ut}from"./purify.es-CmVf96vk.js";function ei(t,i,e){var s=new Yt(t);Ut(()=>{var a=i();s.ensure(a,e)})}const Ne=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Ue(t,i,e,s){t.addEventListener?t.addEventListener(i,e,s):t.attachEvent&&t.attachEvent("on".concat(i),e)}function he(t,i,e,s){t.removeEventListener?t.removeEventListener(i,e,s):t.detachEvent&&t.detachEvent("on".concat(i),e)}function bt(t,i){const e=i.slice(0,i.length-1);for(let s=0;s<e.length;s++)e[s]=t[e[s].toLowerCase()];return e}function gt(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");const i=t.split(",");let e=i.lastIndexOf("");for(;e>=0;)i[e-1]+=",",i.splice(e,1),e=i.lastIndexOf("");return i}function ti(t,i){const e=t.length>=i.length?t:i,s=t.length>=i.length?i:t;let a=!0;for(let l=0;l<e.length;l++)s.indexOf(e[l])===-1&&(a=!1);return a}const we={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,arrowup:38,arrowdown:40,arrowleft:37,arrowright:39,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":Ne?173:189,"=":Ne?61:187,";":Ne?59:186,"'":222,"{":219,"}":221,"[":219,"]":221,"\\":220},R={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,meta:91,command:91},_e={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},A={16:!1,18:!1,17:!1,91:!1},_={};for(let t=1;t<20;t++)we["f".concat(t)]=111+t;let h=[],ye=null,yt="all";const J=new Map,re=t=>we[t.toLowerCase()]||R[t.toLowerCase()]||t.toUpperCase().charCodeAt(0),ii=t=>Object.keys(we).find(i=>we[i]===t),ni=t=>Object.keys(R).find(i=>R[i]===t);function wt(t){yt=t||"all"}function xe(){return yt||"all"}function ai(){return h.slice(0)}function si(){return h.map(t=>ii(t)||ni(t)||String.fromCharCode(t))}function oi(){const t=[];return Object.keys(_).forEach(i=>{_[i].forEach(e=>{let{key:s,scope:a,mods:l,shortcut:f}=e;t.push({scope:a,shortcut:f,mods:l,keys:s.split("+").map(r=>re(r))})})}),t}function ri(t){const i=t.target||t.srcElement,{tagName:e}=i;let s=!0;const a=e==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(i.type);return(i.isContentEditable||(a||e==="TEXTAREA"||e==="SELECT")&&!i.readOnly)&&(s=!1),s}function ci(t){return typeof t=="string"&&(t=re(t)),h.indexOf(t)!==-1}function di(t,i){let e,s;t||(t=xe());for(const a in _)if(Object.prototype.hasOwnProperty.call(_,a))for(e=_[a],s=0;s<e.length;)e[s].scope===t?e.splice(s,1).forEach(f=>{let{element:r}=f;return Ge(r)}):s++;xe()===t&&wt(i||"all")}function li(t){let i=t.keyCode||t.which||t.charCode;t.key&&t.key.toLowerCase()==="capslock"&&(i=re(t.key));const e=h.indexOf(i);if(e>=0&&h.splice(e,1),t.key&&t.key.toLowerCase()==="meta"&&h.splice(0,h.length),(i===93||i===224)&&(i=91),i in A){A[i]=!1;for(const s in R)R[s]===i&&(z[s]=!1)}}function xt(t){if(typeof t>"u")Object.keys(_).forEach(a=>{Array.isArray(_[a])&&_[a].forEach(l=>Ke(l)),delete _[a]}),Ge(null);else if(Array.isArray(t))t.forEach(a=>{a.key&&Ke(a)});else if(typeof t=="object")t.key&&Ke(t);else if(typeof t=="string"){for(var i=arguments.length,e=new Array(i>1?i-1:0),s=1;s<i;s++)e[s-1]=arguments[s];let[a,l]=e;typeof a=="function"&&(l=a,a=""),Ke({key:t,scope:a,method:l,splitKey:"+"})}}const Ke=t=>{let{key:i,scope:e,method:s,splitKey:a="+"}=t;gt(i).forEach(f=>{const r=f.split(a),p=r.length,H=r[p-1],x=H==="*"?"*":re(H);if(!_[x])return;e||(e=xe());const g=p>1?bt(R,r):[],Q=[];_[x]=_[x].filter(y=>{const I=(s?y.method===s:!0)&&y.scope===e&&ti(y.mods,g);return I&&Q.push(y.element),!I}),Q.forEach(y=>Ge(y))})};function ft(t,i,e,s){if(i.element!==s)return;let a;if(i.scope===e||i.scope==="all"){a=i.mods.length>0;for(const l in A)Object.prototype.hasOwnProperty.call(A,l)&&(!A[l]&&i.mods.indexOf(+l)>-1||A[l]&&i.mods.indexOf(+l)===-1)&&(a=!1);(i.mods.length===0&&!A[16]&&!A[18]&&!A[17]&&!A[91]||a||i.shortcut==="*")&&(i.keys=[],i.keys=i.keys.concat(h),i.method(t,i)===!1&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)))}}function vt(t,i){const e=_["*"];let s=t.keyCode||t.which||t.charCode;if(t.key&&t.key.toLowerCase()==="capslock"||!z.filter.call(this,t))return;if((s===93||s===224)&&(s=91),h.indexOf(s)===-1&&s!==229&&h.push(s),["metaKey","ctrlKey","altKey","shiftKey"].forEach(r=>{const p=_e[r];t[r]&&h.indexOf(p)===-1?h.push(p):!t[r]&&h.indexOf(p)>-1?h.splice(h.indexOf(p),1):r==="metaKey"&&t[r]&&(h=h.filter(H=>H in _e||H===s))}),s in A){A[s]=!0;for(const r in R)if(Object.prototype.hasOwnProperty.call(R,r)){const p=_e[R[r]];z[r]=t[p]}if(!e)return}for(const r in A)Object.prototype.hasOwnProperty.call(A,r)&&(A[r]=t[_e[r]]);t.getModifierState&&!(t.altKey&&!t.ctrlKey)&&t.getModifierState("AltGraph")&&(h.indexOf(17)===-1&&h.push(17),h.indexOf(18)===-1&&h.push(18),A[17]=!0,A[18]=!0);const a=xe();if(e)for(let r=0;r<e.length;r++)e[r].scope===a&&(t.type==="keydown"&&e[r].keydown||t.type==="keyup"&&e[r].keyup)&&ft(t,e[r],a,i);if(!(s in _))return;const l=_[s],f=l.length;for(let r=0;r<f;r++)if((t.type==="keydown"&&l[r].keydown||t.type==="keyup"&&l[r].keyup)&&l[r].key){const p=l[r],{splitKey:H}=p,x=p.key.split(H),g=[];for(let Q=0;Q<x.length;Q++)g.push(re(x[Q]));g.sort().join("")===h.sort().join("")&&ft(t,p,a,i)}}function z(t,i,e){h=[];const s=gt(t);let a=[],l="all",f=document,r=0,p=!1,H=!0,x="+",g=!1,Q=!1;for(e===void 0&&typeof i=="function"&&(e=i),Object.prototype.toString.call(i)==="[object Object]"&&(i.scope&&(l=i.scope),i.element&&(f=i.element),i.keyup&&(p=i.keyup),i.keydown!==void 0&&(H=i.keydown),i.capture!==void 0&&(g=i.capture),typeof i.splitKey=="string"&&(x=i.splitKey),i.single===!0&&(Q=!0)),typeof i=="string"&&(l=i),Q&&xt(t,l);r<s.length;r++)t=s[r].split(x),a=[],t.length>1&&(a=bt(R,t)),t=t[t.length-1],t=t==="*"?"*":re(t),t in _||(_[t]=[]),_[t].push({keyup:p,keydown:H,scope:l,mods:a,shortcut:s[r],method:e,key:s[r],splitKey:x,element:f});if(typeof f<"u"&&window){if(!J.has(f)){const y=function(){let I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return vt(I,f)},q=function(){let I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;vt(I,f),li(I)};J.set(f,{keydownListener:y,keyupListenr:q,capture:g}),Ue(f,"keydown",y,g),Ue(f,"keyup",q,g)}if(!ye){const y=()=>{h=[]};ye={listener:y,capture:g},Ue(window,"focus",y,g)}}}function ui(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(_).forEach(e=>{_[e].filter(a=>a.scope===i&&a.shortcut===t).forEach(a=>{a&&a.method&&a.method()})})}function Ge(t){const i=Object.values(_).flat();if(i.findIndex(s=>{let{element:a}=s;return a===t})<0){const{keydownListener:s,keyupListenr:a,capture:l}=J.get(t)||{};s&&a&&(he(t,"keyup",a,l),he(t,"keydown",s,l),J.delete(t))}if((i.length<=0||J.size<=0)&&(Object.keys(J).forEach(a=>{const{keydownListener:l,keyupListenr:f,capture:r}=J.get(a)||{};l&&f&&(he(a,"keyup",f,r),he(a,"keydown",l,r),J.delete(a))}),J.clear(),Object.keys(_).forEach(a=>delete _[a]),ye)){const{listener:a,capture:l}=ye;he(window,"focus",a,l),ye=null}}const ze={getPressedKeyString:si,setScope:wt,getScope:xe,deleteScope:di,getPressedKeyCodes:ai,getAllKeyCodes:oi,isPressed:ci,filter:ri,trigger:ui,unbind:xt,keyMap:we,modifier:R,modifierMap:_e};for(const t in ze)Object.prototype.hasOwnProperty.call(ze,t)&&(z[t]=ze[t]);if(typeof window<"u"){const t=window.hotkeys;z.noConflict=i=>(i&&window.hotkeys===z&&(window.hotkeys=t),z),window.hotkeys=z}var fi=L('<form action="#"><div class="mb-3"><label class="form-label">Answer text</label> <input type="hidden"/> <trix-editor></trix-editor> <!></div> <div class="accordion my-2 "><div class="accordion-item"><h2 class="accordion-header"><button type="button" data-bs-toggle="collapse" aria-expanded="false">Answer hint (optional)</button></h2> <div><div class="accordion-body"><div class="mb-3"><input type="hidden"/> <trix-editor></trix-editor> <!> <div class="form-text">A hint that will be shown once the user has answered the question.</div></div></div></div></div></div></form>',2);function vi(t,i){pt(i,!0);let e=Oe(i,"answer",15),s=M(void 0),a=M(void 0),l=M(void 0),f=M("");ne(()=>{o(s)&&r(o(s))}),ne(()=>{o(a)&&r(o(a))}),ht(()=>{const k=document.getElementById("collapseAnswerHint"+e().id);k&&k.addEventListener("shown.bs.collapse",()=>{o(a)&&o(a).focus()}),w(l,!!e().hint)});function r(k){k.addEventListener("trix-change",function(){e(e().text=document.getElementById("answerText"+e().id).value,!0),e(e().hint=document.getElementById("answerHint"+e().id).value,!0),w(f,'<p class="text-end">Saving ...</p>'),H()})}var p;function H(){p&&p.cancel(),p=_t(()=>{axios.put("/api/answers/"+e().id,e()).then(function(k){w(f,'<p class="text-end">Saved <span class="text-success-dark">&check;</span></p>')}).catch(function(k){w(f,'<p class="text-end">Saving ... <span class="text-danger-dark">failed!</span></p>'),alert(k)})},500,{maxWait:2e3}),p()}var x=fi(),g=d(x),Q=d(g),y=u(Q,2),q=u(y,2);C(()=>U(q,"id",`editor-answer${e().id??""}`)),j(q,1,"bg-light trix-content"),C(()=>U(q,"input",`answerText${e().id??""}`)),ge(q,k=>w(s,k),()=>o(s));var I=u(q,2);oe(I,()=>o(f));var ae=u(g,2),Le=d(ae),$=d(Le),se=d($),ce=u($,2),He=d(ce),ke=d(He),de=d(ke),ee=u(de,2);C(()=>U(ee,"id",`editor-answerHint${e().id??""}`)),j(ee,1,"bg-light trix-content"),C(()=>U(ee,"input",`answerHint${e().id??""}`)),ge(ee,k=>w(a,k),()=>o(a));var Ee=u(ee,2);oe(Ee,()=>o(f));var Qe=u(Ee,2);C(()=>{D(Q,"for",`answerText${e().id??""}`),D(y,"id",`answerText${e().id??""}`),D(ae,"id",`accordionAnswerHint${e().id??""}`),j(se,1,`accordion-button text-black bg-white py-2 px-3 ${o(l)?"":"collapsed"}`),D(se,"data-bs-target",`#collapseAnswerHint${e().id??""}`),D(se,"aria-controls",`#collapseAnswerHint${e().id??""}`),D(ce,"id",`collapseAnswerHint${e().id??""}`),j(ce,1,`accordion-collapse collapse ${o(l)?"show":""}`),D(de,"id",`answerHint${e().id??""}`),D(Qe,"id",`answerHint${e().id??""}`)}),be(y,()=>e().text,k=>e(e().text=k,!0)),be(de,()=>e().hint,k=>e(e().hint=k,!0)),E(t,x),mt()}var pi=L('<button type="button" class="btn btn-outline-secondary btn-sm">Close editor</button>'),mi=L('<div class="alert alert-secondary m-1" role="alert"><p class="small fw-bold"><i class="bi bi-clipboard2-pulse"></i> CASE</p> <p class="trix-content"><!></p></div> <div class="text-end m-1"><button type="button" class="btn btn-sm btn-light" title="Remove case"><i class="bi bi-trash"></i> Remove case</button></div>',1),hi=L("<option> </option>"),_i=L('<div class="alert alert-light" role="alert"><div class="row g-3 align-items-center"><div class="col-auto"><label for="case" class="col-form-label small fw-bold"><i class="bi bi-clipboard2-pulse"></i> CASE</label></div> <div class="col-auto"><select id="case" class="form-select"><option>Select case</option><!></select></div></div></div>'),bi=L(`<!> <div class="mt-3 mb-2"><label for="questionText" class="form-label">Question text</label> <input type="hidden"/> <trix-editor></trix-editor> <!></div> <div class="accordion my-2 " id="accordionQuestionHint"><div class="accordion-item"><h2 class="accordion-header"><button type="button" data-bs-toggle="collapse" data-bs-target="#collapseQuestionHint" aria-expanded="false" aria-controls="collapseQuestionHint">Question hint (optional)</button></h2> <div id="collapseQuestionHint"><div class="accordion-body"><div class="mt-3 mb-3"><input type="hidden"/> <trix-editor></trix-editor> <!> <div id="questionHint" class="form-text">A hint that can be shown to the user if they are stuck.</div></div></div></div></div></div> <div class="accordion my-2" id="accordionQuestionComment"><div class="accordion-item"><h2 class="accordion-header"><button type="button" data-bs-toggle="collapse" data-bs-target="#collapseQuestionComment" aria-expanded="false" aria-controls="collapseQuestionComment">Question comment (optional)</button></h2> <div id="collapseQuestionComment"><div class="accordion-body"><div class="mt-3 mb-3"><input type="hidden"/> <trix-editor></trix-editor> <!> <div id="questionHint" class="form-text">A comment that will be shown once the user has answered the question.
                                It can be used to explain the correct answer or provide additional
                                information, for example sources.</div></div></div></div></div></div> <div class="mb-3 p-3 bg-light rounded"><div class="form-check mb-3"><input type="checkbox" class="form-check-input" id="checkInvalidQuestion"/> <label class="form-check-label" for="checkInvalidQuestion"><i class="bi bi-cone-striped"></i> <strong>Invalid question</strong> - Is the answer unknown or disputed? Invalid questions remain in deck but are not counted into results.</label></div> <div class="form-check"><input type="checkbox" class="form-check-input" id="checkNeedsReview"/> <label class="form-check-label" for="checkNeedsReview"><i class="bi bi-eraser-fill"></i> <strong>Needs review</strong> - Does this question need to be reviewed and improved? Questions marked for review remain in deck and are counted into results.</label></div></div>`,3),gi=L(`<div class="col"><div class="alert alert-warning" role="alert">Don't forget to set the correct answer!</div></div>`),yi=L('<div class="card-body"><p class="card-text"> </p></div>'),wi=L('<div class="col"><div class="card" style="width: 18rem"><div class="card-header bg-transparent"><button type="button" class="btn btn-sm btn-light"><i class="bi bi-trash"></i></button></div> <img class="card-img-top" alt=""/> <!></div></div>'),xi=L('<button type="button" title="Set as correct answer"><i class="bi bi-check-lg"></i></button>'),ki=L('<div class="mt-3 mb-1 px-3 pt-2 pb-1 bg-light-subtle rounded"><!> <div class="text-end mb-2"><!> <button type="button" class="btn btn-sm btn-light" title="Delete answer"><i class="bi bi-trash"></i></button></div></div>'),Ei=L('<div class="sticky-bottom bg-white mt-3" style="z-index: 10;"><div class="row py-3"><div class="col"><button class="btn btn-sm btn-primary" title="Add a new answer (Shortcut: Alt+A)">Add answer</button></div></div></div>'),Ci=L("<option>card</option>"),Ai=L('<div class="alert alert-light" role="alert"><p><strong>Delete question?</strong> Deleting a question will also delete all associated answers and images.</p> <button type="button" class="btn btn-sm btn-danger"><i class="bi bi-trash"></i> Delete question</button></div>'),qi=L(`<div class="row"><div class="col"><div class="mb-3 border-dark" style="border-bottom: dotted; border-width: 1px;"></div></div></div> <div class="alert alert-light" role="alert"><div class="input-group mb-3"><span class="input-group-text">ID</span> <input type="text" class="form-control" disabled readonly=""/></div> <div class="row g-3 align-items-center"><div class="col-auto"><label for="questionType" class="col-form-label fw-bold">Question type:</label></div> <div class="col-auto"><select id="questionType" class="form-select font-monospace text-uppercase"><!><option>mc</option></select></div> <div class="col-auto"><span id="questionTypeHelp" class="form-text">Can be either multiple choice (MC) or card (CARD). <strong>Card Questions
                    can have only one or no answer.</strong></span></div></div></div> <!>`,1),Ki=L('<form action="#" class="mt-3"><!> <!> <div class="mb-3"><label for="image" class="form-label">Add image</label> <input class="form-control" type="file" accept="image/jpeg, image/png, image/webp" name="image"/> <div id="imageHelp" class="form-text">Supported formats are JPEG, PNG, and WebP.</div></div></form> <!> <div class="row row-cols-1 row-cols-lg-3 g4"></div> <!> <!> <!>',1);function Ui(t,i){pt(i,!0);let e=Oe(i,"question",15),s=Oe(i,"showConfigEditor",3,!1),a=Oe(i,"showCaseSelector",3,!1),l=M(void 0),f=M(void 0),r=M(void 0),p=M(void 0),H=0,x=M(void 0),g=M(void 0),Q=M(void 0);const y=1e3;let q=M(""),I=F(()=>e().correct_answer_id);ne(()=>{o(l)&&ae(o(l))}),ne(()=>{o(f)&&ae(o(f))}),ne(()=>{o(r)&&ae(o(r))}),ne(()=>{e().case?w(p,e().case.id,!0):w(p,"")}),ne(()=>{e().id!==o(Q)&&(w(Q,e().id,!0),w(x,!!e().hint),w(g,!!e().comment))}),ht(()=>{z.filter=function(){return!0},z("alt+A",function(v){v.preventDefault();const b=Date.now();b-H>y&&(ke(),H=b)});const n=document.getElementById("collapseQuestionHint");n&&n.addEventListener("shown.bs.collapse",()=>{o(r)&&o(r).focus()});const c=document.getElementById("collapseQuestionComment");c&&c.addEventListener("shown.bs.collapse",()=>{o(f)&&o(f).focus()})});function ae(n){n.addEventListener("trix-change",function(){e(e().text=document.getElementById("questionText"+e().id).value,!0),e(e().comment=document.getElementById("questionComment"+e().id).value,!0),e(e().hint=document.getElementById("questionHint"+e().id).value,!0),w(q,'<p class="text-end">Saving ...</p>'),se()})}function Le(n){n!==e().correct_answer_id&&(e(e().correct_answer_id=n,!0),axios.put("/api/questions/"+e().id,e()).then(function(c){}).catch(function(c){alert(c)}))}var $;function se(){$&&$.cancel(),$=_t(()=>{axios.put("/api/questions/"+e().id,e()).then(function(n){w(q,'<p class="text-end">Saved <span class="text-success-dark">&check;</span></p>')}).catch(function(n){w(q,'<p class="text-end">Saving ... <span class="text-danger-dark">failed!</span></p>'),alert(n)})},500,{maxWait:2e3}),$()}function ce(){var n=new FormData,c=document.getElementById("imageInput"+e().id);n.set("image",c.files[0]),axios.post("/api/questions/"+e().id+"/images",n,{headers:{"Content-Type":"multipart/form-data"}}).then(function(v){c.value="";var b=v.data;e(e().images=[...e().images,b],!0)}).catch(function(v){c.value="",alert(v)})}function He(n){axios.delete("/api/images/"+n).then(function(c){e(e().images=e().images.filter(v=>v.id!==n),!0)}).catch(function(c){alert(c)})}function ke(){axios.post("/api/questions/"+e().id+"/answers",{}).then(function(n){e(e().answers=[...e().answers,n.data],!0),Gt().then(()=>{const c=document.getElementById("editor-answer"+n.data.id);c&&c.focus()})}).catch(function(n){alert(n)})}function de(n){axios.delete("/api/answers/"+n).then(function(c){e(e().answers=e().answers.filter(v=>v.id!==n),!0)}).catch(function(c){alert(c)})}function ee(){axios.put("/api/questions/"+e().id,{type:e().type==="mc"?"mc":"card"}).then(function(n){e(e().type=n.data.type,!0)}).catch(function(n){alert(n)})}function Ee(){axios.put("/api/questions/"+e().id,{case_id:o(p)}).then(function(n){e(e().case_id=n.data.case_id,!0);const c=i.cases.find(v=>v.id===n.data.case_id);e(e().case=c,!0),c.questions||(c.questions=[]),c.questions.push({id:e().id,case_id:c.id})}).catch(function(n){alert(n)})}function Qe(){axios.put("/api/questions/"+e().id,{case_id:null}).then(function(n){e(e().case_id=null,!0),e(e().case=null,!0),i.cases.map(c=>{c.questions=c.questions.filter(v=>v.id!==e().id)})}).catch(function(n){alert(n)})}function k(){axios.put("/api/questions/"+e().id,{is_invalid:!e().is_invalid}).then(function(n){e(e().is_invalid=!e().is_invalid,!0)}).catch(function(n){alert(n)})}function kt(){axios.put("/api/questions/"+e().id,{needs_review:!e().needs_review}).then(function(n){e(e().needs_review=!e().needs_review,!0)}).catch(function(n){alert(n)})}var We=Ki(),Se=me(We),Et=F(()=>Y(se)),Ve=d(Se);{var Ct=n=>{var c=pi(),v=F(()=>Y(i.toggleEditor));c.__click=function(...b){o(v)?.apply(this,b)},E(n,c)};N(Ve,n=>{i.toggleEditor&&n(Ct)})}var Ye=u(Ve,2);ei(Ye,()=>e().id,n=>{var c=bi(),v=me(c);{var b=m=>{var fe=mi(),Ce=me(fe),De=u(d(Ce),2),ve=d(De);oe(ve,()=>ut.sanitize(i.cases.find(ie=>ie.id===e().case_id).text));var Ae=u(Ce,2),Me=d(Ae),je=F(()=>Y(Qe));Me.__click=function(...ie){o(je)?.apply(this,ie)},E(m,fe)},B=m=>{var fe=Vt(),Ce=me(fe);{var De=ve=>{var Ae=_i(),Me=d(Ae),je=u(d(Me),2),ie=d(je);ie.__change=Ee;var Be=d(ie);Be.value=Be.__value="";var Rt=u(Be);Re(Rt,17,()=>i.cases,Jt,(Pe,qe)=>{var pe=hi(),Ft=d(pe),rt={};C(Nt=>{Fe(pe,e().case_id==o(qe).id),ct(Ft,Nt),rt!==(rt=o(qe).id)&&(pe.value=(pe.__value=o(qe).id)??"")},[()=>$t.truncate(ut.sanitize(o(qe).text,{ALLOWED_TAGS:[]}),{length:30})]),E(Pe,pe)}),lt(ie,()=>o(p),Pe=>w(p,Pe)),E(ve,Ae)};N(Ce,ve=>{a()&&i.cases&&i.cases.length>0&&ve(De)},!0)}E(m,fe)};N(v,m=>{a()&&e().case_id?m(b):m(B,!1)})}var G=u(v,2),W=u(d(G),2),K=u(W,2);U(K,"id","editor-questionText"),j(K,1,"bg-light trix-content"),C(()=>U(K,"input",`questionText${e().id??""}`)),ge(K,m=>w(l,m),()=>o(l));var X=u(K,2);oe(X,()=>o(q));var Z=u(G,2),T=d(Z),S=d(T),V=d(S),O=u(S,2),P=d(O),Ie=d(P),le=d(Ie),te=u(le,2);U(te,"id","editor-questionHint"),j(te,1,"bg-light trix-content"),C(()=>U(te,"input",`questionHint${e().id??""}`)),ge(te,m=>w(r,m),()=>o(r));var Ht=u(te,2);oe(Ht,()=>o(q));var tt=u(Z,2),Qt=d(tt),it=d(Qt),St=d(it),nt=u(it,2),It=d(nt),Tt=d(It),Te=d(Tt),ue=u(Te,2);U(ue,"id","editor-questionComment"),j(ue,1,"bg-light trix-content"),C(()=>U(ue,"input",`questionComment${e().id??""}`)),ge(ue,m=>w(f,m),()=>o(f));var Dt=u(ue,2);oe(Dt,()=>o(q));var Mt=u(tt,2),at=d(Mt),st=d(at),jt=F(()=>Y(k));st.__click=function(...m){o(jt)?.apply(this,m)};var Bt=u(at,2),ot=d(Bt),Pt=F(()=>Y(kt));ot.__click=function(...m){o(Pt)?.apply(this,m)},C(()=>{D(W,"id",`questionText${e().id??""}`),j(V,1,`accordion-button text-black bg-white py-2 px-3 ${o(x)?"":"collapsed"}`),j(O,1,`accordion-collapse collapse ${o(x)?"show":""}`),D(le,"id",`questionHint${e().id??""}`),j(St,1,`accordion-button text-black bg-white py-2 px-3 ${o(g)?"":"collapsed"}`),j(nt,1,`accordion-collapse collapse ${o(g)?"show":""}`),D(Te,"id",`questionComment${e().id??""}`)}),be(W,()=>e().text,m=>e(e().text=m,!0)),be(le,()=>e().hint,m=>e(e().hint=m,!0)),be(Te,()=>e().comment,m=>e(e().comment=m,!0)),dt(st,()=>e().is_invalid,m=>e(e().is_invalid=m,!0)),dt(ot,()=>e().needs_review,m=>e(e().needs_review=m,!0)),E(n,c)});var At=u(Ye,2),Je=u(d(At),2);Je.__input=ce;var Xe=u(Se,2);{var qt=n=>{var c=gi();E(n,c)};N(Xe,n=>{!o(I)&&e().type==="mc"&&n(qt)})}var Ze=u(Xe,2);Re(Ze,21,()=>e().images,n=>n.id,(n,c)=>{var v=wi(),b=d(v),B=d(b),G=d(B),W=F(()=>Y(()=>{confirm("Are you sure you want to delete this image?")&&He(o(c).id)}));G.__click=function(...T){o(W)?.apply(this,T)};var K=u(B,2),X=u(K,2);{var Z=T=>{var S=yi(),V=d(S),O=d(V);C(()=>ct(O,o(c).comment)),E(T,S)};N(X,T=>{o(c).comment&&T(Z)})}C(()=>D(K,"src",`/${o(c).path??""}`)),E(n,v)});var $e=u(Ze,2);Re($e,19,()=>e().answers,n=>n.id,(n,c,v)=>{var b=ki();let B;var G=d(b);vi(G,{get answer(){return e().answers[o(v)]},set answer(S){e(e().answers[o(v)]=S,!0)}});var W=u(G,2),K=d(W);{var X=S=>{var V=xi(),O=F(()=>Y(()=>{Le(o(c).id)}));V.__click=function(...P){o(O)?.apply(this,P)},C(()=>j(V,1,`btn btn-sm ${o(I)===o(c).id?"btn-success":"btn-light"}`)),E(S,V)};N(K,S=>{e().type==="mc"&&S(X)})}var Z=u(K,2),T=F(()=>Y(()=>{confirm("Are you sure you want to delete this answer?")&&de(o(c).id)}));Z.__click=function(...S){o(T)?.apply(this,S)},C(()=>B=Zt(b,"",B,{border:"2px dotted "+(o(I)===o(c).id?"green":"lightgray")})),E(n,b)});var et=u($e,2);{var Kt=n=>{var c=Ei(),v=d(c),b=d(v),B=d(b);B.__click=ke,E(n,c)};N(et,n=>{(e().type==="mc"||e().answers.length===0)&&n(Kt)})}var Ot=u(et,2);{var Lt=n=>{var c=qi(),v=u(me(c),2),b=d(v),B=u(d(b),2),G=u(b,2),W=u(d(G),2),K=d(W);K.__change=ee;var X=d(K);{var Z=O=>{var P=Ci();P.value=P.__value="card",C(()=>Fe(P,e().type=="card")),E(O,P)};N(X,O=>{(e().answers.length<=1||e().type==="card")&&O(Z)})}var T=u(X);T.value=T.__value="mc";var S=u(v,2);{var V=O=>{var P=Ai(),Ie=u(d(P),2),le=F(()=>Y(()=>{confirm("Are you sure you want to delete this question?")&&i.handleQuestionRemove(e().id)}));Ie.__click=function(...te){o(le)?.apply(this,te)},E(O,P)};N(S,O=>{i.handleQuestionRemove&&O(V)})}C(()=>{Xt(B,e().id),K.disabled=e().answers.length>1,Fe(T,e().type=="mc")}),lt(K,()=>e().type,O=>e(e().type=O,!0)),E(n,c)};N(Ot,n=>{s()&&n(Lt)})}C(()=>D(Je,"id",`imageInput${e().id??""}`)),Wt("submit",Se,function(...n){o(Et)?.apply(this,n)}),E(t,We),mt()}zt(["click","change","input"]);export{Ui as Q,z as h,ei as k};
