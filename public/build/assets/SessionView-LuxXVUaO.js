import{S as ae,i as fe,s as de,e as ke,a as I,n as N,d as Q,b as h,c as p,G as qe,h as b,l as Z,g as L,t as R,j as le,p as ce,k as E,q as De,f as We,H as je,A as Ve,x as A,y as X,w as v,E as Oe,m as D,o as x,u as $,v as W,z as ee,B as Y,F as ve,C as z,r as Re}from"./index-lwMDWDKL.js";import{p as Ie,d as Qe}from"./purify.es-WTxncMLc.js";import{M as Je}from"./Messages--tlYZA9o.js";import{C as Ke}from"./auto-ovie_dKz.js";import{S as Xe}from"./SessionProgressBar-jxtNUSI8.js";import{e as Pe}from"./each-_vP4lz_n.js";import{h as he,S as Ye}from"./SessionQuestionView-_gdG1t9t.js";import{s as Ze}from"./StatsHelper-9ER37DPz.js";import{U as we}from"./UserSettingsStore-q9gu1FOY.js";import"./_commonjsHelpers-5-cIlDoe.js";import"./parseISO-rY9c-aYN.js";import"./QuestionForm-HINkbC4S.js";function Ce(n){let s,e,i,r,l;return{c(){s=h("div"),e=h("img"),p(e,"class","img-fluid"),qe(e.src,i="/"+n[0])||p(e,"src",i),p(e,"alt","Magic GIF"),p(s,"class","img-fullscreen d-flex justify-content-center align-items-center svelte-116gbkt")},m(t,a){I(t,s,a),b(s,e),r||(l=Z(s,"click",n[2]),r=!0)},p(t,a){a&1&&!qe(e.src,i="/"+t[0])&&p(e,"src",i)},d(t){t&&Q(s),r=!1,l()}}}function xe(n){let s,e=n[0]&&n[1]&&Ce(n);return{c(){e&&e.c(),s=ke()},m(i,r){e&&e.m(i,r),I(i,s,r)},p(i,[r]){i[0]&&i[1]?e?e.p(i,r):(e=Ce(i),e.c(),e.m(s.parentNode,s)):e&&(e.d(1),e=null)},i:N,o:N,d(i){i&&Q(s),e&&e.d(i)}}}function $e(n,s,e){let{magicGIFPath:i=""}=s;var r=!0;function l(){e(1,r=!r)}return n.$$set=t=>{"magicGIFPath"in t&&e(0,i=t.magicGIFPath)},[i,r,l]}class es extends ae{constructor(s){super(),fe(this,s,$e,xe,de,{magicGIFPath:0})}}function Me(n){let s,e,i;return{c(){s=h("button"),s.innerHTML='<i class="bi bi-repeat"></i> Repeat incorrect',p(s,"class","btn btn-sm btn-outline-secondary"),p(s,"type","button")},m(r,l){I(r,s,l),e||(i=Z(s,"click",ce(n[5])),e=!0)},p:N,d(r){r&&Q(s),e=!1,i()}}}function ss(n){let s,e,i,r,l,t,a,u=n[0].correct+"",o,d,w,P,k,T,C,m,g,c=n[0].incorrect>0&&Me(n);return{c(){s=h("div"),e=h("div"),i=h("canvas"),r=L(),l=h("div"),t=h("p"),a=h("span"),o=R(u),d=R("%"),w=R(" correct"),P=L(),k=h("div"),T=h("a"),T.innerHTML='<i class="bi bi-rocket-takeoff"></i> New session',C=L(),c&&c.c(),m=L(),g=h("a"),g.textContent="Home",p(e,"class","col-md"),p(a,"class","fs-4 font-monospace"),p(t,"class","mt-3 text-dark"),p(T,"href","/sessions/create"),p(T,"class","btn btn-sm btn-primary"),p(g,"href","/"),p(g,"class","btn btn-sm btn-outline-secondary"),p(k,"class","d-grid gap-2"),p(l,"class","col-md"),p(s,"class","row mb-5")},m(M,j){I(M,s,j),b(s,e),b(e,i),n[4](i),b(s,r),b(s,l),b(l,t),b(t,a),b(a,o),b(a,d),b(t,w),b(l,P),b(l,k),b(k,T),b(k,C),c&&c.m(k,null),b(k,m),b(k,g)},p(M,[j]){j&1&&u!==(u=M[0].correct+"")&&le(o,u),M[0].incorrect>0?c?c.p(M,j):(c=Me(M),c.c(),c.m(k,m)):c&&(c.d(1),c=null)},i:N,o:N,d(M){M&&Q(s),n[4](null),c&&c.d()}}}function ns(n){axios.post("/api/sessions/"+n+"/newfromincorrect").then(function(s){window.location.href="/sessions/"+s.data.id}).catch(function(s){alert(s)})}function is(n,s,e){let{progressPercentage:i}=s,{sessionId:r}=s,l,t;function a(o){E[o?"unshift":"push"](()=>{l=o,e(2,l)})}const u=()=>ns(r);return n.$$set=o=>{"progressPercentage"in o&&e(0,i=o.progressPercentage),"sessionId"in o&&e(1,r=o.sessionId)},n.$$.update=()=>{n.$$.dirty&13&&l&&(()=>{if(t)return;const o={type:"doughnut",data:{labels:["Correct","Correct with help","Incorrect"],datasets:[{label:"%",data:[i.correct,i.correctWithHelp,i.incorrect],backgroundColor:["#d4edda","#fff3cd","#f8d7da"],hoverOffet:4}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:null}}};t&&t.destroy();var d=l.getContext("2d");e(3,t=new Ke(d,o))})()},[i,r,l,t,a,u]}class ts extends ae{constructor(s){super(),fe(this,s,is,ss,de,{progressPercentage:0,sessionId:1})}}function Ae(n,s,e){const i=n.slice();return i[4]=s[e],i[6]=e,i}function Se(n){let s;return{c(){s=h("li"),s.textContent="Loading ...",p(s,"class","svelte-za7w49")},m(e,i){I(e,s,i)},p:N,d(e){e&&Q(s)}}}function os(n){let s,e=n[6]+1+"",i;return{c(){s=R("Question Nr. "),i=R(e)},m(r,l){I(r,s,l),I(r,i,l)},p:N,d(r){r&&(Q(s),Q(i))}}}function rs(n){let s=Ie.sanitize(n[4].text).replace(/<\/?[^>]+(>|$)/g,"")+"",e;return{c(){e=R(s)},m(i,r){I(i,e,r)},p(i,r){r&1&&s!==(s=Ie.sanitize(i[4].text).replace(/<\/?[^>]+(>|$)/g,"")+"")&&le(e,s)},d(i){i&&Q(e)}}}function ye(n){let s,e,i,r=n[1](n[4])+"",l,t,a,u,o,d;function w(C,m){return C[4].text?rs:os}let P=w(n),k=P(n);function T(){return n[3](n[4])}return{c(){s=h("li"),e=h("small"),i=new je(!1),l=L(),k.c(),t=L(),i.a=l,p(s,"class",a="list-group-item list-group-item-action text-overflow "+(n[4].id===n[0].session.current_question_id?"list-group-item-dark":"list-group-item-light")+" svelte-za7w49"),p(s,"id",u="question"+n[4].id)},m(C,m){I(C,s,m),b(s,e),i.m(r,e),b(e,l),k.m(e,null),b(s,t),o||(d=Z(s,"click",T),o=!0)},p(C,m){n=C,m&3&&r!==(r=n[1](n[4])+"")&&i.p(r),P===(P=w(n))&&k?k.p(n,m):(k.d(1),k=P(n),k&&(k.c(),k.m(e,null))),m&1&&a!==(a="list-group-item list-group-item-action text-overflow "+(n[4].id===n[0].session.current_question_id?"list-group-item-dark":"list-group-item-light")+" svelte-za7w49")&&p(s,"class",a),m&1&&u!==(u="question"+n[4].id)&&p(s,"id",u)},d(C){C&&Q(s),k.d(),o=!1,d()}}}function us(n){let s,e,i=Pe(n[0].deck.questions),r=[];for(let t=0;t<i.length;t+=1)r[t]=ye(Ae(n,i,t));let l=null;return i.length||(l=Se()),{c(){s=h("div"),e=h("ul");for(let t=0;t<r.length;t+=1)r[t].c();l&&l.c(),p(e,"class","list-group"),p(s,"class","overflow-scroll"),De(s,"max-height","85vh")},m(t,a){I(t,s,a),b(s,e);for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(e,null);l&&l.m(e,null)},p(t,[a]){if(a&3){i=Pe(t[0].deck.questions);let u;for(u=0;u<i.length;u+=1){const o=Ae(t,i,u);r[u]?r[u].p(o,a):(r[u]=ye(o),r[u].c(),r[u].m(e,null))}for(;u<r.length;u+=1)r[u].d(1);r.length=i.length,!i.length&&l?l.p(t,a):i.length?l&&(l.d(1),l=null):(l=Se(),l.c(),l.m(e,null))}},i:N,o:N,d(t){t&&Q(s),We(r,t),l&&l.d()}}}function ls(n,s,e){let i,{data:r}=s,{examMode:l}=s;const t=a=>e(0,r.session.current_question_id=a.id,r);return n.$$set=a=>{"data"in a&&e(0,r=a.data),"examMode"in a&&e(2,l=a.examMode)},n.$$.update=()=>{n.$$.dirty&1&&(r.session.current_question_id,(()=>{var a=document.getElementById("question"+r.session.current_question_id);a&&a.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})})()),n.$$.dirty&5&&e(1,i=function(a){var u=r.session.answer_choices.find(o=>o.question_id===a.id);return u?l?'<span class="text-dark fw-bold">&cross;</span>':u.is_correct?u.help_used?'<span class="text-warning-dark fw-bold">&check;</span>':'<span class="text-success-dark fw-bold">&check;</span>':'<span class="text-danger-dark fw-bold">&cross;</span>':'<span class="text-dark fw-bold">&rightarrow;</span>'})},[r,i,l,t]}class cs extends ae{constructor(s){super(),fe(this,s,ls,us,de,{data:0,examMode:2})}}function as(n){let s;return{c(){s=h("div"),s.innerHTML="",p(s,"class","col-6")},m(e,i){I(e,s,i)},p:N,d(e){e&&Q(s)}}}function fs(n){let s,e,i,r;return{c(){s=h("div"),e=h("button"),e.innerHTML='<span class="fw-bold">←</span> Previous',p(e,"class","btn btn-sm btn-light w-100"),p(s,"class","col-6")},m(l,t){I(l,s,t),b(s,e),i||(r=Z(e,"click",ce(n[2])),i=!0)},p:N,d(l){l&&Q(s),i=!1,r()}}}function ds(n){let s;return{c(){s=h("div"),s.innerHTML="",p(s,"class","col-6")},m(e,i){I(e,s,i)},p:N,d(e){e&&Q(s)}}}function _s(n){let s,e,i,r,l,t,a;return{c(){s=h("div"),e=h("button"),i=R("Next "),r=h("span"),r.textContent="→",p(r,"class","fw-bold"),p(e,"class",l="btn btn-sm "+(n[1]?"btn-warning":"btn-light")+" w-100"),p(s,"class","col-6")},m(u,o){I(u,s,o),b(s,e),b(e,i),b(e,r),t||(a=Z(e,"click",ce(n[3])),t=!0)},p(u,o){o&2&&l!==(l="btn btn-sm "+(u[1]?"btn-warning":"btn-light")+" w-100")&&p(e,"class",l)},d(u){u&&Q(s),t=!1,a()}}}function gs(n){let s,e;function i(o,d){return o[0].session.current_question_id&&o[0].session.current_question_id!=o[0].deck.questions[0].id?fs:as}let r=i(n),l=r(n);function t(o,d){return o[0].session.current_question_id!=o[0].deck.questions[o[0].deck.questions.length-1].id?_s:ds}let a=t(n),u=a(n);return{c(){s=h("div"),l.c(),e=L(),u.c(),p(s,"class","row mb-3 pt-1 pb-1 sticky-top bg-white")},m(o,d){I(o,s,d),l.m(s,null),b(s,e),u.m(s,null)},p(o,[d]){r===(r=i(o))&&l?l.p(o,d):(l.d(1),l=r(o),l&&(l.c(),l.m(s,e))),a===(a=t(o))&&u?u.p(o,d):(u.d(1),u=a(o),u&&(u.c(),u.m(s,null)))},i:N,o:N,d(o){o&&Q(s),l.d(),u.d()}}}function ms(n,s,e){let{data:i}=s,{currentQuestionId:r}=s,{currentQuestionAnswered:l}=s;Ve(()=>{he("left","questions",function(o,d){a()}),he("right","questions",function(o,d){u()}),he.setScope("questions")});function t(o){return i.deck.questions.findIndex(d=>d.id===o)}function a(){var o=t(r),d=i.deck.questions[o-1];d&&e(0,i.session.current_question_id=d.id,i)}function u(){var o=t(r),d=i.deck.questions[o+1];d&&e(0,i.session.current_question_id=d.id,i)}return n.$$set=o=>{"data"in o&&e(0,i=o.data),"currentQuestionId"in o&&e(4,r=o.currentQuestionId),"currentQuestionAnswered"in o&&e(1,l=o.currentQuestionAnswered)},[i,l,a,u,r]}class ps extends ae{constructor(s){super(),fe(this,s,ms,gs,de,{data:0,currentQuestionId:4,currentQuestionAnswered:1})}}function bs(n){let s;return{c(){s=h("p"),s.textContent="Loading ..."},m(e,i){I(e,s,i)},p:N,i:N,o:N,d(e){e&&Q(s)}}}function hs(n){let s,e,i,r,l,t,a,u,o,d,w,P,k,T=n[0].deck.name+"",C,m,g,c,M,j,V,J,B,O,K,te,oe,_e,U,re,ge,S=!n[13]&&!n[3]&&Fe(n),y=n[3]&&Ge(n),F=n[5]&&He(n);function me(_){n[27](_)}function pe(_){n[28](_)}function be(_){n[29](_)}let se={};n[0]!==void 0&&(se.data=n[0]),n[0].session.current_question_id!==void 0&&(se.currentQuestionId=n[0].session.current_question_id),n[9]!==void 0&&(se.currentQuestionAnswered=n[9]),O=new ps({props:se}),E.push(()=>D(O,"data",me)),E.push(()=>D(O,"currentQuestionId",pe)),E.push(()=>D(O,"currentQuestionAnswered",be));let G=n[10]&&Te(n);return{c(){s=h("div"),e=h("div"),i=h("p"),r=h("button"),r.innerHTML='<i class="bi bi-layout-sidebar"></i>',l=L(),t=h("button"),t.innerHTML='<i class="bi bi-exclamation-square"></i>',a=L(),u=h("span"),o=R(n[11]),d=R("/"),w=R(n[12]),P=L(),k=h("strong"),C=R(T),m=L(),g=h("div"),c=h("div"),S&&S.c(),M=L(),y&&y.c(),j=L(),V=h("div"),F&&F.c(),J=L(),B=h("div"),x(O.$$.fragment),_e=L(),G&&G.c(),p(r,"class","btn btn-sm d-none d-sm-none d-md-none d-lg-inline bg-light"),p(r,"title","Toggle sidebar"),p(t,"class","btn btn-sm"),p(t,"title","Toggle exam mode"),z(t,"bg-light",!n[4]),z(t,"bg-dark-subtle",n[4]),p(u,"class","ms-1 float-end fw-bold font-monospace badge text-dark"),z(u,"text-bg-light",!n[1]||n[13]),z(u,"bg-success",!n[13]&&!n[10].is_invalid&&n[1]&&n[1].is_correct),z(u,"bg-danger",!n[13]&&!n[10].is_invalid&&n[1]&&!n[1].is_correct),p(i,"class","text-overflow svelte-1gfmo48"),p(e,"class","col mb-1"),p(s,"class","row"),p(c,"class","col mb-1"),p(g,"class","row"),p(B,"class","col-md-12"),z(B,"col-lg-9",n[5]),z(B,"col-lg-10",!n[5]),z(B,"offset-lg-1",!n[5]),p(V,"class","row mt-3")},m(_,q){I(_,s,q),b(s,e),b(e,i),b(i,r),b(i,l),b(i,t),b(i,a),b(i,u),b(u,o),b(u,d),b(u,w),b(i,P),b(i,k),b(k,C),I(_,m,q),I(_,g,q),b(g,c),S&&S.m(c,null),b(c,M),y&&y.m(c,null),I(_,j,q),I(_,V,q),F&&F.m(V,null),b(V,J),b(V,B),$(O,B,null),b(B,_e),G&&G.m(B,null),U=!0,re||(ge=[Z(r,"click",ce(n[21])),Z(t,"click",ce(n[22]))],re=!0)},p(_,q){(!U||q[0]&16)&&z(t,"bg-light",!_[4]),(!U||q[0]&16)&&z(t,"bg-dark-subtle",_[4]),(!U||q[0]&2048)&&le(o,_[11]),(!U||q[0]&4096)&&le(w,_[12]),(!U||q[0]&8194)&&z(u,"text-bg-light",!_[1]||_[13]),(!U||q[0]&9218)&&z(u,"bg-success",!_[13]&&!_[10].is_invalid&&_[1]&&_[1].is_correct),(!U||q[0]&9218)&&z(u,"bg-danger",!_[13]&&!_[10].is_invalid&&_[1]&&!_[1].is_correct),(!U||q[0]&1)&&T!==(T=_[0].deck.name+"")&&le(C,T),!_[13]&&!_[3]?S?(S.p(_,q),q[0]&8200&&v(S,1)):(S=Fe(_),S.c(),v(S,1),S.m(c,M)):S&&(Y(),A(S,1,1,()=>{S=null}),X()),_[3]?y?(y.p(_,q),q[0]&8&&v(y,1)):(y=Ge(_),y.c(),v(y,1),y.m(c,null)):y&&(Y(),A(y,1,1,()=>{y=null}),X()),_[5]?F?(F.p(_,q),q[0]&32&&v(F,1)):(F=He(_),F.c(),v(F,1),F.m(V,J)):F&&(Y(),A(F,1,1,()=>{F=null}),X());const ne={};!K&&q[0]&1&&(K=!0,ne.data=_[0],W(()=>K=!1)),!te&&q[0]&1&&(te=!0,ne.currentQuestionId=_[0].session.current_question_id,W(()=>te=!1)),!oe&&q[0]&512&&(oe=!0,ne.currentQuestionAnswered=_[9],W(()=>oe=!1)),O.$set(ne),_[10]?G?(G.p(_,q),q[0]&1024&&v(G,1)):(G=Te(_),G.c(),v(G,1),G.m(B,null)):G&&(Y(),A(G,1,1,()=>{G=null}),X()),(!U||q[0]&32)&&z(B,"col-lg-9",_[5]),(!U||q[0]&32)&&z(B,"col-lg-10",!_[5]),(!U||q[0]&32)&&z(B,"offset-lg-1",!_[5])},i(_){U||(v(S),v(y),v(F),v(O.$$.fragment,_),v(G),U=!0)},o(_){A(S),A(y),A(F),A(O.$$.fragment,_),A(G),U=!1},d(_){_&&(Q(s),Q(m),Q(g),Q(j),Q(V)),S&&S.d(),y&&y.d(),F&&F.d(),ee(O),G&&G.d(),re=!1,Re(ge)}}}function Fe(n){let s,e,i;function r(t){n[23](t)}let l={};return n[2]!==void 0&&(l.progressPercentage=n[2]),s=new Xe({props:l}),E.push(()=>D(s,"progressPercentage",r)),{c(){x(s.$$.fragment)},m(t,a){$(s,t,a),i=!0},p(t,a){const u={};!e&&a[0]&4&&(e=!0,u.progressPercentage=t[2],W(()=>e=!1)),s.$set(u)},i(t){i||(v(s.$$.fragment,t),i=!0)},o(t){A(s.$$.fragment,t),i=!1},d(t){ee(s,t)}}}function Ge(n){let s,e,i;function r(t){n[24](t)}let l={sessionId:n[0].session.id};return n[2]!==void 0&&(l.progressPercentage=n[2]),s=new ts({props:l}),E.push(()=>D(s,"progressPercentage",r)),{c(){x(s.$$.fragment)},m(t,a){$(s,t,a),i=!0},p(t,a){const u={};a[0]&1&&(u.sessionId=t[0].session.id),!e&&a[0]&4&&(e=!0,u.progressPercentage=t[2],W(()=>e=!1)),s.$set(u)},i(t){i||(v(s.$$.fragment,t),i=!0)},o(t){A(s.$$.fragment,t),i=!1},d(t){ee(s,t)}}}function He(n){let s,e,i,r,l;function t(o){n[25](o)}function a(o){n[26](o)}let u={};return n[0]!==void 0&&(u.data=n[0]),n[13]!==void 0&&(u.examMode=n[13]),e=new cs({props:u}),E.push(()=>D(e,"data",t)),E.push(()=>D(e,"examMode",a)),{c(){s=h("div"),x(e.$$.fragment),p(s,"class","col-lg-3 d-none d-lg-block")},m(o,d){I(o,s,d),$(e,s,null),l=!0},p(o,d){const w={};!i&&d[0]&1&&(i=!0,w.data=o[0],W(()=>i=!1)),!r&&d[0]&8192&&(r=!0,w.examMode=o[13],W(()=>r=!1)),e.$set(w)},i(o){l||(v(e.$$.fragment,o),l=!0)},o(o){A(e.$$.fragment,o),l=!1},d(o){o&&Q(s),ee(e)}}}function Te(n){let s,e,i,r,l,t,a,u,o;function d(g){n[30](g)}function w(g){n[31](g)}function P(g){n[32](g)}function k(g){n[33](g)}function T(g){n[34](g)}let C={submitAnswer:n[14],deleteAnswer:n[15]};n[10]!==void 0&&(C.question=n[10]),n[9]!==void 0&&(C.questionAnswered=n[9]),n[7]!==void 0&&(C.helpUsed=n[7]),n[1]!==void 0&&(C.answerChoice=n[1]),n[13]!==void 0&&(C.examMode=n[13]),s=new Ye({props:C}),E.push(()=>D(s,"question",d)),E.push(()=>D(s,"questionAnswered",w)),E.push(()=>D(s,"helpUsed",P)),E.push(()=>D(s,"answerChoice",k)),E.push(()=>D(s,"examMode",T));let m=!n[13]&&n[9]&&Ue(n);return{c(){x(s.$$.fragment),a=L(),m&&m.c(),u=ke()},m(g,c){$(s,g,c),I(g,a,c),m&&m.m(g,c),I(g,u,c),o=!0},p(g,c){const M={};!e&&c[0]&1024&&(e=!0,M.question=g[10],W(()=>e=!1)),!i&&c[0]&512&&(i=!0,M.questionAnswered=g[9],W(()=>i=!1)),!r&&c[0]&128&&(r=!0,M.helpUsed=g[7],W(()=>r=!1)),!l&&c[0]&2&&(l=!0,M.answerChoice=g[1],W(()=>l=!1)),!t&&c[0]&8192&&(t=!0,M.examMode=g[13],W(()=>t=!1)),s.$set(M),!g[13]&&g[9]?m?(m.p(g,c),c[0]&8704&&v(m,1)):(m=Ue(g),m.c(),v(m,1),m.m(u.parentNode,u)):m&&(Y(),A(m,1,1,()=>{m=null}),X())},i(g){o||(v(s.$$.fragment,g),v(m),o=!0)},o(g){A(s.$$.fragment,g),A(m),o=!1},d(g){g&&(Q(a),Q(u)),ee(s,g),m&&m.d(g)}}}function Ue(n){let s,e,i;function r(t){n[35](t)}let l={};return n[10].id!==void 0&&(l.questionId=n[10].id),s=new Je({props:l}),E.push(()=>D(s,"questionId",r)),{c(){x(s.$$.fragment)},m(t,a){$(s,t,a),i=!0},p(t,a){const u={};!e&&a[0]&1024&&(e=!0,u.questionId=t[10].id,W(()=>e=!1)),s.$set(u)},i(t){i||(v(s.$$.fragment,t),i=!0)},o(t){A(s.$$.fragment,t),i=!1},d(t){ee(s,t)}}}function Le(n){let s,e,i;function r(t){n[36](t)}let l={};return n[8]!==void 0&&(l.magicGIFPath=n[8]),s=new es({props:l}),E.push(()=>D(s,"magicGIFPath",r)),{c(){x(s.$$.fragment)},m(t,a){$(s,t,a),i=!0},p(t,a){const u={};!e&&a[0]&256&&(e=!0,u.magicGIFPath=t[8],W(()=>e=!1)),s.$set(u)},i(t){i||(v(s.$$.fragment,t),i=!0)},o(t){A(s.$$.fragment,t),i=!1},d(t){ee(s,t)}}}function ws(n){let s,e,i,r,l;const t=[hs,bs],a=[];function u(d,w){return d[0]?0:1}s=u(n),e=a[s]=t[s](n);let o=!n[13]&&Le(n);return{c(){e.c(),i=L(),o&&o.c(),r=ke()},m(d,w){a[s].m(d,w),I(d,i,w),o&&o.m(d,w),I(d,r,w),l=!0},p(d,w){let P=s;s=u(d),s===P?a[s].p(d,w):(Y(),A(a[P],1,1,()=>{a[P]=null}),X(),e=a[s],e?e.p(d,w):(e=a[s]=t[s](d),e.c()),v(e,1),e.m(i.parentNode,i)),d[13]?o&&(Y(),A(o,1,1,()=>{o=null}),X()):o?(o.p(d,w),w[0]&8192&&v(o,1)):(o=Le(d),o.c(),v(o,1),o.m(r.parentNode,r))},i(d){l||(v(e),v(o),l=!0)},o(d){A(e),A(o),l=!1},d(d){d&&(Q(i),Q(r)),a[s].d(d),o&&o.d(d)}}}function ks(n,s,e){let i,r,l,t,a,u,o,d,w,P,k,T,C,m;Oe(n,we,f=>e(6,m=f));let{id:g}=s;var c,M=!1,j="",V=-1;Ve(()=>{axios.get("/api/sessions/"+g).then(function(f){e(0,c=f.data)}).catch(function(f){alert(f)})});var J;function B(){if(J&&J.cancel(),!!o){var f=o.id;J=Qe(()=>{axios.get("/api/questions/"+f).then(function(H){var ue=c.deck.questions.findIndex(Ee=>Ee.id===f),ie=H.data;e(0,c.deck.questions[ue]=ie,c),O(ie)}).catch(function(H){alert(H)})},500,{maxWait:1e3}),J()}}function O(f){if(f.type!=="card"){var H=c.session.answer_choices.findIndex(ue=>ue.question_id===f.id);H!==-1&&e(0,c.session.answer_choices[H].is_correct=c.session.answer_choices[H].answer_id===f.correct_answer_id,c)}}var K;function te(){K&&K.cancel(),K=Qe(()=>{axios.put("/api/sessions/"+c.session.id,c.session).then(function(f){}).catch(function(f){alert(f)})},1e3,{maxWait:2e3}),K()}function oe(f){if(!P){var H=!1;o.type==="card"?H=!!f:H=o.correct_answer_id===f;var ue={question_id:w,answer_id:f,is_correct:H,help_used:M};axios.post("/api/sessions/"+g+"/answerchoices",ue).then(function(ie){e(0,c.session.answer_choices=[...c.session.answer_choices,ie.data],c)}).catch(function(ie){alert(ie)})}}function _e(){P&&(e(1,a=c.session.answer_choices.find(f=>f.question_id===w)),u&&axios.delete("/api/sessions/"+g+"/answerchoices/"+a.id).then(function(f){e(0,c.session.answer_choices=[...c.session.answer_choices.filter(H=>H.question_id!==w)],c)}).catch(function(f){alert(f)}))}const U=()=>{ve(we,m.session_show_sidebar=!m.session_show_sidebar,m)},re=()=>{ve(we,m.session_exam_mode=!m.session_exam_mode,m)};function ge(f){k=f,e(2,k),e(0,c),e(20,t),e(19,u)}function S(f){k=f,e(2,k),e(0,c),e(20,t),e(19,u)}function y(f){c=f,e(0,c)}function F(f){i=f,e(13,i),e(3,d),e(6,m),e(0,c),e(20,t),e(19,u)}function me(f){c=f,e(0,c)}function pe(f){n.$$.not_equal(c.session.current_question_id,f)&&(c.session.current_question_id=f,e(0,c))}function be(f){P=f,e(9,P),e(0,c),e(1,a),e(18,w)}function se(f){o=f,e(10,o),e(0,c)}function G(f){P=f,e(9,P),e(0,c),e(1,a),e(18,w)}function _(f){M=f,e(7,M)}function q(f){a=f,e(1,a),e(0,c),e(18,w)}function ne(f){i=f,e(13,i),e(3,d),e(6,m),e(0,c),e(20,t),e(19,u)}function ze(f){n.$$.not_equal(o.id,f)&&(o.id=f,e(10,o),e(0,c))}function Be(f){j=f,e(8,j),e(2,k),e(17,V),e(0,c),e(20,t),e(19,u)}return n.$$set=f=>{"id"in f&&e(16,g=f.id)},n.$$.update=()=>{n.$$.dirty[0]&1&&e(20,t=c?c.deck.questions.filter(f=>!f.is_invalid):null),n.$$.dirty[0]&1048577&&e(19,u=c?c.session.answer_choices.filter(f=>t.some(({id:H})=>H===f.question_id)):null),n.$$.dirty[0]&1572865&&e(3,d=c?t.length===u.length:!1),n.$$.dirty[0]&72&&e(13,i=d?!1:m.session_exam_mode),n.$$.dirty[0]&64&&e(5,r=m.session_show_sidebar),n.$$.dirty[0]&64&&e(4,l=m.session_exam_mode),n.$$.dirty[0]&32&&axios.put("/api/users/me/settings",{session_show_sidebar:r}).then(function(f){}).catch(function(f){alert(f)}),n.$$.dirty[0]&16&&axios.put("/api/users/me/settings",{session_exam_mode:l}).then(function(f){}).catch(function(f){alert(f)}),n.$$.dirty[0]&1&&e(18,w=c?c.session.current_question_id:-1),n.$$.dirty[0]&262145&&e(1,a=c?c.session.answer_choices.find(f=>f.question_id===w):null),n.$$.dirty[0]&1&&e(10,o=c?c.deck.questions.find(f=>f.id===c.session.current_question_id):null),n.$$.dirty[0]&8&&d&&e(13,i=!1),n.$$.dirty[0]&262144&&B(),n.$$.dirty[0]&262144&&te(),n.$$.dirty[0]&3&&e(9,P=c?!!a:!1),n.$$.dirty[0]&1572865&&e(2,k=c?Ze(t.length,u):null),n.$$.dirty[0]&1&&e(12,T=c?c.deck.questions.length:0),n.$$.dirty[0]&1&&e(11,C=c?c.deck.questions.findIndex(f=>f.id==c.session.current_question_id)+1:null),n.$$.dirty[0]&131076&&(()=>{if(k){var f=k.correct;if(f<60){e(17,V=f);return}if(V===-1){e(17,V=f);return}V<60&&(e(17,V=f),axios.get("/api/magic-gif").then(function(H){e(8,j="magic-gifs/"+H.data.id)}).catch(function(H){}))}})()},[c,a,k,d,l,r,m,M,j,P,o,C,T,i,oe,_e,g,V,w,u,t,U,re,ge,S,y,F,me,pe,be,se,G,_,q,ne,ze,Be]}class qs extends ae{constructor(s){super(),fe(this,s,ks,ws,de,{id:16},null,[-1,-1])}}const Ne=document.getElementById("SessionView");new qs({target:Ne,props:{id:Ne.dataset.sessionId}});
