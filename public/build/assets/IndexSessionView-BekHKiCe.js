import{p as N,l as k,h as f,m as y,k as d,g as a,a as Y,i as Q,f as S,j as i,s as v,c as R,u as g,t as Z,d as p,e as C,n as E,b as H,v as _,w as $}from"./lifecycle-BvmTvt_c.js";import{o as ss}from"./index-client-DUeXGvoC.js";import{a as I,c as D,e as es,p as ts,b as as,i as ns}from"./event-modifiers-C9-V6teM.js";import{p as F,s as is}from"./props-DkMS-7Z0.js";import{S as rs}from"./SessionProgressBar-PoCQtOGQ.js";import{s as os}from"./StatsHelper-B91isISU.js";import{f as ds}from"./formatDistance-DD1FqeGq.js";import{p as O,f as ls}from"./parseISO-BjONWRSE.js";import"./style-BxdPOk1g.js";var cs=S('<button class="btn btn-sm btn-outline-secondary flex-fill" style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;" type="button"><i class="bi bi-repeat"></i> Repeat incorrect</button>'),ms=S('<div class="mt-1 mb-2 p-2 rounded-2 border shadow-sm session-hover svelte-jzwx3l"><!> <div class="row mt-1"><div class="col-md-5 text-truncate"><strong> </strong></div> <div class="col-md-4 d-flex gap-1"><a style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;"><i class="bi bi-rocket-takeoff"></i> Open</a> <!> <a class="btn btn-sm btn-outline-secondary" style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;"><i class="bi bi-three-dots-vertical"></i></a></div> <div class="col-md-3 text-muted align-bottom"><span class="float-end d-none d-sm-none d-md-inline"><small> </small></span> <span class="d-inline d-sm-inline d-md-none"><small> </small></span></div></div></div>');function vs(P,b){N(b,!1);const u=y(),r=y(),l=y(),n=y();let s=F(b,"session",8);function z(t){axios.post("/api/sessions/"+t+"/newfromincorrect").then(function(o){window.location.href="/sessions/"+o.data.id}).catch(function(o){alert(o)})}k(()=>d(s()),()=>{f(u,ds(O(s().created_at),new Date))}),k(()=>d(s()),()=>{f(r,ls(O(s().created_at),"dd.MM.yyyy HH:mm"))}),k(()=>d(s()),()=>{f(l,s()?s().deck.questions.filter(t=>!t.is_invalid):null)}),k(()=>(d(s()),a(l)),()=>{f(n,s()?os(a(l).length,s().answerchoices.filter(t=>a(l).some(({id:o})=>o===t.question_id))):null)}),Y(),Q();var e=ms(),c=i(e);rs(c,{get progressPercentage(){return a(n)},set progressPercentage(t){f(n,t)},$$legacy:!0});var V=v(c,2),m=i(V),x=i(m),h=i(x),w=v(m,2),j=i(w);let M;var q=v(j,2);{var G=t=>{var o=cs();es("click",o,ts(()=>z(s().id))),p(t,o)};R(q,t=>{a(n),g(()=>a(n).unanswered===0&&a(n).incorrect>0)&&t(G)})}var J=v(q,2),A=v(w,2),B=i(A),K=i(B),T=i(K),U=v(B,2),W=i(U),X=i(W);Z(t=>{I(m,"title",(d(s()),g(()=>s().name))),D(h,(d(s()),g(()=>s().name))),I(j,"href",`/sessions/${d(s()),g(()=>s().id)??""}`),M=is(j,1,"btn btn-sm flex-fill",null,M,t),I(J,"href",`/sessions/${d(s()),g(()=>s().id)??""}/edit`),I(A,"title",a(r)),D(T,`${a(u)??""} ago`),D(X,`${a(u)??""} ago`)},[()=>({"btn-primary":a(n).unanswered,"btn-outline-secondary":!a(n).unanswered})]),p(P,e),C()}var fs=S('<div class="alert alert-light text-center" role="alert">No sessions yet <i class="bi bi-rocket"></i></div>'),ps=S('<div class="d-flex justify-content-center"><div class="spinner-border text-secondary" role="status"><span class="visually-hidden">Loading sessions ...</span></div></div>');function bs(P,b){N(b,!1);let u=F(b,"userId",8);var r=y(void 0);ss(()=>{axios.get("/api/sessions?take=10&user-id="+u()).then(function(e){f(r,e.data)}).catch(function(e){alert(e)})}),Q();var l=E(),n=H(l);{var s=e=>{var c=E(),V=H(c);as(V,1,()=>_(r),ns,(m,x,h)=>{vs(m,{get session(){return _(r)[h]},set session(w){_(r)[h]=w,$(()=>_(r))},$$legacy:!0})},m=>{var x=fs();p(m,x)}),p(e,c)},z=e=>{var c=ps();p(e,c)};R(n,e=>{_(r)?e(s):e(z,!1)})}p(P,l),C()}const L=document.getElementById("IndexSessionView");new bs({target:L,props:{userId:L.dataset.userId}});
