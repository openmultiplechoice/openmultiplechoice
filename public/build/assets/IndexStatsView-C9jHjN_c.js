import{S as X,i as Y,s as $,g,b as h,q as x,c as u,a as y,h as c,n as T,d as w,A as ee,k as te,f as A,t as q,l as j,p as D,j as C}from"./index-B80I9K_4.js";import{e as S}from"./each-DkBj6IvG.js";import{c as M}from"./NewSessionHelper-Ba9jtPTo.js";import{C as le}from"./auto-B1JLC99t.js";import{f as I,p as se}from"./parseISO-Ds5nI7_t.js";function O(i,e,o){const r=i.slice();return r[12]=e[o],r}function V(i,e,o){const r=i.slice();return r[12]=e[o],r}function B(i,e,o){const r=i.slice();return r[12]=e[o],r}function ie(i){let e;return{c(){e=h("p"),e.textContent="No stats available yet"},m(o,r){y(o,e,r)},p:T,d(o){o&&w(e)}}}function ne(i){let e,o,r,n=i[1].length>0&&P(i),l=i[2].length>0&&i[3]&&R(i),t=i[4].length>0&&G(i);return{c(){e=h("div"),n&&n.c(),o=g(),l&&l.c(),r=g(),t&&t.c(),u(e,"class","row")},m(a,s){y(a,e,s),n&&n.m(e,null),c(e,o),l&&l.m(e,null),c(e,r),t&&t.m(e,null)},p(a,s){a[1].length>0?n?n.p(a,s):(n=P(a),n.c(),n.m(e,o)):n&&(n.d(1),n=null),a[2].length>0&&a[3]?l?l.p(a,s):(l=R(a),l.c(),l.m(e,r)):l&&(l.d(1),l=null),a[4].length>0?t?t.p(a,s):(t=G(a),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},d(a){a&&w(e),n&&n.d(),l&&l.d(),t&&t.d()}}}function P(i){let e,o,r,n=S(i[1]),l=[];for(let t=0;t<n.length;t+=1)l[t]=E(B(i,n,t));return{c(){e=h("div"),o=h("h6"),o.textContent="New decks",r=g();for(let t=0;t<l.length;t+=1)l[t].c();u(e,"class","col-md mt-3")},m(t,a){y(t,e,a),c(e,o),c(e,r);for(let s=0;s<l.length;s+=1)l[s]&&l[s].m(e,null)},p(t,a){if(a&2){n=S(t[1]);let s;for(s=0;s<n.length;s+=1){const f=B(t,n,s);l[s]?l[s].p(f,a):(l[s]=E(f),l[s].c(),l[s].m(e,null))}for(;s<l.length;s+=1)l[s].d(1);l.length=n.length}},d(t){t&&w(e),A(l,t)}}}function U(i){let e,o,r,n=i[12].questions.length+"",l;return{c(){e=h("span"),o=h("i"),r=g(),l=q(n),u(o,"class","bi bi-collection"),u(e,"class","badge text-bg-light"),u(e,"title","Number of questions")},m(t,a){y(t,e,a),c(e,o),c(e,r),c(e,l)},p(t,a){a&2&&n!==(n=t[12].questions.length+"")&&C(l,n)},d(t){t&&w(e)}}}function E(i){let e,o,r,n,l,t=i[12].name+"",a,s,f,k,_,d=i[12].questions.length>0&&U(i);function m(){return i[8](i[12])}return{c(){e=h("div"),d&&d.c(),o=g(),r=h("button"),r.innerHTML='<i class="bi bi-rocket-takeoff"></i>',n=g(),l=h("a"),a=q(t),f=g(),u(r,"type","button"),u(r,"class","btn btn-sm btn-primary"),u(l,"href",s="/decks/"+i[12].id),u(l,"class","alert-link text-overflow svelte-1gfmo48"),u(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),u(e,"role","alert")},m(b,p){y(b,e,p),d&&d.m(e,null),c(e,o),c(e,r),c(e,n),c(e,l),c(l,a),c(e,f),k||(_=j(r,"click",D(m)),k=!0)},p(b,p){i=b,i[12].questions.length>0?d?d.p(i,p):(d=U(i),d.c(),d.m(e,o)):d&&(d.d(1),d=null),p&2&&t!==(t=i[12].name+"")&&C(a,t),p&2&&s!==(s="/decks/"+i[12].id)&&u(l,"href",s)},d(b){b&&w(e),d&&d.d(),k=!1,_()}}}function R(i){let e,o,r,n,l,t,a=S(i[2]),s=[];for(let f=0;f<a.length;f+=1)s[f]=Z(V(i,a,f));return{c(){e=h("div"),o=h("h6"),r=q("Popular decks (last "),n=q(i[3]),l=q(" days)"),t=g();for(let f=0;f<s.length;f+=1)s[f].c();u(e,"class","col-md mt-3")},m(f,k){y(f,e,k),c(e,o),c(o,r),c(o,n),c(o,l),c(e,t);for(let _=0;_<s.length;_+=1)s[_]&&s[_].m(e,null)},p(f,k){if(k&8&&C(n,f[3]),k&4){a=S(f[2]);let _;for(_=0;_<a.length;_+=1){const d=V(f,a,_);s[_]?s[_].p(d,k):(s[_]=Z(d),s[_].c(),s[_].m(e,null))}for(;_<s.length;_+=1)s[_].d(1);s.length=a.length}},d(f){f&&w(e),A(s,f)}}}function z(i){let e,o,r,n=i[12].questions.length+"",l;return{c(){e=h("span"),o=h("i"),r=g(),l=q(n),u(o,"class","bi bi-collection"),u(e,"class","badge text-bg-light"),u(e,"title","Number of questions")},m(t,a){y(t,e,a),c(e,o),c(e,r),c(e,l)},p(t,a){a&4&&n!==(n=t[12].questions.length+"")&&C(l,n)},d(t){t&&w(e)}}}function F(i){let e,o,r,n=i[12].sessions_count+"",l;return{c(){e=h("span"),o=h("i"),r=g(),l=q(n),u(o,"class","bi bi-rocket"),u(e,"class","badge text-bg-light"),u(e,"title","Number of sessions")},m(t,a){y(t,e,a),c(e,o),c(e,r),c(e,l)},p(t,a){a&4&&n!==(n=t[12].sessions_count+"")&&C(l,n)},d(t){t&&w(e)}}}function Z(i){let e,o,r,n,l,t,a=i[12].name+"",s,f,k,_,d,m=i[12].questions.length>0&&z(i),b=i[12].sessions_count&&F(i);function p(){return i[9](i[12])}return{c(){e=h("div"),m&&m.c(),o=g(),b&&b.c(),r=g(),n=h("button"),n.innerHTML='<i class="bi bi-rocket-takeoff"></i>',l=g(),t=h("a"),s=q(a),k=g(),u(n,"type","button"),u(n,"class","btn btn-sm btn-primary"),u(t,"href",f="/decks/"+i[12].id),u(t,"class","alert-link"),u(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),u(e,"role","alert")},m(v,L){y(v,e,L),m&&m.m(e,null),c(e,o),b&&b.m(e,null),c(e,r),c(e,n),c(e,l),c(e,t),c(t,s),c(e,k),_||(d=j(n,"click",D(p)),_=!0)},p(v,L){i=v,i[12].questions.length>0?m?m.p(i,L):(m=z(i),m.c(),m.m(e,o)):m&&(m.d(1),m=null),i[12].sessions_count?b?b.p(i,L):(b=F(i),b.c(),b.m(e,r)):b&&(b.d(1),b=null),L&4&&a!==(a=i[12].name+"")&&C(s,a),L&4&&f!==(f="/decks/"+i[12].id)&&u(t,"href",f)},d(v){v&&w(e),m&&m.d(),b&&b.d(),_=!1,d()}}}function G(i){let e,o,r,n=S(i[4]),l=[];for(let t=0;t<n.length;t+=1)l[t]=K(O(i,n,t));return{c(){e=h("div"),o=h("h6"),o.textContent="Last used decks",r=g();for(let t=0;t<l.length;t+=1)l[t].c();u(e,"class","col-md mt-3")},m(t,a){y(t,e,a),c(e,o),c(e,r);for(let s=0;s<l.length;s+=1)l[s]&&l[s].m(e,null)},p(t,a){if(a&16){n=S(t[4]);let s;for(s=0;s<n.length;s+=1){const f=O(t,n,s);l[s]?l[s].p(f,a):(l[s]=K(f),l[s].c(),l[s].m(e,null))}for(;s<l.length;s+=1)l[s].d(1);l.length=n.length}},d(t){t&&w(e),A(l,t)}}}function J(i){let e,o,r,n=i[12].questions.length+"",l;return{c(){e=h("span"),o=h("i"),r=g(),l=q(n),u(o,"class","bi bi-collection"),u(e,"class","badge text-bg-light"),u(e,"title","Number of questions")},m(t,a){y(t,e,a),c(e,o),c(e,r),c(e,l)},p(t,a){a&16&&n!==(n=t[12].questions.length+"")&&C(l,n)},d(t){t&&w(e)}}}function K(i){let e,o,r,n,l,t=i[12].name+"",a,s,f,k,_,d=i[12].questions.length>0&&J(i);function m(){return i[10](i[12])}return{c(){e=h("div"),d&&d.c(),o=g(),r=h("button"),r.innerHTML='<i class="bi bi-rocket-takeoff"></i>',n=g(),l=h("a"),a=q(t),f=g(),u(r,"type","button"),u(r,"class","btn btn-sm btn-primary"),u(l,"href",s="/decks/"+i[12].id),u(l,"class","alert-link"),u(e,"class","alert alert-light m-1 p-2 text-overflow svelte-1gfmo48"),u(e,"role","alert")},m(b,p){y(b,e,p),d&&d.m(e,null),c(e,o),c(e,r),c(e,n),c(e,l),c(l,a),c(e,f),k||(_=j(r,"click",D(m)),k=!0)},p(b,p){i=b,i[12].questions.length>0?d?d.p(i,p):(d=J(i),d.c(),d.m(e,o)):d&&(d.d(1),d=null),p&16&&t!==(t=i[12].name+"")&&C(a,t),p&16&&s!==(s="/decks/"+i[12].id)&&u(l,"href",s)},d(b){b&&w(e),d&&d.d(),k=!1,_()}}}function ae(i){let e,o,r,n;function l(s,f){return s[1]&&s[2]&&s[4]?ne:ie}let t=l(i),a=t(i);return{c(){a.c(),e=g(),o=h("div"),r=h("div"),n=h("canvas"),x(n,"max-height","300px"),u(r,"class","col-md"),u(o,"class","row mt-3 p-3")},m(s,f){a.m(s,f),y(s,e,f),y(s,o,f),c(o,r),c(r,n),i[11](n)},p(s,[f]){t===(t=l(s))&&a?a.p(s,f):(a.d(1),a=t(s),a&&(a.c(),a.m(e.parentNode,e)))},i:T,o:T,d(s){s&&(w(e),w(o)),a.d(s),i[11](null)}}}function oe(i,e,o){let r,n,l={},t={},a=[],s=[],f=0,k=[];ee(()=>{axios.get("/api/stats/activity").then(function(p){const v=p.data;o(6,l=v.answers_byhour),o(7,t=v.users_byhour),o(1,a=v.decks_new),o(2,s=v.decks_popular),o(3,f=v.decks_popular_timespan),o(4,k=v.decks_last_used)}).catch(function(p){console.log(p)})});const _=p=>M(p.id),d=p=>M(p.id),m=p=>M(p.id);function b(p){te[p?"unshift":"push"](()=>{r=p,o(0,r)})}return i.$$.update=()=>{i.$$.dirty&225&&r&&l&&t&&(()=>{const p=Object.keys(l),v=Object.values(l);if(v.reduce((N,H)=>N+H,0)===0)return;const Q={type:"line",data:{labels:p,datasets:[{label:"Answers",data:v,backgroundColor:"rgba(255, 205, 86, 0.4)",borderColor:"rgba(255, 205, 86, 0.4)",fill:!0,showLine:!1,pointRadius:0,tension:.2},{label:"Users",data:Object.values(t),backgroundColor:"rgba(54, 162, 235, 0.7)",borderColor:"rgba(54, 162, 235, 0.7)",fill:!0,showLine:!1,pointRadius:0,tension:.2}]},options:{plugins:{legend:{display:!1},tooltip:{callbacks:{title(N){return I(se(N[0].label),"dd.MM.yyyy HH:mm")}}}},responsive:!0,interaction:{intersect:!1},scales:{x:{display:!0,title:{display:!1,text:"Hour of the day"},ticks:{autoSkip:!0,maxTicksLimit:3,callback(N){const H=this.getLabelForValue(N);return I(H,"dd.MM.yyyy")}},grid:{display:!1},border:{display:!1}},y:{display:!0,title:{display:!1,text:"Number of answers"},ticks:{beginAtZero:!0,stepSize:1,maxTicksLimit:4,autoSkip:!0},border:{display:!1}}}}};n&&n.destroy();var W=r.getContext("2d");o(5,n=new le(W,Q))})()},[r,a,s,f,k,n,l,t,_,d,m,b]}class re extends X{constructor(e){super(),Y(this,e,oe,ae,$,{})}}const fe=document.getElementById("IndexStatsView");new re({target:fe});
