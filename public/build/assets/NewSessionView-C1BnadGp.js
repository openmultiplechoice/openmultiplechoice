import{S as Ue,i as Ae,s as Le,b as _,g as M,t as S,c as m,a as E,h as s,j,n as ee,d as H,l as W,p as ne,k as pe,m as Se,o as He,e as Ne,u as Re,v as De,w as Ie,x as Ce,z as Pe,f as Ve,r as ot,H as rt,D as ze,y as ut,E as ct,A as at,B as dt,F as Ee}from"./index-DgDIGCFR.js";import{e as ge}from"./each-CvUUWvvD.js";import{s as ft}from"./StatsHelper-B91isISU.js";import{C as _t}from"./auto-Aq1nblnl.js";import{f as ye}from"./format-Dvme3Z7b.js";import{p as je}from"./parseISO-Bm-E8o14.js";import{U as qe}from"./UserSettingsStore-CHRhuN6R.js";function Fe(e){let t,n,l,i,r,u,a,v,g,d,f=e[2]>=40&&We(e),k=e[2]>=70&&Ye(e);return{c(){t=_("div"),f&&f.c(),n=M(),k&&k.c(),l=M(),i=_("button"),r=_("i"),u=S(" Repeat "),a=S(e[2]),v=S(" incorrect"),m(r,"class","bi bi-repeat"),m(i,"class","btn btn-sm btn-outline-secondary"),m(i,"type","button"),m(t,"class","d-grid gap-2")},m(b,h){E(b,t,h),f&&f.m(t,null),s(t,n),k&&k.m(t,null),s(t,l),s(t,i),s(i,r),s(i,u),s(i,a),s(i,v),g||(d=W(i,"click",ne(e[18])),g=!0)},p(b,h){b[2]>=40?f?f.p(b,h):(f=We(b),f.c(),f.m(t,n)):f&&(f.d(1),f=null),b[2]>=70?k?k.p(b,h):(k=Ye(b),k.c(),k.m(t,l)):k&&(k.d(1),k=null),h&4&&j(a,b[2])},d(b){b&&H(t),f&&f.d(),k&&k.d(),g=!1,d()}}}function We(e){let t,n,l;return{c(){t=_("button"),t.innerHTML='<i class="bi bi-repeat"></i> Repeat 30 incorrect',m(t,"class","btn btn-sm btn-outline-secondary"),m(t,"type","button")},m(i,r){E(i,t,r),n||(l=W(t,"click",ne(e[16])),n=!0)},p:ee,d(i){i&&H(t),n=!1,l()}}}function Ye(e){let t,n,l;return{c(){t=_("button"),t.innerHTML='<i class="bi bi-repeat"></i> Repeat 60 incorrect',m(t,"class","btn btn-sm btn-outline-secondary"),m(t,"type","button")},m(i,r){E(i,t,r),n||(l=W(t,"click",ne(e[17])),n=!0)},p:ee,d(i){i&&H(t),n=!1,l()}}}function mt(e){let t,n,l,i,r,u,a,v,g,d,f,k,b,h,o,p,C,c,D,w,q,I=Math.round(100*e[5]/e[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",L,y,P,F,V,Z,A,U,oe,Y=Math.round(100*e[1]/e[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",B,Q,J,se,le,fe,$,ie,_e,re=Math.round(100*e[4]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",me,K,ke,x,ue,be,X,ce,we,ae=Math.round(100*e[3]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",te,he,ve,R,G,T,de,Qe,Te,Me=Math.round(100*e[2]/e[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"",Ge,Be,Oe,O=e[2]>0&&Fe(e);return{c(){t=_("div"),n=_("div"),l=_("canvas"),i=M(),r=_("div"),u=_("table"),a=_("thead"),v=M(),g=_("tbody"),d=_("tr"),f=_("td"),f.textContent="Questions",k=M(),b=_("td"),h=S(e[6]),o=M(),p=_("tr"),C=_("td"),C.textContent="Answered questions",c=M(),D=_("td"),w=S(e[5]),q=S(`
                        (`),L=S(I),y=S("%)"),P=M(),F=_("tr"),V=_("td"),V.textContent="Unanswered questions",Z=M(),A=_("td"),U=S(e[1]),oe=S(`
                        (`),B=S(Y),Q=S("%)"),J=M(),se=_("tr"),le=_("td"),le.textContent="Correct answers",fe=M(),$=_("td"),ie=S(e[4]),_e=S(`
                        (`),me=S(re),K=S("%)"),ke=M(),x=_("tr"),ue=_("td"),ue.textContent="Correct answers with help",be=M(),X=_("td"),ce=S(e[3]),we=S(`
                        (`),te=S(ae),he=S("%)"),ve=M(),R=_("tr"),G=_("td"),G.textContent="Incorrect answers",T=M(),de=_("td"),Qe=S(e[2]),Te=S(`
                        (`),Ge=S(Me),Be=S("%)"),Oe=M(),O&&O.c(),m(n,"class","col-md-5"),m(b,"class","font-monospace text-end"),m(D,"class","font-monospace text-end"),m(A,"class","font-monospace text-end"),m($,"class","font-monospace text-end"),m(X,"class","font-monospace text-end"),m(de,"class","font-monospace text-end"),m(u,"class","table"),m(r,"class","col-md-7 mt-3"),m(t,"class","row mb-5")},m(N,z){E(N,t,z),s(t,n),s(n,l),e[15](l),s(t,i),s(t,r),s(r,u),s(u,a),s(u,v),s(u,g),s(g,d),s(d,f),s(d,k),s(d,b),s(b,h),s(g,o),s(g,p),s(p,C),s(p,c),s(p,D),s(D,w),s(D,q),s(D,L),s(D,y),s(g,P),s(g,F),s(F,V),s(F,Z),s(F,A),s(A,U),s(A,oe),s(A,B),s(A,Q),s(g,J),s(g,se),s(se,le),s(se,fe),s(se,$),s($,ie),s($,_e),s($,me),s($,K),s(g,ke),s(g,x),s(x,ue),s(x,be),s(x,X),s(X,ce),s(X,we),s(X,te),s(X,he),s(g,ve),s(g,R),s(R,G),s(R,T),s(R,de),s(de,Qe),s(de,Te),s(de,Ge),s(de,Be),s(r,Oe),O&&O.m(r,null)},p(N,[z]){z&64&&j(h,N[6]),z&32&&j(w,N[5]),z&96&&I!==(I=Math.round(100*N[5]/N[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(L,I),z&2&&j(U,N[1]),z&66&&Y!==(Y=Math.round(100*N[1]/N[6]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(B,Y),z&16&&j(ie,N[4]),z&48&&re!==(re=Math.round(100*N[4]/N[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(me,re),z&8&&j(ce,N[3]),z&40&&ae!==(ae=Math.round(100*N[3]/N[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(te,ae),z&4&&j(Qe,N[2]),z&36&&Me!==(Me=Math.round(100*N[2]/N[5]).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"")&&j(Ge,Me),N[2]>0?O?O.p(N,z):(O=Fe(N),O.c(),O.m(r,null)):O&&(O.d(1),O=null)},i:ee,o:ee,d(N){N&&H(t),e[15](null),O&&O.d()}}}function ht(e,t,n){let l,i,r,u,a,v,g,d,f,{questionsInModule:k}=t,{answerChoices:b}=t,{moduleId:h}=t,o,p;function C(I){const L={module_id:h,question_ids:I};axios.post("/api/sessions/newfromquestionids",L).then(function(y){window.location.href="/sessions/"+y.data.id}).catch(function(y){alert(y)})}function c(I){pe[I?"unshift":"push"](()=>{p=I,n(0,p)})}const D=()=>C(f.slice(0,30)),w=()=>C(f.slice(0,60)),q=()=>C(f);return e.$$set=I=>{"questionsInModule"in I&&n(9,k=I.questionsInModule),"answerChoices"in I&&n(10,b=I.answerChoices),"moduleId"in I&&n(11,h=I.moduleId)},e.$$.update=()=>{e.$$.dirty&512&&n(14,l=k.filter(I=>!I.is_invalid)),e.$$.dirty&17408&&n(13,i=b.filter(I=>l.some(({id:L})=>L===I.question_id))),e.$$.dirty&16384&&n(6,r=l.length),e.$$.dirty&8192&&n(5,u=i.length),e.$$.dirty&96&&n(1,a=r-u),e.$$.dirty&8192&&n(4,v=i.filter(I=>I.is_correct===1&&I.help_used===0).length),e.$$.dirty&8192&&n(3,g=i.filter(I=>I.is_correct===1&&I.help_used===1).length),e.$$.dirty&8192&&n(2,d=i.filter(I=>I.is_correct===0).length),e.$$.dirty&8192&&n(7,f=i.filter(I=>I.is_correct===0).map(I=>I.question_id)),e.$$.dirty&4127&&p&&(()=>{const I={type:"doughnut",data:{labels:["Correct","Correct with help","Incorrect","Unanswered"],datasets:[{label:"n",data:[v,g,d,a],backgroundColor:["#d4edda","#fff3cd","#f8d7da","#bbbbbb"],hoverOffet:4}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:null},plugins:{legend:{display:!1}}}};o&&o.destroy();var L=p.getContext("2d");n(12,o=new _t(L,I))})()},[p,a,d,g,v,u,r,f,C,k,b,h,o,i,l,c,D,w,q]}class pt extends Ue{constructor(t){super(),Ae(this,t,ht,mt,Le,{questionsInModule:9,answerChoices:10,moduleId:11})}}function Je(e,t,n){const l=e.slice();return l[15]=t[n],l}function Ke(e){let t;return{c(){t=_("p"),t.textContent="Loading ..."},m(n,l){E(n,t,l)},p:ee,d(n){n&&H(t)}}}function gt(e){let t,n=ye(je(e[15].created_at),"dd.MM.yyyy")+"",l;return{c(){t=_("span"),l=S(n),m(t,"class","badge text-bg-light")},m(i,r){E(i,t,r),s(t,l)},p(i,r){r&16&&n!==(n=ye(je(i[15].created_at),"dd.MM.yyyy")+"")&&j(l,n)},d(i){i&&H(t)}}}function kt(e){let t,n=ye(je(e[15].exam_at),"dd.MM.yyyy")+"",l;return{c(){t=_("span"),l=S(n),m(t,"class","badge text-bg-light")},m(i,r){E(i,t,r),s(t,l)},p(i,r){r&16&&n!==(n=ye(je(i[15].exam_at),"dd.MM.yyyy")+"")&&j(l,n)},d(i){i&&H(t)}}}function Xe(e){let t,n=e[5][e[15].id]+"",l;return{c(){t=new rt(!1),l=Ne(),t.a=l},m(i,r){t.m(n,i,r),E(i,l,r)},p(i,r){r&48&&n!==(n=i[5][i[15].id]+"")&&t.p(n)},d(i){i&&(H(l),t.d())}}}function Ze(e){let t,n,l,i,r,u=e[15].questions.length+"",a,v,g,d,f,k,b,h,o,p=e[15].name+"",C,c,D,w,q,I,L,y,P,F;function V(B,Q){return B[15].exam_at?kt:gt}let Z=V(e),A=Z(e),U=e[5][e[15].id]&&Xe(e);function oe(){return e[12](e[15])}function Y(){return e[13](e[15])}return{c(){t=_("div"),n=_("div"),l=_("div"),A.c(),i=M(),r=_("span"),a=S(u),v=M(),U&&U.c(),g=M(),d=_("input"),b=M(),h=_("div"),o=_("h6"),C=S(p),c=M(),D=_("button"),D.innerHTML='<i class="bi bi-rocket-takeoff"></i> New session',w=M(),q=_("a"),I=S("Browse deck"),y=M(),m(r,"class","badge text-bg-secondary"),m(r,"title","Number of questions"),m(d,"class","form-check-input float-end"),m(d,"type","checkbox"),d.value="",m(d,"id",f="selected"+e[15].id),d.checked=k=e[3].has(e[15].id),m(l,"class","card-header"),m(o,"class","card-title"),m(D,"type","button"),m(D,"class","btn btn-sm btn-primary"),m(q,"href",L="/decks/"+e[15].id),m(q,"class","card-link"),m(h,"class","card-body"),m(n,"class","card"),m(t,"class","col-lg-6 mb-1")},m(B,Q){E(B,t,Q),s(t,n),s(n,l),A.m(l,null),s(l,i),s(l,r),s(r,a),s(l,v),U&&U.m(l,null),s(l,g),s(l,d),s(n,b),s(n,h),s(h,o),s(o,C),s(h,c),s(h,D),s(h,w),s(h,q),s(q,I),s(t,y),P||(F=[W(d,"click",oe),W(D,"click",ne(Y))],P=!0)},p(B,Q){e=B,Z===(Z=V(e))&&A?A.p(e,Q):(A.d(1),A=Z(e),A&&(A.c(),A.m(l,i))),Q&16&&u!==(u=e[15].questions.length+"")&&j(a,u),e[5][e[15].id]?U?U.p(e,Q):(U=Xe(e),U.c(),U.m(l,g)):U&&(U.d(1),U=null),Q&16&&f!==(f="selected"+e[15].id)&&m(d,"id",f),Q&24&&k!==(k=e[3].has(e[15].id))&&(d.checked=k),Q&16&&p!==(p=e[15].name+"")&&j(C,p),Q&16&&L!==(L="/decks/"+e[15].id)&&m(q,"href",L)},d(B){B&&H(t),A.d(),U&&U.d(),P=!1,ot(F)}}}function bt(e){let t,n,l,i,r,u,a;function v(o){e[9](o)}function g(o){e[10](o)}function d(o){e[11](o)}let f={};e[0]!==void 0&&(f.moduleId=e[0]),e[7]!==void 0&&(f.questionsInModule=e[7]),e[6]!==void 0&&(f.answerChoices=e[6]),t=new pt({props:f}),pe.push(()=>Se(t,"moduleId",v)),pe.push(()=>Se(t,"questionsInModule",g)),pe.push(()=>Se(t,"answerChoices",d));let k=ge(e[4]),b=[];for(let o=0;o<k.length;o+=1)b[o]=Ze(Je(e,k,o));let h=null;return k.length||(h=Ke()),{c(){He(t.$$.fragment),r=M();for(let o=0;o<b.length;o+=1)b[o].c();u=Ne(),h&&h.c()},m(o,p){Re(t,o,p),E(o,r,p);for(let C=0;C<b.length;C+=1)b[C]&&b[C].m(o,p);E(o,u,p),h&&h.m(o,p),a=!0},p(o,[p]){const C={};if(!n&&p&1&&(n=!0,C.moduleId=o[0],De(()=>n=!1)),!l&&p&128&&(l=!0,C.questionsInModule=o[7],De(()=>l=!1)),!i&&p&64&&(i=!0,C.answerChoices=o[6],De(()=>i=!1)),t.$set(C),p&62){k=ge(o[4]);let c;for(c=0;c<k.length;c+=1){const D=Je(o,k,c);b[c]?b[c].p(D,p):(b[c]=Ze(D),b[c].c(),b[c].m(u.parentNode,u))}for(;c<b.length;c+=1)b[c].d(1);b.length=k.length,!k.length&&h?h.p(o,p):k.length?h&&(h.d(1),h=null):(h=Ke(),h.c(),h.m(u.parentNode,u))}},i(o){a||(Ie(t.$$.fragment,o),a=!0)},o(o){Ce(t.$$.fragment,o),a=!1},d(o){o&&(H(r),H(u)),Pe(t,o),Ve(b,o),h&&h.d(o)}}}function wt(e,t,n){let l,i,r,{moduleId:u}=t,{createSession:a}=t,{selectDeck:v}=t,{userSelectedDecks:g}=t,d=[],f={};function k(c){if(!c){n(4,d=[]);return}axios.get("/api/decks?module="+c).then(function(D){n(4,d=D.data),d.sort(function(w,q){return w.exam_at===null?1:q.exam_at===null?-1:w.exam_at<q.exam_at})}).catch(function(D){alert(D)})}function b(c){u=c,n(0,u)}function h(c){l=c,n(7,l),n(4,d)}function o(c){i=c,n(6,i),n(8,f),n(4,d)}const p=c=>v(c.id),C=c=>a(c.id);return e.$$set=c=>{"moduleId"in c&&n(0,u=c.moduleId),"createSession"in c&&n(1,a=c.createSession),"selectDeck"in c&&n(2,v=c.selectDeck),"userSelectedDecks"in c&&n(3,g=c.userSelectedDecks)},e.$$.update=()=>{e.$$.dirty&16&&n(7,l=(()=>{var c=[];return d.forEach(D=>c.push(...D.questions)),c})()),e.$$.dirty&16&&(()=>{if(d.length===0)return;const c=d.map(D=>"decks[]="+D.id);axios.get("/api/stats/sessionsfordecks?"+c.join("&")).then(function(D){n(8,f=D.data)}).catch(function(D){alert(D)})})(),e.$$.dirty&256&&n(6,i=(()=>{var c=[];for(const D in f)c.push(...f[D].answer_choices);return c.sort(function(D,w){return D.created_at<w.created_at}),c})()),e.$$.dirty&1&&k(u),e.$$.dirty&272&&n(5,r=(()=>{var c={};if(!f)return c;for(const w of d){if(!f[w.id]){c[w.id]="";continue}const q=f[w.id],I=q.deck.questions.filter(P=>!P.is_invalid),L=q.answer_choices.filter(P=>I.some(({id:F})=>F===P.question_id)),y=ft(I.length,L);var D='style="color: #721c24; background-color: #f8d7da;"';y.correct>=60&&(D='style="color: #155724; background-color: #d4edda;"'),c[w.id]="<span "+D+` class="badge" data-bs-toggle="popover" data-bs-title="Popover title" data-bs-content="And here's some..." title="Correct answers in percent">`+y.correct+" %</span>"}return c})())},[u,a,v,g,d,r,i,l,f,b,h,o,p,C]}class vt extends Ue{constructor(t){super(),Ae(this,t,wt,bt,Le,{moduleId:0,createSession:1,selectDeck:2,userSelectedDecks:3})}}function $e(e){let t,n,l,i,r,u,a,v,g,d=e[1].length+"",f,k,b=e[1].length>1?"s":"",h,o,p,C=e[3].length+"",c,D,w=e[3].length>1?"s":"",q,I,L,y,P,F,V,Z,A,U,oe,Y,B,Q,J,se,le=e[3].length+"",fe,$,ie=e[3].length>1?"s":"",_e,re,me,K,ke,x=e[5].length+"",ue,be,X=e[5].length>1?"s":"",ce,we,ae,te,he,ve,R=e[5].length>0&&xe(e);return{c(){t=_("div"),n=_("div"),l=_("div"),i=_("p"),i.textContent="Create your own super deck:",r=M(),u=_("p"),a=S("You have "),v=_("strong"),g=S("selected "),f=S(d),k=S(" deck"),h=S(b),o=S(`
                    with `),p=_("strong"),c=S(C),D=S(" question"),q=S(w),I=M(),R&&R.c(),L=M(),y=_("div"),P=_("label"),P.textContent="Deck Name",F=M(),V=_("input"),Z=M(),A=_("div"),U=_("input"),oe=M(),Y=_("label"),Y.textContent="Filter out duplicates",B=M(),Q=_("div"),J=_("button"),se=S("Create deck ("),fe=S(le),$=S(" question"),_e=S(ie),re=S(")"),me=M(),K=_("button"),ke=S("Create deck ("),ue=S(x),be=S(" image question"),ce=S(X),we=S(")"),ae=M(),te=_("button"),te.textContent="Cancel",m(P,"for","name"),m(P,"class","form-label"),m(V,"type","text"),m(V,"class","form-control"),m(V,"id","name"),m(y,"class","mb-3"),m(U,"type","checkbox"),m(U,"class","form-check-input"),m(U,"id","checkboxRemoveDuplicates"),m(Y,"class","form-check-label"),m(Y,"for","checkboxRemoveDuplicates"),m(A,"class","mb-3 form-check"),m(J,"class","btn btn-sm btn-primary"),m(K,"class","btn btn-sm btn-primary"),m(te,"class","btn btn-sm btn-link"),m(Q,"class","d-grid gap-2 d-md-block"),m(l,"class","alert alert-light"),m(l,"role","alert"),m(n,"class","col-md"),m(t,"class","row")},m(G,T){E(G,t,T),s(t,n),s(n,l),s(l,i),s(l,r),s(l,u),s(u,a),s(u,v),s(v,g),s(v,f),s(v,k),s(v,h),s(u,o),s(u,p),s(p,c),s(p,D),s(p,q),s(u,I),R&&R.m(u,null),s(l,L),s(l,y),s(y,P),s(y,F),s(y,V),ze(V,e[4]),s(l,Z),s(l,A),s(A,U),U.checked=e[2],s(A,oe),s(A,Y),s(l,B),s(l,Q),s(Q,J),s(J,se),s(J,fe),s(J,$),s(J,_e),s(J,re),s(Q,me),s(Q,K),s(K,ke),s(K,ue),s(K,be),s(K,ce),s(K,we),s(Q,ae),s(Q,te),he||(ve=[W(V,"input",e[6]),W(V,"focus",Dt),W(U,"change",e[7]),W(J,"click",ne(e[8])),W(K,"click",ne(e[9])),W(te,"click",ne(e[10]))],he=!0)},p(G,T){T&2&&d!==(d=G[1].length+"")&&j(f,d),T&2&&b!==(b=G[1].length>1?"s":"")&&j(h,b),T&8&&C!==(C=G[3].length+"")&&j(c,C),T&8&&w!==(w=G[3].length>1?"s":"")&&j(q,w),G[5].length>0?R?R.p(G,T):(R=xe(G),R.c(),R.m(u,null)):R&&(R.d(1),R=null),T&16&&V.value!==G[4]&&ze(V,G[4]),T&4&&(U.checked=G[2]),T&8&&le!==(le=G[3].length+"")&&j(fe,le),T&8&&ie!==(ie=G[3].length>1?"s":"")&&j(_e,ie),T&32&&x!==(x=G[5].length+"")&&j(ue,x),T&32&&X!==(X=G[5].length>1?"s":"")&&j(ce,X)},d(G){G&&H(t),R&&R.d(),he=!1,ot(ve)}}}function xe(e){let t,n,l=e[5].length+"",i,r,u=e[5].length>1?"s":"",a,v;return{c(){t=S("/ "),n=_("strong"),i=S(l),r=S(" question"),a=S(u),v=S(" with images")},m(g,d){E(g,t,d),E(g,n,d),s(n,i),s(n,r),s(n,a),s(n,v)},p(g,d){d&32&&l!==(l=g[5].length+"")&&j(i,l),d&32&&u!==(u=g[5].length>1?"s":"")&&j(a,u)},d(g){g&&(H(t),H(n))}}}function St(e){let t,n=e[1].length>0&&$e(e);return{c(){n&&n.c(),t=Ne()},m(l,i){n&&n.m(l,i),E(l,t,i)},p(l,[i]){l[1].length>0?n?n.p(l,i):(n=$e(l),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:ee,o:ee,d(l){l&&H(t),n&&n.d(l)}}}function et(e,t){var n={name:e,question_ids:t};axios.post("/api/decks",n).then(function(l){window.location.href="/decks/"+l.data.id}).catch(function(l){alert(l)})}const Dt=e=>e.target.select();function It(e,t,n){let l,i,{userSelectedDecks:r}=t,u=[],a="My new super deck",v=!0;function g(){if(r.size===0){n(1,u=[]);return}const o=[...r].map(p=>"decks[]="+p);axios.get("/api/decks?"+o.join("&")).then(function(p){n(1,u=p.data)}).catch(function(p){alert(p)})}function d(){a=this.value,n(4,a)}function f(){v=this.checked,n(2,v)}const k=()=>et(a,l.map(o=>o.id)),b=()=>et(a,i.map(o=>o.id)),h=()=>n(0,r=new Set);return e.$$set=o=>{"userSelectedDecks"in o&&n(0,r=o.userSelectedDecks)},e.$$.update=()=>{e.$$.dirty&1&&g(),e.$$.dirty&6&&n(3,l=(()=>{var o=[];return u.forEach(p=>o.push(...p.questions)),v?[...new Map(o.map(p=>[p.id,p])).values()]:o})()),e.$$.dirty&6&&n(5,i=(()=>{var o=[];return u.forEach(p=>{p.questions.forEach(C=>{C.images.length>0&&o.push(C)})}),v?[...new Map(o.map(p=>[p.id,p])).values()]:o})())},[r,u,v,l,a,i,d,f,k,b,h]}class Ct extends Ue{constructor(t){super(),Ae(this,t,It,St,Le,{userSelectedDecks:0})}}function tt(e,t,n){const l=e.slice();return l[12]=t[n],l}function nt(e,t,n){const l=e.slice();return l[15]=t[n],l}function st(e){let t,n,l=ge(e[2]),i=[];for(let r=0;r<l.length;r+=1)i[r]=lt(nt(e,l,r));return{c(){t=_("ul");for(let r=0;r<i.length;r+=1)i[r].c();n=M(),m(t,"class","list-group m-2 me-0")},m(r,u){E(r,t,u);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(t,null);s(t,n)},p(r,u){if(u&37){l=ge(r[2]);let a;for(a=0;a<l.length;a+=1){const v=nt(r,l,a);i[a]?i[a].p(v,u):(i[a]=lt(v),i[a].c(),i[a].m(t,n))}for(;a<i.length;a+=1)i[a].d(1);i.length=l.length}},d(r){r&&H(t),Ve(i,r)}}}function lt(e){let t,n=e[15].name+"",l,i,r,u;function a(){return e[9](e[15])}return{c(){t=_("button"),l=S(n),m(t,"class",i="list-group-item list-group-item-action "+(e[0].last_module_id===e[15].id?"list-group-item-secondary":"list-group-item-light"))},m(v,g){E(v,t,g),s(t,l),r||(u=W(t,"click",ne(a)),r=!0)},p(v,g){e=v,g&4&&n!==(n=e[15].name+"")&&j(l,n),g&5&&i!==(i="list-group-item list-group-item-action "+(e[0].last_module_id===e[15].id?"list-group-item-secondary":"list-group-item-light"))&&m(t,"class",i)},d(v){v&&H(t),r=!1,u()}}}function it(e){let t,n=e[12].name+"",l,i,r,u,a,v;function g(){return e[8](e[12])}let d=e[0].last_subject_id===e[12].id&&st(e);return{c(){t=_("button"),l=S(n),r=M(),d&&d.c(),u=Ne(),m(t,"class",i="list-group-item list-group-item-action "+(e[0].last_subject_id===e[12].id?"list-group-item-dark":"list-group-item-light"))},m(f,k){E(f,t,k),s(t,l),E(f,r,k),d&&d.m(f,k),E(f,u,k),a||(v=W(t,"click",ne(g)),a=!0)},p(f,k){e=f,k&2&&n!==(n=e[12].name+"")&&j(l,n),k&3&&i!==(i="list-group-item list-group-item-action "+(e[0].last_subject_id===e[12].id?"list-group-item-dark":"list-group-item-light"))&&m(t,"class",i),e[0].last_subject_id===e[12].id?d?d.p(e,k):(d=st(e),d.c(),d.m(u.parentNode,u)):d&&(d.d(1),d=null)},d(f){f&&(H(t),H(r),H(u)),d&&d.d(f),a=!1,v()}}}function Mt(e){let t;return{c(){t=_("p"),t.textContent="No module selected."},m(n,l){E(n,t,l)},p:ee,i:ee,o:ee,d(n){n&&H(t)}}}function qt(e){let t,n,l;function i(u){e[11](u)}let r={moduleId:e[0].last_module_id,createSession:jt,selectDeck:e[6]};return e[3]!==void 0&&(r.userSelectedDecks=e[3]),t=new vt({props:r}),pe.push(()=>Se(t,"userSelectedDecks",i)),{c(){He(t.$$.fragment)},m(u,a){Re(t,u,a),l=!0},p(u,a){const v={};a&1&&(v.moduleId=u[0].last_module_id),!n&&a&8&&(n=!0,v.userSelectedDecks=u[3],De(()=>n=!1)),t.$set(v)},i(u){l||(Ie(t.$$.fragment,u),l=!0)},o(u){Ce(t.$$.fragment,u),l=!1},d(u){Pe(t,u)}}}function yt(e){let t,n,l,i,r,u,a,v,g,d,f,k,b=ge(e[1]),h=[];for(let w=0;w<b.length;w+=1)h[w]=it(tt(e,b,w));function o(w){e[10](w)}let p={};e[3]!==void 0&&(p.userSelectedDecks=e[3]),u=new Ct({props:p}),pe.push(()=>Se(u,"userSelectedDecks",o));const C=[qt,Mt],c=[];function D(w,q){return w[0].last_module_id?0:1}return d=D(e),f=c[d]=C[d](e),{c(){t=_("div"),n=_("div"),l=_("ul");for(let w=0;w<h.length;w+=1)h[w].c();i=M(),r=_("div"),He(u.$$.fragment),v=M(),g=_("div"),f.c(),m(l,"class","list-group"),m(n,"class","col-md-4 mb-2"),m(g,"class","row"),m(r,"class","col-md-8"),m(t,"class","row")},m(w,q){E(w,t,q),s(t,n),s(n,l);for(let I=0;I<h.length;I+=1)h[I]&&h[I].m(l,null);s(t,i),s(t,r),Re(u,r,null),s(r,v),s(r,g),c[d].m(g,null),k=!0},p(w,[q]){if(q&55){b=ge(w[1]);let y;for(y=0;y<b.length;y+=1){const P=tt(w,b,y);h[y]?h[y].p(P,q):(h[y]=it(P),h[y].c(),h[y].m(l,null))}for(;y<h.length;y+=1)h[y].d(1);h.length=b.length}const I={};!a&&q&8&&(a=!0,I.userSelectedDecks=w[3],De(()=>a=!1)),u.$set(I);let L=d;d=D(w),d===L?c[d].p(w,q):(dt(),Ce(c[L],1,1,()=>{c[L]=null}),ut(),f=c[d],f?f.p(w,q):(f=c[d]=C[d](w),f.c()),Ie(f,1),f.m(g,null))},i(w){k||(Ie(u.$$.fragment,w),Ie(f),k=!0)},o(w){Ce(u.$$.fragment,w),Ce(f),k=!1},d(w){w&&H(t),Ve(h,w),Pe(u),c[d].d()}}}function jt(e){var t={deck_id:e};axios.post("/api/sessions",t).then(function(n){window.location.href="/sessions/"+n.data.id}).catch(function(n){alert(n)})}function Ut(e,t,n){let l;ct(e,qe,o=>n(0,l=o));let i=[],r=[],u=[],a=new Set;at(()=>{axios.get("/api/modules").then(function(o){var p=o.data;n(7,i=p.filter((c,D,w)=>D===w.findIndex(q=>q.id===c.id)).sort(function(c,D){return c.name>D.name}));var C=i.map(c=>c.subject).filter(c=>!!c);n(1,r=C.filter((c,D,w)=>D===w.findIndex(q=>q.id===c.id)).sort(function(c,D){return c.name>D.name}))}).catch(function(o){alert(o)})});function v(o){var p={last_subject_id:o,last_module_id:0};axios.put("/api/users/me/settings",p).then(function(C){Ee(qe,l.last_subject_id=o,l),Ee(qe,l.last_module_id=0,l)}).catch(function(C){alert(C)})}function g(o){var p={last_module_id:o};axios.put("/api/users/me/settings",p).then(function(C){Ee(qe,l.last_module_id=o,l)}).catch(function(C){alert(C)})}function d(o){a.has(o)?a.delete(o):a.add(o),n(3,a=new Set([...a]))}const f=o=>v(o.id),k=o=>g(o.id);function b(o){a=o,n(3,a)}function h(o){a=o,n(3,a)}return e.$$.update=()=>{e.$$.dirty&129&&(l.last_subject_id,n(2,u=i.filter(o=>l.last_subject_id?o.subject?o.subject.id===l.last_subject_id:!1:!0)))},[l,r,u,a,v,g,d,i,f,k,b,h]}class At extends Ue{constructor(t){super(),Ae(this,t,Ut,yt,Le,{})}}const Lt=document.getElementById("NewSessionView");new At({target:Lt});
