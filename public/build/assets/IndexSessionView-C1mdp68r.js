import{S as re,i as oe,s as le,k as ae,r as ce,d as H,u as fe,w as M,x as I,y as de,q as F,g as u,o as T,a as q,B as ue,c as f,f as m,C as pe,b as P,t as S,E as w,n as z,l as he,p as ve,A as me,e as _e,D as ke,m as we,z as be}from"./index-C5hKwDc9.js";import{e as $}from"./each-JoEH9o9l.js";import{S as ye}from"./SessionProgressBar-C5ebykMo.js";import{s as Ie}from"./StatsHelper-B91isISU.js";import{f as Pe}from"./formatDistance-U_v5DbzH.js";import{p as x,f as Se}from"./parseISO-DDcmzaBF.js";function ee(t){let e,s,r;return{c(){e=m("button"),e.innerHTML='<i class="bi bi-repeat"></i> Repeat incorrect',u(e,"class","btn btn-sm btn-outline-secondary flex-fill"),w(e,"--bs-btn-padding-y",".25rem"),w(e,"--bs-btn-padding-x",".5rem"),w(e,"--bs-btn-font-size",".75rem"),u(e,"type","button")},m(o,c){q(o,e,c),s||(r=he(e,"click",ve(t[6])),s=!0)},p:z,d(o){o&&H(e),s=!1,r()}}}function Me(t){let e,s,r,o,c,n,i,l=t[0].name+"",a,p,B,v,_,C,G,L,J,O,k,j,N,K,y,V,A,Q,U,W,D,E,R,X,g;function ge(d){t[5](d)}let Y={};t[1]!==void 0&&(Y.progressPercentage=t[1]),s=new ye({props:Y}),ae.push(()=>ce(s,"progressPercentage",ge));let b=t[1].unanswered===0&&t[1].incorrect>0&&ee(t);return{c(){e=m("div"),pe(s.$$.fragment),o=P(),c=m("div"),n=m("div"),i=m("strong"),a=S(l),B=P(),v=m("div"),_=m("a"),C=m("i"),G=S(" Open"),J=P(),b&&b.c(),O=P(),k=m("a"),j=m("i"),K=P(),y=m("div"),V=m("span"),A=m("small"),Q=S(t[3]),U=S(" ago"),W=P(),D=m("span"),E=m("small"),R=S(t[3]),X=S(" ago"),u(n,"class","col-md-5 text-truncate"),u(n,"title",p=t[0].name),u(C,"class","bi bi-rocket-takeoff"),u(_,"href",L="/sessions/"+t[0].id),u(_,"class","btn btn-sm flex-fill"),w(_,"--bs-btn-padding-y",".25rem"),w(_,"--bs-btn-padding-x",".5rem"),w(_,"--bs-btn-font-size",".75rem"),T(_,"btn-primary",t[1].unanswered),T(_,"btn-outline-secondary",!t[1].unanswered),u(j,"class","bi bi-three-dots-vertical"),u(k,"href",N="/sessions/"+t[0].id+"/edit"),u(k,"class","btn btn-sm btn-outline-secondary"),w(k,"--bs-btn-padding-y",".25rem"),w(k,"--bs-btn-padding-x",".5rem"),w(k,"--bs-btn-font-size",".75rem"),u(v,"class","col-md-4 d-flex gap-1"),u(V,"class","float-end d-none d-sm-none d-md-inline"),u(D,"class","d-inline d-sm-inline d-md-none"),u(y,"class","col-md-3 text-muted align-bottom"),u(y,"title",t[2]),u(c,"class","row mt-1"),u(e,"class","mt-1 mb-2 p-2 rounded-2 border shadow-sm session-hover svelte-1ulc2tp")},m(d,h){q(d,e,h),ue(s,e,null),f(e,o),f(e,c),f(c,n),f(n,i),f(i,a),f(c,B),f(c,v),f(v,_),f(_,C),f(_,G),f(v,J),b&&b.m(v,null),f(v,O),f(v,k),f(k,j),f(c,K),f(c,y),f(y,V),f(V,A),f(A,Q),f(A,U),f(y,W),f(y,D),f(D,E),f(E,R),f(E,X),g=!0},p(d,[h]){const Z={};!r&&h&2&&(r=!0,Z.progressPercentage=d[1],de(()=>r=!1)),s.$set(Z),(!g||h&1)&&l!==(l=d[0].name+"")&&F(a,l),(!g||h&1&&p!==(p=d[0].name))&&u(n,"title",p),(!g||h&1&&L!==(L="/sessions/"+d[0].id))&&u(_,"href",L),(!g||h&2)&&T(_,"btn-primary",d[1].unanswered),(!g||h&2)&&T(_,"btn-outline-secondary",!d[1].unanswered),d[1].unanswered===0&&d[1].incorrect>0?b?b.p(d,h):(b=ee(d),b.c(),b.m(v,O)):b&&(b.d(1),b=null),(!g||h&1&&N!==(N="/sessions/"+d[0].id+"/edit"))&&u(k,"href",N),(!g||h&8)&&F(Q,d[3]),(!g||h&8)&&F(R,d[3]),(!g||h&4)&&u(y,"title",d[2])},i(d){g||(I(s.$$.fragment,d),g=!0)},o(d){M(s.$$.fragment,d),g=!1},d(d){d&&H(e),fe(s),b&&b.d()}}}function He(t){axios.post("/api/sessions/"+t+"/newfromincorrect").then(function(e){window.location.href="/sessions/"+e.data.id}).catch(function(e){alert(e)})}function qe(t,e,s){let r,o,c,n,{session:i}=e;function l(p){n=p,s(1,n),s(0,i),s(4,c)}const a=()=>He(i.id);return t.$$set=p=>{"session"in p&&s(0,i=p.session)},t.$$.update=()=>{t.$$.dirty&1&&s(3,r=Pe(x(i.created_at),new Date)),t.$$.dirty&1&&s(2,o=Se(x(i.created_at),"dd.MM.yyyy HH:mm")),t.$$.dirty&1&&s(4,c=i?i.deck.questions.filter(p=>!p.is_invalid):null),t.$$.dirty&17&&s(1,n=i?Ie(c.length,i.answerchoices.filter(p=>c.some(({id:B})=>B===p.question_id))):null)},[i,n,o,r,c,l,a]}class ze extends re{constructor(e){super(),oe(this,e,qe,Me,le,{session:0})}}function se(t,e,s){const r=t.slice();return r[3]=e[s],r[4]=e,r[5]=s,r}function Be(t){let e;return{c(){e=m("div"),e.innerHTML='<div class="spinner-border text-secondary" role="status"><span class="visually-hidden">Loading sessions ...</span></div>',u(e,"class","d-flex justify-content-center")},m(s,r){q(s,e,r)},p:z,i:z,o:z,d(s){s&&H(e)}}}function Le(t){let e,s,r=$(t[0]),o=[];for(let i=0;i<r.length;i+=1)o[i]=te(se(t,r,i));const c=i=>M(o[i],1,1,()=>{o[i]=null});let n=null;return r.length||(n=ne()),{c(){for(let i=0;i<o.length;i+=1)o[i].c();e=_e(),n&&n.c()},m(i,l){for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(i,l);q(i,e,l),n&&n.m(i,l),s=!0},p(i,l){if(l&1){r=$(i[0]);let a;for(a=0;a<r.length;a+=1){const p=se(i,r,a);o[a]?(o[a].p(p,l),I(o[a],1)):(o[a]=te(p),o[a].c(),I(o[a],1),o[a].m(e.parentNode,e))}for(be(),a=r.length;a<o.length;a+=1)c(a);me(),!r.length&&n?n.p(i,l):r.length?n&&(n.d(1),n=null):(n=ne(),n.c(),n.m(e.parentNode,e))}},i(i){if(!s){for(let l=0;l<r.length;l+=1)I(o[l]);s=!0}},o(i){o=o.filter(Boolean);for(let l=0;l<o.length;l+=1)M(o[l]);s=!1},d(i){i&&H(e),we(o,i),n&&n.d(i)}}}function ne(t){let e;return{c(){e=m("div"),e.innerHTML='No sessions yet <i class="bi bi-rocket"></i> ',u(e,"class","alert alert-light text-center"),u(e,"role","alert")},m(s,r){q(s,e,r)},p:z,d(s){s&&H(e)}}}function te(t){let e,s,r;function o(n){t[2](n,t[3],t[4],t[5])}let c={};return t[3]!==void 0&&(c.session=t[3]),e=new ze({props:c}),ae.push(()=>ce(e,"session",o)),{c(){pe(e.$$.fragment)},m(n,i){ue(e,n,i),r=!0},p(n,i){t=n;const l={};!s&&i&1&&(s=!0,l.session=t[3],de(()=>s=!1)),e.$set(l)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){M(e.$$.fragment,n),r=!1},d(n){fe(e,n)}}}function Ne(t){let e,s,r,o;const c=[Le,Be],n=[];function i(l,a){return l[0]?0:1}return e=i(t),s=n[e]=c[e](t),{c(){s.c(),r=_e()},m(l,a){n[e].m(l,a),q(l,r,a),o=!0},p(l,[a]){let p=e;e=i(l),e===p?n[e].p(l,a):(be(),M(n[p],1,1,()=>{n[p]=null}),me(),s=n[e],s?s.p(l,a):(s=n[e]=c[e](l),s.c()),I(s,1),s.m(r.parentNode,r))},i(l){o||(I(s),o=!0)},o(l){M(s),o=!1},d(l){l&&H(r),n[e].d(l)}}}function Ve(t,e,s){let{userId:r}=e;var o=void 0;ke(()=>{axios.get("/api/sessions?take=10&user-id="+r).then(function(n){s(0,o=n.data)}).catch(function(n){alert(n)})});function c(n,i,l,a){l[a]=n,s(0,o)}return t.$$set=n=>{"userId"in n&&s(1,r=n.userId)},[o,r,c]}class Ae extends re{constructor(e){super(),oe(this,e,Ve,Ne,le,{userId:1})}}const ie=document.getElementById("IndexSessionView");new Ae({target:ie,props:{userId:ie.dataset.userId}});
